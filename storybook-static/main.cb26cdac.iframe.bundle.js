(self.webpackChunkhbc_project_controls=self.webpackChunkhbc_project_controls||[]).push([[792],{"./node_modules/@storybook/instrumenter/dist sync recursive"(module){function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=()=>[],webpackEmptyContext.resolve=webpackEmptyContext,webpackEmptyContext.id="./node_modules/@storybook/instrumenter/dist sync recursive",module.exports=webpackEmptyContext},"./storybook-config-entry.js"(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__){"use strict";var external_STORYBOOK_MODULE_CHANNELS_=__webpack_require__("storybook/internal/channels"),csf=__webpack_require__("./node_modules/@storybook/core/dist/csf/index.js"),external_STORYBOOK_MODULE_PREVIEW_API_=__webpack_require__("storybook/internal/preview-api"),external_STORYBOOK_MODULE_GLOBAL_=__webpack_require__("@storybook/global");const pipeline=x=>x(),importers=[async path=>{if(!/^\.[\\/](?:src(?:\/(?!\.)(?:(?:(?!(?:^|\/)\.).)*?)\/|\/|$)(?!\.)(?=.)[^/]*?\.stories\.(ts|tsx|mdx))$/.exec(path))return;const pathRemainder=path.substring(6);return __webpack_require__("./src lazy recursive ^\\.\\/.*$ include: (?%21.*node_modules)(?:\\/src(?:\\/(?%21\\.)(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/%7C\\/%7C$)(?%21\\.)(?=.)[^/]*?\\.stories\\.(ts%7Ctsx%7Cmdx))$")("./"+pathRemainder)}];const channel=(0,external_STORYBOOK_MODULE_CHANNELS_.createBrowserChannel)({page:"preview"});external_STORYBOOK_MODULE_PREVIEW_API_.addons.setChannel(channel),"DEVELOPMENT"===external_STORYBOOK_MODULE_GLOBAL_.global.CONFIG_TYPE&&(window.__STORYBOOK_SERVER_CHANNEL__=channel);const preview=new external_STORYBOOK_MODULE_PREVIEW_API_.PreviewWeb(async function importFn(path){for(let i=0;i<importers.length;i++){const moduleExports=await pipeline(()=>importers[i](path));if(moduleExports)return moduleExports}},()=>{const previewAnnotations=[__webpack_require__("./node_modules/@storybook/react/dist/entry-preview.mjs"),__webpack_require__("./node_modules/@storybook/react/dist/entry-preview-docs.mjs"),__webpack_require__("./node_modules/@storybook/addon-essentials/dist/actions/preview.mjs"),__webpack_require__("./node_modules/@storybook/addon-essentials/dist/docs/preview.mjs"),__webpack_require__("./node_modules/@storybook/addon-essentials/dist/backgrounds/preview.mjs"),__webpack_require__("./node_modules/@storybook/addon-essentials/dist/viewport/preview.mjs"),__webpack_require__("./node_modules/@storybook/addon-essentials/dist/measure/preview.mjs"),__webpack_require__("./node_modules/@storybook/addon-essentials/dist/outline/preview.mjs"),__webpack_require__("./node_modules/@storybook/addon-essentials/dist/highlight/preview.mjs"),__webpack_require__("./node_modules/@storybook/addon-a11y/dist/preview.mjs"),__webpack_require__("./node_modules/@storybook/addon-themes/dist/preview.mjs"),__webpack_require__("./.storybook/preview.ts")],userPreview=previewAnnotations[previewAnnotations.length-1]?.default;return(0,csf.bU)(userPreview)?userPreview.composed:(0,external_STORYBOOK_MODULE_PREVIEW_API_.composeConfigs)(previewAnnotations)});window.__STORYBOOK_PREVIEW__=preview,window.__STORYBOOK_STORY_STORE__=preview.storyStore,window.__STORYBOOK_ADDONS_CHANNEL__=channel},"./node_modules/@storybook/test/dist sync recursive"(module){function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=()=>[],webpackEmptyContext.resolve=webpackEmptyContext,webpackEmptyContext.id="./node_modules/@storybook/test/dist sync recursive",module.exports=webpackEmptyContext},"./.storybook/preview.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{HbcAppDecorator:()=>HbcAppDecorator,default:()=>_storybook_preview});var react=__webpack_require__("./node_modules/react/index.js"),router=__webpack_require__("./src/webparts/hbcProjectControls/router/index.tsx"),FluentProvider=__webpack_require__("./node_modules/@fluentui/react-provider/lib/components/FluentProvider/FluentProvider.js"),AppContext=__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/AppContext.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const HelpContext=react.createContext(void 0),HelpProvider=({children})=>{const{dataService,isFeatureEnabled}=(0,AppContext.Us)(),enabled=isFeatureEnabled("EnableHelpSystem"),[guides,setGuides]=react.useState([]),[supportConfig,setSupportConfig]=react.useState(null),[isHelpPanelOpen,setIsHelpPanelOpen]=react.useState(!1),[isTourActive,setIsTourActive]=react.useState(!1),[tourModuleKey,setTourModuleKey]=react.useState(null),[currentModuleKey,setCurrentModuleKey]=react.useState(null),[helpPanelMode,setHelpPanelMode]=react.useState("targeted"),[isLoading,setIsLoading]=react.useState(!1),[isContactSupportOpen,setIsContactSupportOpen]=react.useState(!1),loadGuides=react.useCallback(async()=>{if(enabled){setIsLoading(!0);try{const[fetchedGuides,config]=await Promise.all([dataService.getHelpGuides(),dataService.getSupportConfig()]);setGuides(fetchedGuides),setSupportConfig(config)}catch(err){console.error("Failed to load help guides:",err)}finally{setIsLoading(!1)}}},[dataService,enabled]);react.useEffect(()=>{loadGuides()},[loadGuides]);const openHelpPanel=react.useCallback((mode="targeted")=>{setHelpPanelMode(mode),setIsHelpPanelOpen(!0)},[]),closeHelpPanel=react.useCallback(()=>setIsHelpPanelOpen(!1),[]),startTour=react.useCallback(moduleKey=>{setTourModuleKey(null!=moduleKey?moduleKey:currentModuleKey),setIsTourActive(!0)},[currentModuleKey]),endTour=react.useCallback(()=>{setIsTourActive(!1),setTourModuleKey(null)},[]),openContactSupport=react.useCallback(()=>setIsContactSupportOpen(!0),[]),closeContactSupport=react.useCallback(()=>setIsContactSupportOpen(!1),[]),value=react.useMemo(()=>({guides,supportConfig,isHelpPanelOpen,helpPanelMode,isTourActive,tourModuleKey,currentModuleKey,isLoading,isContactSupportOpen,openHelpPanel,closeHelpPanel,startTour,endTour,setCurrentModuleKey,refreshGuides:loadGuides,openContactSupport,closeContactSupport}),[guides,supportConfig,isHelpPanelOpen,helpPanelMode,isTourActive,tourModuleKey,currentModuleKey,isLoading,isContactSupportOpen,openHelpPanel,closeHelpPanel,startTour,endTour,loadGuides,openContactSupport,closeContactSupport]);return(0,jsx_runtime.jsx)(HelpContext.Provider,{value,children})};try{HelpProvider.displayName="HelpProvider",HelpProvider.__docgenInfo={description:"",displayName:"HelpProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/contexts/HelpContext.tsx#HelpProvider"]={docgenInfo:HelpProvider.__docgenInfo,name:"HelpProvider",path:"src/webparts/hbcProjectControls/components/contexts/HelpContext.tsx#HelpProvider"})}catch(__react_docgen_typescript_loader_error){}var ToastContainer=__webpack_require__("./src/webparts/hbcProjectControls/components/shared/ToastContainer.tsx"),createLightTheme=__webpack_require__("./node_modules/@fluentui/tokens/lib/utils/createLightTheme.js"),createDarkTheme=__webpack_require__("./node_modules/@fluentui/tokens/lib/utils/createDarkTheme.js"),tokens=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");const hbcBrand={10:"#050A14",20:"#0F1A2E",30:"#142240",40:"#192B52",50:"#1B2A4A",60:"#2C3E6B",70:"#3D5280",80:"#4E6695",90:"#6880AA",100:"#8299BF",110:"#9DB3D4",120:"#B8CDE9",130:"#D3E7FE",140:"#E9F3FF",150:"#F4F9FF",160:"#FAFCFF"},hbcLightTheme=Object.assign(Object.assign({},(0,createLightTheme.a)(hbcBrand)),{colorBrandForeground1:tokens.rf.navy,colorBrandForeground2:tokens.rf.lightNavy,colorBrandForegroundLink:tokens.rf.navy,colorBrandForegroundLinkHover:tokens.rf.lightNavy,colorBrandForegroundLinkPressed:tokens.rf.darkNavy,colorBrandBackground:tokens.rf.navy,colorBrandBackgroundHover:tokens.rf.lightNavy,colorBrandBackgroundPressed:tokens.rf.darkNavy,colorBrandBackgroundSelected:tokens.rf.lightNavy,colorNeutralForeground1:tokens.rf.gray900,colorNeutralForeground2:tokens.rf.gray700,colorNeutralForeground3:tokens.rf.gray500,colorNeutralForeground4:tokens.rf.gray400,colorNeutralForegroundDisabled:tokens.rf.gray300,colorNeutralBackground1:tokens.rf.white,colorNeutralBackground2:tokens.rf.gray50,colorNeutralBackground3:tokens.rf.gray100,colorNeutralBackground4:tokens.rf.gray200,colorNeutralBackground5:tokens.rf.gray300,colorNeutralStroke1:tokens.rf.gray200,colorNeutralStroke2:tokens.rf.gray300,colorNeutralStrokeAccessible:tokens.rf.gray500,colorSubtleBackground:"transparent",colorSubtleBackgroundHover:tokens.rf.gray100,colorSubtleBackgroundPressed:tokens.rf.gray200,colorSubtleBackgroundSelected:tokens.rf.gray100,colorStatusSuccessBackground1:tokens.rf.successLight,colorStatusSuccessForeground1:"#065F46",colorStatusWarningBackground1:tokens.rf.warningLight,colorStatusWarningForeground1:"#92400E",colorStatusDangerBackground1:tokens.rf.errorLight,colorStatusDangerForeground1:"#991B1B",shadow2:tokens.sp.level1,shadow4:tokens.sp.level2,shadow8:tokens.sp.level3,shadow16:tokens.sp.level4});Object.assign({},(0,createDarkTheme.W)(hbcBrand));var src=__webpack_require__("./packages/hbc-sp-services/src/index.ts");(0,__webpack_require__("./src/webparts/hbcProjectControls/theme/hbcEChartsTheme.ts").registerHbcTheme)();const globalMockDataService=new src.IOp,HbcAppDecorator=(Story,context)=>{var _a,_b;const dataService=null!==(_a=context.parameters.dataService)&&void 0!==_a?_a:globalMockDataService;return react.createElement(FluentProvider.q,{theme:hbcLightTheme},react.createElement(router.fS,{initialEntries:[null!==(_b=context.parameters.initialRoute)&&void 0!==_b?_b:"/"]},react.createElement(AppContext.Dv,{dataService},react.createElement(HelpProvider,null,react.createElement(ToastContainer.t,null,react.createElement(Story))))))},_storybook_preview={decorators:[HbcAppDecorator],parameters:{backgrounds:{default:"white",values:[{name:"white",value:"#ffffff"},{name:"light-gray",value:"#f4f4f4"},{name:"navy",value:"#1B2A4A"}]},controls:{matchers:{color:/(background|color)$/i,date:/Date$/}},a11y:{config:{rules:[{id:"landmark-one-main",enabled:!1},{id:"region",enabled:!1},{id:"page-has-heading-one",enabled:!1},{id:"duplicate-id-aria",enabled:!0},{id:"color-contrast",enabled:!0}]},options:{runOnly:{type:"tag",values:["wcag2a","wcag2aa","wcag21aa","wcag22aa","best-practice"]}}}}}},"./packages/hbc-sp-services/src/index.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{IM5:()=>enums.AuditAction,GXp:()=>DEFAULT_HUB_SITE_URL,ckT:()=>enums.EntityType,_Th:()=>ExportService,AMU:()=>MONTHLY_CHECKLIST_SECTIONS,IOp:()=>MockDataService,ZQK:()=>MockTelemetryService,sZ5:()=>NAV_GROUP_ROLES,JjK:()=>PERMISSIONS,wyF:()=>enums.RoleName,BIq:()=>enums.Stage,Rhp:()=>enums.WorkflowKey,ZFx:()=>buildBreadcrumbs,sfZ:()=>computeScheduleMetrics,Ge6:()=>detectSiteContext,wLN:()=>riskEngine.evaluateCommitmentRisk,b4L:()=>getStageLabel,RX0:()=>isActiveStage,JJF:()=>parseScheduleFile,sVR:()=>performanceService});var enums=__webpack_require__("./packages/hbc-sp-services/src/models/enums.ts");const SCORECARD_CRITERIA=[{id:1,label:"Client Importance",high:6,avg:4,low:2},{id:2,label:"Competition (short list)",high:4,avg:2,low:0},{id:3,label:"Estimated Project $",high:4,avg:2,low:1},{id:4,label:"Location/Environment",high:5,avg:3,low:1},{id:5,label:"Commercially Viable",high:6,avg:4,low:2},{id:6,label:"Preferred by Decision Maker",high:6,avg:3,low:0},{id:7,label:"A&E Experience",high:5,avg:4,low:1},{id:8,label:"Staff Availability",high:4,avg:2,low:1},{id:9,label:"Staff Experience in Project Type",high:5,avg:3,low:0},{id:10,label:"Staff Experience in Geography",high:5,avg:3,low:0},{id:11,label:"Schedule",high:3,avg:2,low:1},{id:12,label:"Contract Terms/Conditions",high:4,avg:3,low:0},{id:13,label:"Type of Contract",high:5,avg:4,low:1},{id:14,label:"Client Financing",high:5,avg:3,low:1},{id:15,label:"Supports Sector Diversification",high:7,avg:5,low:2},{id:16,label:"Investment Front End/Time Budgeting, Estimating, Mktg.",high:5,avg:2,low:1},{id:17,label:"Profit Potential",high:5,avg:3,low:2},{id:18,label:"Fee Enhancement Subguard, Billable Rates, Savings Split or all",high:5,avg:3,low:2},{id:19,label:"Self Perform Potential",high:3,avg:2,low:1}],MONTHLY_CHECKLIST_SECTIONS=[{key:"schedule",title:"Schedule",items:[{key:"schedule-status",description:"Current schedule status and critical path review"},{key:"schedule-updates",description:"Schedule updates and look-ahead review"}]},{key:"budget",title:"Budget & Cost",items:[{key:"budget-status",description:"Current budget status and cost report review"},{key:"cost-forecast",description:"Cost-to-complete forecast accuracy"},{key:"change-orders",description:"Change order status and pending items"}]},{key:"buyout",title:"Buyout",items:[{key:"buyout-status",description:"Subcontract buyout status and remaining items"},{key:"buyout-savings",description:"Buyout savings/overruns tracking"}]},{key:"rfi",title:"RFIs",items:[{key:"rfi-status",description:"Open RFI status and aging report"},{key:"rfi-response",description:"RFI response time tracking"}]},{key:"submittals",title:"Submittals",items:[{key:"submittal-status",description:"Submittal log status and critical items"}]},{key:"safety",title:"Safety",items:[{key:"safety-incidents",description:"Safety incident review and near-miss reports"},{key:"safety-compliance",description:"Safety compliance and inspection status"}]},{key:"quality",title:"Quality",items:[{key:"quality-issues",description:"Quality concerns and non-conformance reports"},{key:"quality-inspections",description:"Third-party inspection status"}]},{key:"subcontractors",title:"Subcontractor Management",items:[{key:"sub-performance",description:"Subcontractor performance review"},{key:"sub-issues",description:"Subcontractor issues and back-charges"}]},{key:"owner",title:"Owner Relations",items:[{key:"owner-communication",description:"Owner communication and meeting notes"},{key:"owner-satisfaction",description:"Owner satisfaction and concerns"}]},{key:"cashflow",title:"Cash Flow",items:[{key:"billing-status",description:"Monthly billing status and collections"},{key:"retention",description:"Retention status and release schedule"}]},{key:"risk",title:"Risk Management",items:[{key:"risk-register",description:"Risk register review and updates"},{key:"risk-mitigation",description:"Mitigation plan status"}]},{key:"claims",title:"Claims & Disputes",items:[{key:"claims-status",description:"Active claims and dispute status"}]},{key:"staffing",title:"Staffing",items:[{key:"staffing-plan",description:"Project staffing plan and needs"}]},{key:"closeout",title:"Closeout Planning",items:[{key:"closeout-status",description:"Closeout planning and punch list status"}]},{key:"general",title:"General Notes",items:[{key:"general-notes",description:"Additional notes and action items"}]}];var JobNumberRequestStatus;!function(JobNumberRequestStatus){JobNumberRequestStatus.Pending="Pending",JobNumberRequestStatus.Completed="Completed"}(JobNumberRequestStatus||(JobNumberRequestStatus={}));const DEFAULT_ALERT_THRESHOLDS_unbilledWarningPct=15,DEFAULT_ALERT_THRESHOLDS_feeErosionPct=5,DEFAULT_ALERT_THRESHOLDS_scheduleDelayDays=30,PERMISSIONS={LEAD_CREATE:"lead:create",LEAD_READ:"lead:read",LEAD_EDIT:"lead:edit",LEAD_DELETE:"lead:delete",GONOGO_SCORE_ORIGINATOR:"gonogo:score:originator",GONOGO_SCORE_COMMITTEE:"gonogo:score:committee",GONOGO_SUBMIT:"gonogo:submit",GONOGO_DECIDE:"gonogo:decide",GONOGO_READ:"gonogo:read",PRECON_READ:"precon:read",PRECON_EDIT:"precon:edit",PROPOSAL_READ:"proposal:read",PROPOSAL_EDIT:"proposal:edit",WINLOSS_RECORD:"winloss:record",WINLOSS_READ:"winloss:read",CONTRACT_READ:"contract:read",CONTRACT_EDIT:"contract:edit",CONTRACT_VIEW_FINANCIALS:"contract:view:financials",TURNOVER_READ:"turnover:read",TURNOVER_EDIT:"turnover:edit",CLOSEOUT_READ:"closeout:read",CLOSEOUT_EDIT:"closeout:edit",ESTIMATING_READ:"estimating:read",ESTIMATING_EDIT:"estimating:edit",PRECON_HUB_VIEW:"precon:hub:view",PROJECT_HUB_VIEW:"project:hub:view",ADMIN_ROLES:"admin:roles",ADMIN_FLAGS:"admin:flags",ADMIN_CONFIG:"admin:config",ADMIN_CONNECTIONS:"admin:connections",ADMIN_PROVISIONING:"admin:provisioning",MARKETING_EDIT:"marketing:edit",MARKETING_DASHBOARD_VIEW:"marketing:dashboard:view",SITE_PROVISION:"site:provision",MEETING_SCHEDULE:"meeting:schedule",MEETING_READ:"meeting:read",STARTUP_CHECKLIST_EDIT:"startup:checklist:edit",STARTUP_CHECKLIST_SIGNOFF:"startup:checklist:signoff",MATRIX_EDIT:"matrix:edit",PROJECT_RECORD_EDIT:"projectrecord:edit",PROJECT_RECORD_OPS_EDIT:"projectrecord:ops:edit",PMP_EDIT:"pmp:edit",PMP_APPROVE:"pmp:approve",PMP_FINAL_APPROVE:"pmp:final:approve",PMP_SIGN:"pmp:sign",RISK_EDIT:"risk:edit",QUALITY_EDIT:"quality:edit",SAFETY_EDIT:"safety:edit",SCHEDULE_VIEW:"schedule:view",SCHEDULE_EDIT:"schedule:edit",SCHEDULE_IMPORT:"schedule:import",SCHEDULE_MANAGE:"schedule:manage",SUPERINTENDENT_PLAN_EDIT:"superintendent:plan:edit",LESSONS_EDIT:"lessons:edit",MONTHLY_REVIEW_PM:"monthly:review:pm",MONTHLY_REVIEW_PX:"monthly:review:px",MONTHLY_REVIEW_CREATE:"monthly:review:create",JOB_NUMBER_REQUEST_CREATE:"job_number_request:create",JOB_NUMBER_REQUEST_FINALIZE:"job_number_request:finalize",ACCOUNTING_QUEUE_VIEW:"accounting_queue:view",KICKOFF_VIEW:"kickoff:view",KICKOFF_EDIT:"kickoff:edit",KICKOFF_TEMPLATE_EDIT:"kickoff:template:edit",AUTOPSY_VIEW:"autopsy:view",AUTOPSY_CREATE:"autopsy:create",AUTOPSY_EDIT:"autopsy:edit",AUTOPSY_SCHEDULE:"autopsy:schedule",BUYOUT_VIEW:"buyout:view",BUYOUT_EDIT:"buyout:edit",BUYOUT_MANAGE:"buyout:manage",COMMITMENT_SUBMIT:"commitment:submit",COMMITMENT_APPROVE_PX:"commitment:approve:px",COMMITMENT_APPROVE_COMPLIANCE:"commitment:approve:compliance",COMMITMENT_APPROVE_CFO:"commitment:approve:cfo",COMMITMENT_ESCALATE:"commitment:escalate",CONTRACT_TRACKING_SUBMIT:"contractTracking:submit",CONTRACT_TRACKING_APPROVE_APM:"contractTracking:approve:apm",CONTRACT_TRACKING_APPROVE_PM:"contractTracking:approve:pm",CONTRACT_TRACKING_APPROVE_RISK:"contractTracking:approve:risk",CONTRACT_TRACKING_APPROVE_PX:"contractTracking:approve:px",ACTIVE_PROJECTS_VIEW:"active_projects:view",ACTIVE_PROJECTS_SYNC:"active_projects:sync",COMPLIANCE_LOG_VIEW:"compliance_log:view",WORKFLOW_MANAGE:"workflow:manage",TURNOVER_AGENDA_EDIT:"turnover:agenda:edit",TURNOVER_SIGN:"turnover:sign",PERMISSION_TEMPLATES_MANAGE:"permission:templates:manage",PERMISSION_PROJECT_TEAM_MANAGE:"permission:project_team:manage",PERMISSION_PROJECT_TEAM_VIEW:"permission:project_team:view",GONOGO_REVIEW:"gonogo:review",ADMIN_ASSIGNMENTS:"admin:assignments:manage",CONSTRAINTS_VIEW:"constraints:view",CONSTRAINTS_EDIT:"constraints:edit",CONSTRAINTS_MANAGE:"constraints:manage",PERMITS_VIEW:"permits:view",PERMITS_EDIT:"permits:edit",PERMITS_MANAGE:"permits:manage",ADMIN_TEMPLATE_SYNC:"admin:template:sync"},NAV_GROUP_ROLES={Marketing:["Marketing","BD Representative","Executive Leadership","Department Director","SharePoint Admin"],Preconstruction:["BD Representative","Estimating Coordinator","Preconstruction Team","Executive Leadership","Department Director","Legal","SharePoint Admin"],Operations:["Operations Team","Executive Leadership","Department Director","Risk Management","Quality Control","Safety","IDS","SharePoint Admin"],Accounting:["Accounting Manager","Executive Leadership","Department Director","SharePoint Admin"],Admin:["Executive Leadership","SharePoint Admin"]},ROLE_PERMISSIONS={"BD Representative":[PERMISSIONS.LEAD_CREATE,PERMISSIONS.LEAD_READ,PERMISSIONS.LEAD_EDIT,PERMISSIONS.LEAD_DELETE,PERMISSIONS.GONOGO_SCORE_ORIGINATOR,PERMISSIONS.GONOGO_SUBMIT,PERMISSIONS.GONOGO_READ,PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_RECORD,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.ESTIMATING_READ,PERMISSIONS.MEETING_SCHEDULE,PERMISSIONS.MEETING_READ,PERMISSIONS.SITE_PROVISION,PERMISSIONS.KICKOFF_VIEW,PERMISSIONS.AUTOPSY_VIEW,PERMISSIONS.AUTOPSY_CREATE,PERMISSIONS.AUTOPSY_EDIT,PERMISSIONS.AUTOPSY_SCHEDULE,PERMISSIONS.MARKETING_DASHBOARD_VIEW,PERMISSIONS.MARKETING_EDIT,PERMISSIONS.PROJECT_RECORD_EDIT,PERMISSIONS.PRECON_HUB_VIEW],"Estimating Coordinator":[PERMISSIONS.LEAD_READ,PERMISSIONS.GONOGO_READ,PERMISSIONS.PRECON_EDIT,PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_EDIT,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.ESTIMATING_READ,PERMISSIONS.ESTIMATING_EDIT,PERMISSIONS.MEETING_READ,PERMISSIONS.JOB_NUMBER_REQUEST_CREATE,PERMISSIONS.KICKOFF_VIEW,PERMISSIONS.KICKOFF_EDIT,PERMISSIONS.KICKOFF_TEMPLATE_EDIT,PERMISSIONS.AUTOPSY_VIEW,PERMISSIONS.AUTOPSY_CREATE,PERMISSIONS.AUTOPSY_EDIT,PERMISSIONS.AUTOPSY_SCHEDULE,PERMISSIONS.PRECON_HUB_VIEW,PERMISSIONS.PROJECT_HUB_VIEW,PERMISSIONS.TURNOVER_AGENDA_EDIT,PERMISSIONS.TURNOVER_SIGN],"Accounting Manager":[PERMISSIONS.LEAD_READ,PERMISSIONS.GONOGO_READ,PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.CONTRACT_VIEW_FINANCIALS,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.ESTIMATING_READ,PERMISSIONS.MEETING_READ,PERMISSIONS.JOB_NUMBER_REQUEST_FINALIZE,PERMISSIONS.ACCOUNTING_QUEUE_VIEW],"Preconstruction Team":[PERMISSIONS.PRECON_EDIT,PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_EDIT,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.ESTIMATING_READ,PERMISSIONS.MEETING_READ,PERMISSIONS.KICKOFF_VIEW,PERMISSIONS.AUTOPSY_VIEW,PERMISSIONS.BUYOUT_VIEW,PERMISSIONS.TURNOVER_AGENDA_EDIT],"Operations Team":[PERMISSIONS.TURNOVER_EDIT,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_EDIT,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.MEETING_READ,PERMISSIONS.STARTUP_CHECKLIST_EDIT,PERMISSIONS.MATRIX_EDIT,PERMISSIONS.PROJECT_RECORD_OPS_EDIT,PERMISSIONS.PMP_EDIT,PERMISSIONS.PMP_SIGN,PERMISSIONS.MONTHLY_REVIEW_PM,PERMISSIONS.RISK_EDIT,PERMISSIONS.QUALITY_EDIT,PERMISSIONS.SAFETY_EDIT,PERMISSIONS.SCHEDULE_VIEW,PERMISSIONS.SCHEDULE_EDIT,PERMISSIONS.SCHEDULE_IMPORT,PERMISSIONS.SCHEDULE_MANAGE,PERMISSIONS.SUPERINTENDENT_PLAN_EDIT,PERMISSIONS.LESSONS_EDIT,PERMISSIONS.BUYOUT_VIEW,PERMISSIONS.BUYOUT_EDIT,PERMISSIONS.BUYOUT_MANAGE,PERMISSIONS.PROJECT_HUB_VIEW,PERMISSIONS.COMMITMENT_SUBMIT,PERMISSIONS.CONTRACT_TRACKING_SUBMIT,PERMISSIONS.CONTRACT_TRACKING_APPROVE_APM,PERMISSIONS.CONTRACT_TRACKING_APPROVE_PM,PERMISSIONS.ACTIVE_PROJECTS_VIEW,PERMISSIONS.COMPLIANCE_LOG_VIEW,PERMISSIONS.TURNOVER_AGENDA_EDIT,PERMISSIONS.TURNOVER_SIGN,PERMISSIONS.CONSTRAINTS_VIEW,PERMISSIONS.CONSTRAINTS_EDIT,PERMISSIONS.CONSTRAINTS_MANAGE,PERMISSIONS.PERMITS_VIEW,PERMISSIONS.PERMITS_EDIT,PERMISSIONS.PERMITS_MANAGE],"Executive Leadership":[PERMISSIONS.LEAD_READ,PERMISSIONS.GONOGO_SCORE_COMMITTEE,PERMISSIONS.GONOGO_DECIDE,PERMISSIONS.GONOGO_READ,PERMISSIONS.GONOGO_REVIEW,PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.CONTRACT_VIEW_FINANCIALS,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.ESTIMATING_READ,PERMISSIONS.SCHEDULE_VIEW,PERMISSIONS.SCHEDULE_IMPORT,PERMISSIONS.SCHEDULE_MANAGE,PERMISSIONS.ADMIN_ROLES,PERMISSIONS.ADMIN_FLAGS,PERMISSIONS.ADMIN_CONFIG,PERMISSIONS.ADMIN_CONNECTIONS,PERMISSIONS.ADMIN_PROVISIONING,PERMISSIONS.ADMIN_TEMPLATE_SYNC,PERMISSIONS.ADMIN_ASSIGNMENTS,PERMISSIONS.MEETING_SCHEDULE,PERMISSIONS.MEETING_READ,PERMISSIONS.STARTUP_CHECKLIST_SIGNOFF,PERMISSIONS.MARKETING_DASHBOARD_VIEW,PERMISSIONS.PMP_APPROVE,PERMISSIONS.PMP_FINAL_APPROVE,PERMISSIONS.PMP_SIGN,PERMISSIONS.MONTHLY_REVIEW_PX,PERMISSIONS.MONTHLY_REVIEW_CREATE,PERMISSIONS.KICKOFF_VIEW,PERMISSIONS.KICKOFF_EDIT,PERMISSIONS.KICKOFF_TEMPLATE_EDIT,PERMISSIONS.AUTOPSY_VIEW,PERMISSIONS.AUTOPSY_CREATE,PERMISSIONS.AUTOPSY_EDIT,PERMISSIONS.AUTOPSY_SCHEDULE,PERMISSIONS.BUYOUT_VIEW,PERMISSIONS.BUYOUT_EDIT,PERMISSIONS.PRECON_HUB_VIEW,PERMISSIONS.PROJECT_HUB_VIEW,PERMISSIONS.COMMITMENT_APPROVE_PX,PERMISSIONS.COMMITMENT_APPROVE_CFO,PERMISSIONS.COMMITMENT_ESCALATE,PERMISSIONS.CONTRACT_TRACKING_APPROVE_PX,PERMISSIONS.ACTIVE_PROJECTS_VIEW,PERMISSIONS.ACTIVE_PROJECTS_SYNC,PERMISSIONS.COMPLIANCE_LOG_VIEW,PERMISSIONS.WORKFLOW_MANAGE,PERMISSIONS.TURNOVER_AGENDA_EDIT,PERMISSIONS.TURNOVER_SIGN,PERMISSIONS.PERMISSION_TEMPLATES_MANAGE,PERMISSIONS.PERMISSION_PROJECT_TEAM_MANAGE,PERMISSIONS.PERMISSION_PROJECT_TEAM_VIEW,PERMISSIONS.CONSTRAINTS_VIEW,PERMISSIONS.CONSTRAINTS_EDIT,PERMISSIONS.PERMITS_VIEW,PERMISSIONS.PERMITS_EDIT],"Department Director":[PERMISSIONS.LEAD_READ,PERMISSIONS.SCHEDULE_VIEW,PERMISSIONS.GONOGO_SCORE_COMMITTEE,PERMISSIONS.GONOGO_DECIDE,PERMISSIONS.GONOGO_READ,PERMISSIONS.GONOGO_REVIEW,PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.CONTRACT_VIEW_FINANCIALS,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.ESTIMATING_READ,PERMISSIONS.MEETING_SCHEDULE,PERMISSIONS.MEETING_READ,PERMISSIONS.STARTUP_CHECKLIST_SIGNOFF,PERMISSIONS.MARKETING_DASHBOARD_VIEW,PERMISSIONS.PMP_APPROVE,PERMISSIONS.PMP_FINAL_APPROVE,PERMISSIONS.PMP_SIGN,PERMISSIONS.MONTHLY_REVIEW_PX,PERMISSIONS.MONTHLY_REVIEW_CREATE,PERMISSIONS.KICKOFF_VIEW,PERMISSIONS.KICKOFF_EDIT,PERMISSIONS.KICKOFF_TEMPLATE_EDIT,PERMISSIONS.AUTOPSY_VIEW,PERMISSIONS.AUTOPSY_CREATE,PERMISSIONS.AUTOPSY_EDIT,PERMISSIONS.AUTOPSY_SCHEDULE,PERMISSIONS.BUYOUT_VIEW,PERMISSIONS.BUYOUT_EDIT,PERMISSIONS.PRECON_HUB_VIEW,PERMISSIONS.PROJECT_HUB_VIEW,PERMISSIONS.COMMITMENT_APPROVE_PX,PERMISSIONS.COMMITMENT_APPROVE_CFO,PERMISSIONS.COMMITMENT_ESCALATE,PERMISSIONS.CONTRACT_TRACKING_APPROVE_PX,PERMISSIONS.ACTIVE_PROJECTS_VIEW,PERMISSIONS.ACTIVE_PROJECTS_SYNC,PERMISSIONS.COMPLIANCE_LOG_VIEW,PERMISSIONS.TURNOVER_AGENDA_EDIT,PERMISSIONS.TURNOVER_SIGN,PERMISSIONS.PERMISSION_PROJECT_TEAM_VIEW,PERMISSIONS.CONSTRAINTS_VIEW,PERMISSIONS.CONSTRAINTS_EDIT,PERMISSIONS.PERMITS_VIEW,PERMISSIONS.PERMITS_EDIT],Legal:[PERMISSIONS.LEAD_READ,PERMISSIONS.GONOGO_READ,PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.CONTRACT_EDIT,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.MEETING_READ],"Risk Management":[PERMISSIONS.LEAD_READ,PERMISSIONS.GONOGO_READ,PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.MEETING_READ,PERMISSIONS.RISK_EDIT,PERMISSIONS.COMMITMENT_APPROVE_COMPLIANCE,PERMISSIONS.COMMITMENT_ESCALATE,PERMISSIONS.CONTRACT_TRACKING_APPROVE_RISK,PERMISSIONS.COMPLIANCE_LOG_VIEW],Marketing:[PERMISSIONS.LEAD_READ,PERMISSIONS.GONOGO_READ,PERMISSIONS.PRECON_READ,PERMISSIONS.MARKETING_EDIT,PERMISSIONS.PROPOSAL_EDIT,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.MEETING_READ,PERMISSIONS.PROJECT_RECORD_EDIT,PERMISSIONS.MARKETING_DASHBOARD_VIEW],"Quality Control":[PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.MEETING_READ,PERMISSIONS.QUALITY_EDIT],Safety:[PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.MEETING_READ],IDS:[PERMISSIONS.PRECON_READ,PERMISSIONS.PROPOSAL_READ,PERMISSIONS.WINLOSS_READ,PERMISSIONS.CONTRACT_READ,PERMISSIONS.TURNOVER_READ,PERMISSIONS.CLOSEOUT_READ,PERMISSIONS.MEETING_READ,PERMISSIONS.ADMIN_CONFIG,PERMISSIONS.ADMIN_TEMPLATE_SYNC,PERMISSIONS.PERMISSION_TEMPLATES_MANAGE,PERMISSIONS.PERMISSION_PROJECT_TEAM_MANAGE,PERMISSIONS.PERMISSION_PROJECT_TEAM_VIEW],"SharePoint Admin":[...Object.values(PERMISSIONS)]},CACHE_KEYS_ACTIVE_PROJECTS="hbc_active_projects",CACHE_KEYS_ASSIGNMENTS="hbc_assignments",CACHE_KEYS_DATA_MART="hbc_data_mart",CACHE_KEYS_PORTFOLIO_SUMMARY="hbc_portfolio_summary",CACHE_KEYS_PERSONNEL_WORKLOAD="hbc_personnel_workload",CACHE_KEYS_ACCESSIBLE_PROJECTS="hbc_accessible_projects",CACHE_KEYS_CONSTRAINTS="hbc_constraints",CACHE_KEYS_TEMPLATE_SITE_CONFIG="hbc_template_site_config",CACHE_KEYS_TEMPLATE_REGISTRY="hbc_template_registry",HUB_LISTS={LEADS_MASTER:"Leads_Master",APP_ROLES:"App_Roles",FEATURE_FLAGS:"Feature_Flags",APP_CONTEXT_CONFIG:"App_Context_Config",AUDIT_LOG:"Audit_Log",AUDIT_LOG_ARCHIVE:"Audit_Log_Archive",PROVISIONING_LOG:"Provisioning_Log",ESTIMATING_TRACKER:"Estimating_Tracker",GONOGO_SCORECARD:"GoNoGo_Scorecard",GNG_COMMITTEE:"GNG_Committee",ACTIVE_PROJECTS_PORTFOLIO:"Active_Projects_Portfolio",TEMPLATE_REGISTRY:"Template_Registry",REGIONS:"Regions",SECTORS:"Sectors",AUTOPSY_ATTENDEES:"Autopsy_Attendees",JOB_NUMBER_REQUESTS:"Job_Number_Requests",ESTIMATING_KICKOFFS:"Estimating_Kickoffs",ESTIMATING_KICKOFF_ITEMS:"Estimating_Kickoff_Items",LOSS_AUTOPSIES:"Loss_Autopsies",MARKETING_PROJECT_RECORDS:"Marketing_Project_Records",LESSONS_LEARNED_HUB:"Lessons_Learned_Hub",PROJECT_TYPES:"Project_Types",STANDARD_COST_CODES:"Standard_Cost_Codes",SCORECARD_APPROVAL_CYCLES:"Scorecard_Approval_Cycles",SCORECARD_APPROVAL_STEPS:"Scorecard_Approval_Steps",SCORECARD_VERSIONS:"Scorecard_Versions",WORKFLOW_DEFINITIONS:"Workflow_Definitions",WORKFLOW_STEPS:"Workflow_Steps",WORKFLOW_CONDITIONAL_ASSIGNMENTS:"Workflow_Conditional_Assignments",WORKFLOW_STEP_OVERRIDES:"Workflow_Step_Overrides",PERMISSION_TEMPLATES:"Permission_Templates",SECURITY_GROUP_MAPPINGS:"Security_Group_Mappings",PROJECT_TEAM_ASSIGNMENTS:"Project_Team_Assignments",SECTOR_DEFINITIONS:"Sector_Definitions",ASSIGNMENT_MAPPINGS:"Assignment_Mappings",PERFORMANCE_LOGS:"Performance_Logs",HELP_GUIDES:"Help_Guides",DIVISION_APPROVERS:"Division_Approvers",PMP_BOILERPLATE:"PMP_Boilerplate",PROJECT_DATA_MART:"Project_Data_Mart",TEMPLATE_SITE_CONFIG:"Template_Site_Config",TEMPLATE_MANIFEST_LOG:"Template_Manifest_Log"},LIST_NAMES=Object.assign(Object.assign({},HUB_LISTS),{PROJECT_INFO:"Project_Info",TEAM_MEMBERS:"Team_Members",DELIVERABLES:"Deliverables",ACTION_ITEMS:"Action_Items",TURNOVER_CHECKLIST:"Turnover_Checklist",BUYOUT_LOG:"Buyout_Log",COMMITMENT_APPROVALS:"Commitment_Approvals",CONTRACT_TRACKING_APPROVALS:"Contract_Tracking_Approvals",STARTUP_CHECKLIST:"Startup_Checklist",CHECKLIST_ACTIVITY_LOG:"Checklist_Activity_Log",INTERNAL_MATRIX:"Internal_Matrix",TEAM_ROLE_ASSIGNMENTS:"Team_Role_Assignments",OWNER_CONTRACT_MATRIX:"Owner_Contract_Matrix",SUB_CONTRACT_MATRIX:"Sub_Contract_Matrix",RISK_COST_MANAGEMENT:"Risk_Cost_Management",RISK_COST_ITEMS:"Risk_Cost_Items",QUALITY_CONCERNS:"Quality_Concerns",SAFETY_CONCERNS:"Safety_Concerns",PROJECT_SCHEDULE:"Project_Schedule",CRITICAL_PATH_ITEMS:"Critical_Path_Items",SUPERINTENDENT_PLAN:"Superintendent_Plan",SUPERINTENDENT_PLAN_SECTIONS:"Superintendent_Plan_Sections",LESSONS_LEARNED:"Lessons_Learned",PMP:"Project_Management_Plans",PMP_SIGNATURES:"PMP_Signatures",PMP_APPROVAL_CYCLES:"PMP_Approval_Cycles",PMP_APPROVAL_STEPS:"PMP_Approval_Steps",MONTHLY_REVIEWS:"Monthly_Reviews",MONTHLY_CHECKLIST_ITEMS:"Monthly_Checklist_Items",MONTHLY_FOLLOW_UPS:"Monthly_Follow_Ups",CLOSEOUT_ITEMS:"Closeout_Items",MARKETING_PROJECT_RECORD:"Marketing_Project_Record",CONTRACT_INFO:"Contract_Info",INTERVIEW_PREP:"Interview_Prep",TURNOVER_AGENDAS:"Turnover_Agendas",TURNOVER_PREREQUISITES:"Turnover_Prerequisites",TURNOVER_DISCUSSION_ITEMS:"Turnover_Discussion_Items",TURNOVER_SUBCONTRACTORS:"Turnover_Subcontractors",TURNOVER_EXHIBITS:"Turnover_Exhibits",TURNOVER_SIGNATURES:"Turnover_Signatures",TURNOVER_ATTACHMENTS:"Turnover_Attachments",TURNOVER_ESTIMATE_OVERVIEWS:"Turnover_Estimate_Overviews",SCHEDULE_ACTIVITIES:"Schedule_Activities",SCHEDULE_IMPORTS:"Schedule_Imports",CONSTRAINTS_LOG:"Constraints_Log",PERMITS_LOG:"Permits_Log"}),SCORE_THRESHOLDS_HIGH=69,SCORE_THRESHOLDS_MID=55,DEFAULT_HUB_SITE_URL="https://hedrickbrotherscom.sharepoint.com/sites/HBCentral",PERFORMANCE_THRESHOLDS_SAMPLE_RATE=1,BD_LEADS_SITE_URL="https://hedrickbrotherscom.sharepoint.com/sites/PXPortfolioDashboard",BD_LEADS_SUBFOLDERS=["Client Information","Correspondence","Proposal Documents","Site and Project Plans","Financial Estimates","Evaluations and Scorecards","Contracts and Legal","Media and Visuals","Archives"];function calculateTotalScore(scores,column){let total=0;for(const criterion of SCORECARD_CRITERIA){const score=scores[criterion.id];if(score){const value="originator"===column?score.originator:score.committee;void 0!==value&&(total+=value)}}return total}function getRecommendedDecision(committeeTotal){return committeeTotal>=SCORE_THRESHOLDS_HIGH?{decision:enums.GoNoGoDecision.Go,confidence:"Strong",reasoning:`Committee score of ${committeeTotal} exceeds the Go threshold of ${SCORE_THRESHOLDS_HIGH}`}:committeeTotal>=SCORE_THRESHOLDS_MID?{decision:enums.GoNoGoDecision.ConditionalGo,confidence:"Moderate",reasoning:`Committee score of ${committeeTotal} falls between thresholds (${SCORE_THRESHOLDS_MID}â€“${SCORE_THRESHOLDS_HIGH}). Consider conditional approval.`}:{decision:enums.GoNoGoDecision.NoGo,confidence:"Strong",reasoning:`Committee score of ${committeeTotal} is below the minimum threshold of ${SCORE_THRESHOLDS_MID}`}}function computeScheduleMetrics(activities){const total=activities.length,completedCount=activities.filter(a=>"Completed"===a.status).length,inProgressCount=activities.filter(a=>"In Progress"===a.status).length,notStartedCount=activities.filter(a=>"Not Started"===a.status).length,criticalActivityCount=activities.filter(a=>a.isCritical).length,negativeFloatCount=activities.filter(a=>null!==a.remainingFloat&&a.remainingFloat<0).length,floatsWithValues=activities.filter(a=>null!==a.remainingFloat).map(a=>a.remainingFloat),averageFloat=floatsWithValues.length>0?floatsWithValues.reduce((s,f)=>s+f,0)/floatsWithValues.length:0,percentComplete=total>0?Math.round(completedCount/total*100):0,totalDuration=activities.reduce((s,a)=>s+a.originalDuration,0),earnedDurationBasic=activities.reduce((s,a)=>s+a.actualDuration,0),spiApproximation=totalDuration>0?Math.round(earnedDurationBasic/totalDuration*100)/100:null,floatDistribution={negative:negativeFloatCount,zero:activities.filter(a=>0===a.remainingFloat).length,low:activities.filter(a=>null!==a.remainingFloat&&a.remainingFloat>0&&a.remainingFloat<=10).length,medium:activities.filter(a=>null!==a.remainingFloat&&a.remainingFloat>10&&a.remainingFloat<=30).length,high:activities.filter(a=>null!==a.remainingFloat&&a.remainingFloat>30).length},negativeFloatPercent=total>0?Math.round(negativeFloatCount/total*1e3)/10:0,bac=totalDuration,ev=activities.reduce((s,a)=>s+a.percentComplete/100*a.originalDuration,0),actualDurationTotal=activities.reduce((s,a)=>s+a.actualDuration,0),today=new Date,pv=activities.reduce((s,a)=>{const baseFinish=a.baselineFinishDate?new Date(a.baselineFinishDate):null;if(baseFinish&&baseFinish<=today)return s+a.originalDuration;if(!baseFinish)return s;const baseStart=a.baselineStartDate?new Date(a.baselineStartDate):null;if(baseStart&&baseStart<today&&baseFinish>today){const totalSpan=baseFinish.getTime()-baseStart.getTime(),elapsed=today.getTime()-baseStart.getTime();if(totalSpan>0)return s+a.originalDuration*(elapsed/totalSpan)}return s},0),sv=ev-pv,evSpi=pv>0?Math.round(ev/pv*100)/100:null,evCpi=actualDurationTotal>0?Math.round(ev/actualDurationTotal*100)/100:null,earnedValueMetrics={plannedDuration:Math.round(10*totalDuration)/10,earnedDuration:Math.round(10*ev)/10,actualDuration:Math.round(10*actualDurationTotal)/10,bac:Math.round(10*bac)/10,ev:Math.round(10*ev)/10,pv:Math.round(10*pv)/10,sv:Math.round(10*sv)/10,spi:evSpi,cpi:evCpi},cpiApproximation=evCpi,constraintCounts={};let totalConstrained=0;for(const a of activities)if(a.primaryConstraint&&""!==a.primaryConstraint.trim()){const key=a.primaryConstraint.trim();constraintCounts[key]=(constraintCounts[key]||0)+1,totalConstrained++}const constraintAnalysis={totalConstrained,byType:constraintCounts};let totalRelationships=0,totalPredCount=0,totalSuccCount=0,noSuccessor=0,noPredecessor=0;const relTypeCounts={FS:0,FF:0,SS:0,SF:0};for(const a of activities){totalPredCount+=a.predecessors.length,totalSuccCount+=a.successors.length,0===a.successors.length&&noSuccessor++,0===a.predecessors.length&&noPredecessor++;for(const sd of a.successorDetails){totalRelationships++;const rt=sd.relationshipType;rt in relTypeCounts?relTypeCounts[rt]++:relTypeCounts[rt]=1}}const logicMetrics={totalRelationships,avgPredecessors:total>0?Math.round(totalPredCount/total*10)/10:0,avgSuccessors:total>0?Math.round(totalSuccCount/total*10)/10:0,openEnds:{noSuccessor,noPredecessor},relationshipTypes:relTypeCounts};return{totalActivities:total,completedCount,inProgressCount,notStartedCount,percentComplete,criticalActivityCount,negativeFloatCount,averageFloat:Math.round(10*averageFloat)/10,spiApproximation,floatDistribution,negativeFloatPercent,cpiApproximation,constraintAnalysis,earnedValueMetrics,logicMetrics}}const leads_namespaceObject=JSON.parse('[{"id":1,"Title":"Palm Beach Atlantic University Science Building","ClientName":"Palm Beach Atlantic University","AE":"HKS Architects","CityLocation":"West Palm Beach","AddressCity":"West Palm Beach","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"State","SubSector":"Academic Facilities","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":null,"DateSubmitted":"2026-01-28","SquareFeet":68000,"ProjectValue":42000000,"DeliveryMethod":"GMP","Stage":"Lead-Discovery","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":null,"GoNoGoScore_Committee":null,"GoNoGoDecision":null,"Notes":"University expanding STEM program. Bond referendum passed Nov 2025. Design team already selected."},{"id":2,"Title":"Brightline Orlando Terminal Expansion","ClientName":"Brightline / Florida East Coast Industries","AE":"Zyscovich Architects","CityLocation":"Orlando","AddressCity":"Orlando","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Orlando","Sector":"Municipal","SubSector":"Rail Infrastructure","Division":"Commercial","Originator":"jrodriguez@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":null,"DateSubmitted":"2026-02-03","SquareFeet":125000,"ProjectValue":185000000,"DeliveryMethod":"Other","Stage":"Lead-Discovery","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":null,"GoNoGoScore_Committee":null,"GoNoGoDecision":null,"Notes":"Major expansion to handle increased ridership. Phase 2 of Brightline infrastructure. Very competitive pursuit."},{"id":3,"Title":"Sawgrass Mills Mixed-Use Tower","ClientName":"Simon Property Group","AE":"Arquitectonica","CityLocation":"Sunrise","AddressCity":"Sunrise","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Miami","Sector":"Mixed-Use","SubSector":"Retail / Residential","Division":"Commercial","Originator":"smitchell@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":null,"DateSubmitted":"2026-01-15","SquareFeet":450000,"ProjectValue":320000000,"DeliveryMethod":"GMP","Stage":"Lead-Discovery","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":null,"GoNoGoScore_Committee":null,"GoNoGoDecision":null,"Notes":"35-story mixed-use tower adjacent to Sawgrass Mills. 280 residential units over 85,000 SF retail. Early concept phase."},{"id":4,"Title":"Martin County Fire Station #9","ClientName":"Martin County Board of Commissioners","AE":"TLC Engineering","CityLocation":"Stuart","AddressCity":"Stuart","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Martin County","Sector":"Municipal","SubSector":"Public Safety","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":null,"DateSubmitted":"2026-02-01","SquareFeet":12500,"ProjectValue":8500000,"DeliveryMethod":"Hard-Bid","Stage":"Lead-Discovery","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":null,"GoNoGoScore_Committee":null,"GoNoGoDecision":null,"Notes":"New fire station to serve Indiantown corridor. County approved funding Q4 2025. Bid date expected April 2026."},{"id":5,"Title":"Tallahassee State Office Complex","ClientName":"Florida Department of Management Services","AE":"Leo A Daly","CityLocation":"Tallahassee","AddressCity":"Tallahassee","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Tallahassee","Sector":"State","SubSector":"State Offices","Division":"Commercial","Originator":"jrodriguez@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":null,"DateSubmitted":"2026-01-22","SquareFeet":210000,"ProjectValue":145000000,"DeliveryMethod":"GMP","Stage":"Lead-Discovery","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":null,"GoNoGoScore_Committee":null,"GoNoGoDecision":null,"Notes":"Replacement of aging state office buildings near Capitol Complex. Legislative appropriation pending. Long lead pursuit."},{"id":6,"Title":"Jupiter Inlet Colony Residence","ClientName":"Private Client (Confidential)","AE":"Affiniti Architects","CityLocation":"Jupiter","AddressCity":"Jupiter","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"Commercial","SubSector":"Custom Estate","Division":"Luxury Residential","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":null,"DateSubmitted":"2026-02-05","SquareFeet":14200,"ProjectValue":18500000,"DeliveryMethod":"Precon w/ GMP Amend","Stage":"Lead-Discovery","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":null,"GoNoGoScore_Committee":null,"GoNoGoDecision":null,"Notes":"Oceanfront estate on Jupiter Island. Client referral from completed Manalapan project. High-end finishes, impact glass throughout."},{"id":7,"Title":"Boca Raton Regional Hospital Surgical Wing","ClientName":"Baptist Health South Florida","AE":"Perkins&Will","CityLocation":"Boca Raton","AddressCity":"Boca Raton","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"County","SubSector":"Acute Care","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2026-02-12","DateSubmitted":"2025-12-18","SquareFeet":95000,"ProjectValue":78000000,"DeliveryMethod":"GMP","Stage":"GoNoGo-Pending","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":70,"GoNoGoScore_Committee":null,"GoNoGoDecision":null,"Notes":"New 4-story surgical wing with 12 ORs. Existing client relationship from previous renovation work."},{"id":8,"Title":"Aventura Luxury Condominium Tower","ClientName":"Terra Group","AE":"ODP Architecture","CityLocation":"Aventura","AddressCity":"Aventura","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Miami","Sector":"Multi-Family","SubSector":"High-Rise Condominium","Division":"Commercial","Originator":"smitchell@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2026-02-14","DateSubmitted":"2025-12-02","SquareFeet":580000,"ProjectValue":425000000,"DeliveryMethod":"GMP","Stage":"GoNoGo-Pending","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":64,"GoNoGoScore_Committee":null,"GoNoGoDecision":null,"Notes":"48-story luxury condo. 120 units, private marina. Heavy competition from Coastal and Suffolk."},{"id":9,"Title":"Lake Nona Town Center Phase III","ClientName":"Tavistock Development","AE":"AECOM","CityLocation":"Orlando","AddressCity":"Orlando","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Orlando","Sector":"Mixed-Use","SubSector":"Town Center","Division":"Commercial","Originator":"jrodriguez@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2026-02-10","DateSubmitted":"2025-11-20","SquareFeet":320000,"ProjectValue":210000000,"DeliveryMethod":"GMP","Stage":"GoNoGo-Pending","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":58,"GoNoGoScore_Committee":null,"GoNoGoDecision":null,"Notes":"Third phase of master-planned community. Retail, office, and 200 multifamily units. Orlando market expanding."},{"id":10,"Title":"Port St. Lucie Civic Center Renovation","ClientName":"City of Port St. Lucie","AE":"Song + Associates","CityLocation":"Port St. Lucie","AddressCity":"Port St. Lucie","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Martin County","Sector":"Municipal","SubSector":"Government Facilities","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2026-02-08","DateSubmitted":"2025-11-10","SquareFeet":45000,"ProjectValue":22000000,"DeliveryMethod":"GMP","Stage":"GoNoGo-Pending","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":67,"GoNoGoScore_Committee":null,"GoNoGoDecision":null,"Notes":"Full renovation of 1990s civic center. HVAC replacement, hurricane hardening, ADA compliance upgrades."},{"id":11,"Title":"Delray Beach Atlantic Avenue Hotel","ClientName":"Pebb Capital","AE":"ADD Inc / Stantec","CityLocation":"Delray Beach","AddressCity":"Delray Beach","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"Commercial","SubSector":"Boutique Hotel","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-12-15","DateSubmitted":"2025-10-28","SquareFeet":110000,"ProjectValue":85000000,"DeliveryMethod":"GMP","Stage":"Opportunity","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":62,"GoNoGoScore_Committee":55,"GoNoGoDecision":"Conditional Go","Notes":"175-key boutique hotel on Atlantic Ave. Zoning appeal in progress. Committee wants to see resolution before committing resources."},{"id":12,"Title":"Seminole County School District K-8 Campus","ClientName":"Seminole County Public Schools","AE":"SchenkelShultz Architecture","CityLocation":"Sanford","AddressCity":"Sanford","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Orlando","Sector":"Municipal","SubSector":"New Campus","Division":"Commercial","Originator":"jrodriguez@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-11-22","DateSubmitted":"2025-09-30","SquareFeet":155000,"ProjectValue":62000000,"DeliveryMethod":"GMP","Stage":"Opportunity","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":56,"GoNoGoScore_Committee":48,"GoNoGoDecision":"Conditional Go","Notes":"New K-8 school for 1,200 students. District bond approved but school board delaying timeline. Revisit Q2 2026."},{"id":13,"Title":"Flagler Drive Waterfront Mixed-Use","ClientName":"Related Companies","AE":"Nichols Architects","CityLocation":"West Palm Beach","AddressCity":"West Palm Beach","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"Mixed-Use","SubSector":"Waterfront Development","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-10-20","DateSubmitted":"2025-08-15","SquareFeet":750000,"ProjectValue":650000000,"DeliveryMethod":"GMP","Stage":"Opportunity","ProjectCode":"25-038-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/25-038-01-FlaglerMixedUse","GoNoGoScore_Originator":73,"GoNoGoScore_Committee":71,"GoNoGoDecision":"Go","Notes":"Flagship pursuit. 42-story tower with 350 condos, 120K SF office, ground-floor retail. RFP response due March 2026."},{"id":14,"Title":"FPL Solar Operations Center","ClientName":"Florida Power & Light","AE":"Gensler","CityLocation":"Riviera Beach","AddressCity":"Riviera Beach","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"Warehouse","SubSector":"Utility / Energy","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-09-12","DateSubmitted":"2025-07-20","SquareFeet":48000,"ProjectValue":35000000,"DeliveryMethod":"Other","Stage":"Opportunity","ProjectCode":"25-035-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/25-035-01-FPLSolarOps","GoNoGoScore_Originator":79,"GoNoGoScore_Committee":75,"GoNoGoDecision":"Go","Notes":"Control center for FPL solar farm network. Repeat client. Strong relationship with facilities team. Shortlisted to final 3."},{"id":15,"Title":"Coral Gables Senior Living Community","ClientName":"Belmont Village Senior Living","AE":"Humphreys & Partners","CityLocation":"Coral Gables","AddressCity":"Coral Gables","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Miami","Sector":"Multi-Family","SubSector":"Assisted Living / Memory Care","Division":"Commercial","Originator":"smitchell@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-11-05","DateSubmitted":"2025-09-01","SquareFeet":185000,"ProjectValue":98000000,"DeliveryMethod":"Precon w/ GMP Amend","Stage":"Opportunity","ProjectCode":"25-041-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/25-041-01-CoralGablesSenior","GoNoGoScore_Originator":64,"GoNoGoScore_Committee":61,"GoNoGoDecision":"Go","Notes":"200-unit senior living. Negotiated contract with Belmont. Previous work for this client in Texas market."},{"id":16,"Title":"Kissimmee Gateway Airport Hangar Complex","ClientName":"Kissimmee Gateway Airport Authority","AE":"RS&H","CityLocation":"Kissimmee","AddressCity":"Kissimmee","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Orlando","Sector":"Airport","SubSector":"Aircraft Hangars","Division":"Commercial","Originator":"jrodriguez@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-10-01","DateSubmitted":"2025-08-05","SquareFeet":72000,"ProjectValue":28000000,"DeliveryMethod":"Other","Stage":"Opportunity","ProjectCode":"25-039-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/25-039-01-KissimmeeHangar","GoNoGoScore_Originator":67,"GoNoGoScore_Committee":63,"GoNoGoDecision":"Go","Notes":"Three new corporate hangars with FBO office space. FAA funding component. Interview scheduled Feb 2026."},{"id":17,"Title":"Palm Beach Gardens Medical Pavilion","ClientName":"Jupiter Medical Center","AE":"HKS Architects","CityLocation":"Palm Beach Gardens","AddressCity":"Palm Beach Gardens","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"County","SubSector":"Outpatient / MOB","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-08-18","DateSubmitted":"2025-06-10","SquareFeet":55000,"ProjectValue":38000000,"DeliveryMethod":"GMP","Stage":"Won-ContractPending","ProjectCode":"25-033-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/25-033-01-PBGMedPavilion","GoNoGoScore_Originator":78,"GoNoGoScore_Committee":74,"GoNoGoDecision":"Go","Notes":"Outpatient surgery and imaging center. Awarded Dec 2025. Contract in legal review. GMP development in progress."},{"id":18,"Title":"Manalapan Oceanfront Estate","ClientName":"Private Client (Confidential)","AE":"Bridges Marsh Associates","CityLocation":"Manalapan","AddressCity":"Manalapan","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"Commercial","SubSector":"Custom Estate","Division":"Luxury Residential","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-07-10","DateSubmitted":"2025-05-20","SquareFeet":22000,"ProjectValue":45000000,"DeliveryMethod":"Precon w/ GMP Amend","Stage":"Won-ContractPending","ProjectCode":"25-030-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/25-030-01-ManalapanEstate","GoNoGoScore_Originator":81,"GoNoGoScore_Committee":75,"GoNoGoDecision":"Go","Notes":"Ultra-luxury oceanfront estate. Ocean-to-Intracoastal property. Contract finalization with client\'s attorney. Notice to proceed expected Feb 2026."},{"id":19,"Title":"Fort Lauderdale Parking Structure - Las Olas","ClientName":"City of Fort Lauderdale","AE":"Walker Consultants","CityLocation":"Fort Lauderdale","AddressCity":"Fort Lauderdale","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Miami","Sector":"Parking Garage","SubSector":"Parking Structures","Division":"Commercial","Originator":"smitchell@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-06-05","DateSubmitted":"2025-04-01","SquareFeet":280000,"ProjectValue":32000000,"DeliveryMethod":"GMP","Stage":"Won-ContractPending","ProjectCode":"25-028-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/25-028-01-LasOlasParking","GoNoGoScore_Originator":70,"GoNoGoScore_Committee":66,"GoNoGoDecision":"Go","Notes":"6-level parking garage with 850 spaces. Ground-floor retail liner. Contract approved by city commission, awaiting execution."},{"id":20,"Title":"Norton Museum of Art Expansion","ClientName":"Norton Museum of Art","AE":"Foster + Partners","CityLocation":"West Palm Beach","AddressCity":"West Palm Beach","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"Municipal","SubSector":"Museum / Gallery","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-03-15","DateSubmitted":"2025-01-10","SquareFeet":40000,"ProjectValue":55000000,"DeliveryMethod":"GMP","Stage":"Active-Construction","ProjectCode":"25-012-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/25-012-01-NortonExpansion","GoNoGoScore_Originator":83,"GoNoGoScore_Committee":79,"GoNoGoDecision":"Go","Notes":"New contemporary wing and sculpture garden. Construction started Aug 2025. On schedule, under budget. 35% complete."},{"id":21,"Title":"Doral Logistics Distribution Center","ClientName":"Prologis","AE":"Ware Malcomb","CityLocation":"Doral","AddressCity":"Doral","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Miami","Sector":"Warehouse","SubSector":"Distribution / Warehouse","Division":"Commercial","Originator":"smitchell@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2024-11-20","DateSubmitted":"2024-09-15","SquareFeet":520000,"ProjectValue":68000000,"DeliveryMethod":"Other","Stage":"Active-Construction","ProjectCode":"24-078-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/24-078-01-DoralLogistics","GoNoGoScore_Originator":75,"GoNoGoScore_Committee":72,"GoNoGoDecision":"Go","Notes":"Tilt-wall distribution center with 40-ft clear height. Construction started March 2025. 65% complete. Turnover scheduled Oct 2026."},{"id":22,"Title":"Palm Beach County Convention Center Renovation","ClientName":"Palm Beach County","AE":"TVS Design","CityLocation":"West Palm Beach","AddressCity":"West Palm Beach","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"Commercial","SubSector":"Convention Center","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2024-08-10","DateSubmitted":"2024-06-01","SquareFeet":350000,"ProjectValue":175000000,"DeliveryMethod":"GMP","Stage":"Active-Construction","ProjectCode":"24-052-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/24-052-01-PBCConvention","GoNoGoScore_Originator":79,"GoNoGoScore_Committee":75,"GoNoGoDecision":"Go","Notes":"Major renovation and expansion. New ballroom, exhibit halls, waterfront terrace. Phase 1 substantially complete. Phase 2 underway. 55% overall."},{"id":23,"Title":"Coconut Grove Waterfront Residences","ClientName":"Swire Properties","AE":"Bjarke Ingels Group (BIG)","CityLocation":"Miami","AddressCity":"Miami","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Miami","Sector":"Multi-Family","SubSector":"High-Rise Condominium","Division":"Commercial","Originator":"smitchell@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2024-06-15","DateSubmitted":"2024-04-10","SquareFeet":620000,"ProjectValue":480000000,"DeliveryMethod":"GMP","Stage":"Active-Construction","ProjectCode":"24-042-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/24-042-01-CoconutGroveRes","GoNoGoScore_Originator":77,"GoNoGoScore_Committee":74,"GoNoGoDecision":"Go","Notes":"Twin 38-story luxury towers. 410 units total. Deep foundation work complete. Vertical construction on Tower A at level 22. 40% complete."},{"id":24,"Title":"Indian River State College Pruitt Campus Library","ClientName":"Indian River State College","AE":"SchenkelShultz Architecture","CityLocation":"Fort Pierce","AddressCity":"Fort Pierce","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Martin County","Sector":"State","SubSector":"Academic Facilities","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2024-02-15","DateSubmitted":"2023-12-01","SquareFeet":38000,"ProjectValue":24000000,"DeliveryMethod":"GMP","Stage":"Closeout","ProjectCode":"24-008-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/24-008-01-IRSCLibrary","GoNoGoScore_Originator":73,"GoNoGoScore_Committee":69,"GoNoGoDecision":"Go","Notes":"New learning commons and library. Substantial completion achieved Jan 2026. Punch list 95% complete. Final retainage release pending."},{"id":25,"Title":"Boynton Beach Town Square Phase II","ClientName":"E2L Real Estate Solutions","AE":"MSA Architects","CityLocation":"Boynton Beach","AddressCity":"Boynton Beach","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"Mixed-Use","SubSector":"Town Center","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2023-11-10","DateSubmitted":"2023-09-05","SquareFeet":180000,"ProjectValue":95000000,"DeliveryMethod":"GMP","Stage":"Closeout","ProjectCode":"23-065-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/23-065-01-BoyntonTownSq","GoNoGoScore_Originator":76,"GoNoGoScore_Committee":73,"GoNoGoDecision":"Go","Notes":"Mixed-use: 240 apartments, 30K SF retail, 500-space garage. Substantially complete Nov 2025. Close-out in progress."},{"id":26,"Title":"Miami Design District Retail Pavilion","ClientName":"Dacra Development","AE":"Sou Fujimoto Architects","CityLocation":"Miami","AddressCity":"Miami","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Miami","Sector":"Commercial","SubSector":"Luxury Retail","Division":"Commercial","Originator":"smitchell@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-06-20","DateSubmitted":"2025-04-15","SquareFeet":85000,"ProjectValue":110000000,"DeliveryMethod":"GMP","Stage":"Archived-NoGo","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":52,"GoNoGoScore_Committee":38,"GoNoGoDecision":"No-Go","Notes":"Complex design with high-risk structural elements. Client has unrealistic budget expectations. Committee declined to pursue."},{"id":27,"Title":"Orlando Health Horizon West Hospital","ClientName":"Orlando Health","AE":"HKS Architects","CityLocation":"Winter Garden","AddressCity":"Winter Garden","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Orlando","Sector":"County","SubSector":"Acute Care","Division":"Commercial","Originator":"jrodriguez@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-04-10","DateSubmitted":"2025-02-01","SquareFeet":280000,"ProjectValue":310000000,"DeliveryMethod":"GMP","Stage":"Archived-Loss","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":74,"GoNoGoScore_Committee":69,"GoNoGoDecision":"Go","LossReason":"Price","LossCompetitor":"Brasfield & Gorrie","LossNotes":"Final two. Lost on GMP by $4.2M. B&G had existing MSA with Orlando Health system. Consider JV partnership for future healthcare pursuits in Orlando.","Notes":"New 150-bed community hospital. Strong pursuit but lost in final selection."},{"id":28,"Title":"Vero Beach Oceanfront Resort Renovation","ClientName":"Kimpton Hotels","AE":"Stantec","CityLocation":"Vero Beach","AddressCity":"Vero Beach","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Martin County","Sector":"Commercial","SubSector":"Resort Renovation","Division":"Commercial","Originator":"kfoster@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2024-03-20","DateSubmitted":"2024-01-15","SquareFeet":120000,"ProjectValue":48000000,"DeliveryMethod":"Hard-Bid","Stage":"Archived-Historical","ProjectCode":null,"SiteURL":null,"GoNoGoScore_Originator":56,"GoNoGoScore_Committee":50,"GoNoGoDecision":"Go","LossReason":"Other","LossNotes":"Client shelved renovation plans after Hurricane Ian insurance reassessment. Project indefinitely delayed. May re-emerge in 2027.","Notes":"Full resort renovation including 200 guest rooms, spa, restaurant, pool deck. Project canceled by owner."},{"id":29,"Title":"HBC Corporate Office Renovation","ClientName":"Hedrick Brothers Construction","AE":"SchenkelShultz Architecture","CityLocation":"West Palm Beach","AddressCity":"West Palm Beach","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"West Palm Beach","Sector":"Commercial","SubSector":"Office Building","Division":"Commercial","Originator":"bfetting@hedrickbrothers.com","DepartmentOfOrigin":"Operations","DateOfEvaluation":"2025-01-15","DateSubmitted":"2025-01-10","SquareFeet":45000,"ProjectValue":12500000,"DeliveryMethod":"GMP","Stage":"Active-Construction","ProjectCode":"25-042-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/25-042-01","GoNoGoScore_Originator":92,"GoNoGoScore_Committee":90,"GoNoGoDecision":"Go","Notes":"Internal corporate office renovation project. Full access to all Phase 9/10 features for dev testing.","ProjectAddress":"4200 Blue Heron Blvd, West Palm Beach, FL 33404","ProjectExecutive":"bfetting@hedrickbrothers.com","ProjectManager":"jrodriguez@hedrickbrothers.com","OfficialJobNumber":"25-042-01"},{"id":30,"Title":"Tallahassee State Office Complex","ClientName":"State of Florida DMS","AE":"HOK Architects","CityLocation":"Tallahassee","AddressCity":"Tallahassee","AddressState":"FL","AddressStreet":"","AddressZip":"","Region":"Tallahassee","Sector":"State","SubSector":"Government Office","Division":"Commercial","Originator":"smitchell@hedrickbrothers.com","DepartmentOfOrigin":"Business Development","DateOfEvaluation":"2025-03-10","DateSubmitted":"2025-02-20","SquareFeet":95000,"ProjectValue":28500000,"DeliveryMethod":"GMP","Stage":"Active-Construction","ProjectCode":"25-115-01","SiteURL":"https://hedrickbrothers.sharepoint.com/sites/25-115-01","GoNoGoScore_Originator":78,"GoNoGoScore_Committee":74,"GoNoGoDecision":"Go","Notes":"State government office complex renovation. Phase 1 underway.","ProjectExecutive":"mhedrick@hedrickbrothers.com","ProjectManager":"mrodriguez@hedrickbrothers.com","OfficialJobNumber":"25-115-01"}]'),scorecards_namespaceObject=JSON.parse('{"scorecards":[{"id":1,"LeadID":7,"ProjectCode":null,"scores":{"1":{"originator":6,"committee":4},"2":{"originator":4,"committee":4},"3":{"originator":4,"committee":3},"4":{"originator":5,"committee":4},"5":{"originator":3,"committee":3},"6":{"originator":4,"committee":4},"7":{"originator":5,"committee":5},"8":{"originator":3,"committee":3},"9":{"originator":4,"committee":4},"10":{"originator":4,"committee":3},"11":{"originator":3,"committee":3},"12":{"originator":4,"committee":4},"13":{"originator":4,"committee":4},"14":{"originator":3,"committee":3},"15":{"originator":3,"committee":4},"16":{"originator":4,"committee":3},"17":{"originator":3,"committee":3},"18":{"originator":2,"committee":3},"19":{"originator":2,"committee":3}},"TotalScore_Orig":70,"TotalScore_Cmte":67,"OriginatorComments":"Strong existing client relationship with Baptist Health. We completed renovations at Boca Regional in 2023. Their facilities team is familiar with our work and prefers our approach to occupied healthcare construction.","CommitteeComments":"Good relationship but highly competitive healthcare market. Perkins&Will has a preferred builder list. Need to confirm we are on their short list before committing full pursuit resources.","Decision":"Go","DecisionDate":"2026-02-12","ScoredBy_Orig":"kfoster@hedrickbrothers.com","ScoredBy_Cmte":["mhedrick@hedrickbrothers.com","dpark@hedrickbrothers.com","thedrick@hedrickbrothers.com"],"scorecardStatus":"Locked","currentApprovalStep":2,"committeeScoresEnteredBy":"dpark@hedrickbrothers.com","committeeScoresEnteredDate":"2026-02-11","committeeMeetingDate":"2026-02-11","recommendedDecision":"Go","finalDecision":"Go","finalDecisionBy":"mhedrick@hedrickbrothers.com","finalDecisionDate":"2026-02-12","currentVersion":1,"isLocked":true},{"id":2,"LeadID":8,"ProjectCode":null,"scores":{"1":{"originator":5,"committee":3},"2":{"originator":4,"committee":3},"3":{"originator":3,"committee":2},"4":{"originator":4,"committee":3},"5":{"originator":3,"committee":2},"6":{"originator":3,"committee":3},"7":{"originator":4,"committee":4},"8":{"originator":4,"committee":3},"9":{"originator":3,"committee":3},"10":{"originator":3,"committee":3},"11":{"originator":3,"committee":3},"12":{"originator":3,"committee":3},"13":{"originator":4,"committee":3},"14":{"originator":3,"committee":2},"15":{"originator":3,"committee":3},"16":{"originator":4,"committee":3},"17":{"originator":3,"committee":3},"18":{"originator":3,"committee":2},"19":{"originator":2,"committee":2}},"TotalScore_Orig":64,"TotalScore_Cmte":53,"OriginatorComments":"Terra Group is a top Miami developer with strong pipeline. This would be our largest condo project to date. Relationship is warm but not established.","CommitteeComments":"Very competitive field including Coastal, Suffolk, and Plaza. Our high-rise condo experience is limited. Risk-reward ratio is concerning at this scale without prior relationship. Recommend NO GO.","Decision":"No-Go","DecisionDate":"2026-02-14","ScoredBy_Orig":"smitchell@hedrickbrothers.com","ScoredBy_Cmte":["mhedrick@hedrickbrothers.com","dpark@hedrickbrothers.com"],"scorecardStatus":"Locked","currentApprovalStep":2,"committeeScoresEnteredBy":"dpark@hedrickbrothers.com","committeeScoresEnteredDate":"2026-02-13","recommendedDecision":"No-Go","finalDecision":"No-Go","finalDecisionBy":"mhedrick@hedrickbrothers.com","finalDecisionDate":"2026-02-14","currentVersion":1,"isLocked":true},{"id":3,"LeadID":9,"ProjectCode":null,"scores":{"1":{"originator":4,"committee":3},"2":{"originator":3,"committee":3},"3":{"originator":3,"committee":2},"4":{"originator":3,"committee":3},"5":{"originator":3,"committee":3},"6":{"originator":3,"committee":3},"7":{"originator":3,"committee":3},"8":{"originator":4,"committee":3},"9":{"originator":3,"committee":3},"10":{"originator":2,"committee":2},"11":{"originator":3,"committee":3},"12":{"originator":3,"committee":2},"13":{"originator":3,"committee":3},"14":{"originator":3,"committee":3},"15":{"originator":3,"committee":3},"16":{"originator":3,"committee":3},"17":{"originator":3,"committee":2},"18":{"originator":3,"committee":2},"19":{"originator":2,"committee":2}},"TotalScore_Orig":58,"TotalScore_Cmte":51,"OriginatorComments":"Tavistock is a premier Orlando developer. Lake Nona is one of the fastest-growing communities in FL. This would establish HBC in the Orlando mixed-use market.","CommitteeComments":"Orlando market is outside our core geography. Staffing concerns for a project this size that far from WPB. Would need to hire locally. Margins historically thin on Tavistock projects.","Decision":"No-Go","DecisionDate":"2026-02-10","ScoredBy_Orig":"jrodriguez@hedrickbrothers.com","ScoredBy_Cmte":["mhedrick@hedrickbrothers.com","dpark@hedrickbrothers.com","thedrick@hedrickbrothers.com"],"scorecardStatus":"Locked","currentApprovalStep":2,"committeeScoresEnteredBy":"dpark@hedrickbrothers.com","committeeScoresEnteredDate":"2026-02-09","recommendedDecision":"No-Go","finalDecision":"No-Go","finalDecisionBy":"mhedrick@hedrickbrothers.com","finalDecisionDate":"2026-02-10","currentVersion":1,"isLocked":true},{"id":4,"LeadID":10,"ProjectCode":null,"scores":{"1":{"originator":5,"committee":4},"2":{"originator":4,"committee":4},"3":{"originator":4,"committee":3},"4":{"originator":4,"committee":4},"5":{"originator":3,"committee":3},"6":{"originator":4,"committee":3},"7":{"originator":4,"committee":4},"8":{"originator":3,"committee":3},"9":{"originator":3,"committee":3},"10":{"originator":4,"committee":4},"11":{"originator":3,"committee":3},"12":{"originator":4,"committee":3},"13":{"originator":3,"committee":3},"14":{"originator":3,"committee":3},"15":{"originator":3,"committee":3},"16":{"originator":3,"committee":3},"17":{"originator":4,"committee":4},"18":{"originator":3,"committee":3},"19":{"originator":3,"committee":3}},"TotalScore_Orig":67,"TotalScore_Cmte":63,"OriginatorComments":"Good public sector opportunity on the Treasure Coast. We have strong municipal renovation experience and the project scope aligns well with our capabilities.","CommitteeComments":"Committee scores entered. Awaiting scheduling of committee meeting for final review and scoring.","ScoredBy_Orig":"kfoster@hedrickbrothers.com","ScoredBy_Cmte":["dpark@hedrickbrothers.com"],"scorecardStatus":"Awaiting Committee Scoring","currentApprovalStep":2,"committeeScoresEnteredBy":"dpark@hedrickbrothers.com","committeeScoresEnteredDate":"2026-02-07","currentVersion":1,"isLocked":false},{"id":5,"LeadID":11,"ProjectCode":null,"scores":{"1":{"originator":4,"committee":3},"2":{"originator":4,"committee":3},"3":{"originator":3,"committee":3},"4":{"originator":4,"committee":3},"5":{"originator":3,"committee":2},"6":{"originator":3,"committee":3},"7":{"originator":4,"committee":3},"8":{"originator":3,"committee":3},"9":{"originator":3,"committee":3},"10":{"originator":3,"committee":3},"11":{"originator":3,"committee":3},"12":{"originator":3,"committee":3},"13":{"originator":3,"committee":2},"14":{"originator":3,"committee":3},"15":{"originator":3,"committee":3},"16":{"originator":4,"committee":3},"17":{"originator":3,"committee":2},"18":{"originator":3,"committee":3},"19":{"originator":3,"committee":3}},"TotalScore_Orig":62,"TotalScore_Cmte":55,"OriginatorComments":"Pebb Capital has a strong track record in Delray. Boutique hotel market is growing on Atlantic Ave. Good fit for our hospitality renovation experience.","CommitteeComments":"Zoning appeal creates uncertainty on timeline. If zoning is resolved favorably, this becomes a GO. Conditional approval granted pending zoning resolution.","Decision":"Conditional Go","DecisionDate":"2025-12-15","ScoredBy_Orig":"kfoster@hedrickbrothers.com","ScoredBy_Cmte":["mhedrick@hedrickbrothers.com","dpark@hedrickbrothers.com"],"scorecardStatus":"Locked","currentApprovalStep":2,"committeeScoresEnteredBy":"dpark@hedrickbrothers.com","committeeScoresEnteredDate":"2025-12-14","recommendedDecision":"Conditional Go","finalDecision":"Conditional Go","finalDecisionBy":"mhedrick@hedrickbrothers.com","finalDecisionDate":"2025-12-15","conditionalGoConditions":"Conditional upon favorable zoning appeal resolution. Revisit in 60 days. If zoning denied, revert to No-Go.","currentVersion":1,"isLocked":true},{"id":6,"LeadID":13,"ProjectCode":"25-038-01","scores":{"1":{"originator":6,"committee":5},"2":{"originator":4,"committee":4},"3":{"originator":4,"committee":4},"4":{"originator":5,"committee":5},"5":{"originator":4,"committee":4},"6":{"originator":4,"committee":4},"7":{"originator":5,"committee":5},"8":{"originator":4,"committee":3},"9":{"originator":4,"committee":4},"10":{"originator":3,"committee":3},"11":{"originator":3,"committee":3},"12":{"originator":4,"committee":4},"13":{"originator":3,"committee":3},"14":{"originator":4,"committee":4},"15":{"originator":3,"committee":3},"16":{"originator":4,"committee":4},"17":{"originator":3,"committee":3},"18":{"originator":3,"committee":3},"19":{"originator":3,"committee":3}},"TotalScore_Orig":73,"TotalScore_Cmte":71,"OriginatorComments":"Marquee project for HBC. Related Companies is a top-tier national developer. Flagship waterfront location in our home market. This would be our largest project ever and a transformative win.","CommitteeComments":"High-profile, high-reward. Strong alignment with our strategic plan to grow in large-scale mixed-use. Related has a good reputation for fair contracts. Full pursuit authorized. Allocate senior team.","Decision":"Go","DecisionDate":"2025-10-20","ScoredBy_Orig":"kfoster@hedrickbrothers.com","ScoredBy_Cmte":["mhedrick@hedrickbrothers.com","thedrick@hedrickbrothers.com","dpark@hedrickbrothers.com"],"scorecardStatus":"Locked","currentApprovalStep":2,"committeeScoresEnteredBy":"dpark@hedrickbrothers.com","committeeScoresEnteredDate":"2025-10-19","committeeMeetingDate":"2025-10-19","recommendedDecision":"Go","finalDecision":"Go","finalDecisionBy":"mhedrick@hedrickbrothers.com","finalDecisionDate":"2025-10-20","currentVersion":2,"isLocked":true,"unlockedBy":"mhedrick@hedrickbrothers.com","unlockedDate":"2025-11-05","unlockReason":"Client revised project scope - updating committee scores to reflect larger building footprint"},{"id":7,"LeadID":14,"ProjectCode":"25-035-01","scores":{"1":{"originator":6,"committee":6},"2":{"originator":4,"committee":4},"3":{"originator":4,"committee":4},"4":{"originator":5,"committee":5},"5":{"originator":4,"committee":4},"6":{"originator":5,"committee":4},"7":{"originator":5,"committee":5},"8":{"originator":4,"committee":4},"9":{"originator":4,"committee":4},"10":{"originator":4,"committee":3},"11":{"originator":3,"committee":3},"12":{"originator":4,"committee":4},"13":{"originator":4,"committee":4},"14":{"originator":4,"committee":4},"15":{"originator":4,"committee":3},"16":{"originator":4,"committee":4},"17":{"originator":4,"committee":3},"18":{"originator":4,"committee":4},"19":{"originator":3,"committee":3}},"TotalScore_Orig":79,"TotalScore_Cmte":75,"OriginatorComments":"Repeat client with FPL. Completed two substations for them in 2022-2024. Their facilities director specifically requested HBC. Design-build delivery plays to our strengths.","CommitteeComments":"Excellent pursuit. Repeat client, proven track record, manageable scope. Strong probability of win. Authorize full pursuit with dedicated estimating resources.","Decision":"Go","DecisionDate":"2025-09-12","ScoredBy_Orig":"kfoster@hedrickbrothers.com","ScoredBy_Cmte":["mhedrick@hedrickbrothers.com","dpark@hedrickbrothers.com"],"scorecardStatus":"Locked","currentApprovalStep":2,"committeeScoresEnteredBy":"dpark@hedrickbrothers.com","committeeScoresEnteredDate":"2025-09-11","committeeMeetingDate":"2025-09-11","recommendedDecision":"Go","finalDecision":"Go","finalDecisionBy":"mhedrick@hedrickbrothers.com","finalDecisionDate":"2025-09-12","currentVersion":1,"isLocked":true},{"id":8,"LeadID":12,"ProjectCode":null,"scores":{"1":{"originator":4,"committee":3},"2":{"originator":3,"committee":2},"3":{"originator":3,"committee":2},"4":{"originator":3,"committee":3},"5":{"originator":3,"committee":2},"6":{"originator":3,"committee":3},"7":{"originator":3,"committee":3},"8":{"originator":3,"committee":2},"9":{"originator":3,"committee":3},"10":{"originator":3,"committee":2},"11":{"originator":3,"committee":2},"12":{"originator":3,"committee":3},"13":{"originator":3,"committee":2},"14":{"originator":3,"committee":3},"15":{"originator":3,"committee":3},"16":{"originator":3,"committee":2},"17":{"originator":3,"committee":2},"18":{"originator":2,"committee":2},"19":{"originator":2,"committee":2}},"TotalScore_Orig":56,"TotalScore_Cmte":48,"OriginatorComments":"K-12 public school market is steady work. Seminole County has multiple projects coming from bond referendum. This could lead to program management relationship.","CommitteeComments":"","ScoredBy_Orig":"jrodriguez@hedrickbrothers.com","scorecardStatus":"Awaiting Director Review","currentApprovalStep":1,"currentVersion":1,"isLocked":false},{"id":9,"LeadID":26,"ProjectCode":null,"scores":{"1":{"originator":4,"committee":2},"2":{"originator":3,"committee":2},"3":{"originator":2,"committee":1},"4":{"originator":3,"committee":2},"5":{"originator":3,"committee":2},"6":{"originator":3,"committee":2},"7":{"originator":3,"committee":2},"8":{"originator":3,"committee":2},"9":{"originator":2,"committee":2},"10":{"originator":3,"committee":2},"11":{"originator":3,"committee":2},"12":{"originator":2,"committee":2},"13":{"originator":3,"committee":2},"14":{"originator":3,"committee":2},"15":{"originator":3,"committee":2},"16":{"originator":3,"committee":2},"17":{"originator":2,"committee":2},"18":{"originator":3,"committee":2},"19":{"originator":2,"committee":2}},"TotalScore_Orig":52,"TotalScore_Cmte":38,"OriginatorComments":"Unique architectural design by Sou Fujimoto. High visibility project in Miami Design District. Would be a great portfolio piece for luxury retail sector.","CommitteeComments":"Structural complexity is extremely high with cantilevered glass elements. Client budget is 30% below realistic cost for this design. Dacra has a reputation for pushing contractors on price. Too much risk. NO GO.","Decision":"No-Go","DecisionDate":"2025-06-20","ScoredBy_Orig":"smitchell@hedrickbrothers.com","ScoredBy_Cmte":["mhedrick@hedrickbrothers.com","dpark@hedrickbrothers.com","thedrick@hedrickbrothers.com"],"scorecardStatus":"Locked","currentApprovalStep":2,"committeeScoresEnteredBy":"dpark@hedrickbrothers.com","committeeScoresEnteredDate":"2025-06-19","recommendedDecision":"No-Go","finalDecision":"No-Go","finalDecisionBy":"mhedrick@hedrickbrothers.com","finalDecisionDate":"2025-06-20","currentVersion":1,"isLocked":true},{"id":10,"LeadID":27,"ProjectCode":null,"scores":{"1":{"originator":5},"2":{"originator":4},"3":{"originator":4},"4":{"originator":4},"5":{"originator":4},"6":{"originator":4},"7":{"originator":4},"8":{"originator":4},"9":{"originator":4},"10":{"originator":4},"11":{"originator":3},"12":{"originator":4},"13":{"originator":4},"14":{"originator":4},"15":{"originator":4},"16":{"originator":4},"17":{"originator":3}},"TotalScore_Orig":73,"OriginatorComments":"Major healthcare opportunity in growing Orlando market. Orlando Health is one of the largest health systems in FL. HKS is a trusted AE partner for us. Strong pursuit potential.","ScoredBy_Orig":"jrodriguez@hedrickbrothers.com","scorecardStatus":"BD Draft","currentVersion":1,"isLocked":false}],"scorecardApprovalCycles":[{"id":1,"scorecardId":1,"cycleNumber":1,"version":1,"startedDate":"2026-02-10","completedDate":"2026-02-12","status":"Completed"},{"id":2,"scorecardId":2,"cycleNumber":1,"version":1,"startedDate":"2026-02-12","completedDate":"2026-02-14","status":"Completed"},{"id":3,"scorecardId":3,"cycleNumber":1,"version":1,"startedDate":"2026-02-08","completedDate":"2026-02-10","status":"Completed"},{"id":4,"scorecardId":4,"cycleNumber":1,"version":1,"startedDate":"2026-02-05","status":"Active"},{"id":5,"scorecardId":5,"cycleNumber":1,"version":1,"startedDate":"2025-12-12","completedDate":"2025-12-15","status":"Completed"},{"id":6,"scorecardId":6,"cycleNumber":1,"version":1,"startedDate":"2025-10-17","completedDate":"2025-10-20","status":"Completed"},{"id":7,"scorecardId":6,"cycleNumber":2,"version":2,"startedDate":"2025-11-06","completedDate":"2025-11-08","status":"Completed"},{"id":8,"scorecardId":7,"cycleNumber":1,"version":1,"startedDate":"2025-09-10","completedDate":"2025-09-12","status":"Completed"},{"id":9,"scorecardId":8,"cycleNumber":1,"version":1,"startedDate":"2026-02-06","status":"Active"},{"id":10,"scorecardId":9,"cycleNumber":1,"version":1,"startedDate":"2025-06-18","completedDate":"2025-06-20","status":"Completed"}],"scorecardApprovalSteps":[{"id":1,"cycleId":1,"stepOrder":1,"name":"BD Rep Submission","assigneeEmail":"kfoster@hedrickbrothers.com","assigneeName":"Katie Foster","assignmentSource":"Default","status":"Approved","actionDate":"2026-02-10"},{"id":2,"cycleId":1,"stepOrder":2,"name":"Director of Precon Review","assigneeEmail":"dpark@hedrickbrothers.com","assigneeName":"David Park","assignmentSource":"Default","status":"Approved","actionDate":"2026-02-11"},{"id":3,"cycleId":2,"stepOrder":1,"name":"BD Rep Submission","assigneeEmail":"smitchell@hedrickbrothers.com","assigneeName":"Sarah Mitchell","assignmentSource":"Default","status":"Approved","actionDate":"2026-02-12"},{"id":4,"cycleId":2,"stepOrder":2,"name":"Director of Precon Review","assigneeEmail":"dpark@hedrickbrothers.com","assigneeName":"David Park","assignmentSource":"Default","status":"Approved","actionDate":"2026-02-13"},{"id":5,"cycleId":3,"stepOrder":1,"name":"BD Rep Submission","assigneeEmail":"jrodriguez@hedrickbrothers.com","assigneeName":"Jorge Rodriguez","assignmentSource":"Default","status":"Approved","actionDate":"2026-02-08"},{"id":6,"cycleId":3,"stepOrder":2,"name":"Director of Precon Review","assigneeEmail":"dpark@hedrickbrothers.com","assigneeName":"David Park","assignmentSource":"Default","status":"Approved","actionDate":"2026-02-09"},{"id":7,"cycleId":4,"stepOrder":1,"name":"BD Rep Submission","assigneeEmail":"kfoster@hedrickbrothers.com","assigneeName":"Katie Foster","assignmentSource":"Default","status":"Approved","actionDate":"2026-02-05"},{"id":8,"cycleId":4,"stepOrder":2,"name":"Director of Precon Review","assigneeEmail":"dpark@hedrickbrothers.com","assigneeName":"David Park","assignmentSource":"Default","status":"Approved","actionDate":"2026-02-06"},{"id":9,"cycleId":5,"stepOrder":1,"name":"BD Rep Submission","assigneeEmail":"kfoster@hedrickbrothers.com","assigneeName":"Katie Foster","assignmentSource":"Default","status":"Approved","actionDate":"2025-12-12"},{"id":10,"cycleId":5,"stepOrder":2,"name":"Director of Precon Review","assigneeEmail":"dpark@hedrickbrothers.com","assigneeName":"David Park","assignmentSource":"Default","status":"Approved","actionDate":"2025-12-13"},{"id":11,"cycleId":6,"stepOrder":1,"name":"BD Rep Submission","assigneeEmail":"kfoster@hedrickbrothers.com","assigneeName":"Katie Foster","assignmentSource":"Default","status":"Approved","actionDate":"2025-10-17"},{"id":12,"cycleId":6,"stepOrder":2,"name":"Director of Precon Review","assigneeEmail":"dpark@hedrickbrothers.com","assigneeName":"David Park","assignmentSource":"Default","status":"Approved","actionDate":"2025-10-18"},{"id":13,"cycleId":7,"stepOrder":1,"name":"BD Rep Submission","assigneeEmail":"kfoster@hedrickbrothers.com","assigneeName":"Katie Foster","assignmentSource":"Default","status":"Approved","actionDate":"2025-11-06"},{"id":14,"cycleId":7,"stepOrder":2,"name":"Director of Precon Review","assigneeEmail":"dpark@hedrickbrothers.com","assigneeName":"David Park","assignmentSource":"Default","status":"Approved","actionDate":"2025-11-07"},{"id":15,"cycleId":8,"stepOrder":1,"name":"BD Rep Submission","assigneeEmail":"kfoster@hedrickbrothers.com","assigneeName":"Katie Foster","assignmentSource":"Default","status":"Approved","actionDate":"2025-09-10"},{"id":16,"cycleId":8,"stepOrder":2,"name":"Director of Precon Review","assigneeEmail":"dpark@hedrickbrothers.com","assigneeName":"David Park","assignmentSource":"Default","status":"Approved","actionDate":"2025-09-11"},{"id":17,"cycleId":9,"stepOrder":1,"name":"BD Rep Submission","assigneeEmail":"jrodriguez@hedrickbrothers.com","assigneeName":"Jorge Rodriguez","assignmentSource":"Default","status":"Approved","actionDate":"2026-02-06"},{"id":18,"cycleId":9,"stepOrder":2,"name":"Director of Precon Review","assigneeEmail":"dpark@hedrickbrothers.com","assigneeName":"David Park","assignmentSource":"Default","status":"Pending"},{"id":19,"cycleId":10,"stepOrder":1,"name":"BD Rep Submission","assigneeEmail":"smitchell@hedrickbrothers.com","assigneeName":"Sarah Mitchell","assignmentSource":"Default","status":"Approved","actionDate":"2025-06-18"},{"id":20,"cycleId":10,"stepOrder":2,"name":"Director of Precon Review","assigneeEmail":"dpark@hedrickbrothers.com","assigneeName":"David Park","assignmentSource":"Default","status":"Approved","actionDate":"2025-06-19"}],"scorecardVersions":[{"id":1,"scorecardId":1,"versionNumber":1,"createdDate":"2026-02-12","createdBy":"mhedrick@hedrickbrothers.com","reason":"Initial decision recorded","originalScores":{"1":6,"2":4,"3":4,"4":5,"5":3,"6":4,"7":5,"8":3,"9":4,"10":4,"11":3,"12":4,"13":4,"14":3,"15":3,"16":4,"17":3,"18":2,"19":2},"committeeScores":{"1":4,"2":4,"3":3,"4":4,"5":3,"6":4,"7":5,"8":3,"9":4,"10":3,"11":3,"12":4,"13":4,"14":3,"15":4,"16":3,"17":3,"18":3,"19":3},"totalOriginal":70,"totalCommittee":67,"decision":"Go"},{"id":2,"scorecardId":2,"versionNumber":1,"createdDate":"2026-02-14","createdBy":"mhedrick@hedrickbrothers.com","reason":"Initial decision recorded","originalScores":{"1":5,"2":4,"3":3,"4":4,"5":3,"6":3,"7":4,"8":4,"9":3,"10":3,"11":3,"12":3,"13":4,"14":3,"15":3,"16":4,"17":3,"18":3,"19":2},"committeeScores":{"1":3,"2":3,"3":2,"4":3,"5":2,"6":3,"7":4,"8":3,"9":3,"10":3,"11":3,"12":3,"13":3,"14":2,"15":3,"16":3,"17":3,"18":2,"19":2},"totalOriginal":64,"totalCommittee":53,"decision":"No-Go"},{"id":3,"scorecardId":6,"versionNumber":1,"createdDate":"2025-10-20","createdBy":"mhedrick@hedrickbrothers.com","reason":"Initial decision recorded","originalScores":{"1":6,"2":4,"3":4,"4":5,"5":4,"6":4,"7":5,"8":4,"9":4,"10":3,"11":3,"12":4,"13":3,"14":4,"15":3,"16":4,"17":3,"18":3,"19":3},"committeeScores":{"1":5,"2":4,"3":3,"4":5,"5":4,"6":3,"7":5,"8":3,"9":4,"10":3,"11":3,"12":4,"13":3,"14":4,"15":3,"16":4,"17":3,"18":3,"19":3},"totalOriginal":73,"totalCommittee":69,"decision":"Go"},{"id":4,"scorecardId":6,"versionNumber":2,"createdDate":"2025-11-08","createdBy":"mhedrick@hedrickbrothers.com","reason":"Re-scored after client scope revision - larger building footprint increases project value","originalScores":{"1":6,"2":4,"3":4,"4":5,"5":4,"6":4,"7":5,"8":4,"9":4,"10":3,"11":3,"12":4,"13":3,"14":4,"15":3,"16":4,"17":3,"18":3,"19":3},"committeeScores":{"1":5,"2":4,"3":4,"4":5,"5":4,"6":4,"7":5,"8":3,"9":4,"10":3,"11":3,"12":4,"13":3,"14":4,"15":3,"16":4,"17":3,"18":3,"19":3},"totalOriginal":73,"totalCommittee":71,"decision":"Go"},{"id":5,"scorecardId":5,"versionNumber":1,"createdDate":"2025-12-15","createdBy":"mhedrick@hedrickbrothers.com","reason":"Initial decision recorded","originalScores":{"1":4,"2":4,"3":3,"4":4,"5":3,"6":3,"7":4,"8":3,"9":3,"10":3,"11":3,"12":3,"13":3,"14":3,"15":3,"16":4,"17":3,"18":3,"19":3},"committeeScores":{"1":3,"2":3,"3":3,"4":3,"5":2,"6":3,"7":3,"8":3,"9":3,"10":3,"11":3,"12":3,"13":2,"14":3,"15":3,"16":3,"17":2,"18":3,"19":3},"totalOriginal":62,"totalCommittee":55,"decision":"Conditional Go","conditions":"Conditional upon favorable zoning appeal resolution. Revisit in 60 days. If zoning denied, revert to No-Go."}]}'),estimating_namespaceObject=JSON.parse('[{"id":1,"Title":"Palm Beach County - EOC Four Points Connector","LeadID":13,"ProjectCode":"25-038-01","Source":"RFP","DeliverableType":"GMP","SubBidsDue":"2026-03-01","PreSubmissionReview":"2026-03-05","WinStrategyMeeting":"2026-02-20","DueDate_OutTheDoor":"2026-03-15","LeadEstimator":"Sam","LeadEstimatorId":1,"Contributors":["Vito","Hank"],"ContributorIds":[2,4],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":false,"Chk_BIMProposal":true,"Chk_PreconProposal":false,"Chk_ProposalTabs":false,"Chk_CoordMarketing":false,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"GMP","EstimatedCostValue":650000000,"CostPerGSF":867,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":"Pending","NotesFeedback":"Flagship pursuit. 42-story tower. RFP response due March 2026."},{"id":2,"Title":"Alton Hilltop (Kolter)","LeadID":14,"ProjectCode":"25-035-01","Source":"Client Request","DeliverableType":"Lump Sum Proposal","SubBidsDue":"2026-02-15","PreSubmissionReview":"2026-02-18","WinStrategyMeeting":"2026-02-10","DueDate_OutTheDoor":"2026-02-28","LeadEstimator":"Sam","LeadEstimatorId":1,"Contributors":["Bill"],"ContributorIds":[3],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":false,"Chk_CoordMarketing":false,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"Lump Sum Proposal","EstimatedCostValue":35000000,"CostPerGSF":729,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":"Pending","NotesFeedback":"Repeat client. Design-build proposal with Kimley-Horn."},{"id":3,"Title":"Murray Middle School","LeadID":15,"ProjectCode":"25-041-01","Source":"RFP","DeliverableType":"GMP","SubBidsDue":"2026-03-15","PreSubmissionReview":"2026-03-20","WinStrategyMeeting":"2026-03-01","DueDate_OutTheDoor":"2026-04-01","LeadEstimator":"Vito","LeadEstimatorId":2,"Contributors":["Claudia"],"ContributorIds":[7],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":true,"Chk_PPBond":false,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":false,"Chk_PreconProposal":false,"Chk_ProposalTabs":false,"Chk_CoordMarketing":false,"Chk_BusinessTerms":false,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"GMP","EstimatedCostValue":98000000,"CostPerGSF":530,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":null,"NotesFeedback":"Negotiated contract with Belmont. Focus on value engineering."},{"id":4,"Title":"Winter Springs ILF","LeadID":16,"ProjectCode":"25-039-01","Source":"RFQ","DeliverableType":"Lump Sum Proposal","SubBidsDue":"2026-02-28","PreSubmissionReview":"2026-03-05","WinStrategyMeeting":"2026-02-15","DueDate_OutTheDoor":"2026-03-20","LeadEstimator":"Bill","LeadEstimatorId":3,"Contributors":["Hunter"],"ContributorIds":[5],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":false,"Chk_Logistics":false,"Chk_BIMProposal":false,"Chk_PreconProposal":false,"Chk_ProposalTabs":false,"Chk_CoordMarketing":false,"Chk_BusinessTerms":false,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"Lump Sum Proposal","EstimatedCostValue":28000000,"CostPerGSF":389,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":null,"NotesFeedback":"FAA funding requires Davis-Bacon compliance. Interview scheduled Feb 20."},{"id":5,"Title":"PGA Tower - The Modern","LeadID":17,"ProjectCode":"25-033-01","Source":"Client Request","DeliverableType":"GMP","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Hank","LeadEstimatorId":4,"Contributors":["Sam"],"ContributorIds":[1],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"GMP","EstimatedCostValue":38000000,"CostPerGSF":691,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":"Pending","NotesFeedback":"Won - transitioning to GMP development. All checklist items complete."},{"id":6,"Title":"Boca Raton Regional Hospital Surgical Wing","LeadID":7,"ProjectCode":"26-004-01","Source":"RFP","DeliverableType":"Conceptual Est","SubBidsDue":"2026-04-15","PreSubmissionReview":"2026-04-20","WinStrategyMeeting":"2026-03-10","DueDate_OutTheDoor":"2026-05-01","LeadEstimator":"Hank","LeadEstimatorId":4,"Contributors":["Jayden"],"ContributorIds":[6],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":false,"Chk_PPBond":false,"Chk_Schedule":false,"Chk_Logistics":false,"Chk_BIMProposal":false,"Chk_PreconProposal":false,"Chk_ProposalTabs":false,"Chk_CoordMarketing":false,"Chk_BusinessTerms":false,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"Conceptual Est","EstimatedCostValue":78000000,"CostPerGSF":821,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":null,"NotesFeedback":"Pending Go/No-Go decision. Healthcare-specialized estimating required."},{"id":7,"Title":"Port St. Lucie Civic Center Renovation","LeadID":10,"ProjectCode":"26-005-01","Source":"RFQ","DeliverableType":"GMP","SubBidsDue":"2026-04-01","PreSubmissionReview":"2026-04-05","WinStrategyMeeting":"2026-03-15","DueDate_OutTheDoor":"2026-04-15","LeadEstimator":"Sam","LeadEstimatorId":1,"Contributors":["Hunter"],"ContributorIds":[5],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":false,"Chk_PPBond":false,"Chk_Schedule":false,"Chk_Logistics":false,"Chk_BIMProposal":false,"Chk_PreconProposal":false,"Chk_ProposalTabs":false,"Chk_CoordMarketing":false,"Chk_BusinessTerms":false,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"GMP","EstimatedCostValue":22000000,"CostPerGSF":489,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":null,"NotesFeedback":"Just received Go decision. Municipal renovation - need phasing plan for occupied building."},{"id":8,"Title":"Manalapan Oceanfront Estate","LeadID":18,"ProjectCode":"25-030-01","Source":"Referral","DeliverableType":"Lump Sum Proposal","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Vito","LeadEstimatorId":2,"Contributors":["Claudia"],"ContributorIds":[7],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"Lump Sum Proposal","EstimatedCostValue":45000000,"CostPerGSF":2045,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":"Pending","NotesFeedback":"Contract pending with client\'s attorney. All estimating complete."},{"id":9,"Title":"Fort Lauderdale Parking Structure - Las Olas","LeadID":19,"ProjectCode":"25-028-01","Source":"RFP","DeliverableType":"GMP","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Vito","LeadEstimatorId":2,"Contributors":["Bill"],"ContributorIds":[3],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"GMP","EstimatedCostValue":32000000,"CostPerGSF":114,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":"Pending","NotesFeedback":"Won. City commission approved contract. GMP accepted. NTP expected Feb 2026."},{"id":10,"Title":"Norton Museum of Art Expansion","LeadID":20,"ProjectCode":"25-012-01","Source":"Client Request","DeliverableType":"GMP","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Sam","LeadEstimatorId":1,"Contributors":["Hank"],"ContributorIds":[4],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":"GMP","PreconFee":72000,"FeePaidToDate":72000,"DesignBudget":65000,"EstimateType":"GMP","EstimatedCostValue":55000000,"CostPerGSF":1375,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":"Pending","NotesFeedback":"GMP approved. Construction underway. Preconstruction phase complete."},{"id":11,"Title":"Palm Beach County Convention Center Renovation","LeadID":22,"ProjectCode":"24-052-01","Source":"RFP","DeliverableType":"GMP","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Hank","LeadEstimatorId":4,"Contributors":["Sam","Vito"],"ContributorIds":[1,2],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":"90% CD","PreconFee":133000,"FeePaidToDate":110000,"DesignBudget":120000,"EstimateType":"GMP","EstimatedCostValue":175000000,"CostPerGSF":500,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":"Pending","NotesFeedback":"Phase 2 GMP amendment in development for expanded ballroom scope."},{"id":12,"Title":"Coconut Grove Waterfront Residences","LeadID":23,"ProjectCode":"24-042-01","Source":"Client Request","DeliverableType":"GMP","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Vito","LeadEstimatorId":2,"Contributors":["Hank","Claudia"],"ContributorIds":[4,7],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":"GMP","PreconFee":98000,"FeePaidToDate":78000,"DesignBudget":88000,"EstimateType":"GMP","EstimatedCostValue":480000000,"CostPerGSF":774,"CostPerUnit":1170732,"SubmittedDate":null,"AwardStatus":"Pending","NotesFeedback":"GMP approved for both towers. Tower A under construction."},{"id":13,"Title":"Doral Logistics Distribution Center","LeadID":21,"ProjectCode":"24-078-01","Source":"Client Request","DeliverableType":"Lump Sum Proposal","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Vito","LeadEstimatorId":2,"Contributors":["Hunter"],"ContributorIds":[5],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":"50% CD","PreconFee":55000,"FeePaidToDate":55000,"DesignBudget":48000,"EstimateType":"Lump Sum Proposal","EstimatedCostValue":68000000,"CostPerGSF":131,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":"Pending","NotesFeedback":"Design-build with Ware Malcomb. GMP approved. Construction progressing."},{"id":14,"Title":"Indian River State College Pruitt Campus Library","LeadID":24,"ProjectCode":"24-008-01","Source":"RFP","DeliverableType":"Schematic","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Sam","LeadEstimatorId":1,"Contributors":["Jayden"],"ContributorIds":[6],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":"SD","PreconFee":16000,"FeePaidToDate":16000,"DesignBudget":14000,"EstimateType":"Schematic","EstimatedCostValue":24000000,"CostPerGSF":632,"CostPerUnit":null,"SubmittedDate":null,"AwardStatus":"Pending","NotesFeedback":"Project in closeout. Preconstruction completed on SD documents."},{"id":15,"Title":"Delray Beach Fire Station #4 Replacement","LeadID":null,"ProjectCode":"25-022-01","Source":"RFP","DeliverableType":"Hard Bid","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Sam","LeadEstimatorId":1,"Contributors":[],"ContributorIds":[],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"Hard Bid","EstimatedCostValue":9500000,"CostPerGSF":679,"CostPerUnit":null,"SubmittedDate":"2025-09-15","AwardStatus":"Awarded w/ Precon","NotesFeedback":"Won competitive hard bid. Construction started Jan 2026."},{"id":16,"Title":"Wellington Equestrian Facility Expansion","LeadID":null,"ProjectCode":"25-025-01","Source":"Client Request","DeliverableType":"Lump Sum Proposal","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Hank","LeadEstimatorId":4,"Contributors":["Bill"],"ContributorIds":[3],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"Lump Sum Proposal","EstimatedCostValue":15000000,"CostPerGSF":231,"CostPerUnit":null,"SubmittedDate":"2025-11-01","AwardStatus":"Awarded w/o Precon","NotesFeedback":"Design-build award. Fast-track schedule for 2027 equestrian season."},{"id":17,"Title":"Broward College Central Campus Student Center","LeadID":null,"ProjectCode":"25-019-01","Source":"RFP","DeliverableType":"GMP","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Vito","LeadEstimatorId":2,"Contributors":["Sam"],"ContributorIds":[1],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"GMP","EstimatedCostValue":28000000,"CostPerGSF":538,"CostPerUnit":null,"SubmittedDate":"2025-08-20","AwardStatus":"Not Awarded","NotesFeedback":"Lost to Kaufman Lynn by $800K. Existing relationship was decisive."},{"id":18,"Title":"Jupiter Medical Center MOB Phase II","LeadID":null,"ProjectCode":"25-015-01","Source":"Client Request","DeliverableType":"GMP","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Hank","LeadEstimatorId":4,"Contributors":[],"ContributorIds":[],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"GMP","EstimatedCostValue":22000000,"CostPerGSF":550,"CostPerUnit":null,"SubmittedDate":"2025-06-15","AwardStatus":"Awarded w/ Precon","NotesFeedback":"Negotiated follow-on work. Precon VE saved client $1.2M."},{"id":19,"Title":"Miami Lakes Athletic Club Renovation","LeadID":null,"ProjectCode":"25-020-01","Source":"RFQ","DeliverableType":"Hard Bid","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Vito","LeadEstimatorId":2,"Contributors":[],"ContributorIds":[],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"Hard Bid","EstimatedCostValue":5200000,"CostPerGSF":289,"CostPerUnit":null,"SubmittedDate":"2025-10-10","AwardStatus":"Not Awarded","NotesFeedback":"Lost by $180K. Miller had lower MEP sub pricing."},{"id":20,"Title":"Tequesta Country Club Clubhouse","LeadID":null,"ProjectCode":"25-027-01","Source":"Referral","DeliverableType":"Lump Sum Proposal","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Sam","LeadEstimatorId":1,"Contributors":["Claudia"],"ContributorIds":[7],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"Lump Sum Proposal","EstimatedCostValue":18000000,"CostPerGSF":750,"CostPerUnit":null,"SubmittedDate":"2025-12-01","AwardStatus":"Pending","NotesFeedback":"Negotiated proposal submitted. Club board reviewing in February."},{"id":21,"Title":"Boca West Country Club Pool Complex","LeadID":null,"ProjectCode":"26-001-01","Source":"Referral","DeliverableType":"Lump Sum Proposal","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Sam","LeadEstimatorId":1,"Contributors":[],"ContributorIds":[],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"Lump Sum Proposal","EstimatedCostValue":12000000,"CostPerGSF":800,"CostPerUnit":null,"SubmittedDate":"2026-01-10","AwardStatus":"Pending","NotesFeedback":"Resort-style pool complex. Board vote March 2026."},{"id":22,"Title":"Riviera Beach Marina Village Retail","LeadID":null,"ProjectCode":"25-018-01","Source":"RFP","DeliverableType":"GMP","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Hank","LeadEstimatorId":4,"Contributors":[],"ContributorIds":[],"PX_ProjectExecutive":"Jeff Collier","PX_ProjectExecutiveId":11,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"GMP","EstimatedCostValue":8500000,"CostPerGSF":386,"CostPerUnit":null,"SubmittedDate":"2025-07-20","AwardStatus":"Awarded w/o Precon","NotesFeedback":"Waterfront retail village. Won CM at Risk selection. Under construction."},{"id":23,"Title":"Palm Beach State College Loxahatchee Campus Expansion","LeadID":null,"ProjectCode":"25-010-01","Source":"RFP","DeliverableType":"GMP","SubBidsDue":null,"PreSubmissionReview":null,"WinStrategyMeeting":null,"DueDate_OutTheDoor":null,"LeadEstimator":"Bill","LeadEstimatorId":3,"Contributors":["Jayden"],"ContributorIds":[6],"PX_ProjectExecutive":"Mike Henderson","PX_ProjectExecutiveId":10,"Chk_BidBond":true,"Chk_PPBond":true,"Chk_Schedule":true,"Chk_Logistics":true,"Chk_BIMProposal":true,"Chk_PreconProposal":true,"Chk_ProposalTabs":true,"Chk_CoordMarketing":true,"Chk_BusinessTerms":true,"DocSetStage":null,"PreconFee":null,"FeePaidToDate":null,"DesignBudget":null,"EstimateType":"GMP","EstimatedCostValue":34000000,"CostPerGSF":567,"CostPerUnit":null,"SubmittedDate":"2025-05-15","AwardStatus":"Not Awarded","NotesFeedback":"Lost in final interview. Weitz had more recent higher-ed experience."}]'),users_namespaceObject=JSON.parse('[{"id":1,"displayName":"Mike Hedrick","email":"mhedrick@hedrickbrothers.com","roles":["Executive Leadership"],"region":"West Palm Beach","department":"Executive"},{"id":2,"displayName":"Tom Hedrick","email":"thedrick@hedrickbrothers.com","roles":["Executive Leadership"],"region":"West Palm Beach","department":"Executive"},{"id":3,"displayName":"Sarah Mitchell","email":"smitchell@hedrickbrothers.com","roles":["BD Representative"],"region":"Miami","department":"Business Development"},{"id":4,"displayName":"James Rodriguez","email":"jrodriguez@hedrickbrothers.com","roles":["BD Representative"],"region":"Orlando","department":"Business Development"},{"id":5,"displayName":"Karen Foster","email":"kfoster@hedrickbrothers.com","roles":["BD Representative"],"region":"West Palm Beach","department":"Business Development"},{"id":6,"displayName":"Sam Patterson","email":"spatterson@hedrickbrothers.com","roles":["Estimating Coordinator"],"region":"West Palm Beach","department":"Estimating"},{"id":7,"displayName":"Vito Calandrino","email":"vcalandrino@hedrickbrothers.com","roles":["Estimating Coordinator"],"region":"Miami","department":"Estimating"},{"id":8,"displayName":"Bill Thompson","email":"bthompson@hedrickbrothers.com","roles":["Estimating Coordinator"],"region":"Orlando","department":"Estimating"},{"id":9,"displayName":"Hank Morrison","email":"hmorrison@hedrickbrothers.com","roles":["Estimating Coordinator"],"region":"West Palm Beach","department":"Estimating"},{"id":10,"displayName":"Lisa Chen","email":"lchen@hedrickbrothers.com","roles":["Accounting Manager"],"region":"West Palm Beach","department":"Accounting"},{"id":11,"displayName":"Robert Davis","email":"rdavis@hedrickbrothers.com","roles":["Accounting Manager"],"region":"West Palm Beach","department":"Accounting"},{"id":12,"displayName":"David Park","email":"dpark@hedrickbrothers.com","roles":["Department Director"],"region":"West Palm Beach","department":"Preconstruction"},{"id":13,"displayName":"Maria Gonzalez","email":"mgonzalez@hedrickbrothers.com","roles":["Legal"],"region":"West Palm Beach","department":"Legal"},{"id":14,"displayName":"Steve Walker","email":"swalker@hedrickbrothers.com","roles":["Legal"],"region":"West Palm Beach","department":"Legal"},{"id":15,"displayName":"Jennifer Adams","email":"jadams@hedrickbrothers.com","roles":["Risk Management"],"region":"West Palm Beach","department":"Risk"},{"id":16,"displayName":"Chris Taylor","email":"ctaylor@hedrickbrothers.com","roles":["Marketing"],"region":"West Palm Beach","department":"Marketing"},{"id":17,"displayName":"Amanda White","email":"awhite@hedrickbrothers.com","roles":["Marketing"],"region":"Miami","department":"Marketing"},{"id":18,"displayName":"Brian Nguyen","email":"bnguyen@hedrickbrothers.com","roles":["Safety"],"region":"West Palm Beach","department":"Safety"},{"id":19,"displayName":"Carlos Ruiz","email":"cruiz@hedrickbrothers.com","roles":["Quality Control"],"region":"Miami","department":"Quality"},{"id":20,"displayName":"Derek Johnson","email":"djohnson@hedrickbrothers.com","roles":["IDS"],"region":"West Palm Beach","department":"IDS"},{"id":21,"displayName":"Ryan Phillips","email":"rphillips@hedrickbrothers.com","roles":["Operations Team"],"region":"Miami","department":"Operations"},{"id":22,"displayName":"Mark Stevens","email":"mstevens@hedrickbrothers.com","roles":["Operations Team"],"region":"Orlando","department":"Operations"},{"id":23,"displayName":"Nick Petrov","email":"npetrov@hedrickbrothers.com","roles":["Preconstruction Team"],"region":"West Palm Beach","department":"Preconstruction"},{"id":24,"displayName":"Tony Alvarez","email":"talvarez@hedrickbrothers.com","roles":["Preconstruction Team"],"region":"Miami","department":"Preconstruction"},{"id":25,"displayName":"Alex Torres","email":"atorres@hedrickbrothers.com","roles":["SharePoint Admin"],"region":"West Palm Beach","department":"IT"}]'),featureFlags_namespaceObject=JSON.parse('[{"id":1,"FeatureName":"LeadIntake","DisplayName":"Lead Intake","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Core feature - always on","Category":"Core Platform"},{"id":2,"FeatureName":"GoNoGoScorecard","DisplayName":"Go/No-Go Scorecard","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"","Category":"Core Platform"},{"id":3,"FeatureName":"AutoSiteProvisioning","DisplayName":"Automatic Site Provisioning","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"","Category":"Infrastructure"},{"id":4,"FeatureName":"MeetingScheduler","DisplayName":"Meeting Scheduler","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"","Category":"Preconstruction"},{"id":5,"FeatureName":"PipelineDashboard","DisplayName":"Pipeline Dashboard","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"","Category":"Core Platform"},{"id":6,"FeatureName":"TurnoverWorkflow","DisplayName":"Turnover Workflow","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"","Category":"Project Execution"},{"id":7,"FeatureName":"LossAutopsy","DisplayName":"Post-Bid Loss Autopsy","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"","Category":"Preconstruction"},{"id":8,"FeatureName":"EstimatingTracker","DisplayName":"Estimating Tracker","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"","Category":"Core Platform"},{"id":9,"FeatureName":"UnanetIntegration","DisplayName":"Unanet ERP Integration","Enabled":false,"EnabledForRoles":null,"TargetDate":"2026-06-01","Notes":"Phase 2 - Unanet ERP integration","Category":"Integrations"},{"id":10,"FeatureName":"SageIntegration","DisplayName":"Sage 300 Integration","Enabled":false,"EnabledForRoles":null,"TargetDate":"2026-06-01","Notes":"Phase 2 - Sage 300 accounting","Category":"Integrations"},{"id":11,"FeatureName":"DocumentCrunchIntegration","DisplayName":"Document Crunch AI Review","Enabled":false,"EnabledForRoles":null,"TargetDate":"2026-09-01","Notes":"AI contract review","Category":"Integrations"},{"id":12,"FeatureName":"EstimatingModule","DisplayName":"Full Estimating Module","Enabled":false,"EnabledForRoles":null,"TargetDate":"2026-12-01","Notes":"Full estimating module","Category":"Integrations"},{"id":13,"FeatureName":"BudgetSync","DisplayName":"Budget Sync","Enabled":false,"EnabledForRoles":null,"TargetDate":null,"Notes":"Budget sync with accounting","Category":"Integrations"},{"id":14,"FeatureName":"ExecutiveDashboard","DisplayName":"Executive Dashboard","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Phase 8 exec dashboard","Category":"Core Platform"},{"id":15,"FeatureName":"DualNotifications","DisplayName":"Dual Notifications (Email + Teams)","Enabled":false,"EnabledForRoles":null,"TargetDate":null,"Notes":"Send both email and Teams notifications","Category":"Infrastructure"},{"id":16,"FeatureName":"AuditTrail","DisplayName":"Audit Trail","Enabled":false,"EnabledForRoles":null,"TargetDate":null,"Notes":"Detailed audit trail logging","Category":"Infrastructure"},{"id":17,"FeatureName":"OfflineSupport","DisplayName":"Offline Support","Enabled":false,"EnabledForRoles":null,"TargetDate":null,"Notes":"Offline mode with queue sync","Category":"Infrastructure"},{"id":18,"FeatureName":"ProjectStartup","DisplayName":"Project Startup","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Phase 9 startup checklist and responsibility matrices","Category":"Project Execution"},{"id":19,"FeatureName":"MarketingProjectRecord","DisplayName":"Marketing Project Record","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Phase 9 marketing project record and dashboard","Category":"Project Execution"},{"id":20,"FeatureName":"ProjectManagementPlan","DisplayName":"Project Management Plan","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Phase 10 PMP and operational modules","Category":"Project Execution"},{"id":21,"FeatureName":"MonthlyProjectReview","DisplayName":"Monthly Project Review","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Phase 10 monthly project review","Category":"Project Execution"},{"id":22,"FeatureName":"WorkflowDefinitions","DisplayName":"Workflow Definitions","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Phase 13 workflow definition configuration","Category":"Preconstruction"},{"id":23,"FeatureName":"PermissionEngine","DisplayName":"Permission Engine","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Phase 19 Procore-modeled permission engine with templates and project scoping","Category":"Infrastructure"},{"id":24,"FeatureName":"PerformanceMonitoring","DisplayName":"Performance Monitoring","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Web part performance monitoring with dashboard","Category":"Infrastructure"},{"id":25,"FeatureName":"EnableHelpSystem","DisplayName":"Help & Support System","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Contextual help panels, guided tours, and support config","Category":"Infrastructure"},{"id":26,"FeatureName":"ProvisioningRealOps","DisplayName":"Real Site Provisioning Operations","Enabled":false,"EnabledForRoles":null,"TargetDate":null,"Notes":"When ON, provisioning uses real PnP.js SP operations instead of simulation","Category":"Infrastructure"},{"id":27,"FeatureName":"ContractTracking","DisplayName":"Contract Tracking Workflow","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"4-step subcontract approval workflow: APM/PA â†’ PM â†’ Risk Manager â†’ PX","Category":"Project Execution"},{"id":28,"FeatureName":"ContractTrackingDevPreview","DisplayName":"Contract Tracking Dev Preview","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Shows dev-mode preview of next approver view after submission","Category":"Debug"},{"id":29,"FeatureName":"DevUserManagement","DisplayName":"Dev User Management","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Admin panel tab for editing mock user role assignments","Category":"Debug"},{"id":30,"FeatureName":"ScheduleModule","DisplayName":"P6 Schedule Management","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Full Primavera P6-style schedule management with CSV import, Gantt, and analytics","Category":"Project Execution"},{"id":31,"FeatureName":"ConstraintsLog","DisplayName":"Constraints Log","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Constraints log with dashboard charts, detail modal, and sortable columns","Category":"Project Execution"},{"id":32,"FeatureName":"TelemetryDashboard","DisplayName":"Telemetry Dashboard","Enabled":true,"EnabledForRoles":["ExecutiveLeadership","SharePointAdmin"],"TargetDate":null,"Notes":"Application Insights + ECharts telemetry dashboard. Admin-only.","Category":"Debug"},{"id":33,"FeatureName":"GitOpsProvisioning","DisplayName":"GitOps Template Provisioning","Enabled":false,"EnabledForRoles":null,"TargetDate":null,"Notes":"Step 5 uses committed /templates/ instead of Template_Registry SP list","Category":"Infrastructure"},{"id":34,"FeatureName":"TemplateSiteSync","DisplayName":"Template Site Sync Panel","Enabled":false,"EnabledForRoles":["ExecutiveLeadership","IDS","SharePointAdmin"],"TargetDate":null,"Notes":"Shows Template Site sync UI in AdminPanel â†’ Provisioning tab","Category":"Infrastructure"},{"id":35,"FeatureName":"TanStackRouterEnabled","DisplayName":"TanStack Router Enabled","Enabled":false,"EnabledForRoles":null,"TargetDate":null,"Notes":"Enables TanStack Router pilot routes (Operations, Preconstruction, Lead, Job Request, Admin, Accounting, Marketing, and system fallback) while react-router-dom remains in parallel.","Category":"Debug"},{"id":36,"FeatureName":"LazyHeavyLibsV1","DisplayName":"Lazy Heavy Libraries V1","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Enables deferred loading for ECharts runtime and export libraries (jsPDF/html2canvas/xlsx).","Category":"Infrastructure"},{"id":37,"FeatureName":"PhaseChunkingV1","DisplayName":"Phase Chunking V1","Enabled":true,"EnabledForRoles":null,"TargetDate":null,"Notes":"Enables phase-based chunk boundaries (Preconstruction, Operations, Admin/Hub, Shared).","Category":"Infrastructure"},{"id":38,"FeatureName":"OptimisticMutationsEnabled","DisplayName":"Optimistic Mutations Enabled","Enabled":false,"EnabledForRoles":null,"TargetDate":null,"Notes":"Global gate for optimistic mutation lifecycle (onMutate rollback/invalidation).","Category":"Infrastructure"},{"id":39,"FeatureName":"OptimisticMutations_Leads","DisplayName":"Optimistic Mutations Leads","Enabled":false,"EnabledForRoles":["PMOAdmin","SuperAdmin"],"TargetDate":null,"Notes":"Enables optimistic mutation flow for Leads domain.","Category":"Infrastructure"},{"id":40,"FeatureName":"OptimisticMutations_Estimating","DisplayName":"Optimistic Mutations Estimating","Enabled":false,"EnabledForRoles":["Estimator","PMOAdmin"],"TargetDate":null,"Notes":"Enables optimistic mutation flow for Estimating domain.","Category":"Infrastructure"},{"id":41,"FeatureName":"OptimisticMutations_Buyout","DisplayName":"Optimistic Mutations Buyout","Enabled":false,"EnabledForRoles":["OperationsLead","PMOAdmin"],"TargetDate":null,"Notes":"Enables optimistic mutation flow for Buyout and compliance workflows.","Category":"Infrastructure"},{"id":42,"FeatureName":"OptimisticMutations_PMP","DisplayName":"Optimistic Mutations PMP","Enabled":false,"EnabledForRoles":["ProjectManager","PMOAdmin"],"TargetDate":null,"Notes":"Enables optimistic mutation flow for PMP updates and approvals.","Category":"Infrastructure"}]'),calendarAvailability_namespaceObject=JSON.parse('[{"email":"mhedrick@hedrickbrothers.com","displayName":"Mike Hedrick","slots":[{"start":"2026-02-09T09:00:00","end":"2026-02-09T10:00:00","available":true},{"start":"2026-02-09T10:00:00","end":"2026-02-09T11:00:00","available":false},{"start":"2026-02-09T11:00:00","end":"2026-02-09T12:00:00","available":true},{"start":"2026-02-09T13:00:00","end":"2026-02-09T14:00:00","available":true},{"start":"2026-02-09T14:00:00","end":"2026-02-09T15:00:00","available":false},{"start":"2026-02-09T15:00:00","end":"2026-02-09T16:00:00","available":false},{"start":"2026-02-10T09:00:00","end":"2026-02-10T10:00:00","available":true},{"start":"2026-02-10T10:00:00","end":"2026-02-10T11:00:00","available":true},{"start":"2026-02-10T11:00:00","end":"2026-02-10T12:00:00","available":false},{"start":"2026-02-10T13:00:00","end":"2026-02-10T14:00:00","available":false},{"start":"2026-02-10T14:00:00","end":"2026-02-10T15:00:00","available":true},{"start":"2026-02-11T09:00:00","end":"2026-02-11T10:00:00","available":false},{"start":"2026-02-11T10:00:00","end":"2026-02-11T11:00:00","available":false},{"start":"2026-02-11T11:00:00","end":"2026-02-11T12:00:00","available":true},{"start":"2026-02-11T13:00:00","end":"2026-02-11T14:00:00","available":true},{"start":"2026-02-11T14:00:00","end":"2026-02-11T15:00:00","available":true},{"start":"2026-02-12T09:00:00","end":"2026-02-12T10:00:00","available":true},{"start":"2026-02-12T10:00:00","end":"2026-02-12T11:00:00","available":false},{"start":"2026-02-12T13:00:00","end":"2026-02-12T14:00:00","available":true},{"start":"2026-02-12T14:00:00","end":"2026-02-12T15:00:00","available":false},{"start":"2026-02-13T09:00:00","end":"2026-02-13T10:00:00","available":false},{"start":"2026-02-13T10:00:00","end":"2026-02-13T11:00:00","available":true},{"start":"2026-02-13T13:00:00","end":"2026-02-13T14:00:00","available":true},{"start":"2026-02-13T14:00:00","end":"2026-02-13T15:00:00","available":true}]},{"email":"dpark@hedrickbrothers.com","displayName":"David Park","slots":[{"start":"2026-02-09T09:00:00","end":"2026-02-09T10:00:00","available":false},{"start":"2026-02-09T10:00:00","end":"2026-02-09T11:00:00","available":true},{"start":"2026-02-09T11:00:00","end":"2026-02-09T12:00:00","available":true},{"start":"2026-02-09T13:00:00","end":"2026-02-09T14:00:00","available":true},{"start":"2026-02-09T14:00:00","end":"2026-02-09T15:00:00","available":false},{"start":"2026-02-09T15:00:00","end":"2026-02-09T16:00:00","available":true},{"start":"2026-02-10T09:00:00","end":"2026-02-10T10:00:00","available":false},{"start":"2026-02-10T10:00:00","end":"2026-02-10T11:00:00","available":false},{"start":"2026-02-10T11:00:00","end":"2026-02-10T12:00:00","available":true},{"start":"2026-02-10T13:00:00","end":"2026-02-10T14:00:00","available":true},{"start":"2026-02-10T14:00:00","end":"2026-02-10T15:00:00","available":true},{"start":"2026-02-11T09:00:00","end":"2026-02-11T10:00:00","available":true},{"start":"2026-02-11T10:00:00","end":"2026-02-11T11:00:00","available":false},{"start":"2026-02-11T11:00:00","end":"2026-02-11T12:00:00","available":false},{"start":"2026-02-11T13:00:00","end":"2026-02-11T14:00:00","available":true},{"start":"2026-02-11T14:00:00","end":"2026-02-11T15:00:00","available":true},{"start":"2026-02-12T09:00:00","end":"2026-02-12T10:00:00","available":true},{"start":"2026-02-12T10:00:00","end":"2026-02-12T11:00:00","available":true},{"start":"2026-02-12T13:00:00","end":"2026-02-12T14:00:00","available":false},{"start":"2026-02-12T14:00:00","end":"2026-02-12T15:00:00","available":true},{"start":"2026-02-13T09:00:00","end":"2026-02-13T10:00:00","available":true},{"start":"2026-02-13T10:00:00","end":"2026-02-13T11:00:00","available":false},{"start":"2026-02-13T13:00:00","end":"2026-02-13T14:00:00","available":true},{"start":"2026-02-13T14:00:00","end":"2026-02-13T15:00:00","available":false}]},{"email":"smitchell@hedrickbrothers.com","displayName":"Sarah Mitchell","slots":[{"start":"2026-02-09T09:00:00","end":"2026-02-09T10:00:00","available":false},{"start":"2026-02-09T10:00:00","end":"2026-02-09T11:00:00","available":false},{"start":"2026-02-09T11:00:00","end":"2026-02-09T12:00:00","available":true},{"start":"2026-02-09T13:00:00","end":"2026-02-09T14:00:00","available":true},{"start":"2026-02-09T14:00:00","end":"2026-02-09T15:00:00","available":true},{"start":"2026-02-09T15:00:00","end":"2026-02-09T16:00:00","available":false},{"start":"2026-02-10T09:00:00","end":"2026-02-10T10:00:00","available":true},{"start":"2026-02-10T10:00:00","end":"2026-02-10T11:00:00","available":false},{"start":"2026-02-10T11:00:00","end":"2026-02-10T12:00:00","available":false},{"start":"2026-02-10T13:00:00","end":"2026-02-10T14:00:00","available":true},{"start":"2026-02-10T14:00:00","end":"2026-02-10T15:00:00","available":true},{"start":"2026-02-11T09:00:00","end":"2026-02-11T10:00:00","available":false},{"start":"2026-02-11T10:00:00","end":"2026-02-11T11:00:00","available":true},{"start":"2026-02-11T11:00:00","end":"2026-02-11T12:00:00","available":true},{"start":"2026-02-11T13:00:00","end":"2026-02-11T14:00:00","available":false},{"start":"2026-02-11T14:00:00","end":"2026-02-11T15:00:00","available":true},{"start":"2026-02-12T09:00:00","end":"2026-02-12T10:00:00","available":false},{"start":"2026-02-12T10:00:00","end":"2026-02-12T11:00:00","available":true},{"start":"2026-02-12T13:00:00","end":"2026-02-12T14:00:00","available":true},{"start":"2026-02-12T14:00:00","end":"2026-02-12T15:00:00","available":false},{"start":"2026-02-13T09:00:00","end":"2026-02-13T10:00:00","available":true},{"start":"2026-02-13T10:00:00","end":"2026-02-13T11:00:00","available":true},{"start":"2026-02-13T13:00:00","end":"2026-02-13T14:00:00","available":false},{"start":"2026-02-13T14:00:00","end":"2026-02-13T15:00:00","available":true}]},{"email":"spatterson@hedrickbrothers.com","displayName":"Sam Patterson","slots":[{"start":"2026-02-09T09:00:00","end":"2026-02-09T10:00:00","available":true},{"start":"2026-02-09T10:00:00","end":"2026-02-09T11:00:00","available":true},{"start":"2026-02-09T11:00:00","end":"2026-02-09T12:00:00","available":false},{"start":"2026-02-09T13:00:00","end":"2026-02-09T14:00:00","available":false},{"start":"2026-02-09T14:00:00","end":"2026-02-09T15:00:00","available":true},{"start":"2026-02-09T15:00:00","end":"2026-02-09T16:00:00","available":true},{"start":"2026-02-10T09:00:00","end":"2026-02-10T10:00:00","available":false},{"start":"2026-02-10T10:00:00","end":"2026-02-10T11:00:00","available":false},{"start":"2026-02-10T11:00:00","end":"2026-02-10T12:00:00","available":true},{"start":"2026-02-10T13:00:00","end":"2026-02-10T14:00:00","available":true},{"start":"2026-02-10T14:00:00","end":"2026-02-10T15:00:00","available":false},{"start":"2026-02-11T09:00:00","end":"2026-02-11T10:00:00","available":true},{"start":"2026-02-11T10:00:00","end":"2026-02-11T11:00:00","available":true},{"start":"2026-02-11T11:00:00","end":"2026-02-11T12:00:00","available":false},{"start":"2026-02-11T13:00:00","end":"2026-02-11T14:00:00","available":true},{"start":"2026-02-11T14:00:00","end":"2026-02-11T15:00:00","available":false},{"start":"2026-02-12T09:00:00","end":"2026-02-12T10:00:00","available":false},{"start":"2026-02-12T10:00:00","end":"2026-02-12T11:00:00","available":true},{"start":"2026-02-12T13:00:00","end":"2026-02-12T14:00:00","available":true},{"start":"2026-02-12T14:00:00","end":"2026-02-12T15:00:00","available":true},{"start":"2026-02-13T09:00:00","end":"2026-02-13T10:00:00","available":false},{"start":"2026-02-13T10:00:00","end":"2026-02-13T11:00:00","available":false},{"start":"2026-02-13T13:00:00","end":"2026-02-13T14:00:00","available":true},{"start":"2026-02-13T14:00:00","end":"2026-02-13T15:00:00","available":true}]},{"email":"vcalandrino@hedrickbrothers.com","displayName":"Vito Calandrino","slots":[{"start":"2026-02-09T09:00:00","end":"2026-02-09T10:00:00","available":false},{"start":"2026-02-09T10:00:00","end":"2026-02-09T11:00:00","available":false},{"start":"2026-02-09T11:00:00","end":"2026-02-09T12:00:00","available":false},{"start":"2026-02-09T13:00:00","end":"2026-02-09T14:00:00","available":true},{"start":"2026-02-09T14:00:00","end":"2026-02-09T15:00:00","available":true},{"start":"2026-02-09T15:00:00","end":"2026-02-09T16:00:00","available":true},{"start":"2026-02-10T09:00:00","end":"2026-02-10T10:00:00","available":true},{"start":"2026-02-10T10:00:00","end":"2026-02-10T11:00:00","available":false},{"start":"2026-02-10T11:00:00","end":"2026-02-10T12:00:00","available":false},{"start":"2026-02-10T13:00:00","end":"2026-02-10T14:00:00","available":false},{"start":"2026-02-10T14:00:00","end":"2026-02-10T15:00:00","available":true},{"start":"2026-02-11T09:00:00","end":"2026-02-11T10:00:00","available":false},{"start":"2026-02-11T10:00:00","end":"2026-02-11T11:00:00","available":false},{"start":"2026-02-11T11:00:00","end":"2026-02-11T12:00:00","available":true},{"start":"2026-02-11T13:00:00","end":"2026-02-11T14:00:00","available":true},{"start":"2026-02-11T14:00:00","end":"2026-02-11T15:00:00","available":true},{"start":"2026-02-12T09:00:00","end":"2026-02-12T10:00:00","available":true},{"start":"2026-02-12T10:00:00","end":"2026-02-12T11:00:00","available":true},{"start":"2026-02-12T13:00:00","end":"2026-02-12T14:00:00","available":false},{"start":"2026-02-12T14:00:00","end":"2026-02-12T15:00:00","available":false},{"start":"2026-02-13T09:00:00","end":"2026-02-13T10:00:00","available":true},{"start":"2026-02-13T10:00:00","end":"2026-02-13T11:00:00","available":true},{"start":"2026-02-13T13:00:00","end":"2026-02-13T14:00:00","available":true},{"start":"2026-02-13T14:00:00","end":"2026-02-13T15:00:00","available":false}]},{"email":"kfoster@hedrickbrothers.com","displayName":"Karen Foster","slots":[{"start":"2026-02-09T09:00:00","end":"2026-02-09T10:00:00","available":true},{"start":"2026-02-09T10:00:00","end":"2026-02-09T11:00:00","available":false},{"start":"2026-02-09T11:00:00","end":"2026-02-09T12:00:00","available":true},{"start":"2026-02-09T13:00:00","end":"2026-02-09T14:00:00","available":false},{"start":"2026-02-09T14:00:00","end":"2026-02-09T15:00:00","available":true},{"start":"2026-02-09T15:00:00","end":"2026-02-09T16:00:00","available":true},{"start":"2026-02-10T09:00:00","end":"2026-02-10T10:00:00","available":false},{"start":"2026-02-10T10:00:00","end":"2026-02-10T11:00:00","available":true},{"start":"2026-02-10T11:00:00","end":"2026-02-10T12:00:00","available":true},{"start":"2026-02-10T13:00:00","end":"2026-02-10T14:00:00","available":true},{"start":"2026-02-10T14:00:00","end":"2026-02-10T15:00:00","available":false},{"start":"2026-02-11T09:00:00","end":"2026-02-11T10:00:00","available":true},{"start":"2026-02-11T10:00:00","end":"2026-02-11T11:00:00","available":true},{"start":"2026-02-11T11:00:00","end":"2026-02-11T12:00:00","available":false},{"start":"2026-02-11T13:00:00","end":"2026-02-11T14:00:00","available":false},{"start":"2026-02-11T14:00:00","end":"2026-02-11T15:00:00","available":true},{"start":"2026-02-12T09:00:00","end":"2026-02-12T10:00:00","available":true},{"start":"2026-02-12T10:00:00","end":"2026-02-12T11:00:00","available":false},{"start":"2026-02-12T13:00:00","end":"2026-02-12T14:00:00","available":true},{"start":"2026-02-12T14:00:00","end":"2026-02-12T15:00:00","available":true},{"start":"2026-02-13T09:00:00","end":"2026-02-13T10:00:00","available":false},{"start":"2026-02-13T10:00:00","end":"2026-02-13T11:00:00","available":true},{"start":"2026-02-13T13:00:00","end":"2026-02-13T14:00:00","available":true},{"start":"2026-02-13T14:00:00","end":"2026-02-13T15:00:00","available":false}]}]'),teamMembers_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","name":"Karen Foster","email":"kfoster@hedrickbrothers.com","role":"BD Representative","department":"Business Development","phone":"561-555-0101"},{"id":2,"projectCode":"25-042-01","name":"Mike Chen","email":"mchen@hedrickbrothers.com","role":"Estimating Coordinator","department":"Estimating","phone":"561-555-0102"},{"id":3,"projectCode":"25-042-01","name":"Sarah Martinez","email":"smartinez@hedrickbrothers.com","role":"Preconstruction Team","department":"Preconstruction","phone":"561-555-0103"},{"id":4,"projectCode":"25-042-01","name":"James Wilson","email":"jwilson@hedrickbrothers.com","role":"Operations Team","department":"Operations","phone":"561-555-0104"},{"id":5,"projectCode":"25-042-01","name":"Lisa Park","email":"lpark@hedrickbrothers.com","role":"Quality Control","department":"Quality Control","phone":"561-555-0105"},{"id":6,"projectCode":"25-042-01","name":"Tom Bradley","email":"tbradley@hedrickbrothers.com","role":"Safety","department":"Safety","phone":"561-555-0106"},{"id":7,"projectCode":"25-042-01","name":"David Kim","email":"dkim@hedrickbrothers.com","role":"IDS","department":"IDS","phone":"561-555-0107"},{"id":8,"projectCode":"25-042-01","name":"Rachel Green","email":"rgreen@hedrickbrothers.com","role":"Marketing","department":"Marketing","phone":"561-555-0108"},{"id":9,"projectCode":"25-042-01","name":"Robert Hedrick","email":"rhedrick@hedrickbrothers.com","role":"Executive Leadership","department":"Executive","phone":"561-555-0109"},{"id":10,"projectCode":"25-042-01","name":"Jennifer Adams","email":"jadams@hedrickbrothers.com","role":"Legal","department":"Legal","phone":"561-555-0110"}]'),deliverables_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","name":"Conceptual Estimate","department":"Estimating","assignedTo":"Mike Chen","assignedToId":2,"status":"Complete","dueDate":"2026-02-01","completedDate":"2026-01-29"},{"id":2,"projectCode":"25-042-01","name":"Schematic Design Estimate","department":"Estimating","assignedTo":"Mike Chen","assignedToId":2,"status":"In Progress","dueDate":"2026-02-15"},{"id":3,"projectCode":"25-042-01","name":"Qualifications Package","department":"Marketing","assignedTo":"Rachel Green","assignedToId":8,"status":"In Review","dueDate":"2026-02-10"},{"id":4,"projectCode":"25-042-01","name":"Project Schedule (Preliminary)","department":"Estimating","assignedTo":"Sarah Martinez","assignedToId":3,"status":"Not Started","dueDate":"2026-02-20"},{"id":5,"projectCode":"25-042-01","name":"Site Logistics Plan","department":"Estimating","assignedTo":"Sarah Martinez","assignedToId":3,"status":"Not Started","dueDate":"2026-02-25"},{"id":6,"projectCode":"25-042-01","name":"BIM Execution Plan","department":"IDS","assignedTo":"David Kim","assignedToId":7,"status":"In Progress","dueDate":"2026-02-12"},{"id":7,"projectCode":"25-042-01","name":"Safety Plan (Pre-Bid)","department":"BD","assignedTo":"Tom Bradley","assignedToId":6,"status":"Complete","dueDate":"2026-01-28","completedDate":"2026-01-27"},{"id":8,"projectCode":"25-042-01","name":"Proposal Cover Letter","department":"Marketing","assignedTo":"Rachel Green","assignedToId":8,"status":"Not Started","dueDate":"2026-03-01"},{"id":9,"projectCode":"25-042-01","name":"Fee Proposal","department":"BD","assignedTo":"Karen Foster","assignedToId":1,"status":"Not Started","dueDate":"2026-03-05"},{"id":10,"projectCode":"25-042-01","name":"Value Engineering Options","department":"Estimating","assignedTo":"Mike Chen","assignedToId":2,"status":"Not Started","dueDate":"2026-03-10"}]'),turnoverItems_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","category":"Documents","description":"Transfer all preconstruction documents to project site","status":"Not Started","assignedTo":"Sarah Martinez","assignedToId":3,"required":true},{"id":2,"projectCode":"25-042-01","category":"Documents","description":"Compile final estimate package with bid tabs","status":"Not Started","assignedTo":"Mike Chen","assignedToId":2,"required":true},{"id":3,"projectCode":"25-042-01","category":"Documents","description":"Update project directory with subcontractor contacts","status":"Not Started","assignedTo":"Sarah Martinez","assignedToId":3,"required":true},{"id":4,"projectCode":"25-042-01","category":"Safety","description":"Complete site-specific safety plan","status":"Not Started","assignedTo":"Tom Bradley","assignedToId":6,"required":true},{"id":5,"projectCode":"25-042-01","category":"Safety","description":"Identify site hazards and mitigation measures","status":"Not Started","assignedTo":"Tom Bradley","assignedToId":6,"required":true},{"id":6,"projectCode":"25-042-01","category":"Financial","description":"Transfer budget and cost codes to operations","status":"Not Started","assignedTo":"Mike Chen","assignedToId":2,"required":true},{"id":7,"projectCode":"25-042-01","category":"Financial","description":"Reconcile preconstruction fee billing","status":"Not Started","assignedTo":"Karen Foster","assignedToId":1,"required":true},{"id":8,"projectCode":"25-042-01","category":"Scheduling","description":"Develop construction baseline schedule","status":"Not Started","assignedTo":"James Wilson","assignedToId":4,"required":true},{"id":9,"projectCode":"25-042-01","category":"Scheduling","description":"Identify long-lead procurement items","status":"Not Started","assignedTo":"James Wilson","assignedToId":4,"required":true},{"id":10,"projectCode":"25-042-01","category":"Staffing","description":"Assign project superintendent","status":"Not Started","assignedTo":"James Wilson","assignedToId":4,"required":true},{"id":11,"projectCode":"25-042-01","category":"Staffing","description":"Assign project engineer","status":"Not Started","assignedTo":"James Wilson","assignedToId":4,"required":true},{"id":12,"projectCode":"25-042-01","category":"Subcontracts","description":"Finalize subcontractor scope letters","status":"Not Started","assignedTo":"Sarah Martinez","assignedToId":3,"required":true},{"id":13,"projectCode":"25-042-01","category":"Subcontracts","description":"Execute critical path subcontracts","status":"Not Started","assignedTo":"James Wilson","assignedToId":4,"required":true},{"id":14,"projectCode":"25-042-01","category":"Documents","description":"Archive preconstruction meeting minutes","status":"Not Started","assignedTo":"Sarah Martinez","assignedToId":3,"required":false}]'),closeoutItems_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","category":"Tasks","description":"Notify subcontractors of project completion and closeout requirements","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-11-10T14:00:00Z","notes":null,"sectionNumber":1,"sectionName":"Tasks","itemNumber":"1.1","label":"Notify subcontractors of project completion and closeout requirements","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-10T14:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":1},{"id":2,"projectCode":"25-042-01","category":"Tasks","description":"Compile punch list and distribute to responsible parties","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-11-12T09:30:00Z","notes":null,"sectionNumber":1,"sectionName":"Tasks","itemNumber":"1.2","label":"Compile punch list and distribute to responsible parties","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-12T09:30:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":2},{"id":3,"projectCode":"25-042-01","category":"Tasks","description":"Schedule final walk-through with owner","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-11-14T11:00:00Z","notes":null,"sectionNumber":1,"sectionName":"Tasks","itemNumber":"1.3","label":"Schedule final walk-through with owner","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-14T11:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":3},{"id":4,"projectCode":"25-042-01","category":"Tasks","description":"Obtain owner sign-off on punch list completion","status":"Deficient","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":1,"sectionName":"Tasks","itemNumber":"1.4","label":"Obtain owner sign-off on punch list completion","responseType":"yesNoNA","response":"Deficient","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-18T15:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":4},{"id":5,"projectCode":"25-042-01","category":"Tasks","description":"Submit final punch list status report","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-11-20T10:00:00Z","notes":null,"sectionNumber":1,"sectionName":"Tasks","itemNumber":"1.5","label":"Submit final punch list status report","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T10:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":5},{"id":6,"projectCode":"25-042-01","category":"Document Tracking","description":"As-built drawings submitted and approved","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-11-22T08:30:00Z","notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.1","label":"As-built drawings submitted and approved","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-22T08:30:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":6},{"id":7,"projectCode":"25-042-01","category":"Document Tracking","description":"O&M manuals collected and submitted","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-11-25T09:00:00Z","notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.2","label":"O&M manuals collected and submitted","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-25T09:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":7},{"id":8,"projectCode":"25-042-01","category":"Document Tracking","description":"Warranty documents collected and submitted","status":"Deficient","assignedTo":"tlewis@hedrickbrothers.com","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.3","label":"Warranty documents collected and submitted","responseType":"yesNoNA","response":"Deficient","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-28T10:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":8},{"id":9,"projectCode":"25-042-01","category":"Document Tracking","description":"Attic stock delivered and documented","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-12-01T14:00:00Z","notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.4","label":"Attic stock delivered and documented","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-01T14:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":9},{"id":10,"projectCode":"25-042-01","category":"Document Tracking","description":"Final lien waivers collected from all subcontractors","status":"Deficient","assignedTo":"kfoster@hedrickbrothers.com","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.5","label":"Final lien waivers collected from all subcontractors","responseType":"yesNoNA","response":"Deficient","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-03T11:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":10},{"id":11,"projectCode":"25-042-01","category":"Document Tracking","description":"Final pay application submitted","status":"Conforming","assignedTo":"kfoster@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-12-05T09:00:00Z","notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.6","label":"Final pay application submitted","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-05T09:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":11},{"id":12,"projectCode":"25-042-01","category":"Document Tracking","description":"Consent of surety obtained","status":"NA","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.7","label":"Consent of surety obtained","responseType":"yesNoNA","response":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-05T09:15:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":12},{"id":13,"projectCode":"25-042-01","category":"Document Tracking","description":"Certificate of Substantial Completion issued","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-12-08T10:30:00Z","notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.8","label":"Certificate of Substantial Completion issued","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-08T10:30:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":13},{"id":14,"projectCode":"25-042-01","category":"Document Tracking","description":"Final change orders processed","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-12-10T14:00:00Z","notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.9","label":"Final change orders processed","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-10T14:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":14},{"id":15,"projectCode":"25-042-01","category":"Document Tracking","description":"All RFIs closed out","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.10","label":"All RFIs closed out","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":15},{"id":16,"projectCode":"25-042-01","category":"Document Tracking","description":"All submittals closed out","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.11","label":"All submittals closed out","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":16},{"id":17,"projectCode":"25-042-01","category":"Document Tracking","description":"Project photos organized and archived","status":"NA","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.12","label":"Project photos organized and archived","responseType":"yesNoNA","response":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-12T08:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":17},{"id":18,"projectCode":"25-042-01","category":"Document Tracking","description":"Daily reports finalized and archived","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-12-12T10:00:00Z","notes":null,"sectionNumber":2,"sectionName":"Document Tracking","itemNumber":"2.13","label":"Daily reports finalized and archived","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-12T10:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":18},{"id":19,"projectCode":"25-042-01","category":"Inspections","description":"Final building inspection passed","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-12-15T09:00:00Z","notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.1","label":"Final building inspection passed","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-15T09:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":19},{"id":20,"projectCode":"25-042-01","category":"Inspections","description":"Fire alarm inspection and certification","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-12-15T10:00:00Z","notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.2","label":"Fire alarm inspection and certification","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-15T10:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":20},{"id":21,"projectCode":"25-042-01","category":"Inspections","description":"Elevator inspection and certification","status":"NA","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.3","label":"Elevator inspection and certification","responseType":"yesNoNA","response":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-15T10:15:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":21},{"id":22,"projectCode":"25-042-01","category":"Inspections","description":"Mechanical systems commissioning complete","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.4","label":"Mechanical systems commissioning complete","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":22},{"id":23,"projectCode":"25-042-01","category":"Inspections","description":"Electrical systems commissioning complete","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-12-16T11:00:00Z","notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.5","label":"Electrical systems commissioning complete","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-16T11:00:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":23},{"id":24,"projectCode":"25-042-01","category":"Inspections","description":"Plumbing systems inspection passed","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.6","label":"Plumbing systems inspection passed","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":24},{"id":25,"projectCode":"25-042-01","category":"Inspections","description":"Life safety systems tested and certified","status":"Conforming","assignedTo":"jmartinez@hedrickbrothers.com","assignedToId":null,"completedDate":"2025-12-18T14:30:00Z","notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.7","label":"Life safety systems tested and certified","responseType":"yesNoNA","response":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-12-18T14:30:00Z","comment":null,"isHidden":false,"isCustom":false,"sortOrder":25},{"id":26,"projectCode":"25-042-01","category":"Inspections","description":"Environmental compliance verification","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.8","label":"Environmental compliance verification","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":26},{"id":27,"projectCode":"25-042-01","category":"Inspections","description":"ADA compliance verification","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.9","label":"ADA compliance verification","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":27},{"id":28,"projectCode":"25-042-01","category":"Inspections","description":"Roof inspection and warranty certification","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.10","label":"Roof inspection and warranty certification","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":28},{"id":29,"projectCode":"25-042-01","category":"Inspections","description":"Site drainage and grading inspection","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":3,"sectionName":"Inspections","itemNumber":"3.11","label":"Site drainage and grading inspection","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":29},{"id":30,"projectCode":"25-042-01","category":"Turnover","description":"Owner training on building systems scheduled and completed","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.1","label":"Owner training on building systems scheduled and completed","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":30},{"id":31,"projectCode":"25-042-01","category":"Turnover","description":"Keys and access devices turned over to owner","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.2","label":"Keys and access devices turned over to owner","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":31},{"id":32,"projectCode":"25-042-01","category":"Turnover","description":"Security system codes and manuals provided","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.3","label":"Security system codes and manuals provided","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":32},{"id":33,"projectCode":"25-042-01","category":"Turnover","description":"Utility accounts transferred to owner","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.4","label":"Utility accounts transferred to owner","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":33},{"id":34,"projectCode":"25-042-01","category":"Turnover","description":"Certificate of Occupancy obtained","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.5","label":"Certificate of Occupancy obtained","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":34},{"id":35,"projectCode":"25-042-01","category":"Turnover","description":"Temporary facilities and equipment removed","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.6","label":"Temporary facilities and equipment removed","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":35},{"id":36,"projectCode":"25-042-01","category":"Turnover","description":"Construction debris and waste removed from site","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.7","label":"Construction debris and waste removed from site","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":36},{"id":37,"projectCode":"25-042-01","category":"Turnover","description":"Final site cleanup completed","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.8","label":"Final site cleanup completed","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":37},{"id":38,"projectCode":"25-042-01","category":"Turnover","description":"Signage and barricades removed","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.9","label":"Signage and barricades removed","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":38},{"id":39,"projectCode":"25-042-01","category":"Turnover","description":"Landscaping and site restoration complete","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.10","label":"Landscaping and site restoration complete","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":39},{"id":40,"projectCode":"25-042-01","category":"Turnover","description":"Temporary utilities disconnected","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.11","label":"Temporary utilities disconnected","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":40},{"id":41,"projectCode":"25-042-01","category":"Turnover","description":"Spare parts and extra materials delivered to owner","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.12","label":"Spare parts and extra materials delivered to owner","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":41},{"id":42,"projectCode":"25-042-01","category":"Turnover","description":"Date last contractual work on project was performed","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.13","label":"Date last contractual work on project was performed","responseType":"date","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":42,"dateValue":null},{"id":43,"projectCode":"25-042-01","category":"Turnover","description":"Flag 80 calendar days from last day HB worked on project","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.14","label":"Flag 80 calendar days from last day HB worked on project","responseType":"calculatedDate","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":43,"dateValue":null,"calculatedFrom":"4.13"},{"id":44,"projectCode":"25-042-01","category":"Turnover","description":"Final turnover walk-through completed with owner","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":4,"sectionName":"Turnover","itemNumber":"4.15","label":"Final turnover walk-through completed with owner","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":44},{"id":45,"projectCode":"25-042-01","category":"Post Turnover","description":"Warranty callback log established","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":5,"sectionName":"Post Turnover","itemNumber":"5.1","label":"Warranty callback log established","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":45},{"id":46,"projectCode":"25-042-01","category":"Post Turnover","description":"One-year warranty walk-through scheduled","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":5,"sectionName":"Post Turnover","itemNumber":"5.2","label":"One-year warranty walk-through scheduled","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":46},{"id":47,"projectCode":"25-042-01","category":"Post Turnover","description":"Lessons learned session completed","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":5,"sectionName":"Post Turnover","itemNumber":"5.3","label":"Lessons learned session completed","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":47},{"id":48,"projectCode":"25-042-01","category":"Post Turnover","description":"Subcontractor performance evaluations completed","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":5,"sectionName":"Post Turnover","itemNumber":"5.4","label":"Subcontractor performance evaluations completed","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":48},{"id":49,"projectCode":"25-042-01","category":"Post Turnover","description":"Final project cost report submitted","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":5,"sectionName":"Post Turnover","itemNumber":"5.5","label":"Final project cost report submitted","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":49},{"id":50,"projectCode":"25-042-01","category":"Complete Project Closeout Documents for PX","description":"Final cost reconciliation complete","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":6,"sectionName":"Complete Project Closeout Documents for PX","itemNumber":"6.1","label":"Final cost reconciliation complete","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":50},{"id":51,"projectCode":"25-042-01","category":"Complete Project Closeout Documents for PX","description":"Project closeout binder compiled","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":6,"sectionName":"Complete Project Closeout Documents for PX","itemNumber":"6.2","label":"Project closeout binder compiled","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":51},{"id":52,"projectCode":"25-042-01","category":"Complete Project Closeout Documents for PX","description":"Final project schedule submitted","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":6,"sectionName":"Complete Project Closeout Documents for PX","itemNumber":"6.3","label":"Final project schedule submitted","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":52},{"id":53,"projectCode":"25-042-01","category":"Complete Project Closeout Documents for PX","description":"Client satisfaction survey submitted","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":6,"sectionName":"Complete Project Closeout Documents for PX","itemNumber":"6.4","label":"Client satisfaction survey submitted","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":53},{"id":54,"projectCode":"25-042-01","category":"Complete Project Closeout Documents for PX","description":"Project files archived per company standard","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":6,"sectionName":"Complete Project Closeout Documents for PX","itemNumber":"6.5","label":"Project files archived per company standard","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":54},{"id":55,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Final application for payment submitted","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.1","label":"Final application for payment submitted","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":55},{"id":56,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Contractor\'s final affidavit submitted","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.2","label":"Contractor\'s final affidavit submitted","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":56},{"id":57,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Final release of liens from all subcontractors","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.3","label":"Final release of liens from all subcontractors","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":57},{"id":58,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Consent of surety for final payment","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.4","label":"Consent of surety for final payment","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":58},{"id":59,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Certificate of Substantial Completion executed","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.5","label":"Certificate of Substantial Completion executed","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":59},{"id":60,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Structural letter of completion","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.6","label":"Structural letter of completion","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":60,"details":"To be issued by Structural EOR, signed and sealed"},{"id":61,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Final inspections by Authority Having Jurisdiction","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.7","label":"Final inspections by Authority Having Jurisdiction","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":61,"details":"PBCFD (will include DDCV) & Plumbing"},{"id":62,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"All permits closed with final inspections","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.8","label":"All permits closed with final inspections","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":62},{"id":63,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"As-built survey submitted","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.9","label":"As-built survey submitted","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":63},{"id":64,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Record drawings submitted","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.10","label":"Record drawings submitted","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":64},{"id":65,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Operations and maintenance manuals submitted","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.11","label":"Operations and maintenance manuals submitted","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":65},{"id":66,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Warranty documents submitted","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.12","label":"Warranty documents submitted","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":66},{"id":67,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"TCO/CO issued by jurisdiction","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.13","label":"TCO/CO issued by jurisdiction","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":67,"details":"PBC will not issue TCO for phase if any inspections are recorded as incomplete / partial / failed"},{"id":68,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Final inspections complete for all sub-permits","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.14","label":"Final inspections complete for all sub-permits","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":68,"details":"As Required by Master Building Permit and All Associated Sub-Permits"},{"id":69,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Impact fee credits reconciled","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.15","label":"Impact fee credits reconciled","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":69},{"id":70,"projectCode":"25-042-01","category":"PBC Close-Out Requirements","description":"Special inspections final report","status":"NoResponse","assignedTo":"","assignedToId":null,"completedDate":null,"notes":null,"sectionNumber":7,"sectionName":"PBC Close-Out Requirements","itemNumber":"7.16","label":"Special inspections final report","responseType":"yesNoNA","response":null,"respondedBy":null,"respondedDate":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":70,"details":"May be required by PBC in addition to UES Final Inspection"}]'),startupChecklist_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","sectionNumber":1,"sectionName":"Review Owner\'s Contract","itemNumber":"1.1","label":"Split savings clause if any & Contingency usage parameters","responseType":"percent","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-15T10:30:00Z","assignedTo":"jmartinez@hedrickbrothers.com","assignedToName":"Jose Martinez","comment":"5% contingency per Article 7.3","isHidden":false,"isCustom":false,"sortOrder":1,"hbShare":15,"placeholder":"Contingency Use Contract Article","activityLog":[{"timestamp":"2025-11-15T10:30:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming","comment":"5% contingency per Article 7.3"}]},{"id":2,"projectCode":"25-042-01","sectionNumber":1,"sectionName":"Review Owner\'s Contract","itemNumber":"1.2","label":"Liquidated damages are?","responseType":"currencyWithPeriod","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-15T10:32:00Z","assignedTo":"jmartinez@hedrickbrothers.com","assignedToName":"Jose Martinez","comment":null,"isHidden":false,"isCustom":false,"sortOrder":2,"amount":2500,"period":"Day","activityLog":[{"timestamp":"2025-11-15T10:32:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":3,"projectCode":"25-042-01","sectionNumber":1,"sectionName":"Review Owner\'s Contract","itemNumber":"1.3","label":"Any other special terms to be aware of?","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-15T10:35:00Z","assignedTo":"jmartinez@hedrickbrothers.com","assignedToName":"Jose Martinez","comment":null,"isHidden":false,"isCustom":false,"sortOrder":3,"activityLog":[{"timestamp":"2025-11-15T10:35:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":4,"projectCode":"25-042-01","sectionNumber":1,"sectionName":"Review Owner\'s Contract","itemNumber":"1.4","label":"Allowances to track- Set up change event to track","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-15T10:38:00Z","assignedTo":"jmartinez@hedrickbrothers.com","assignedToName":"Jose Martinez","comment":null,"isHidden":false,"isCustom":false,"sortOrder":4,"activityLog":[{"timestamp":"2025-11-15T10:38:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":5,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.1","label":"Project Executive assigned","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"kfoster@hedrickbrothers.com","respondedDate":"2025-11-16T08:00:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":5,"activityLog":[{"timestamp":"2025-11-16T08:00:00Z","user":"kfoster@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":6,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.2","label":"Project Manager assigned","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"kfoster@hedrickbrothers.com","respondedDate":"2025-11-16T08:01:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":6,"activityLog":[{"timestamp":"2025-11-16T08:01:00Z","user":"kfoster@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":7,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.3","label":"Superintendent assigned","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"kfoster@hedrickbrothers.com","respondedDate":"2025-11-16T08:02:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":7,"activityLog":[{"timestamp":"2025-11-16T08:02:00Z","user":"kfoster@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":8,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.4","label":"Project Engineer/Assistant PM assigned","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"kfoster@hedrickbrothers.com","respondedDate":"2025-11-16T08:03:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":8,"activityLog":[{"timestamp":"2025-11-16T08:03:00Z","user":"kfoster@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":9,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.5","label":"Project Accountant assigned","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"kfoster@hedrickbrothers.com","respondedDate":"2025-11-16T08:04:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":9,"activityLog":[{"timestamp":"2025-11-16T08:04:00Z","user":"kfoster@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":10,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.6","label":"Internal kick-off meeting scheduled","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-17T09:00:00Z","assignedTo":"jmartinez@hedrickbrothers.com","assignedToName":"Jose Martinez","comment":null,"isHidden":false,"isCustom":false,"sortOrder":10,"activityLog":[{"timestamp":"2025-11-17T09:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":11,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.7","label":"Pre-construction meeting with owner scheduled","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-17T09:05:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":11,"activityLog":[{"timestamp":"2025-11-17T09:05:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":12,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.8","label":"Project schedule developed","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-18T14:00:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":12,"activityLog":[{"timestamp":"2025-11-18T14:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":13,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.9","label":"Subcontractor pre-qualification completed","responseType":"yesNoNA","response":"Deficient","status":"Deficient","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T11:00:00Z","assignedTo":"tlewis@hedrickbrothers.com","assignedToName":"Tom Lewis","comment":"3 major subs still pending pre-qual review","isHidden":false,"isCustom":false,"sortOrder":13,"activityLog":[{"timestamp":"2025-11-20T11:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Deficient","comment":"3 major subs still pending pre-qual review"}]},{"id":14,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.10","label":"Buyout schedule established","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-18T15:00:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":14,"activityLog":[{"timestamp":"2025-11-18T15:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":15,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.11","label":"Subcontracts issued","responseType":"yesNoNA","response":"Deficient","status":"Deficient","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-22T10:00:00Z","assignedTo":"tlewis@hedrickbrothers.com","assignedToName":"Tom Lewis","comment":"Awaiting insurance certs from 5 subs before issuing","isHidden":false,"isCustom":false,"sortOrder":15,"activityLog":[{"timestamp":"2025-11-22T10:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Deficient"}]},{"id":16,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.12","label":"Purchase orders issued","responseType":"yesNoNA","response":"NA","status":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-22T10:05:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":16,"activityLog":[{"timestamp":"2025-11-22T10:05:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"NA"}]},{"id":17,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.13","label":"Insurance certificates obtained from subs","responseType":"yesNoNA","response":"Deficient","status":"Deficient","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-22T10:10:00Z","assignedTo":"lchen@hedrickbrothers.com","assignedToName":"Linda Chen","comment":null,"isHidden":false,"isCustom":false,"sortOrder":17,"activityLog":[{"timestamp":"2025-11-22T10:10:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Deficient"}]},{"id":18,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.14","label":"Builder\'s risk insurance in place","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-16T11:00:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":18,"activityLog":[{"timestamp":"2025-11-16T11:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":19,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.15","label":"Payment and performance bonds obtained","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-16T11:05:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":19,"activityLog":[{"timestamp":"2025-11-16T11:05:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":20,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.16","label":"Job cost code structure set up","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"rthompson@hedrickbrothers.com","respondedDate":"2025-11-19T09:00:00Z","assignedTo":"rthompson@hedrickbrothers.com","assignedToName":"Rachel Thompson","comment":null,"isHidden":false,"isCustom":false,"sortOrder":20,"activityLog":[{"timestamp":"2025-11-19T09:00:00Z","user":"rthompson@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":21,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.17","label":"Project budget entered in accounting system","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"rthompson@hedrickbrothers.com","respondedDate":"2025-11-19T09:30:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":21,"activityLog":[{"timestamp":"2025-11-19T09:30:00Z","user":"rthompson@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":22,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.18","label":"Submittal log created","responseType":"yesNoNA","response":"Neutral","status":"Neutral","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T14:00:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":22,"activityLog":[{"timestamp":"2025-11-20T14:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Neutral"}]},{"id":23,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.19","label":"RFI log created","responseType":"yesNoNA","response":"Neutral","status":"Neutral","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T14:05:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":23,"activityLog":[{"timestamp":"2025-11-20T14:05:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Neutral"}]},{"id":24,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.20","label":"Change order log created","responseType":"yesNoNA","response":"Neutral","status":"Neutral","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T14:10:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":24,"activityLog":[{"timestamp":"2025-11-20T14:10:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Neutral"}]},{"id":25,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.21","label":"Drawing log/plan management system set up","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T14:15:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":25,"activityLog":[{"timestamp":"2025-11-20T14:15:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":26,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.22","label":"Daily report system established","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T14:20:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":26,"activityLog":[{"timestamp":"2025-11-20T14:20:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":27,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.23","label":"Photo documentation system established","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":27,"activityLog":[]},{"id":28,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.24","label":"Safety plan developed for project","responseType":"yesNoNA","response":"Deficient","status":"Deficient","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-25T09:00:00Z","assignedTo":"msafety@hedrickbrothers.com","assignedToName":"Mike Safety","comment":"Safety dept to review site-specific hazards","isHidden":false,"isCustom":false,"sortOrder":28,"activityLog":[{"timestamp":"2025-11-25T09:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Deficient"}]},{"id":29,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.25","label":"Site-specific safety orientation developed","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":"msafety@hedrickbrothers.com","assignedToName":"Mike Safety","comment":null,"isHidden":false,"isCustom":false,"sortOrder":29,"activityLog":[]},{"id":30,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.26","label":"Emergency action plan established","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":30,"activityLog":[]},{"id":31,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.27","label":"Quality control plan developed","responseType":"yesNoNA","response":"NA","status":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-22T16:00:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":31,"activityLog":[{"timestamp":"2025-11-22T16:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"NA"}]},{"id":32,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.28","label":"SWPPP/erosion control plan in place","responseType":"yesNoNA","response":"NA","status":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-22T16:05:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":32,"activityLog":[{"timestamp":"2025-11-22T16:05:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"NA"}]},{"id":33,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.29","label":"Site logistics plan developed","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":33,"activityLog":[]},{"id":34,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.30","label":"Temporary facilities planned","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":34,"activityLog":[]},{"id":35,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.31","label":"Project sign installed","responseType":"yesNoNA","response":"Neutral","status":"Neutral","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-28T10:00:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":35,"activityLog":[{"timestamp":"2025-11-28T10:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Neutral"}]},{"id":36,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.32","label":"Project directory distributed","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":36,"activityLog":[]},{"id":37,"projectCode":"25-042-01","sectionNumber":2,"sectionName":"Job Start-up","itemNumber":"2.33","label":"As-built document process established","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":37,"activityLog":[]},{"id":38,"projectCode":"25-042-01","sectionNumber":3,"sectionName":"Order Services and Equipment","itemNumber":"3.1","label":"Temporary power arranged","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T10:00:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":38,"activityLog":[{"timestamp":"2025-11-20T10:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":39,"projectCode":"25-042-01","sectionNumber":3,"sectionName":"Order Services and Equipment","itemNumber":"3.2","label":"Temporary water arranged","responseType":"yesNoNA","response":"Conforming","status":"Conforming","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T10:05:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":39,"activityLog":[{"timestamp":"2025-11-20T10:05:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Conforming"}]},{"id":40,"projectCode":"25-042-01","sectionNumber":3,"sectionName":"Order Services and Equipment","itemNumber":"3.3","label":"Portable toilets ordered","responseType":"yesNoNA","response":"NA","status":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T10:10:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":40,"activityLog":[{"timestamp":"2025-11-20T10:10:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"NA"}]},{"id":41,"projectCode":"25-042-01","sectionNumber":3,"sectionName":"Order Services and Equipment","itemNumber":"3.4","label":"Dumpster/waste management arranged","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":41,"activityLog":[]},{"id":42,"projectCode":"25-042-01","sectionNumber":3,"sectionName":"Order Services and Equipment","itemNumber":"3.5","label":"Fencing and site security arranged","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":42,"activityLog":[]},{"id":43,"projectCode":"25-042-01","sectionNumber":3,"sectionName":"Order Services and Equipment","itemNumber":"3.6","label":"Surveying services arranged","responseType":"yesNoNA","response":"NA","status":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-20T10:15:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":43,"activityLog":[{"timestamp":"2025-11-20T10:15:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"NA"}]},{"id":44,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.1","label":"Building permit obtained and posted","responseType":"yesNoNA","response":"Deficient","status":"Deficient","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-25T14:00:00Z","assignedTo":"jmartinez@hedrickbrothers.com","assignedToName":"Jose Martinez","comment":"Permit application submitted, awaiting approval","isHidden":false,"isCustom":false,"sortOrder":44,"activityLog":[{"timestamp":"2025-11-25T14:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Deficient"}]},{"id":45,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.2","label":"OSHA poster displayed","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":45,"activityLog":[]},{"id":46,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.3","label":"Equal opportunity poster displayed","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":46,"activityLog":[]},{"id":47,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.4","label":"Workers compensation poster displayed","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":47,"activityLog":[]},{"id":48,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.5","label":"Minimum wage poster displayed","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":48,"activityLog":[]},{"id":49,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.6","label":"NPDES/dewatering permit obtained","responseType":"yesNoNA","response":"NA","status":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-25T14:30:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":49,"activityLog":[{"timestamp":"2025-11-25T14:30:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"NA"}]},{"id":50,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.7","label":"Environmental permits obtained","responseType":"yesNoNA","response":"NA","status":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-25T14:35:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":50,"activityLog":[{"timestamp":"2025-11-25T14:35:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"NA"}]},{"id":51,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.8","label":"Fire department permit/notification","responseType":"yesNoNA","response":"Neutral","status":"Neutral","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-26T09:00:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":51,"activityLog":[{"timestamp":"2025-11-26T09:00:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"Neutral"}]},{"id":52,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.9","label":"Street/sidewalk closure permit obtained","responseType":"yesNoNA","response":"NA","status":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-26T09:05:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":52,"activityLog":[{"timestamp":"2025-11-26T09:05:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"NA"}]},{"id":53,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.10","label":"Crane permit obtained","responseType":"yesNoNA","response":"NA","status":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-26T09:10:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":53,"activityLog":[{"timestamp":"2025-11-26T09:10:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"NA"}]},{"id":54,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.11","label":"Demolition permit obtained","responseType":"yesNoNA","response":"NA","status":"NA","respondedBy":"jmartinez@hedrickbrothers.com","respondedDate":"2025-11-26T09:15:00Z","assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":54,"activityLog":[{"timestamp":"2025-11-26T09:15:00Z","user":"jmartinez@hedrickbrothers.com","previousValue":null,"newValue":"NA"}]},{"id":55,"projectCode":"25-042-01","sectionNumber":4,"sectionName":"Permits Posted on Jobsite","itemNumber":"4.12","label":"Utility connection permits obtained","responseType":"yesNoNA","response":null,"status":"NoResponse","respondedBy":null,"respondedDate":null,"assignedTo":null,"assignedToName":null,"comment":null,"isHidden":false,"isCustom":false,"sortOrder":55,"activityLog":[]}]'),internalMatrix_namespaceObject=JSON.parse('{"tasks":[{"id":1,"projectCode":"25-042-01","sortOrder":1,"taskCategory":"PX","taskDescription":"Overall project oversight and client relationship","PX":"X","SrPM":"Support","PM2":"","PM1":"","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":2,"projectCode":"25-042-01","sortOrder":2,"taskCategory":"PX","taskDescription":"Contract negotiations and execution","PX":"X","SrPM":"Support","PM2":"","PM1":"","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":3,"projectCode":"25-042-01","sortOrder":3,"taskCategory":"PX","taskDescription":"Risk assessment and mitigation strategy","PX":"X","SrPM":"Review","PM2":"","PM1":"","PA":"","QAQC":"Support","ProjAcct":"","isHidden":false,"isCustom":false},{"id":4,"projectCode":"25-042-01","sortOrder":4,"taskCategory":"PX","taskDescription":"Executive reporting and stakeholder communication","PX":"X","SrPM":"Support","PM2":"","PM1":"","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":5,"projectCode":"25-042-01","sortOrder":5,"taskCategory":"Sr. PM","taskDescription":"Project planning and scheduling","PX":"Review","SrPM":"X","PM2":"Support","PM1":"","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":6,"projectCode":"25-042-01","sortOrder":6,"taskCategory":"Sr. PM","taskDescription":"Subcontractor procurement and buyout","PX":"Sign-Off","SrPM":"X","PM2":"Support","PM1":"","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":7,"projectCode":"25-042-01","sortOrder":7,"taskCategory":"Sr. PM","taskDescription":"Monthly cost reporting","PX":"Review","SrPM":"X","PM2":"Support","PM1":"","PA":"","QAQC":"","ProjAcct":"Support","isHidden":false,"isCustom":false},{"id":8,"projectCode":"25-042-01","sortOrder":8,"taskCategory":"Sr. PM","taskDescription":"Change order management","PX":"Sign-Off","SrPM":"X","PM2":"Support","PM1":"","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":9,"projectCode":"25-042-01","sortOrder":9,"taskCategory":"Sr. PM","taskDescription":"Owner pay application preparation","PX":"Review","SrPM":"X","PM2":"","PM1":"","PA":"Support","QAQC":"","ProjAcct":"Support","isHidden":false,"isCustom":false},{"id":10,"projectCode":"25-042-01","sortOrder":10,"taskCategory":"Sr. PM","taskDescription":"Subcontractor pay application review","PX":"","SrPM":"X","PM2":"Support","PM1":"","PA":"Support","QAQC":"","ProjAcct":"Review","isHidden":false,"isCustom":false},{"id":11,"projectCode":"25-042-01","sortOrder":11,"taskCategory":"Sr. PM","taskDescription":"Project safety oversight","PX":"Review","SrPM":"X","PM2":"Support","PM1":"","PA":"","QAQC":"Support","ProjAcct":"","isHidden":false,"isCustom":false},{"id":12,"projectCode":"25-042-01","sortOrder":12,"taskCategory":"Sr. PM","taskDescription":"Quality assurance program management","PX":"","SrPM":"X","PM2":"Support","PM1":"","PA":"","QAQC":"X","ProjAcct":"","isHidden":false,"isCustom":false},{"id":13,"projectCode":"25-042-01","sortOrder":13,"taskCategory":"Sr. PM","taskDescription":"Design coordination and RFI management","PX":"","SrPM":"X","PM2":"X","PM1":"","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":14,"projectCode":"25-042-01","sortOrder":14,"taskCategory":"Sr. PM","taskDescription":"Owner/architect meeting coordination","PX":"Support","SrPM":"X","PM2":"Support","PM1":"","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":15,"projectCode":"25-042-01","sortOrder":15,"taskCategory":"Sr. PM","taskDescription":"Submittal processing and tracking","PX":"","SrPM":"X","PM2":"X","PM1":"","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":16,"projectCode":"25-042-01","sortOrder":16,"taskCategory":"Sr. PM","taskDescription":"Project closeout coordination","PX":"Sign-Off","SrPM":"X","PM2":"Support","PM1":"","PA":"Support","QAQC":"Support","ProjAcct":"Support","isHidden":false,"isCustom":false},{"id":17,"projectCode":"25-042-01","sortOrder":17,"taskCategory":"Sr. PM","taskDescription":"Owner move-in coordination","PX":"Support","SrPM":"X","PM2":"Support","PM1":"Support","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":18,"projectCode":"25-042-01","sortOrder":18,"taskCategory":"PM 2","taskDescription":"Daily field coordination and supervision","PX":"","SrPM":"Review","PM2":"X","PM1":"Support","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":19,"projectCode":"25-042-01","sortOrder":19,"taskCategory":"PM 2","taskDescription":"Three-week look-ahead schedule maintenance","PX":"","SrPM":"Review","PM2":"X","PM1":"Support","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":20,"projectCode":"25-042-01","sortOrder":20,"taskCategory":"PM 2","taskDescription":"Subcontractor coordination meetings","PX":"","SrPM":"","PM2":"X","PM1":"Support","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":21,"projectCode":"25-042-01","sortOrder":21,"taskCategory":"PM 2","taskDescription":"Material procurement and tracking","PX":"","SrPM":"","PM2":"X","PM1":"Support","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":22,"projectCode":"25-042-01","sortOrder":22,"taskCategory":"PM 2","taskDescription":"Field issue resolution and documentation","PX":"","SrPM":"Review","PM2":"X","PM1":"Support","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":23,"projectCode":"25-042-01","sortOrder":23,"taskCategory":"PM 2","taskDescription":"Site safety inspections and reporting","PX":"","SrPM":"","PM2":"X","PM1":"Support","PA":"","QAQC":"Support","ProjAcct":"","isHidden":false,"isCustom":false},{"id":24,"projectCode":"25-042-01","sortOrder":24,"taskCategory":"PM 2","taskDescription":"Daily reports and photo documentation","PX":"","SrPM":"","PM2":"X","PM1":"Support","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":25,"projectCode":"25-042-01","sortOrder":25,"taskCategory":"PM 2","taskDescription":"Punchlist management","PX":"","SrPM":"Review","PM2":"X","PM1":"Support","PA":"","QAQC":"Support","ProjAcct":"","isHidden":false,"isCustom":false},{"id":26,"projectCode":"25-042-01","sortOrder":26,"taskCategory":"PM 2","taskDescription":"As-built documentation tracking","PX":"","SrPM":"","PM2":"X","PM1":"Support","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":27,"projectCode":"25-042-01","sortOrder":27,"taskCategory":"PM 2","taskDescription":"Temporary facilities management","PX":"","SrPM":"","PM2":"X","PM1":"Support","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":28,"projectCode":"25-042-01","sortOrder":28,"taskCategory":"PM 2","taskDescription":"Site logistics and crane operations","PX":"","SrPM":"","PM2":"X","PM1":"Support","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":29,"projectCode":"25-042-01","sortOrder":29,"taskCategory":"PM 2","taskDescription":"Long lead item procurement tracking","PX":"","SrPM":"Review","PM2":"X","PM1":"Support","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":30,"projectCode":"25-042-01","sortOrder":30,"taskCategory":"PM 2","taskDescription":"Project signage coordination","PX":"","SrPM":"","PM2":"X","PM1":"","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":31,"projectCode":"25-042-01","sortOrder":31,"taskCategory":"PM 2","taskDescription":"Utility coordination","PX":"","SrPM":"","PM2":"X","PM1":"Support","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":32,"projectCode":"25-042-01","sortOrder":32,"taskCategory":"PM 2","taskDescription":"Storm water management","PX":"","SrPM":"","PM2":"X","PM1":"Support","PA":"","QAQC":"Support","ProjAcct":"","isHidden":false,"isCustom":false},{"id":33,"projectCode":"25-042-01","sortOrder":33,"taskCategory":"PM 1","taskDescription":"Assist with submittal processing","PX":"","SrPM":"","PM2":"Review","PM1":"X","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":34,"projectCode":"25-042-01","sortOrder":34,"taskCategory":"PM 1","taskDescription":"RFI drafting and tracking","PX":"","SrPM":"","PM2":"Review","PM1":"X","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":35,"projectCode":"25-042-01","sortOrder":35,"taskCategory":"PM 1","taskDescription":"Meeting minutes preparation","PX":"","SrPM":"","PM2":"Review","PM1":"X","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":36,"projectCode":"25-042-01","sortOrder":36,"taskCategory":"PM 1","taskDescription":"Document control and distribution","PX":"","SrPM":"","PM2":"","PM1":"X","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":37,"projectCode":"25-042-01","sortOrder":37,"taskCategory":"PM 1","taskDescription":"Drawing log maintenance","PX":"","SrPM":"","PM2":"Review","PM1":"X","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":38,"projectCode":"25-042-01","sortOrder":38,"taskCategory":"PM 1","taskDescription":"Permit application assistance","PX":"","SrPM":"","PM2":"Review","PM1":"X","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":39,"projectCode":"25-042-01","sortOrder":39,"taskCategory":"PM 1","taskDescription":"Subcontractor insurance tracking","PX":"","SrPM":"","PM2":"","PM1":"X","PA":"Support","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":40,"projectCode":"25-042-01","sortOrder":40,"taskCategory":"PM 1","taskDescription":"Schedule update data collection","PX":"","SrPM":"","PM2":"Review","PM1":"X","PA":"","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":41,"projectCode":"25-042-01","sortOrder":41,"taskCategory":"PM 1","taskDescription":"Cost code tracking assistance","PX":"","SrPM":"","PM2":"","PM1":"X","PA":"","QAQC":"","ProjAcct":"Support","isHidden":false,"isCustom":false},{"id":42,"projectCode":"25-042-01","sortOrder":42,"taskCategory":"PM 1","taskDescription":"Safety documentation maintenance","PX":"","SrPM":"","PM2":"","PM1":"X","PA":"","QAQC":"Support","ProjAcct":"","isHidden":false,"isCustom":false},{"id":43,"projectCode":"25-042-01","sortOrder":43,"taskCategory":"PM 1","taskDescription":"Building code review","PX":"","SrPM":"","PM2":"Review","PM1":"X","PA":"","QAQC":"Support","ProjAcct":"","isHidden":false,"isCustom":false},{"id":44,"projectCode":"25-042-01","sortOrder":44,"taskCategory":"PA","taskDescription":"Project filing system setup and maintenance","PX":"","SrPM":"","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":45,"projectCode":"25-042-01","sortOrder":45,"taskCategory":"PA","taskDescription":"Contract document management","PX":"","SrPM":"Review","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":46,"projectCode":"25-042-01","sortOrder":46,"taskCategory":"PA","taskDescription":"Subcontract preparation and distribution","PX":"","SrPM":"Review","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":47,"projectCode":"25-042-01","sortOrder":47,"taskCategory":"PA","taskDescription":"Purchase order processing","PX":"","SrPM":"Sign-Off","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":48,"projectCode":"25-042-01","sortOrder":48,"taskCategory":"PA","taskDescription":"Insurance certificate tracking","PX":"","SrPM":"","PM2":"","PM1":"Support","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":49,"projectCode":"25-042-01","sortOrder":49,"taskCategory":"PA","taskDescription":"Lien waiver collection and tracking","PX":"","SrPM":"","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"Support","isHidden":false,"isCustom":false},{"id":50,"projectCode":"25-042-01","sortOrder":50,"taskCategory":"PA","taskDescription":"Pay application distribution to subs","PX":"","SrPM":"","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"Support","isHidden":false,"isCustom":false},{"id":51,"projectCode":"25-042-01","sortOrder":51,"taskCategory":"PA","taskDescription":"Correspondence tracking and distribution","PX":"","SrPM":"","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":52,"projectCode":"25-042-01","sortOrder":52,"taskCategory":"PA","taskDescription":"Transmittal preparation and logging","PX":"","SrPM":"","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":53,"projectCode":"25-042-01","sortOrder":53,"taskCategory":"PA","taskDescription":"Meeting scheduling and logistics","PX":"","SrPM":"Support","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":54,"projectCode":"25-042-01","sortOrder":54,"taskCategory":"PA","taskDescription":"Project directory maintenance","PX":"","SrPM":"","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":55,"projectCode":"25-042-01","sortOrder":55,"taskCategory":"PA","taskDescription":"Closeout document collection","PX":"","SrPM":"Review","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":56,"projectCode":"25-042-01","sortOrder":56,"taskCategory":"PA","taskDescription":"Warranty tracking and documentation","PX":"","SrPM":"","PM2":"","PM1":"","PA":"X","QAQC":"Support","ProjAcct":"","isHidden":false,"isCustom":false},{"id":57,"projectCode":"25-042-01","sortOrder":57,"taskCategory":"PA","taskDescription":"O&M manual coordination","PX":"","SrPM":"","PM2":"Support","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":58,"projectCode":"25-042-01","sortOrder":58,"taskCategory":"PA","taskDescription":"Attic stock coordination","PX":"","SrPM":"","PM2":"Support","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":59,"projectCode":"25-042-01","sortOrder":59,"taskCategory":"PA","taskDescription":"Final release of retainage processing","PX":"","SrPM":"Sign-Off","PM2":"","PM1":"","PA":"X","QAQC":"","ProjAcct":"Support","isHidden":false,"isCustom":false},{"id":60,"projectCode":"25-042-01","sortOrder":60,"taskCategory":"PA","taskDescription":"Construction waste diversion tracking","PX":"","SrPM":"","PM2":"Support","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":61,"projectCode":"25-042-01","sortOrder":61,"taskCategory":"PA","taskDescription":"Monthly progress photography","PX":"","SrPM":"","PM2":"Support","PM1":"","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":62,"projectCode":"25-042-01","sortOrder":62,"taskCategory":"QAQC","taskDescription":"Quality control inspections","PX":"","SrPM":"Review","PM2":"Support","PM1":"","PA":"","QAQC":"X","ProjAcct":"","isHidden":false,"isCustom":false},{"id":63,"projectCode":"25-042-01","sortOrder":63,"taskCategory":"QAQC","taskDescription":"Mock-up and sample reviews","PX":"","SrPM":"","PM2":"Support","PM1":"","PA":"","QAQC":"X","ProjAcct":"","isHidden":false,"isCustom":false},{"id":64,"projectCode":"25-042-01","sortOrder":64,"taskCategory":"QAQC","taskDescription":"Third-party testing coordination","PX":"","SrPM":"","PM2":"Support","PM1":"","PA":"Support","QAQC":"X","ProjAcct":"","isHidden":false,"isCustom":false},{"id":65,"projectCode":"25-042-01","sortOrder":65,"taskCategory":"QAQC","taskDescription":"Pre-installation conference facilitation","PX":"","SrPM":"Support","PM2":"Support","PM1":"","PA":"","QAQC":"X","ProjAcct":"","isHidden":false,"isCustom":false},{"id":66,"projectCode":"25-042-01","sortOrder":66,"taskCategory":"QAQC","taskDescription":"Commissioning coordination","PX":"","SrPM":"Review","PM2":"Support","PM1":"","PA":"","QAQC":"X","ProjAcct":"","isHidden":false,"isCustom":false},{"id":67,"projectCode":"25-042-01","sortOrder":67,"taskCategory":"QAQC","taskDescription":"Environmental compliance monitoring","PX":"","SrPM":"","PM2":"Support","PM1":"","PA":"Support","QAQC":"X","ProjAcct":"","isHidden":false,"isCustom":false},{"id":68,"projectCode":"25-042-01","sortOrder":68,"taskCategory":"QAQC","taskDescription":"Punchlist final verification","PX":"","SrPM":"Sign-Off","PM2":"Support","PM1":"","PA":"","QAQC":"X","ProjAcct":"","isHidden":false,"isCustom":false},{"id":69,"projectCode":"25-042-01","sortOrder":69,"taskCategory":"Proj Acct","taskDescription":"Job cost setup in accounting system","PX":"","SrPM":"Review","PM2":"","PM1":"","PA":"","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":70,"projectCode":"25-042-01","sortOrder":70,"taskCategory":"Proj Acct","taskDescription":"Monthly job cost reports","PX":"","SrPM":"Review","PM2":"","PM1":"","PA":"","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":71,"projectCode":"25-042-01","sortOrder":71,"taskCategory":"Proj Acct","taskDescription":"Subcontractor payment processing","PX":"","SrPM":"Sign-Off","PM2":"","PM1":"","PA":"Support","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":72,"projectCode":"25-042-01","sortOrder":72,"taskCategory":"Proj Acct","taskDescription":"Owner billing/invoicing","PX":"","SrPM":"Review","PM2":"","PM1":"","PA":"Support","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":73,"projectCode":"25-042-01","sortOrder":73,"taskCategory":"Proj Acct","taskDescription":"Retainage tracking","PX":"","SrPM":"","PM2":"","PM1":"","PA":"Support","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":74,"projectCode":"25-042-01","sortOrder":74,"taskCategory":"Proj Acct","taskDescription":"Sales tax reporting and compliance","PX":"","SrPM":"","PM2":"","PM1":"","PA":"","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":75,"projectCode":"25-042-01","sortOrder":75,"taskCategory":"Proj Acct","taskDescription":"Certified payroll tracking","PX":"","SrPM":"","PM2":"","PM1":"","PA":"Support","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":76,"projectCode":"25-042-01","sortOrder":76,"taskCategory":"Proj Acct","taskDescription":"Budget transfer processing","PX":"","SrPM":"Sign-Off","PM2":"","PM1":"","PA":"","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":77,"projectCode":"25-042-01","sortOrder":77,"taskCategory":"Proj Acct","taskDescription":"WIP schedule preparation","PX":"","SrPM":"Review","PM2":"","PM1":"","PA":"","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":78,"projectCode":"25-042-01","sortOrder":78,"taskCategory":"Proj Acct","taskDescription":"Final project cost reconciliation","PX":"Review","SrPM":"Sign-Off","PM2":"","PM1":"","PA":"","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":79,"projectCode":"25-042-01","sortOrder":79,"taskCategory":"Proj Acct","taskDescription":"Project financial closeout","PX":"Sign-Off","SrPM":"Review","PM2":"","PM1":"","PA":"Support","QAQC":"","ProjAcct":"X","isHidden":false,"isCustom":false},{"id":80,"projectCode":"25-042-01","sortOrder":80,"taskCategory":"All","taskDescription":"Attend weekly project team meetings","PX":"X","SrPM":"X","PM2":"X","PM1":"X","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false},{"id":81,"projectCode":"25-042-01","sortOrder":81,"taskCategory":"All","taskDescription":"Monthly safety walk participation","PX":"X","SrPM":"X","PM2":"X","PM1":"X","PA":"","QAQC":"X","ProjAcct":"","isHidden":false,"isCustom":false},{"id":82,"projectCode":"25-042-01","sortOrder":82,"taskCategory":"All","taskDescription":"Lessons learned documentation","PX":"X","SrPM":"X","PM2":"X","PM1":"X","PA":"","QAQC":"X","ProjAcct":"","isHidden":false,"isCustom":false},{"id":83,"projectCode":"25-042-01","sortOrder":83,"taskCategory":"All","taskDescription":"Project milestone celebration planning","PX":"Support","SrPM":"X","PM2":"Support","PM1":"Support","PA":"X","QAQC":"","ProjAcct":"","isHidden":false,"isCustom":false}],"recurringItems":[{"id":1,"projectCode":"25-042-01","role":"PM","duePattern":"Weekly (Monday)","description":"Update three-week look-ahead schedule","isActive":true},{"id":2,"projectCode":"25-042-01","role":"PM","duePattern":"Weekly (Friday)","description":"Submit weekly progress report to owner","isActive":true},{"id":3,"projectCode":"25-042-01","role":"PM","duePattern":"Monthly (1st)","description":"Prepare owner pay application","isActive":true},{"id":4,"projectCode":"25-042-01","role":"PM","duePattern":"Monthly (15th)","description":"Review and approve subcontractor pay applications","isActive":true},{"id":5,"projectCode":"25-042-01","role":"PM","duePattern":"Monthly (20th)","description":"Complete monthly cost projection update","isActive":true},{"id":6,"projectCode":"25-042-01","role":"Super","duePattern":"Daily","description":"Complete daily field report with photos","isActive":true},{"id":7,"projectCode":"25-042-01","role":"Super","duePattern":"Weekly (Monday)","description":"Conduct site safety inspection","isActive":true},{"id":8,"projectCode":"25-042-01","role":"PA","duePattern":"Weekly (Wednesday)","description":"Update insurance certificate tracker","isActive":true},{"id":9,"projectCode":"25-042-01","role":"ProjAcct","duePattern":"Monthly (5th)","description":"Process subcontractor payments","isActive":true},{"id":10,"projectCode":"25-042-01","role":"QAQC","duePattern":"Bi-Weekly","description":"Conduct quality control field inspection","isActive":true}],"teamAssignments":[{"projectCode":"25-042-01","roleAbbreviation":"PX","assignedPerson":"Robert Hedrick","assignedPersonEmail":"rhedrick@hedrickbrothers.com"},{"projectCode":"25-042-01","roleAbbreviation":"SrPM","assignedPerson":"Jose Martinez","assignedPersonEmail":"jmartinez@hedrickbrothers.com"},{"projectCode":"25-042-01","roleAbbreviation":"PM2","assignedPerson":"Tom Lewis","assignedPersonEmail":"tlewis@hedrickbrothers.com"},{"projectCode":"25-042-01","roleAbbreviation":"PM1","assignedPerson":"Sarah Kim","assignedPersonEmail":"skim@hedrickbrothers.com"},{"projectCode":"25-042-01","roleAbbreviation":"PA","assignedPerson":"Linda Chen","assignedPersonEmail":"lchen@hedrickbrothers.com"},{"projectCode":"25-042-01","roleAbbreviation":"QAQC","assignedPerson":"David Park","assignedPersonEmail":"dpark@hedrickbrothers.com"},{"projectCode":"25-042-01","roleAbbreviation":"ProjAcct","assignedPerson":"Rachel Thompson","assignedPersonEmail":"rthompson@hedrickbrothers.com"}]}'),ownerContractMatrix_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","sortOrder":1,"articleNumber":"1","pageNumber":"3","responsibleParty":"","description":"General Provisions â€” Definitions and relationship of parties","isHidden":false,"isCustom":false},{"id":2,"projectCode":"25-042-01","sortOrder":2,"articleNumber":"2","pageNumber":"7","responsibleParty":"O","description":"Owner\'s Responsibilities â€” Information, surveys, permits, insurance","isHidden":false,"isCustom":false},{"id":3,"projectCode":"25-042-01","sortOrder":3,"articleNumber":"3","pageNumber":"12","responsibleParty":"C","description":"Contractor\'s Responsibilities â€” Supervision, labor, materials, equipment","isHidden":false,"isCustom":false},{"id":4,"projectCode":"25-042-01","sortOrder":4,"articleNumber":"4","pageNumber":"18","responsibleParty":"","description":"Subcontractors â€” Award, management, and responsibility for subcontracted work","isHidden":false,"isCustom":false},{"id":5,"projectCode":"25-042-01","sortOrder":5,"articleNumber":"5","pageNumber":"25","responsibleParty":"","description":"Contract Time â€” Commencement, substantial completion, liquidated damages","isHidden":false,"isCustom":false},{"id":6,"projectCode":"25-042-01","sortOrder":6,"articleNumber":"6","pageNumber":"","responsibleParty":"","description":"Contract Sum â€” GMP/Lump Sum, allowances, unit prices","isHidden":false,"isCustom":false},{"id":7,"projectCode":"25-042-01","sortOrder":7,"articleNumber":"7","pageNumber":"","responsibleParty":"","description":"Changes in the Work â€” Change order procedures, pricing, time extensions","isHidden":false,"isCustom":false},{"id":8,"projectCode":"25-042-01","sortOrder":8,"articleNumber":"8","pageNumber":"","responsibleParty":"","description":"Payment â€” Progress payments, retainage, final payment","isHidden":false,"isCustom":false},{"id":9,"projectCode":"25-042-01","sortOrder":9,"articleNumber":"9","pageNumber":"","responsibleParty":"C","description":"Insurance and Bonds â€” Liability, property, builder\'s risk, surety","isHidden":false,"isCustom":false},{"id":10,"projectCode":"25-042-01","sortOrder":10,"articleNumber":"10","pageNumber":"","responsibleParty":"C","description":"Safety â€” Site safety program, OSHA compliance, hazardous materials","isHidden":false,"isCustom":false},{"id":11,"projectCode":"25-042-01","sortOrder":11,"articleNumber":"11","pageNumber":"","responsibleParty":"","description":"Uncovering and Correction of Work â€” Inspection, testing, remediation","isHidden":false,"isCustom":false},{"id":12,"projectCode":"25-042-01","sortOrder":12,"articleNumber":"12","pageNumber":"","responsibleParty":"","description":"Warranty â€” Duration, scope, exclusions","isHidden":false,"isCustom":false},{"id":13,"projectCode":"25-042-01","sortOrder":13,"articleNumber":"13","pageNumber":"","responsibleParty":"","description":"Dispute Resolution â€” Mediation, arbitration, litigation","isHidden":false,"isCustom":false},{"id":14,"projectCode":"25-042-01","sortOrder":14,"articleNumber":"14","pageNumber":"","responsibleParty":"","description":"Termination â€” For cause, for convenience, payment obligations","isHidden":false,"isCustom":false},{"id":15,"projectCode":"25-042-01","sortOrder":15,"articleNumber":"15","pageNumber":"","responsibleParty":"","description":"Indemnification â€” Scope, limitations, mutual obligations","isHidden":false,"isCustom":false},{"id":16,"projectCode":"25-042-01","sortOrder":16,"articleNumber":"16","pageNumber":"","responsibleParty":"O","description":"Permits and Fees â€” Responsibility, cost allocation","isHidden":false,"isCustom":false},{"id":17,"projectCode":"25-042-01","sortOrder":17,"articleNumber":"17","pageNumber":"","responsibleParty":"","description":"Sustainability Requirements â€” LEED, green building, certifications","isHidden":false,"isCustom":false},{"id":18,"projectCode":"25-042-01","sortOrder":18,"articleNumber":"18","pageNumber":"","responsibleParty":"","description":"Owner\'s Right to Perform Work â€” Self-performed work, separate contractors","isHidden":false,"isCustom":false},{"id":19,"projectCode":"25-042-01","sortOrder":19,"articleNumber":"19","pageNumber":"","responsibleParty":"","description":"Concealed Conditions â€” Discovery, notice, cost adjustment","isHidden":false,"isCustom":false},{"id":20,"projectCode":"25-042-01","sortOrder":20,"articleNumber":"20","pageNumber":"","responsibleParty":"","description":"Miscellaneous â€” Governing law, assignment, notice requirements","isHidden":false,"isCustom":false}]'),subContractMatrix_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","sortOrder":1,"refNumber":"SC-1","pageNumber":"2","clauseDescription":"Scope of Work â€” Detailed description of subcontracted work","ProjExec":"","ProjMgr":"X","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":2,"projectCode":"25-042-01","sortOrder":2,"refNumber":"SC-2","pageNumber":"5","clauseDescription":"Contract Sum and Payment Terms â€” Price, retainage, payment schedule","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":3,"projectCode":"25-042-01","sortOrder":3,"refNumber":"SC-3","pageNumber":"8","clauseDescription":"Schedule and Time â€” Start date, duration, milestones, delay provisions","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":4,"projectCode":"25-042-01","sortOrder":4,"refNumber":"SC-4","pageNumber":"","clauseDescription":"Change Orders â€” Pricing methodology, approval process, time extensions","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":5,"projectCode":"25-042-01","sortOrder":5,"refNumber":"SC-5","pageNumber":"","clauseDescription":"Insurance Requirements â€” GL, auto, workers comp, umbrella minimums","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"X","isHidden":false,"isCustom":false},{"id":6,"projectCode":"25-042-01","sortOrder":6,"refNumber":"SC-6","pageNumber":"","clauseDescription":"Indemnification and Hold Harmless â€” Mutual obligations and limitations","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":7,"projectCode":"25-042-01","sortOrder":7,"refNumber":"SC-7","pageNumber":"","clauseDescription":"Safety Requirements â€” Site-specific safety plan, OSHA compliance, PPE","ProjExec":"","ProjMgr":"Review","AsstPM":"","Super":"X","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":8,"projectCode":"25-042-01","sortOrder":8,"refNumber":"SC-8","pageNumber":"","clauseDescription":"Quality Control â€” Inspections, testing, mock-ups, standards compliance","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":9,"projectCode":"25-042-01","sortOrder":9,"refNumber":"SC-9","pageNumber":"","clauseDescription":"Submittals and Shop Drawings â€” Requirements, review periods, resubmittals","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":10,"projectCode":"25-042-01","sortOrder":10,"refNumber":"SC-10","pageNumber":"","clauseDescription":"Cleanup and Waste Management â€” Daily cleanup, debris removal, recycling","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":11,"projectCode":"25-042-01","sortOrder":11,"refNumber":"SC-11","pageNumber":"","clauseDescription":"Warranty â€” Duration, scope, callback procedures","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":12,"projectCode":"25-042-01","sortOrder":12,"refNumber":"SC-12","pageNumber":"","clauseDescription":"Dispute Resolution â€” Escalation, mediation, arbitration","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":13,"projectCode":"25-042-01","sortOrder":13,"refNumber":"SC-13","pageNumber":"","clauseDescription":"Termination â€” For cause, for convenience, payment for work completed","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":14,"projectCode":"25-042-01","sortOrder":14,"refNumber":"SC-14","pageNumber":"","clauseDescription":"Lien Waivers â€” Conditional/unconditional, progress and final","ProjExec":"","ProjMgr":"Sign-Off","AsstPM":"","Super":"","ProjAdmin":"X","isHidden":false,"isCustom":false},{"id":15,"projectCode":"25-042-01","sortOrder":15,"refNumber":"SC-15","pageNumber":"","clauseDescription":"Certified Payroll â€” Davis-Bacon, prevailing wage compliance","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":16,"projectCode":"25-042-01","sortOrder":16,"refNumber":"SC-16","pageNumber":"","clauseDescription":"MWBE/SBE Requirements â€” Participation goals, documentation, reporting","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":17,"projectCode":"25-042-01","sortOrder":17,"refNumber":"SC-17","pageNumber":"","clauseDescription":"Liquidated Damages â€” Flow-down provisions, daily rates, cap","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":18,"projectCode":"25-042-01","sortOrder":18,"refNumber":"SC-18","pageNumber":"","clauseDescription":"Bonds â€” Payment and performance bond requirements","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":19,"projectCode":"25-042-01","sortOrder":19,"refNumber":"SC-19","pageNumber":"","clauseDescription":"As-Built Documentation â€” Requirements, format, delivery schedule","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false},{"id":20,"projectCode":"25-042-01","sortOrder":20,"refNumber":"SC-20","pageNumber":"","clauseDescription":"Closeout Requirements â€” Punchlist, O&M manuals, warranties, training","ProjExec":"","ProjMgr":"","AsstPM":"","Super":"","ProjAdmin":"","isHidden":false,"isCustom":false}]'),marketingProjectRecords_namespaceObject=JSON.parse('[{"projectName":"Palm Beach Mixed-Use Tower","projectCode":"25-042-01","leadId":1,"contractType":["Cost Plus with GMP","AIA Docs"],"deliveryMethod":"Construction Manager","architect":"Arquitectonica","landscapeArchitect":"Kimley-Horn and Associates","interiorDesigner":"Gensler","engineer":"TLC Engineering Solutions","buildingSystemType":"Cast-in-place concrete with post-tensioned slabs, curtain wall facade","projectDescription":"A 22-story mixed-use tower in downtown West Palm Beach featuring 180 luxury residential units, 45,000 SF of Class A office space, and 12,000 SF of ground-floor retail. The building includes a 6-level parking garage with 450 spaces, resort-style amenity deck on level 8, and rooftop lounge with panoramic Intracoastal views. Total gross area of 385,000 SF on a 1.2-acre site.","uniqueCharacteristics":"First high-rise in West Palm Beach to achieve LEED Gold certification. Innovative wind-resistant curtain wall system rated for 180 mph winds. Integrated stormwater harvesting system providing 40% of irrigation needs. Active construction adjacent to occupied historic buildings requiring vibration monitoring and underpinning of existing foundations.","renderingUrls":["https://hbcprojects.sharepoint.com/sites/25-042-01/Shared%20Documents/Marketing/Renderings/exterior-day.jpg","https://hbcprojects.sharepoint.com/sites/25-042-01/Shared%20Documents/Marketing/Renderings/exterior-night.jpg","https://hbcprojects.sharepoint.com/sites/25-042-01/Shared%20Documents/Marketing/Renderings/amenity-deck.jpg"],"finalPhotoUrls":["https://hbcprojects.sharepoint.com/sites/25-042-01/Shared%20Documents/Marketing/Final%20Photos/aerial-completion.jpg","https://hbcprojects.sharepoint.com/sites/25-042-01/Shared%20Documents/Marketing/Final%20Photos/lobby-interior.jpg","https://hbcprojects.sharepoint.com/sites/25-042-01/Shared%20Documents/Marketing/Final%20Photos/rooftop-lounge.jpg","https://hbcprojects.sharepoint.com/sites/25-042-01/Shared%20Documents/Marketing/Final%20Photos/pool-deck-sunset.jpg"],"contractBudget":45000000,"contractFinalCost":44200000,"totalCostPerGSF":114.81,"totalBudgetVariance":-800000,"budgetExplanation":"Project completed $800K under GMP. Value engineering on mechanical systems and facade detailing offset owner-directed upgrades to lobby finishes and amenity spaces. Favorable subcontractor pricing during buyout contributed to savings.","CO_OwnerDirected_Count":14,"CO_OwnerDirected_Value":1250000,"CO_MunicipalityDirected_Count":3,"CO_MunicipalityDirected_Value":185000,"CO_EO_Count":8,"CO_EO_Value":420000,"CO_ContractorDirected_Count":2,"savingsReturned":580000,"savingsReturnedPct":72.5,"scheduleStartAnticipated":"2025-03-15","scheduleStartActual":"2025-03-22","scheduleEndAnticipated":"2027-06-30","scheduleEndActual":"2027-06-15","onSchedule":"Yes â€” completed 15 days ahead of schedule","scheduleExplanation":"Despite a 7-day delayed start due to permit processing, the team recovered schedule through accelerated foundation work and prefabricated MEP assemblies. Tower crane strategy with dual cranes allowed concurrent vertical and horizontal operations.","substantialCompletionDate":"2027-05-28","finalCompletionDate":"2027-06-15","punchListItems":342,"punchListDaysToComplete":18,"innovativeSafetyPrograms":"Implemented AI-powered camera monitoring for real-time PPE compliance detection. Drone-based perimeter safety inspections reduced fall exposure for inspection personnel. Weekly safety stand-downs with bilingual training materials. Zero lost-time incidents over 780,000 work hours.","mwbeRequirement":"15% MBE / 5% WBE","mwbeAchievement":"18.2% MBE / 6.8% WBE","sbeRequirement":"10% SBE","sbeAchievement":"12.4% SBE","localRequirement":"30% local workforce","localAchievement":"34% local workforce achieved","leedDesignation":"LEED Gold","sustainabilityFeatures":"High-efficiency VRF HVAC system, low-E triple-pane curtain wall, 120 kW rooftop solar array, rainwater harvesting for irrigation, EV charging stations on all garage levels, native landscaping reducing irrigation by 60%.","leedAdditionalCost":1350000,"CS_Conflicts":"Resolved a significant design conflict between the structural engineer and curtain wall consultant regarding connection details at the amenity deck cantilever. HBC facilitated a joint workshop that produced a solution saving $180K versus the original detail while improving constructability.","CS_CostControl":"Monthly cost forecasting identified a potential $600K overrun in mechanical rough-in at month 8. The team negotiated a VE package with the MEP subcontractor, switching to prefabricated risers that reduced labor costs by 22% and brought the project back within GMP.","CS_ValueEngineering":"28 VE items totaling $2.1M in potential savings were identified during preconstruction. Owner accepted 19 items worth $1.4M, including alternative waterproofing systems, pre-engineered stair assemblies, and revised elevator pit details.","CS_QualityControl":"Implemented a digital QC inspection platform with real-time deficiency tracking. Mock-up program for all exterior finish systems ensured first-time quality on curtain wall, precast, and landscape hardscape. Achieved 98.2% first-pass inspection rate.","CS_Schedule":"Utilized pull planning with trade partners to identify and resolve schedule conflicts 6 weeks in advance. Critical path activities were tracked daily with real-time dashboards visible to all stakeholders. Milestone incentive program for key subcontractors.","CS_Team":"Dedicated on-site team of 8 HBC professionals with combined 140+ years of high-rise experience. Weekly owner/architect/contractor alignment meetings and monthly executive steering committee reviews maintained stakeholder confidence throughout.","CS_Safety":"Zero OSHA recordable incidents. Implemented site-specific fall protection plan with 100% tie-off policy above 6 feet. Crane operations managed with full-time signal person and anti-collision system. Safety orientation required for all workers in English and Spanish.","CS_LEED":"HBC assigned a dedicated LEED coordinator who tracked 47 individual credits throughout construction. Construction waste diversion achieved 89% (goal was 75%). Indoor air quality management plan implemented 3 months before substantial completion.","CS_SupplierDiversity":"Exceeded all diversity targets through proactive outreach at preconstruction phase. Mentored 3 emerging MBE firms through the project, resulting in their capacity growth and subsequent bonding capability increases. Hosted quarterly diversity networking events.","CS_Challenges":"Primary challenges included active construction adjacent to a historic 1920s building requiring vibration monitoring and foundation underpinning, a 6-month supply chain delay on custom curtain wall units, and coordinating tower crane operations within FAA height restrictions near PBIA.","CS_InnovativeSolutions":"Developed a custom logistics plan using BIM 4D simulation to sequence 2,400 curtain wall panel deliveries with just-in-time installation, eliminating the need for on-site storage. Augmented reality used for MEP coordination in ceiling spaces, reducing field conflicts by 85%.","CS_ProductsSystems":"Schuco FWS 60+ curtain wall system, Carrier AquaEdge 19DV chiller, Otis Gen2 MRL elevators, Hilti firestop systems, Tremco waterproofing, Hunter Douglas ceiling systems, Lutron Vive wireless lighting controls.","CS_ClientService":"Provided monthly executive summary reports with drone photography and time-lapse video updates. Hosted quarterly hard-hat tours for the owner\'s investors and board members. Implemented a dedicated owner portal for real-time project status and document access.","CS_LessonsLearned":"Early engagement of curtain wall installer during DD phase would have reduced lead time impacts. Future projects should include vibration monitoring specifications in the geotechnical scope to avoid separate mobilization. Digital twin model proved invaluable for owner facilities training and should be standard on all projects over $30M.","sectionCompletion":{"projectInfo":100,"description":100,"budget":100,"schedule":100,"qc":100,"safety":100,"supplierDiversity":100,"sustainability":100,"caseStudy":85},"overallCompletion":75,"lastUpdatedBy":"Jose Martinez","lastUpdatedAt":"2026-01-28T14:30:00Z","createdBy":"Linda Chen","createdAt":"2025-07-15T09:00:00Z"},{"projectName":"Orlando Airport Terminal Expansion","projectCode":"25-115-01","leadId":3,"contractType":["Cost Plus with GMP"],"deliveryMethod":"Construction Manager","architect":"HOK","landscapeArchitect":"","interiorDesigner":"Gresham Smith","engineer":"Kimley-Horn and Associates","buildingSystemType":"Structural steel frame with long-span trusses, unitized curtain wall","projectDescription":"Expansion of the south terminal at Orlando International Airport adding 16 new gates, a 210,000 SF concourse building, passenger boarding bridges, and supporting apron infrastructure. The project includes a 2,500-space parking garage connected via an automated people mover extension. Construction phased to maintain full airport operations throughout.","uniqueCharacteristics":"Active airside construction requiring FAA coordination and TSA security protocols. Night-shift-only work windows for apron and taxiway modifications. Complex phasing plan maintaining minimum gate availability throughout construction.","renderingUrls":["https://hbcprojects.sharepoint.com/sites/25-115-01/Shared%20Documents/Marketing/Renderings/terminal-aerial.jpg","https://hbcprojects.sharepoint.com/sites/25-115-01/Shared%20Documents/Marketing/Renderings/concourse-interior.jpg"],"finalPhotoUrls":[],"contractBudget":128000000,"contractFinalCost":null,"totalCostPerGSF":null,"totalBudgetVariance":null,"budgetExplanation":"","CO_OwnerDirected_Count":6,"CO_OwnerDirected_Value":2400000,"CO_MunicipalityDirected_Count":1,"CO_MunicipalityDirected_Value":75000,"CO_EO_Count":null,"CO_EO_Value":null,"CO_ContractorDirected_Count":null,"savingsReturned":null,"savingsReturnedPct":null,"scheduleStartAnticipated":"2025-06-01","scheduleStartActual":"2025-06-15","scheduleEndAnticipated":"2028-03-31","scheduleEndActual":null,"onSchedule":"Tracking on schedule","scheduleExplanation":"Minor start delay due to FAA airspace coordination approval. Night work operations running efficiently with no schedule impacts to date.","substantialCompletionDate":null,"finalCompletionDate":null,"punchListItems":null,"punchListDaysToComplete":null,"innovativeSafetyPrograms":"FAA-compliant safety program with airside escort protocols. Dedicated safety officer for night operations. FOD prevention program exceeding GOAA requirements.","mwbeRequirement":"18% MWBE combined","mwbeAchievement":"","sbeRequirement":"12% SBE","sbeAchievement":"","localRequirement":"","localAchievement":"","leedDesignation":"","sustainabilityFeatures":"High-performance glazing, energy recovery ventilation, LED lighting with daylight harvesting sensors.","leedAdditionalCost":null,"CS_Conflicts":"Ongoing coordination between airside operations and construction activities requires daily planning meetings with GOAA operations staff.","CS_CostControl":"","CS_ValueEngineering":"","CS_QualityControl":"","CS_Schedule":"","CS_Team":"","CS_Safety":"","CS_LEED":"","CS_SupplierDiversity":"","CS_Challenges":"","CS_InnovativeSolutions":"","CS_ProductsSystems":"","CS_ClientService":"","CS_LessonsLearned":"","sectionCompletion":{"projectInfo":90,"description":80,"budget":40,"schedule":60,"qc":0,"safety":50,"supplierDiversity":30,"sustainability":25,"caseStudy":8},"overallCompletion":40,"lastUpdatedBy":"Tom Lewis","lastUpdatedAt":"2026-01-10T11:15:00Z","createdBy":"Linda Chen","createdAt":"2025-09-01T10:00:00Z"},{"projectName":"Tallahassee State Office Complex","projectCode":"25-200-01","leadId":5,"contractType":["Lump Sum"],"deliveryMethod":"General Contractor","architect":"Leo A Daly","landscapeArchitect":"","interiorDesigner":"","engineer":"","buildingSystemType":"Structural steel with composite metal deck","projectDescription":"New 4-story state office building with 120,000 SF of office space for the Florida Department of Environmental Protection. Includes a 200-space surface parking lot, emergency generator facility, and secure data center wing.","uniqueCharacteristics":"","renderingUrls":[],"finalPhotoUrls":[],"contractBudget":32000000,"contractFinalCost":null,"totalCostPerGSF":null,"totalBudgetVariance":null,"budgetExplanation":"","CO_OwnerDirected_Count":null,"CO_OwnerDirected_Value":null,"CO_MunicipalityDirected_Count":null,"CO_MunicipalityDirected_Value":null,"CO_EO_Count":null,"CO_EO_Value":null,"CO_ContractorDirected_Count":null,"savingsReturned":null,"savingsReturnedPct":null,"scheduleStartAnticipated":"2026-01-15","scheduleStartActual":null,"scheduleEndAnticipated":"2027-09-30","scheduleEndActual":null,"onSchedule":"","scheduleExplanation":"","substantialCompletionDate":null,"finalCompletionDate":null,"punchListItems":null,"punchListDaysToComplete":null,"innovativeSafetyPrograms":"","mwbeRequirement":"","mwbeAchievement":"","sbeRequirement":"","sbeAchievement":"","localRequirement":"","localAchievement":"","leedDesignation":"","sustainabilityFeatures":"","leedAdditionalCost":null,"CS_Conflicts":"","CS_CostControl":"","CS_ValueEngineering":"","CS_QualityControl":"","CS_Schedule":"","CS_Team":"","CS_Safety":"","CS_LEED":"","CS_SupplierDiversity":"","CS_Challenges":"","CS_InnovativeSolutions":"","CS_ProductsSystems":"","CS_ClientService":"","CS_LessonsLearned":"","sectionCompletion":{"projectInfo":50,"description":30,"budget":5,"schedule":10,"qc":0,"safety":0,"supplierDiversity":0,"sustainability":0,"caseStudy":0},"overallCompletion":10,"lastUpdatedBy":"Linda Chen","lastUpdatedAt":"2025-12-05T16:45:00Z","createdBy":"Linda Chen","createdAt":"2025-12-01T09:00:00Z"},{"projectName":"Martin County Courthouse Renovation","projectCode":"24-089-01","leadId":7,"contractType":["Cost Plus with GMP","AIA Docs"],"deliveryMethod":"Construction Manager","architect":"Schenkel Shultz Architecture","landscapeArchitect":"Land Design South","interiorDesigner":"Spector Group","engineer":"WSP USA","buildingSystemType":"Renovated reinforced concrete frame with new MEP systems, historic facade preservation","projectDescription":"Comprehensive renovation of the 85,000 SF Martin County Courthouse originally constructed in 1978. Scope includes full MEP replacement, ADA compliance upgrades, courtroom modernization (6 courtrooms), new security screening and holding areas, judges\' chambers renovation, clerk of court office reconfiguration, and historic facade restoration. All work phased to maintain partial courthouse operations.","uniqueCharacteristics":"Occupied renovation requiring complex phasing across 4 construction phases over 18 months. Temporary courtroom facilities provided via modular units during renovation. Discovery of asbestos-containing materials in original ceiling systems required abatement scope addition. Historic facade elements preserved and restored per Florida Division of Historical Resources guidelines.","renderingUrls":["https://hbcprojects.sharepoint.com/sites/24-089-01/Shared%20Documents/Marketing/Renderings/lobby-renovation.jpg","https://hbcprojects.sharepoint.com/sites/24-089-01/Shared%20Documents/Marketing/Renderings/courtroom-modern.jpg"],"finalPhotoUrls":["https://hbcprojects.sharepoint.com/sites/24-089-01/Shared%20Documents/Marketing/Final%20Photos/exterior-restored.jpg","https://hbcprojects.sharepoint.com/sites/24-089-01/Shared%20Documents/Marketing/Final%20Photos/main-lobby.jpg","https://hbcprojects.sharepoint.com/sites/24-089-01/Shared%20Documents/Marketing/Final%20Photos/courtroom-a.jpg","https://hbcprojects.sharepoint.com/sites/24-089-01/Shared%20Documents/Marketing/Final%20Photos/judges-chambers.jpg","https://hbcprojects.sharepoint.com/sites/24-089-01/Shared%20Documents/Marketing/Final%20Photos/security-screening.jpg","https://hbcprojects.sharepoint.com/sites/24-089-01/Shared%20Documents/Marketing/Final%20Photos/aerial-completed.jpg"],"contractBudget":18500000,"contractFinalCost":18920000,"totalCostPerGSF":222.59,"totalBudgetVariance":420000,"budgetExplanation":"Final cost exceeded original GMP by $420K (2.3%) due to unforeseen asbestos abatement in ceiling plenum areas not identified in pre-construction environmental survey. Owner-directed courtroom AV upgrades added $310K but were offset by VE savings in mechanical systems. Asbestos abatement change order of $730K was the primary variance driver.","CO_OwnerDirected_Count":22,"CO_OwnerDirected_Value":890000,"CO_MunicipalityDirected_Count":5,"CO_MunicipalityDirected_Value":215000,"CO_EO_Count":12,"CO_EO_Value":730000,"CO_ContractorDirected_Count":0,"savingsReturned":125000,"savingsReturnedPct":29.8,"scheduleStartAnticipated":"2024-04-01","scheduleStartActual":"2024-04-08","scheduleEndAnticipated":"2025-10-31","scheduleEndActual":"2025-11-14","onSchedule":"No â€” 14 calendar days late due to asbestos abatement scope addition","scheduleExplanation":"Original schedule of 19 months was impacted by discovery of asbestos-containing materials during Phase 2 demolition, requiring a 3-week abatement suspension and revised phasing plan. Team recovered 7 days through weekend overtime on MEP rough-in and accelerated finish installations. Final 14-day delay was within the approved time extension for the abatement change order.","substantialCompletionDate":"2025-10-28","finalCompletionDate":"2025-11-14","punchListItems":187,"punchListDaysToComplete":12,"innovativeSafetyPrograms":"Developed a courthouse-specific safety plan addressing occupied renovation hazards including dust containment, noise mitigation during court sessions, and secure perimeter around construction zones. Negative air pressure containment systems maintained throughout abatement operations. Workers underwent background checks and security screening per judicial facility requirements. Achieved zero safety incidents across 245,000 work hours.","mwbeRequirement":"10% MBE / 5% WBE","mwbeAchievement":"11.3% MBE / 7.1% WBE","sbeRequirement":"8% SBE","sbeAchievement":"9.6% SBE","localRequirement":"25% Martin County residents","localAchievement":"28% Martin County residents achieved","leedDesignation":"LEED Silver (Existing Building)","sustainabilityFeatures":"High-efficiency VRF HVAC system replacing original 1978 equipment, reducing energy consumption by 42%. LED lighting throughout with occupancy sensors. Low-flow plumbing fixtures reducing water usage by 35%. Recycled 78% of demolition materials. New roof assembly with R-30 insulation and cool roof membrane.","leedAdditionalCost":425000,"CS_Conflicts":"Coordinated daily with the Martin County Clerk of Court and judges to minimize disruption to court proceedings. Developed a detailed noise schedule aligning demolition and concrete cutting activities with court recess periods. Resolved a conflict between the historic preservation requirements and ADA accessibility upgrades through a creative ramp design that preserved the original terrazzo entry.","CS_CostControl":"Implemented weekly cost tracking with real-time dashboard reporting to the County. Identified the asbestos cost impact within 48 hours of discovery and provided three remediation options with detailed cost/schedule analysis. Proactive buyout strategy achieved 4.2% savings against the original budget on non-impacted scopes.","CS_ValueEngineering":"Identified 15 VE items totaling $680K in potential savings. Owner accepted 11 items worth $485K, including alternative ceiling grid system, revised courtroom millwork profiles, and simplified security camera routing. All VE items maintained design intent while reducing cost.","CS_QualityControl":"Mock-up program for courtroom finishes including millwork, acoustical panels, and AV integration. Pre-installation conferences for all major scopes with documented quality checklists. Third-party commissioning of all HVAC systems. Historic facade restoration overseen by a licensed preservation consultant with weekly quality reviews.","CS_Schedule":"Four-phase construction approach maintained a minimum of 4 operational courtrooms at all times. Pull planning sessions with trade partners every 2 weeks. Critical path managed daily with earned value tracking. Phase transitions completed over weekends to minimize disruption.","CS_Team":"Senior Project Manager with 20+ years of occupied renovation experience led the on-site team. Dedicated liaison officer coordinated daily with courthouse staff. Team included specialists in historic preservation, asbestos abatement oversight, and courtroom AV systems.","CS_Safety":"Zero OSHA recordable incidents over 18 months. Daily JHA (Job Hazard Analysis) for all work areas. Lead and asbestos monitoring per NESHAP requirements. All workers held current OSHA-30 certifications. Monthly safety recognition program with trade partner participation.","CS_LEED":"Achieved LEED Silver certification for Existing Buildings through comprehensive energy modeling, water conservation measures, and construction waste management. Indoor air quality testing performed in all occupied spaces prior to each phase transition. Low-VOC materials specified throughout.","CS_SupplierDiversity":"Exceeded all diversity goals through targeted outreach to Martin County and Treasure Coast minority and small business enterprises. Provided bonding assistance to two local MBE firms for their first public project. Monthly diversity compliance reporting submitted to County procurement office.","CS_Challenges":"Primary challenges included maintaining courthouse security during construction with active prisoner transport, discovery of undocumented underground utilities during sitework, coordinating asbestos abatement with occupied renovation schedule, and matching historic facade materials no longer in production.","CS_InnovativeSolutions":"Developed custom negative-air containment system allowing abatement work concurrent with adjacent occupied spaces. Used 3D laser scanning to document existing conditions and identify clashes before demolition. Created a BIM model of existing structure from as-built drawings and field verification to coordinate new MEP routing in congested ceiling spaces.","CS_ProductsSystems":"Daikin VRV IV heat recovery HVAC system, Lutron Quantum lighting controls, Crestron DigitalMedia courtroom AV, Allegion electronic access control, Milestone video management system, Armstrong Optima acoustical ceilings, Sherwin-Williams Emerald low-VOC paint, Kawneer curtain wall for new entry addition.","CS_ClientService":"Weekly progress meetings with County Administrator and Facilities Director. Monthly presentations to the Board of County Commissioners with photo documentation and financial summaries. Dedicated project hotline for courthouse staff to report concerns. Post-occupancy walkthrough at 30, 60, and 90 days with warranty response within 24 hours.","CS_LessonsLearned":"Pre-construction environmental surveys for renovation projects should include destructive testing of representative ceiling and wall assemblies, not just accessible areas. Modular courtroom facilities should be procured 4 months before needed due to lead times. Early establishment of a dedicated liaison role between construction team and courthouse operations staff is essential for occupied renovation projects. BIM for existing conditions documentation should be standard scope on all renovation projects.","sectionCompletion":{"projectInfo":100,"description":100,"budget":100,"schedule":100,"qc":100,"safety":100,"supplierDiversity":100,"sustainability":100,"caseStudy":100},"overallCompletion":100,"lastUpdatedBy":"Jose Martinez","lastUpdatedAt":"2026-02-03T10:00:00Z","createdBy":"Linda Chen","createdAt":"2024-08-20T09:00:00Z"}]'),riskCostManagement_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","contractType":"GMP","contractAmount":48500000,"buyoutOpportunities":[{"id":101,"category":"Buyout","letter":"A","description":"Structural steel - competitive bid environment may yield savings","estimatedValue":350000,"status":"Open","notes":"3 qualified bidders identified","createdDate":"2025-11-15","updatedDate":"2025-11-15"},{"id":102,"category":"Buyout","letter":"B","description":"Mechanical HVAC - value engineering alternate accepted","estimatedValue":275000,"status":"Realized","notes":"VE alternate approved by owner","createdDate":"2025-11-20","updatedDate":"2026-01-10"},{"id":103,"category":"Buyout","letter":"C","description":"Electrical - LED fixture package substitution","estimatedValue":125000,"status":"Open","notes":"Pending A/E approval","createdDate":"2025-12-01","updatedDate":"2025-12-01"}],"potentialRisks":[{"id":201,"category":"Risk","letter":"A","description":"Unforeseen soil conditions - potential rock excavation","estimatedValue":500000,"status":"Open","notes":"Geotech report indicates potential rock at -8ft","createdDate":"2025-11-10","updatedDate":"2025-11-10"},{"id":202,"category":"Risk","letter":"B","description":"Supply chain delays on curtain wall system","estimatedValue":200000,"status":"Monitoring","notes":"Lead time extended from 16 to 22 weeks","createdDate":"2025-11-25","updatedDate":"2026-01-05"},{"id":203,"category":"Risk","letter":"C","description":"Hurricane season schedule impact","estimatedValue":150000,"status":"Open","notes":"Dry-in target before June 1","createdDate":"2025-12-10","updatedDate":"2025-12-10"},{"id":204,"category":"Risk","letter":"D","description":"Owner-directed scope additions not yet formalized","estimatedValue":300000,"status":"Open","notes":"Lobby redesign discussions ongoing","createdDate":"2026-01-08","updatedDate":"2026-01-08"}],"potentialSavings":[{"id":301,"category":"Savings","letter":"A","description":"Self-perform concrete foundations","estimatedValue":180000,"status":"Open","notes":"Crew available from 25-039 project completion","createdDate":"2025-11-15","updatedDate":"2025-11-15"},{"id":302,"category":"Savings","letter":"B","description":"Bulk material purchase with 25-115 project","estimatedValue":95000,"status":"Realized","notes":"Combined rebar order placed","createdDate":"2025-12-05","updatedDate":"2026-01-12"},{"id":303,"category":"Savings","letter":"C","description":"Early payment discount from key suppliers","estimatedValue":45000,"status":"Open","notes":"2% net 10 terms available","createdDate":"2026-01-15","updatedDate":"2026-01-15"}],"createdBy":"jthompson@hedrickbrothers.com","createdAt":"2025-11-10T09:00:00.000Z","lastUpdatedBy":"jthompson@hedrickbrothers.com","lastUpdatedAt":"2026-01-15T14:30:00.000Z"},{"id":2,"projectCode":"25-115-01","contractType":"Lump Sum","contractAmount":12200000,"buyoutOpportunities":[{"id":401,"category":"Buyout","letter":"A","description":"Landscape package - owner may delete pool feature","estimatedValue":85000,"status":"Open","notes":"Owner reviewing revised plans","createdDate":"2026-01-05","updatedDate":"2026-01-05"},{"id":402,"category":"Buyout","letter":"B","description":"Interior millwork - alternate wood species","estimatedValue":42000,"status":"Mitigated","notes":"Designer approved white oak substitute","createdDate":"2026-01-10","updatedDate":"2026-01-20"}],"potentialRisks":[{"id":501,"category":"Risk","letter":"A","description":"Custom window lead time exceeds schedule allowance","estimatedValue":75000,"status":"Open","notes":"28-week lead time, only 24 weeks in schedule","createdDate":"2026-01-05","updatedDate":"2026-01-05"},{"id":502,"category":"Risk","letter":"B","description":"Adjacent property construction interference","estimatedValue":35000,"status":"Monitoring","notes":"Neighbor starting foundation work Q2","createdDate":"2026-01-12","updatedDate":"2026-01-12"}],"potentialSavings":[{"id":601,"category":"Savings","letter":"A","description":"Roof tile direct-from-manufacturer purchase","estimatedValue":28000,"status":"Open","notes":"Eliminating distributor markup","createdDate":"2026-01-08","updatedDate":"2026-01-08"},{"id":602,"category":"Savings","letter":"B","description":"Self-perform site work and grading","estimatedValue":55000,"status":"Open","notes":"Equipment available from fleet","createdDate":"2026-01-15","updatedDate":"2026-01-15"}],"createdBy":"mrodriguez@hedrickbrothers.com","createdAt":"2026-01-05T10:00:00.000Z","lastUpdatedBy":"mrodriguez@hedrickbrothers.com","lastUpdatedAt":"2026-01-20T11:00:00.000Z"}]'),qualityConcerns_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","letter":"A","description":"Concrete pour joints not aligned with architectural reveals per detail 5/A301","raisedBy":"jthompson@hedrickbrothers.com","raisedDate":"2025-12-05","status":"Open","resolution":"","resolvedDate":null,"notes":"Structural engineer reviewing alternate joint locations"},{"id":2,"projectCode":"25-042-01","letter":"B","description":"Waterproofing membrane laps below manufacturer minimum at foundation step","raisedBy":"kfoster@hedrickbrothers.com","raisedDate":"2025-12-12","status":"Resolved","resolution":"Additional membrane layer installed per manufacturer recommendation","resolvedDate":"2025-12-20","notes":"Manufacturer rep inspected and approved"},{"id":3,"projectCode":"25-042-01","letter":"C","description":"Curtain wall mock-up water infiltration at corner mullion condition","raisedBy":"jthompson@hedrickbrothers.com","raisedDate":"2026-01-08","status":"Open","resolution":"","resolvedDate":null,"notes":"Second mock-up test scheduled for Jan 20"},{"id":4,"projectCode":"25-042-01","letter":"D","description":"Floor flatness readings in parking garage exceed FF25 tolerance","raisedBy":"dmartin@hedrickbrothers.com","raisedDate":"2026-01-15","status":"Monitoring","resolution":"","resolvedDate":null,"notes":"Concrete sub reviewing finishing procedures"},{"id":5,"projectCode":"25-115-01","letter":"A","description":"Exterior stucco color variation between north and south elevations","raisedBy":"mrodriguez@hedrickbrothers.com","raisedDate":"2026-01-10","status":"Open","resolution":"","resolvedDate":null,"notes":"Different batch numbers used; owner reviewing acceptability"},{"id":6,"projectCode":"25-115-01","letter":"B","description":"Cabinet shop drawings show different hardware from specification","raisedBy":"mrodriguez@hedrickbrothers.com","raisedDate":"2026-01-14","status":"Resolved","resolution":"Shop drawings revised to match spec; resubmitted and approved","resolvedDate":"2026-01-22","notes":""},{"id":7,"projectCode":"25-115-01","letter":"C","description":"Roof truss deflection exceeds L/360 at master bedroom span","raisedBy":"kfoster@hedrickbrothers.com","raisedDate":"2026-01-18","status":"Open","resolution":"","resolvedDate":null,"notes":"Structural engineer of record reviewing calculations"},{"id":8,"projectCode":"25-042-01","letter":"E","description":"Fire-rated partition head track detail does not match UL assembly","raisedBy":"dmartin@hedrickbrothers.com","raisedDate":"2026-01-20","status":"Closed","resolution":"Detail corrected by drywall sub; special inspection confirmed compliance","resolvedDate":"2026-01-28","notes":"Documented in QC log"}]'),safetyConcerns_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","safetyOfficerName":"David Chen","safetyOfficerEmail":"dchen@hedrickbrothers.com","letter":"A","description":"Inadequate fall protection at elevator shaft openings during core work","severity":"Critical","raisedBy":"dchen@hedrickbrothers.com","raisedDate":"2025-12-01","status":"Resolved","resolution":"Installed permanent guardrails and safety nets; daily inspection protocol established","resolvedDate":"2025-12-05","notes":"All elevator openings now protected per OSHA 1926.502"},{"id":2,"projectCode":"25-042-01","safetyOfficerName":"David Chen","safetyOfficerEmail":"dchen@hedrickbrothers.com","letter":"B","description":"Silica dust exposure during concrete cutting exceeds PEL","severity":"High","raisedBy":"dchen@hedrickbrothers.com","raisedDate":"2025-12-15","status":"Monitoring","resolution":"","resolvedDate":null,"notes":"Wet-cutting methods implemented; air monitoring ongoing"},{"id":3,"projectCode":"25-042-01","safetyOfficerName":"David Chen","safetyOfficerEmail":"dchen@hedrickbrothers.com","letter":"C","description":"Crane swing radius encroaches on public sidewalk during steel erection","severity":"High","raisedBy":"jthompson@hedrickbrothers.com","raisedDate":"2026-01-05","status":"Open","resolution":"","resolvedDate":null,"notes":"MOT plan revision needed; coordinate with city for sidewalk closure"},{"id":4,"projectCode":"25-042-01","safetyOfficerName":"David Chen","safetyOfficerEmail":"dchen@hedrickbrothers.com","letter":"D","description":"Housekeeping deficiencies on levels 3-5 creating trip hazards","severity":"Medium","raisedBy":"dchen@hedrickbrothers.com","raisedDate":"2026-01-12","status":"Open","resolution":"","resolvedDate":null,"notes":"Daily cleanup enforcement memo issued to all subcontractors"},{"id":5,"projectCode":"25-115-01","safetyOfficerName":"Maria Santos","safetyOfficerEmail":"msantos@hedrickbrothers.com","letter":"A","description":"Trench excavation deeper than 4ft without shoring or sloping","severity":"Critical","raisedBy":"msantos@hedrickbrothers.com","raisedDate":"2026-01-08","status":"Resolved","resolution":"Work stopped; trench box installed before re-entry. Subcontractor received written warning.","resolvedDate":"2026-01-08","notes":"Same-day correction"},{"id":6,"projectCode":"25-115-01","safetyOfficerName":"Maria Santos","safetyOfficerEmail":"msantos@hedrickbrothers.com","letter":"B","description":"Missing GFCIs on temporary power distribution during wet conditions","severity":"High","raisedBy":"msantos@hedrickbrothers.com","raisedDate":"2026-01-15","status":"Open","resolution":"","resolvedDate":null,"notes":"Electrician ordered additional GFCI-protected spider boxes"},{"id":7,"projectCode":"25-115-01","safetyOfficerName":"Maria Santos","safetyOfficerEmail":"msantos@hedrickbrothers.com","letter":"C","description":"Ladder access to roof not secured; improper setup angle","severity":"Low","raisedBy":"mrodriguez@hedrickbrothers.com","raisedDate":"2026-01-20","status":"Open","resolution":"","resolvedDate":null,"notes":"Ladder safety training refresher scheduled for next toolbox talk"}]'),projectScheduleCriticalPath_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","startDate":"2025-10-15","substantialCompletionDate":"2027-04-30","ntpDate":"2025-10-01","nocDate":null,"contractCalendarDays":562,"contractBasisType":"Calendar Days","teamGoalDaysAhead":30,"teamGoalDescription":"Achieve substantial completion 30 days ahead of contract date to allow for owner move-in preparation","hasLiquidatedDamages":true,"liquidatedDamagesAmount":5000,"liquidatedDamagesTerms":"$5,000 per calendar day beyond substantial completion date","criticalPathConcerns":[{"id":101,"letter":"A","description":"Curtain wall fabrication and delivery","impactDescription":"22-week lead time drives exterior enclosure milestone; delays cascade to interior finishes","status":"Active","mitigationPlan":"Weekly calls with manufacturer; early release of shop drawings for fabrication","createdDate":"2025-11-15","updatedDate":"2026-01-10"},{"id":102,"letter":"B","description":"Elevator installation and inspection","impactDescription":"14-week installation window required; state inspection backlog adding 3-4 weeks","status":"Active","mitigationPlan":"Pre-filed inspection request; consider third-party inspector option","createdDate":"2025-12-01","updatedDate":"2025-12-01"},{"id":103,"letter":"C","description":"Fire alarm system testing and acceptance","impactDescription":"Full building test required for TCO; 2-week testing window needed","status":"Monitoring","mitigationPlan":"Phased testing approach to verify systems floor-by-floor","createdDate":"2026-01-05","updatedDate":"2026-01-05"},{"id":104,"letter":"D","description":"Permit processing for structural steel revisions","impactDescription":"Revised connection details require re-review; 3-week permit turnaround","status":"Active","mitigationPlan":"Expedited review request submitted; pre-construction meeting with building official","createdDate":"2026-01-12","updatedDate":"2026-01-12"},{"id":105,"letter":"E","description":"Underground utility relocation coordination with FPL","impactDescription":"FPL transformer relocation drives site work sequence","status":"Resolved","mitigationPlan":"FPL completed relocation ahead of schedule on Dec 20","createdDate":"2025-11-20","updatedDate":"2025-12-22"}],"createdBy":"jthompson@hedrickbrothers.com","createdAt":"2025-11-01T08:00:00.000Z","lastUpdatedBy":"jthompson@hedrickbrothers.com","lastUpdatedAt":"2026-01-12T16:00:00.000Z"},{"id":2,"projectCode":"25-115-01","startDate":"2026-01-06","substantialCompletionDate":"2027-01-15","ntpDate":"2025-12-20","nocDate":null,"contractCalendarDays":375,"contractBasisType":"Calendar Days","teamGoalDaysAhead":14,"teamGoalDescription":"Two-week early completion buffer for owner landscaping and furnishing","hasLiquidatedDamages":false,"liquidatedDamagesAmount":null,"liquidatedDamagesTerms":"","criticalPathConcerns":[{"id":201,"letter":"A","description":"Custom window and door fabrication","impactDescription":"28-week lead time for impact-rated custom windows; must order by Feb 1","status":"Active","mitigationPlan":"Owner deposit received; shop drawings in final review","createdDate":"2026-01-06","updatedDate":"2026-01-20"},{"id":202,"letter":"B","description":"Pool construction sequencing with main structure","impactDescription":"Pool shell must be poured before backfill of rear foundation; 3-week window","status":"Active","mitigationPlan":"Pool sub mobilizing week of Feb 10; concrete schedule coordinated","createdDate":"2026-01-10","updatedDate":"2026-01-10"},{"id":203,"letter":"C","description":"Custom stone import from Italy for master bath and kitchen","impactDescription":"16-week fabrication and shipping; selection must be finalized by Feb 15","status":"Monitoring","mitigationPlan":"Owner visiting stone yard in Miami next week for final selection","createdDate":"2026-01-15","updatedDate":"2026-01-15"}],"createdBy":"mrodriguez@hedrickbrothers.com","createdAt":"2026-01-06T09:00:00.000Z","lastUpdatedBy":"mrodriguez@hedrickbrothers.com","lastUpdatedAt":"2026-01-20T10:00:00.000Z"}]'),superintendentPlan_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","superintendentName":"Dan Martin","sections":[{"id":1,"sectionKey":"siteLogistics","sectionTitle":"Site Logistics","content":"Primary access via NW 2nd Ave gate. Material staging in east lot (Zones A-C marked on site plan). Tower crane positioned per structural engineer layout at grid D-5. Concrete pump setup area designated at south entry. Laydown area capacity: 200 tons structural steel, 50 CY formwork.","attachmentUrls":["https://hedrickbrothers.sharepoint.com/sites/25-042-01/Shared%20Documents/Plans/site-logistics-v3.pdf"],"isComplete":true},{"id":2,"sectionKey":"safetyPlan","sectionTitle":"Safety Plan","content":"Weekly toolbox talks every Monday 6:30 AM. Safety orientation required for all new workers. Daily JHA reviews for high-risk activities. Designated safety officer: David Chen. Emergency assembly point at NE corner parking lot. First aid station in trailer #2.","attachmentUrls":[],"isComplete":true},{"id":3,"sectionKey":"utilityServices","sectionTitle":"Utility Services","content":"Temporary power: 400A service from FPL transformer at east boundary. Temp water: 2\\" tap from city main on NW 2nd Ave (meter installed). Sanitary: 4 portable units per floor during active work, cleaned 2x weekly.","attachmentUrls":[],"isComplete":true},{"id":4,"sectionKey":"trafficPedestrian","sectionTitle":"Traffic & Pedestrian","content":"MOT plan approved by City of West Palm Beach (Permit #MOT-2025-4421). Sidewalk closure on south side of Clematis St, 7AM-5PM weekdays. Flag person required during crane operations over street. Pedestrian detour signs at both intersection corners.","attachmentUrls":["https://hedrickbrothers.sharepoint.com/sites/25-042-01/Shared%20Documents/Permits/mot-plan-approved.pdf"],"isComplete":true},{"id":5,"sectionKey":"siteSecurity","sectionTitle":"Site Security","content":"8-ft chain link fence with privacy screening on all sides. Electronic gate access (keypad + card reader) at NW 2nd Ave entry. 4 PTZ cameras covering perimeter and material storage. After-hours security patrol Fri-Sun 6PM-6AM.","attachmentUrls":[],"isComplete":true},{"id":6,"sectionKey":"environmentalControls","sectionTitle":"Environmental Controls","content":"SWPPP posted at site entry. Silt fence perimeter installed and inspected weekly. Concrete washout area: designated pit in NE corner with pH monitoring. Dust control: water truck on-site during earthwork. Noise restrictions: 7AM-6PM per city ordinance.","attachmentUrls":[],"isComplete":true},{"id":7,"sectionKey":"existingConditions","sectionTitle":"Existing Conditions","content":"Pre-construction survey completed Nov 2025. Existing 8\\" sanitary line crossing site at grid B (to be relocated). Known groundwater at -6ft. Adjacent building (3-story office) within 15ft of south foundation - vibration monitoring installed.","attachmentUrls":[],"isComplete":true},{"id":8,"sectionKey":"phasingPlan","sectionTitle":"Phasing Plan","content":"Phase 1 (Oct-Dec 2025): Demolition, site prep, foundations. Phase 2 (Jan-Apr 2026): Structural frame, core walls. Phase 3 (May-Aug 2026): Exterior enclosure, MEP rough-in. Phase 4 (Sep-Dec 2026): Interior finishes, commissioning. Phase 5 (Jan-Apr 2027): Punch list, closeout.","attachmentUrls":[],"isComplete":true},{"id":9,"sectionKey":"crewCoordination","sectionTitle":"Crew Coordination","content":"Self-perform: Concrete (20-person crew), general labor (8-person crew). Peak manpower: 120 workers (Month 8). Subcontractor coordination meetings: Wednesdays 2PM. 3-week look-ahead distributed every Monday.","attachmentUrls":[],"isComplete":true},{"id":10,"sectionKey":"additionalPlans","sectionTitle":"Additional Plans","content":"Hurricane preparedness plan: secure all loose materials when storm within 72 hours; crane to be weathervaned. Hot weather concreting plan for summer pours: ice in mix, early morning placement, curing compound.","attachmentUrls":[],"isComplete":true}],"createdBy":"dmartin@hedrickbrothers.com","createdAt":"2025-11-01T07:00:00.000Z","lastUpdatedBy":"dmartin@hedrickbrothers.com","lastUpdatedAt":"2026-01-18T15:00:00.000Z"},{"id":2,"projectCode":"25-115-01","superintendentName":"Carlos Rivera","sections":[{"id":11,"sectionKey":"siteLogistics","sectionTitle":"Site Logistics","content":"Single point of access from Ocean Blvd. Material deliveries restricted to 7AM-4PM per HOA agreement. Staging area limited to front yard zone; rear access via temporary construction road (gravel).","attachmentUrls":[],"isComplete":true},{"id":12,"sectionKey":"safetyPlan","sectionTitle":"Safety Plan","content":"Weekly safety meetings Monday 7AM. Safety officer: Maria Santos. All workers must complete HBC safety orientation plus site-specific training.","attachmentUrls":[],"isComplete":true},{"id":13,"sectionKey":"utilityServices","sectionTitle":"Utility Services","content":"Temporary 200A service from FPL pole. Temporary water from neighbor\'s tap (owner arranged). Generator backup for concrete pump operations.","attachmentUrls":[],"isComplete":false},{"id":14,"sectionKey":"trafficPedestrian","sectionTitle":"Traffic & Pedestrian","content":"","attachmentUrls":[],"isComplete":false},{"id":15,"sectionKey":"siteSecurity","sectionTitle":"Site Security","content":"6-ft temporary fencing around property. Camera system with remote monitoring. Gate locked after hours.","attachmentUrls":[],"isComplete":true},{"id":16,"sectionKey":"environmentalControls","sectionTitle":"Environmental Controls","content":"","attachmentUrls":[],"isComplete":false},{"id":17,"sectionKey":"existingConditions","sectionTitle":"Existing Conditions","content":"Existing single-family home demolished Dec 2025. Survey pins set by Johnson Land Surveying. No known underground tanks or hazardous materials.","attachmentUrls":[],"isComplete":true},{"id":18,"sectionKey":"phasingPlan","sectionTitle":"Phasing Plan","content":"","attachmentUrls":[],"isComplete":false},{"id":19,"sectionKey":"crewCoordination","sectionTitle":"Crew Coordination","content":"","attachmentUrls":[],"isComplete":false},{"id":20,"sectionKey":"additionalPlans","sectionTitle":"Additional Plans","content":"","attachmentUrls":[],"isComplete":false}],"createdBy":"crivera@hedrickbrothers.com","createdAt":"2026-01-06T08:00:00.000Z","lastUpdatedBy":"crivera@hedrickbrothers.com","lastUpdatedAt":"2026-01-20T12:00:00.000Z"}]'),lessonsLearned_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","title":"Early curtain wall mock-up saved 6 weeks","category":"Schedule","impact":"Positive","description":"By building the curtain wall mock-up 4 weeks earlier than typical, we identified a corner mullion water infiltration issue before fabrication. This allowed redesign without impacting the overall schedule.","recommendation":"Always schedule mock-ups at least 6 weeks before fabrication begins, not just before installation.","raisedBy":"jthompson@hedrickbrothers.com","raisedDate":"2026-01-15","phase":"Construction","isIncludedInFinalRecord":true,"tags":["curtain-wall","mock-up","schedule"]},{"id":2,"projectCode":"25-042-01","title":"Bulk rebar purchase with sister project","category":"Cost","impact":"Positive","description":"Combined rebar order with project 25-115-01 yielded $95K in savings through volume pricing. Coordination required 2 weeks of planning but was well worth the effort.","recommendation":"When multiple projects have overlapping material needs within a 60-day window, always explore combined purchasing.","raisedBy":"jthompson@hedrickbrothers.com","raisedDate":"2026-01-12","phase":"Construction","isIncludedInFinalRecord":true,"tags":["procurement","cost-savings","coordination"]},{"id":3,"projectCode":"25-042-01","title":"Permit re-review caused 3-week delay","category":"Schedule","impact":"Negative","description":"Structural steel connection revisions required permit re-review. The building department took 3 weeks instead of the expected 1 week due to staff shortages.","recommendation":"Build 3-week buffer into schedule for any permit re-reviews. Consider pre-construction meetings with building officials for complex revisions.","raisedBy":"dmartin@hedrickbrothers.com","raisedDate":"2026-01-20","phase":"Construction","isIncludedInFinalRecord":false,"tags":["permits","schedule-delay"]},{"id":4,"projectCode":"25-042-01","title":"Subcontractor safety non-compliance pattern","category":"Safety","impact":"Negative","description":"Concrete subcontractor had 3 safety violations in first month (missing guardrails, no hard hats, improper scaffold). Root cause: inadequate safety training for new crew members.","recommendation":"Require all subcontractors to provide proof of site-specific safety training for every worker before site access. Implement a probationary period with daily safety audits for new subs.","raisedBy":"dchen@hedrickbrothers.com","raisedDate":"2025-12-10","phase":"Construction","isIncludedInFinalRecord":true,"tags":["safety","subcontractor-management"]},{"id":5,"projectCode":"25-115-01","title":"Owner decision delays on finish selections","category":"Client","impact":"Negative","description":"Owner took 6 weeks to select stone finishes instead of the 2-week allowance in the schedule. This pushed the stone fabrication order back and may impact the installation window.","recommendation":"Include specific decision deadlines in the owner contract with schedule impact language. Present selections earlier with clear \'decide by\' dates.","raisedBy":"mrodriguez@hedrickbrothers.com","raisedDate":"2026-01-18","phase":"Construction","isIncludedInFinalRecord":false,"tags":["owner-decisions","schedule-impact"]},{"id":6,"projectCode":"25-115-01","title":"Pre-construction neighbor meeting prevented issues","category":"Communication","impact":"Positive","description":"Held a pre-construction meeting with adjacent property owners before mobilization. This proactive communication prevented complaints about noise, dust, and construction traffic.","recommendation":"Always schedule neighbor meetings 2 weeks before mobilization for residential projects. Provide a contact card and construction schedule.","raisedBy":"mrodriguez@hedrickbrothers.com","raisedDate":"2026-01-10","phase":"Preconstruction","isIncludedInFinalRecord":true,"tags":["communication","community-relations"]},{"id":7,"projectCode":"25-042-01","title":"Self-perform concrete quality exceeded expectations","category":"Quality","impact":"Positive","description":"Our self-perform concrete crew achieved consistent FF50/FL30 readings across all elevated slabs, exceeding the FF25/FL20 specification. This eliminated the need for leveling compound on most floors.","recommendation":"Continue investing in concrete crew training and equipment. The quality differential pays for itself in reduced floor prep costs.","raisedBy":"dmartin@hedrickbrothers.com","raisedDate":"2026-01-22","phase":"Construction","isIncludedInFinalRecord":true,"tags":["concrete","quality","self-perform"]},{"id":8,"projectCode":"24-089-01","title":"Inadequate contingency for underground conditions","category":"Cost","impact":"Negative","description":"Encountered unexpected underground storage tank during excavation. Remediation cost $180K and delayed start by 4 weeks. Original contingency of $50K was insufficient.","recommendation":"For any project with prior commercial use, budget Phase I/II environmental assessment and minimum $150K underground contingency.","raisedBy":"kfoster@hedrickbrothers.com","raisedDate":"2025-08-15","phase":"Construction","isIncludedInFinalRecord":true,"tags":["environmental","contingency","underground"]},{"id":9,"projectCode":"24-089-01","title":"Drone photography for progress documentation","category":"Communication","impact":"Positive","description":"Monthly drone photography provided excellent progress documentation for owner meetings and marketing materials. Cost was minimal ($500/month) with significant communication value.","recommendation":"Include monthly drone photography in all project budgets. Use for owner reports, marketing, and as-built documentation.","raisedBy":"kfoster@hedrickbrothers.com","raisedDate":"2025-09-20","phase":"Construction","isIncludedInFinalRecord":true,"tags":["technology","documentation","communication"]},{"id":10,"projectCode":"24-089-01","title":"Early commissioning agent engagement","category":"Quality","impact":"Positive","description":"Bringing the commissioning agent on board during design phase (instead of construction) identified 12 design conflicts that would have been costly field changes.","recommendation":"Engage commissioning agent during SD/DD phase for all projects over $10M.","raisedBy":"kfoster@hedrickbrothers.com","raisedDate":"2025-10-05","phase":"Preconstruction","isIncludedInFinalRecord":true,"tags":["commissioning","design","quality"]},{"id":11,"projectCode":"25-042-01","title":"Design team coordination gap on MEP routing","category":"Design","impact":"Negative","description":"Mechanical and electrical engineers did not coordinate ceiling space allocation, resulting in 15 RFIs and 3 change orders for routing conflicts in corridor areas.","recommendation":"Require BIM clash detection reports before issuing construction documents. Hold a dedicated MEP coordination workshop during DD phase.","raisedBy":"jthompson@hedrickbrothers.com","raisedDate":"2026-01-25","phase":"Construction","isIncludedInFinalRecord":false,"tags":["design-coordination","MEP","BIM"]},{"id":12,"projectCode":"25-115-01","title":"Pool subcontractor scheduling flexibility","category":"Subcontractor","impact":"Positive","description":"Pool subcontractor agreed to mobilize 2 weeks early to align with foundation schedule. Their flexibility allowed us to maintain the critical path without additional cost.","recommendation":"During buyout, discuss schedule flexibility requirements with specialty subs. Include mobilization windows in subcontract language.","raisedBy":"crivera@hedrickbrothers.com","raisedDate":"2026-01-22","phase":"Construction","isIncludedInFinalRecord":false,"tags":["subcontractor","scheduling","flexibility"]}]'),projectManagementPlans_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","projectName":"Clematis Mixed-Use Tower","jobNumber":"25-042","status":"Approved","currentCycleNumber":1,"division":"Commercial","superintendentPlan":"","preconMeetingNotes":"Pre-construction meeting held Oct 22, 2025. Owner, A/E team, and HBC leadership attended. Key topics: phasing, site access, community impact. Meeting minutes distributed Oct 23.","siteManagementNotes":"Urban site with limited laydown. Coordinate with city for lane closures during major deliveries. Noise restrictions per city ordinance 7AM-6PM.","projectAdminBuyoutDate":"2026-03-15","attachmentUrls":["https://hedrickbrothers.sharepoint.com/sites/25-042-01/Shared%20Documents/PMP/org-chart.pdf","https://hedrickbrothers.sharepoint.com/sites/25-042-01/Shared%20Documents/PMP/site-plan.pdf"],"riskCostData":{"contractType":"GMP","contractAmount":48500000},"qualityConcerns":[],"safetyConcerns":[],"scheduleData":{"startDate":"2025-10-15","completionDate":"2027-04-30"},"superintendentPlanData":{"completionPercentage":100},"lessonsLearned":[],"teamAssignments":[],"startupSignatures":[{"id":1,"projectCode":"25-042-01","signatureType":"Startup","role":"Project Manager","personName":"John Thompson","personEmail":"jthompson@hedrickbrothers.com","isRequired":true,"isLead":true,"status":"Signed","signedDate":"2025-11-01T09:00:00.000Z","affidavitText":"I have reviewed and commit to this Project Management Plan.","comment":""},{"id":2,"projectCode":"25-042-01","signatureType":"Startup","role":"Superintendent","personName":"Dan Martin","personEmail":"dmartin@hedrickbrothers.com","isRequired":true,"isLead":false,"status":"Signed","signedDate":"2025-11-01T10:30:00.000Z","affidavitText":"I have reviewed and commit to this Project Management Plan.","comment":""},{"id":3,"projectCode":"25-042-01","signatureType":"Startup","role":"Project Executive","personName":"Kim Foster","personEmail":"kfoster@hedrickbrothers.com","isRequired":false,"isLead":false,"status":"Signed","signedDate":"2025-11-02T08:00:00.000Z","affidavitText":"I have reviewed and commit to this Project Management Plan.","comment":"Good plan. Proceed."}],"completionSignatures":[],"approvalCycles":[{"cycleNumber":1,"submittedBy":"jthompson@hedrickbrothers.com","submittedDate":"2025-11-03T09:00:00.000Z","status":"Approved","steps":[{"id":1,"projectCode":"25-042-01","stepOrder":1,"approverRole":"Project Executive","approverName":"Kim Foster","approverEmail":"kfoster@hedrickbrothers.com","status":"Approved","comment":"Comprehensive plan. Approved.","actionDate":"2025-11-04T14:00:00.000Z","approvalCycleNumber":1},{"id":2,"projectCode":"25-042-01","stepOrder":2,"approverRole":"Division Head","approverName":"Arthur Miller","approverEmail":"amiller@hedrickbrothers.com","status":"Approved","comment":"Good to go.","actionDate":"2025-11-05T10:00:00.000Z","approvalCycleNumber":1}],"changesFromPrevious":[]}],"boilerplate":[],"createdBy":"jthompson@hedrickbrothers.com","createdAt":"2025-10-25T08:00:00.000Z","lastUpdatedBy":"jthompson@hedrickbrothers.com","lastUpdatedAt":"2025-11-05T10:00:00.000Z"},{"id":2,"projectCode":"25-115-01","projectName":"Ocean Blvd Residence","jobNumber":"25-115","status":"Draft","currentCycleNumber":0,"division":"Luxury Residential","superintendentPlan":"","preconMeetingNotes":"","siteManagementNotes":"","projectAdminBuyoutDate":null,"attachmentUrls":[],"riskCostData":{"contractType":"Lump Sum","contractAmount":12200000},"qualityConcerns":[],"safetyConcerns":[],"scheduleData":{"startDate":"2026-01-06","completionDate":"2027-01-15"},"superintendentPlanData":{"completionPercentage":40},"lessonsLearned":[],"teamAssignments":[],"startupSignatures":[{"id":4,"projectCode":"25-115-01","signatureType":"Startup","role":"Project Manager","personName":"Maria Rodriguez","personEmail":"mrodriguez@hedrickbrothers.com","isRequired":true,"isLead":true,"status":"Pending","signedDate":null,"affidavitText":"I have reviewed and commit to this Project Management Plan.","comment":""},{"id":5,"projectCode":"25-115-01","signatureType":"Startup","role":"Superintendent","personName":"Carlos Rivera","personEmail":"crivera@hedrickbrothers.com","isRequired":true,"isLead":false,"status":"Pending","signedDate":null,"affidavitText":"I have reviewed and commit to this Project Management Plan.","comment":""}],"completionSignatures":[],"approvalCycles":[],"boilerplate":[],"createdBy":"mrodriguez@hedrickbrothers.com","createdAt":"2026-01-10T09:00:00.000Z","lastUpdatedBy":"mrodriguez@hedrickbrothers.com","lastUpdatedAt":"2026-01-20T11:00:00.000Z"},{"id":3,"projectCode":"24-089-01","projectName":"Palm Beach Gardens Office Complex","jobNumber":"24-089","status":"Closed","currentCycleNumber":2,"division":"Commercial","superintendentPlan":"","preconMeetingNotes":"Pre-construction meeting held June 2024. Full team present.","siteManagementNotes":"Suburban site with ample staging. Standard access controls.","projectAdminBuyoutDate":"2024-09-01","attachmentUrls":[],"riskCostData":{"contractType":"GMP","contractAmount":22000000},"qualityConcerns":[],"safetyConcerns":[],"scheduleData":{"startDate":"2024-06-15","completionDate":"2025-10-30"},"superintendentPlanData":{"completionPercentage":100},"lessonsLearned":[],"teamAssignments":[],"startupSignatures":[],"completionSignatures":[],"approvalCycles":[{"cycleNumber":1,"submittedBy":"kfoster@hedrickbrothers.com","submittedDate":"2024-07-01T09:00:00.000Z","status":"Returned","steps":[{"id":3,"projectCode":"24-089-01","stepOrder":1,"approverRole":"Project Executive","approverName":"Kim Foster","approverEmail":"kfoster@hedrickbrothers.com","status":"Returned","comment":"Need more detail on underground risk mitigation.","actionDate":"2024-07-03T14:00:00.000Z","approvalCycleNumber":1}],"changesFromPrevious":[]},{"cycleNumber":2,"submittedBy":"kfoster@hedrickbrothers.com","submittedDate":"2024-07-10T09:00:00.000Z","status":"Approved","steps":[{"id":4,"projectCode":"24-089-01","stepOrder":1,"approverRole":"Project Executive","approverName":"Kim Foster","approverEmail":"kfoster@hedrickbrothers.com","status":"Approved","comment":"Revised plan addresses concerns.","actionDate":"2024-07-12T10:00:00.000Z","approvalCycleNumber":2},{"id":5,"projectCode":"24-089-01","stepOrder":2,"approverRole":"Division Head","approverName":"Arthur Miller","approverEmail":"amiller@hedrickbrothers.com","status":"Approved","comment":"","actionDate":"2024-07-13T09:00:00.000Z","approvalCycleNumber":2}],"changesFromPrevious":["Added underground risk contingency plan","Updated environmental controls section"]}],"boilerplate":[],"createdBy":"kfoster@hedrickbrothers.com","createdAt":"2024-06-20T08:00:00.000Z","lastUpdatedBy":"kfoster@hedrickbrothers.com","lastUpdatedAt":"2025-10-30T16:00:00.000Z"}]'),divisionApprovers_namespaceObject=JSON.parse('[{"id":1,"division":"Commercial","approverName":"Arthur Miller","approverEmail":"amiller@hedrickbrothers.com","approverTitle":"Division Head - Commercial"},{"id":2,"division":"Luxury Residential","approverName":"Joe Morrin","approverEmail":"jmorrin@hedrickbrothers.com","approverTitle":"Division Head - Luxury Residential"}]'),monthlyProjectReviews_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","reviewMonth":"2025-12","status":"Complete","dueDate":"2026-01-10","meetingDate":"2026-01-08","pmSubmittedDate":"2026-01-05T09:00:00.000Z","pxReviewDate":"2026-01-07T14:00:00.000Z","pxValidationDate":"2026-01-09T10:00:00.000Z","leadershipSubmitDate":"2026-01-09T11:00:00.000Z","completedDate":"2026-01-10T09:00:00.000Z","checklistItems":[{"id":1,"sectionKey":"schedule","sectionTitle":"Schedule","itemKey":"schedule-status","itemDescription":"Current schedule status and critical path review","pmComment":"On track. Curtain wall delivery confirmed for Feb 15.","pxComment":"Confirmed with manufacturer.","pxInitial":"KF"},{"id":2,"sectionKey":"schedule","sectionTitle":"Schedule","itemKey":"schedule-updates","itemDescription":"Schedule updates and look-ahead review","pmComment":"3-week look-ahead distributed. Steel erection 85% complete.","pxComment":"Good progress.","pxInitial":"KF"},{"id":3,"sectionKey":"budget","sectionTitle":"Budget & Cost","itemKey":"budget-status","itemDescription":"Current budget status and cost report review","pmComment":"Budget tracking within 1.5% of GMP. No concerns.","pxComment":"Review cost report in detail at next meeting.","pxInitial":"KF"},{"id":4,"sectionKey":"budget","sectionTitle":"Budget & Cost","itemKey":"cost-forecast","itemDescription":"Cost-to-complete forecast accuracy","pmComment":"CTC updated through December billing cycle.","pxComment":"","pxInitial":"KF"},{"id":5,"sectionKey":"safety","sectionTitle":"Safety","itemKey":"safety-incidents","itemDescription":"Safety incident review and near-miss reports","pmComment":"Zero recordable incidents in December. 2 near-miss reports filed.","pxComment":"Excellent safety record.","pxInitial":"KF"}],"followUps":[{"id":1,"question":"Provide updated curtain wall delivery schedule from manufacturer","requestedBy":"kfoster@hedrickbrothers.com","requestedDate":"2026-01-08","pmResponse":"Updated schedule received Jan 12. On track for Feb 15 first delivery.","responseDate":"2026-01-12","pxForwardedDate":null,"status":"Closed"}],"reportDocumentUrls":["https://hedrickbrothers.sharepoint.com/sites/25-042-01/Shared%20Documents/Monthly/Dec-2025-Review.pdf"],"createdBy":"jthompson@hedrickbrothers.com","createdAt":"2026-01-02T09:00:00.000Z","lastUpdatedBy":"kfoster@hedrickbrothers.com","lastUpdatedAt":"2026-01-10T09:00:00.000Z"},{"id":2,"projectCode":"25-042-01","reviewMonth":"2026-01","status":"InProgress","dueDate":"2026-02-10","meetingDate":null,"pmSubmittedDate":null,"pxReviewDate":null,"pxValidationDate":null,"leadershipSubmitDate":null,"completedDate":null,"checklistItems":[{"id":6,"sectionKey":"schedule","sectionTitle":"Schedule","itemKey":"schedule-status","itemDescription":"Current schedule status and critical path review","pmComment":"Steel complete. Starting exterior enclosure.","pxComment":"","pxInitial":""},{"id":7,"sectionKey":"budget","sectionTitle":"Budget & Cost","itemKey":"budget-status","itemDescription":"Current budget status and cost report review","pmComment":"","pxComment":"","pxInitial":""}],"followUps":[],"reportDocumentUrls":[],"createdBy":"jthompson@hedrickbrothers.com","createdAt":"2026-02-01T09:00:00.000Z","lastUpdatedBy":"jthompson@hedrickbrothers.com","lastUpdatedAt":"2026-02-05T14:00:00.000Z"},{"id":3,"projectCode":"25-115-01","reviewMonth":"2026-01","status":"PendingPXReview","dueDate":"2026-02-10","meetingDate":null,"pmSubmittedDate":"2026-02-03T09:00:00.000Z","pxReviewDate":null,"pxValidationDate":null,"leadershipSubmitDate":null,"completedDate":null,"checklistItems":[{"id":8,"sectionKey":"schedule","sectionTitle":"Schedule","itemKey":"schedule-status","itemDescription":"Current schedule status and critical path review","pmComment":"Foundation work 60% complete. On schedule.","pxComment":"","pxInitial":""},{"id":9,"sectionKey":"budget","sectionTitle":"Budget & Cost","itemKey":"budget-status","itemDescription":"Current budget status and cost report review","pmComment":"First billing submitted. Budget on track.","pxComment":"","pxInitial":""},{"id":10,"sectionKey":"safety","sectionTitle":"Safety","itemKey":"safety-incidents","itemDescription":"Safety incident review and near-miss reports","pmComment":"Zero incidents in January. Trench safety issue resolved same day.","pxComment":"","pxInitial":""}],"followUps":[],"reportDocumentUrls":[],"createdBy":"mrodriguez@hedrickbrothers.com","createdAt":"2026-02-01T09:00:00.000Z","lastUpdatedBy":"mrodriguez@hedrickbrothers.com","lastUpdatedAt":"2026-02-03T09:00:00.000Z"},{"id":4,"projectCode":"25-115-01","reviewMonth":"2025-12","status":"Complete","dueDate":"2026-01-10","meetingDate":"2026-01-09","pmSubmittedDate":"2026-01-06T09:00:00.000Z","pxReviewDate":"2026-01-08T10:00:00.000Z","pxValidationDate":"2026-01-09T15:00:00.000Z","leadershipSubmitDate":"2026-01-09T16:00:00.000Z","completedDate":"2026-01-10T09:00:00.000Z","checklistItems":[{"id":11,"sectionKey":"schedule","sectionTitle":"Schedule","itemKey":"schedule-status","itemDescription":"Current schedule status and critical path review","pmComment":"Mobilization complete. Demo finished ahead of schedule.","pxComment":"Good start to project.","pxInitial":"KF"}],"followUps":[],"reportDocumentUrls":["https://hedrickbrothers.sharepoint.com/sites/25-115-01/Shared%20Documents/Monthly/Dec-2025-Review.pdf"],"createdBy":"mrodriguez@hedrickbrothers.com","createdAt":"2026-01-02T09:00:00.000Z","lastUpdatedBy":"kfoster@hedrickbrothers.com","lastUpdatedAt":"2026-01-10T09:00:00.000Z"}]'),pmpBoilerplate_namespaceObject=JSON.parse('[{"sectionNumber":"I","sectionTitle":"Project Team Philosophy","content":"Hedrick Brothers Construction (HBC) is committed to delivering every project safely, on time, and within budget while exceeding our client\'s expectations. Our project team operates under the following principles:\\n\\n1. Safety First â€” Every team member has the authority and responsibility to stop work if unsafe conditions exist.\\n2. Quality Built In â€” We build it right the first time through proactive planning and quality control.\\n3. Open Communication â€” Transparent communication with our owner, design team, and trade partners is essential.\\n4. Collaborative Problem Solving â€” We approach challenges as a team, leveraging the expertise of all project stakeholders.\\n5. Continuous Improvement â€” We learn from every project and apply those lessons to improve our processes.","sourceDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/HBCHub/Shared%20Documents/Templates/PMP/Section-I-Philosophy.docx","lastSourceUpdate":"2025-06-15"},{"sectionNumber":"III","sectionTitle":"Quality Control","content":"HBC\'s Quality Control Program ensures that all work meets or exceeds the requirements of the contract documents. The following quality control measures are implemented on every project:\\n\\n1. Pre-Installation Conferences â€” Held with each trade contractor before beginning their scope of work.\\n2. Material Verification â€” All materials verified against submittals before installation.\\n3. First-Work-in-Place Inspections â€” Initial installation inspected and approved before proceeding.\\n4. Mock-Up Requirements â€” Full-scale mock-ups for critical assemblies as required by specifications.\\n5. Quality Concerns â€” [See live data from Quality Concerns module]\\n6. Inspection Documentation â€” Digital inspection reports filed daily.\\n7. Non-Conformance Tracking â€” NCRs tracked in project management system with corrective actions.\\n8. Third-Party Testing â€” Testing labs engaged per specification requirements.\\n9. Commissioning Coordination â€” Cx agent integrated into construction process.\\n10. Punch List Management â€” Systematic walk-throughs at 50%, 75%, and 100% completion.","sourceDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/HBCHub/Shared%20Documents/Templates/PMP/Section-III-QC.docx","lastSourceUpdate":"2025-06-15"},{"sectionNumber":"IV","sectionTitle":"Preconstruction Meeting","content":"A preconstruction meeting shall be held within 10 business days of Notice to Proceed. The meeting agenda includes:\\n\\n1. Introductions and project team organization\\n2. Communication protocols and points of contact\\n3. Submittal and RFI procedures\\n4. Pay application process and schedule of values\\n5. Change order procedures\\n6. Safety requirements and site-specific plans\\n7. Schedule review and milestone dates\\n8. Site logistics and access plan\\n9. Quality control requirements\\n10. Document management procedures","sourceDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/HBCHub/Shared%20Documents/Templates/PMP/Section-IV-Precon.docx","lastSourceUpdate":"2025-06-15"},{"sectionNumber":"V","sectionTitle":"Safety","content":"HBC\'s Safety Program is designed to protect every person on our jobsites. Our safety program includes:\\n\\n1. Site-Specific Safety Plan developed for each project\\n2. Weekly toolbox talks conducted by superintendent\\n3. Daily Job Hazard Analyses (JHAs) for all high-risk activities\\n4. Safety orientation required for all workers before site access\\n5. Personal Protective Equipment (PPE) requirements enforced\\n6. Substance abuse policy â€” zero tolerance\\n7. Fall protection plan for all work above 6 feet\\n8. Confined space entry procedures\\n9. Hot work permit program\\n10. Crane and rigging safety program\\n11. Electrical safety / LOTO procedures\\n12. Emergency action plan and evacuation routes\\n13. First aid stations and AED locations posted\\n14. Safety Concerns â€” [See live data from Safety Concerns module]\\n15. Incident investigation and reporting procedures\\n16. Monthly safety audits by Safety Director","sourceDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/HBCHub/Shared%20Documents/Templates/PMP/Section-V-Safety.docx","lastSourceUpdate":"2025-06-15"},{"sectionNumber":"VI","sectionTitle":"Maintaining Cost Control","content":"HBC maintains strict cost control through the following procedures:\\n\\n1. Monthly cost reports prepared and reviewed with Project Executive\\n2. Cost-to-complete forecasts updated monthly\\n3. Change order management â€” all potential changes logged immediately\\n4. Contingency tracking and drawdown monitoring\\n5. [See live data from Risk & Cost Management module for buyout, risks, and savings]\\n6. Subcontractor payment certification process\\n7. Material cost tracking and procurement coordination\\n8. Self-perform work cost monitoring\\n9. Value engineering opportunities evaluated continuously\\n10. Back-charge documentation and enforcement\\n11. Insurance claim documentation procedures","sourceDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/HBCHub/Shared%20Documents/Templates/PMP/Section-VI-CostControl.docx","lastSourceUpdate":"2025-06-15"},{"sectionNumber":"VIII","sectionTitle":"Team Responsibilities","content":"Each team member has defined responsibilities as outlined in the Internal Responsibility Matrix. Key roles include:\\n\\nâ€¢ Project Executive (PX) â€” Overall project oversight, client relationship, financial accountability\\nâ€¢ Senior Project Manager (Sr. PM) â€” Day-to-day project management, scheduling, cost control\\nâ€¢ Project Manager (PM) â€” Subcontract administration, submittals, RFIs, pay applications\\nâ€¢ Assistant Project Manager (APM) â€” Support PM with document control, meetings, correspondence\\nâ€¢ Project Administrator (PA) â€” Administrative support, filing, correspondence tracking\\nâ€¢ Superintendent â€” Field operations, safety, quality, schedule execution\\nâ€¢ Project Accountant â€” Billing, cost reporting, budget management\\nâ€¢ QA/QC Manager â€” Quality control inspections, mock-ups, testing coordination\\n\\nDetailed assignments are maintained in the Responsibility Matrix module.","sourceDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/HBCHub/Shared%20Documents/Templates/PMP/Section-VIII-Responsibilities.docx","lastSourceUpdate":"2025-06-15"},{"sectionNumber":"IX","sectionTitle":"Site Management","content":"Effective site management is critical to project success. HBC\'s site management approach includes:\\n\\n1. Site logistics plan reviewed and updated monthly\\n2. Material delivery coordination â€” 2-week rolling schedule\\n3. Subcontractor coordination meetings weekly\\n4. 3-week look-ahead schedule distributed weekly\\n5. Daily reports completed by superintendent\\n6. Photo documentation â€” daily and milestone\\n7. Visitor management and site access control\\n8. Environmental compliance monitoring","sourceDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/HBCHub/Shared%20Documents/Templates/PMP/Section-IX-SiteMgmt.docx","lastSourceUpdate":"2025-06-15"},{"sectionNumber":"XI","sectionTitle":"Project Administration","content":"Project administration procedures ensure consistent and thorough documentation:\\n\\n1. Buyout Schedule â€” [See PMP-specific buyout target date]\\n2. Pay Application Process â€” Monthly billing per AIA format, submitted by 25th of each month\\n3. Lien Release Tracking â€” Conditional and unconditional waivers tracked for every pay period\\n4. Insurance Certificate Management â€” All subcontractor certificates verified and tracked","sourceDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/HBCHub/Shared%20Documents/Templates/PMP/Section-XI-Admin.docx","lastSourceUpdate":"2025-06-15"},{"sectionNumber":"XV","sectionTitle":"Pre-Work Meeting Agenda","content":"Before each trade contractor begins work, a Pre-Work Meeting is conducted covering:\\n\\n1. Scope of work review and clarification\\n2. Schedule requirements and milestones\\n3. Safety requirements and site-specific hazards\\n4. Quality expectations and inspection hold points\\n5. Material storage and handling requirements\\n6. Coordination with other trades\\n7. Clean-up responsibilities\\n8. Communication protocols\\n9. Change order procedures\\n10. Payment terms and billing procedures","sourceDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/HBCHub/Shared%20Documents/Templates/PMP/Section-XV-PreWork.docx","lastSourceUpdate":"2025-06-15"}]'),jobNumberRequests_namespaceObject=JSON.parse('[{"id":1,"LeadID":13,"RequestDate":"2026-01-20","Originator":"jsmith@hedrickbrothers.com","RequiredByDate":"2026-02-01","ProjectAddress":"1500 Okeechobee Blvd, West Palm Beach, FL 33401","ProjectExecutive":"bfetting@hedrickbrothers.com","ProjectManager":"jrodriguez@hedrickbrothers.com","ProjectType":"01-43","ProjectTypeLabel":"HB HQ - GENERAL COMMERCIAL","IsEstimatingOnly":false,"RequestedCostCodes":["10-01-100","15-01-100","15-01-200","15-01-400","15-01-500"],"RequestStatus":"Pending","SiteProvisioningHeld":true,"Notes":"Need job number before site provisioning â€” client requires formal project code on all documents."},{"id":2,"LeadID":14,"RequestDate":"2026-01-25","Originator":"jsmith@hedrickbrothers.com","RequiredByDate":"2026-02-10","ProjectAddress":"4200 NW 36th St, Miami Springs, FL 33166","ProjectExecutive":"smitchell@hedrickbrothers.com","ProjectManager":"","ProjectType":"01-41","ProjectTypeLabel":"HB HQ - AEROSPACE","IsEstimatingOnly":true,"RequestedCostCodes":["01-01-413","01-01-025","01-01-311","01-01-302"],"RequestStatus":"Pending","SiteProvisioningHeld":true,"Notes":"Estimating only for now â€” awaiting client design package."},{"id":3,"LeadID":15,"RequestDate":"2026-01-10","Originator":"jsmith@hedrickbrothers.com","RequiredByDate":"2026-01-20","ProjectAddress":"200 S Orange Ave, Orlando, FL 32801","ProjectExecutive":"bfetting@hedrickbrothers.com","ProjectManager":"kfoster@hedrickbrothers.com","ProjectType":"01-45","ProjectTypeLabel":"HB HQ - EDUCATIONAL & MUNICIPAL","IsEstimatingOnly":false,"RequestedCostCodes":["10-01-100","10-01-200","15-01-100","15-01-200","15-01-300"],"RequestStatus":"Completed","AssignedJobNumber":"26-015-01","AssignedBy":"hthomas@hedrickbrothers.com","AssignedDate":"2026-01-18","SiteProvisioningHeld":false,"TempProjectCode":"25-041-01","Notes":"Assigned and site provisioned with temporary code â€” re-keyed to official number."}]'),projectTypes_namespaceObject=JSON.parse('[{"code":"01-41","label":"HB HQ - AEROSPACE","office":"HB Headquarters"},{"code":"01-42","label":"HB HQ - AUTOMOTIVE","office":"HB Headquarters"},{"code":"01-43","label":"HB HQ - GENERAL COMMERCIAL","office":"HB Headquarters"},{"code":"01-44","label":"HB HQ - COUNTRY CLUBS & HOSPITALITY","office":"HB Headquarters"},{"code":"01-45","label":"HB HQ - EDUCATIONAL & MUNICIPAL","office":"HB Headquarters"},{"code":"01-51","label":"BROWARD - AEROSPACE","office":"Broward Office"},{"code":"01-52","label":"BROWARD - AUTOMOTIVE","office":"Broward Office"},{"code":"01-53","label":"BROWARD - GENERAL COMMERCIAL","office":"Broward Office"},{"code":"01-54","label":"BROWARD - COUNTRY CLUBS & HOSPITALITY","office":"Broward Office"},{"code":"01-55","label":"BROWARD - EDUCATIONAL & MUNICIPAL","office":"Broward Office"},{"code":"01-56","label":"BROWARD - OVERHEAD","office":"Broward Office"},{"code":"01-31","label":"SPACE COAST - AEROSPACE","office":"Space Coast Office"},{"code":"01-32","label":"SPACE COAST - AUTOMOTIVE","office":"Space Coast Office"},{"code":"01-33","label":"SPACE COAST - GENERAL COMMERCIAL","office":"Space Coast Office"},{"code":"01-34","label":"SPACE COAST - COUNTRY CLUBS & HOSPITALITY","office":"Space Coast Office"},{"code":"01-35","label":"SPACE COAST - EDUCATIONAL & MUNICIPAL","office":"Space Coast Office"},{"code":"01-36","label":"SPACE COAST - OVERHEAD","office":"Space Coast Office"},{"code":"01-10","label":"RESIDENTIAL - PARKER","office":"Residential"},{"code":"01-05","label":"HB - HEDRICK","office":"HB Corporate"}]'),standardCostCodes_namespaceObject=JSON.parse('[{"id":"01-01-413","description":"Estimating","phase":"03","division":"01","isDefault":true},{"id":"01-01-025","description":"Plan Copy Expense","phase":"03","division":"01","isDefault":true},{"id":"01-01-311","description":"Project Executive","phase":"03","division":"01","isDefault":true},{"id":"01-01-302","description":"VDC Director","phase":"03","division":"01","isDefault":true},{"id":"01-01-100","description":"Presentation / Proposal / RFQ","phase":"01","division":"01","isDefault":false},{"id":"02-01-100","description":"Preconstruction Services","phase":"02","division":"01","isDefault":false},{"id":"03-01-100","description":"Estimating General","phase":"03","division":"01","isDefault":false},{"id":"10-01-100","description":"General Conditions - Supervision","phase":"10","division":"01","isDefault":false},{"id":"10-01-200","description":"General Conditions - Temporary Facilities","phase":"10","division":"01","isDefault":false},{"id":"10-01-300","description":"General Conditions - Equipment","phase":"10","division":"01","isDefault":false},{"id":"10-01-400","description":"General Conditions - Cleanup","phase":"10","division":"01","isDefault":false},{"id":"15-01-100","description":"Main Construction / GMP","phase":"15","division":"01","isDefault":false},{"id":"15-01-200","description":"Concrete","phase":"15","division":"01","isDefault":false},{"id":"15-01-300","description":"Structural Steel","phase":"15","division":"01","isDefault":false},{"id":"15-01-400","description":"Mechanical / HVAC","phase":"15","division":"01","isDefault":false},{"id":"15-01-500","description":"Electrical","phase":"15","division":"01","isDefault":false},{"id":"15-01-600","description":"Plumbing","phase":"15","division":"01","isDefault":false},{"id":"15-01-700","description":"Fire Protection","phase":"15","division":"01","isDefault":false},{"id":"90-01-100","description":"Non-Billable - General","phase":"90","division":"01","isDefault":false},{"id":"90-01-200","description":"Non-Billable - Warranty Reserve","phase":"90","division":"01","isDefault":false},{"id":"99-01-100","description":"Warranty - General","phase":"99","division":"01","isDefault":false},{"id":"99-01-200","description":"Warranty - Callbacks","phase":"99","division":"01","isDefault":false}]'),estimatingKickoffs_namespaceObject=JSON.parse('[{"id":1,"LeadID":29,"ProjectCode":"25-042-01","Architect":"SchenkelShultz Architecture","ProposalDueDateTime":"2026-03-01T17:00:00.000Z","ProposalType":"GMP","RFIFormat":"Procore","PrimaryOwnerContact":"owner@hedrickbrothers.com","ProposalDeliveryMethod":"Email","CopiesIfHandDelivered":0,"HBProposalDue":"2026-03-01","SubcontractorProposalsDue":"2026-02-15","PreSubmissionReview":"2026-02-20","SubcontractorSiteWalkThru":"2026-02-10","OwnerEstimateReview":"2026-02-25","keyPersonnel":[{"id":1,"label":"Lead Estimator","person":{"userId":"6","displayName":"Sam Patterson","email":"spatterson@hedrickbrothers.com"}},{"id":2,"label":"PX","person":{"userId":"1","displayName":"Mike Hedrick","email":"mhedrick@hedrickbrothers.com"}}],"items":[],"KickoffMeetingId":"","KickoffMeetingDate":"","CreatedBy":"jsmith@hedrickbrothers.com","CreatedDate":"2026-02-01T14:00:00.000Z","ModifiedBy":"jsmith@hedrickbrothers.com","ModifiedDate":"2026-02-01T14:00:00.000Z"}]'),lossAutopsies_namespaceObject=JSON.parse('[{"id":1,"leadId":27,"projectCode":null,"rootCauseAnalysis":"Lost on GMP price by $4.2M. Brasfield & Gorrie had an existing MSA with Orlando Health system which gave them a significant advantage.","lessonsLearned":"Need to establish MSA relationships with major healthcare systems before pursuing large-scale hospital projects.","competitiveIntelligence":"Brasfield & Gorrie leveraged existing MSA for preferential pricing on repeat work. Their team had completed 3 previous Orlando Health projects.","actionItems":[{"id":1,"projectCode":null,"description":"Research MSA opportunities with Orlando Health and other Central FL healthcare systems","assignee":"jrodriguez@hedrickbrothers.com","dueDate":"2025-06-15","status":"Open"},{"id":2,"projectCode":null,"description":"Update historical pricing database with latest healthcare construction costs","assignee":"estimating@hedrickbrothers.com","dueDate":"2025-05-30","status":"Open"}],"meetingNotes":"Team reviewed the bid process in detail. Consensus that our pricing was competitive but the MSA advantage was insurmountable.","completedDate":null,"completedBy":null,"realisticTimeline":true,"scopesBeforeProposals":true,"threeBidsPerTrade":true,"reasonableITBTime":false,"bidsSavedProperly":true,"multipleSubCommunications":true,"vettedProposals":true,"reasonableSpread":false,"pricesMatchHistorical":false,"veOptionsOffered":true,"deliverablesOnTime":true,"processScore":73,"strengths":"Strong estimating team coordination. Excellent subcontractor engagement with 15+ trades providing competitive bids. VE options were well-received by the client.","weaknesses":"ITB time was compressed due to late plan revisions. Historical pricing for healthcare MEP systems was outdated. Spread on mechanical trades exceeded 8%.","opportunities":"Pursue MSA relationships with healthcare systems. Develop specialized healthcare estimating database. Partner with specialized healthcare subs for future pursuits.","challenges":"Competing against firms with existing MSAs. Healthcare construction complexity requires specialized historical data. Orlando market is highly competitive.","overallRating":6,"meetingScheduledDate":"2025-04-15T10:00:00.000Z","meetingAttendees":["jrodriguez@hedrickbrothers.com","estimating@hedrickbrothers.com","exec@hedrickbrothers.com"],"isFinalized":true,"finalizedDate":"2025-04-15T11:00:00.000Z","finalizedBy":"estimating@hedrickbrothers.com"}]'),buyoutEntries_namespaceObject=JSON.parse('[{"id":501,"projectCode":"25-042-01","divisionCode":"02-300","divisionDescription":"Staking","isStandard":true,"originalBudget":45000,"estimatedTax":3150,"totalBudget":48150,"subcontractorName":"Precision Survey Co.","contractValue":42500,"overUnder":5650,"enrolledInSDI":false,"bondRequired":false,"loiSentDate":"2025-06-10","loiReturnedDate":"2025-06-14","contractSentDate":"2025-06-18","contractExecutedDate":"2025-06-22","insuranceCOIReceivedDate":"2025-06-20","status":"Executed","notes":"","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-06-22T00:00:00.000Z","commitmentStatus":"Committed","waiverRequired":false,"approvalHistory":[],"contractTrackingStatus":"NotStarted","contractTrackingHistory":[]},{"id":502,"projectCode":"25-042-01","divisionCode":"02-310","divisionDescription":"Site Clearing","isStandard":true,"originalBudget":120000,"estimatedTax":8400,"totalBudget":128400,"subcontractorName":"GreenField Clearing Inc.","contractValue":135000,"overUnder":-6600,"enrolledInSDI":true,"bondRequired":false,"loiSentDate":"2025-06-12","loiReturnedDate":"2025-06-18","contractSentDate":"2025-06-25","contractExecutedDate":"2025-07-01","insuranceCOIReceivedDate":"2025-06-28","status":"Executed","notes":"Exceeded budget due to unforeseen debris removal.","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-07-01T00:00:00.000Z","commitmentStatus":"Committed","waiverRequired":false,"approvalHistory":[],"contractTrackingStatus":"NotStarted","contractTrackingHistory":[]},{"id":503,"projectCode":"25-042-01","divisionCode":"02-320","divisionDescription":"Earthwork","isStandard":true,"originalBudget":350000,"estimatedTax":24500,"totalBudget":374500,"subcontractorName":"Atlas Earthmovers LLC","contractValue":340000,"overUnder":34500,"enrolledInSDI":true,"bondRequired":true,"loiSentDate":"2025-06-15","loiReturnedDate":"2025-06-20","contractSentDate":"2025-07-01","contractExecutedDate":null,"insuranceCOIReceivedDate":"2025-06-25","status":"Awarded","notes":"Contract pending final review.","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-07-05T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":504,"projectCode":"25-042-01","divisionCode":"03-100","divisionDescription":"Concrete Formwork","isStandard":true,"originalBudget":280000,"estimatedTax":19600,"totalBudget":299600,"subcontractorName":"FormPro Concrete","contractValue":275000,"overUnder":24600,"enrolledInSDI":false,"bondRequired":true,"loiSentDate":"2025-07-01","loiReturnedDate":"2025-07-05","contractSentDate":null,"contractExecutedDate":null,"insuranceCOIReceivedDate":null,"status":"Awarded","notes":"","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-07-05T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":505,"projectCode":"25-042-01","divisionCode":"03-200","divisionDescription":"Concrete Reinforcement","isStandard":true,"originalBudget":195000,"estimatedTax":13650,"totalBudget":208650,"subcontractorName":"","contractValue":null,"overUnder":null,"enrolledInSDI":false,"bondRequired":false,"loiSentDate":null,"loiReturnedDate":null,"contractSentDate":null,"contractExecutedDate":null,"insuranceCOIReceivedDate":null,"status":"In Progress","notes":"Soliciting bids from 3 vendors.","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-07-10T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":506,"projectCode":"25-042-01","divisionCode":"03-300","divisionDescription":"Cast-in-Place Concrete","isStandard":true,"originalBudget":410000,"estimatedTax":28700,"totalBudget":438700,"subcontractorName":"","contractValue":null,"overUnder":null,"enrolledInSDI":false,"bondRequired":true,"loiSentDate":null,"loiReturnedDate":null,"contractSentDate":null,"contractExecutedDate":null,"insuranceCOIReceivedDate":null,"status":"In Progress","notes":"","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-07-08T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":507,"projectCode":"25-042-01","divisionCode":"05-120","divisionDescription":"Structural Steel","isStandard":true,"originalBudget":1250000,"estimatedTax":87500,"totalBudget":1337500,"subcontractorName":"ABC Steel Works","contractValue":1195000,"overUnder":142500,"enrolledInSDI":true,"bondRequired":true,"loiSentDate":"2025-06-05","loiReturnedDate":"2025-06-08","contractSentDate":"2025-06-12","contractExecutedDate":"2025-06-18","insuranceCOIReceivedDate":"2025-06-15","status":"Executed","notes":"Significant savings achieved through early procurement.","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-06-18T00:00:00.000Z","commitmentStatus":"Committed","waiverRequired":false,"approvalHistory":[],"contractTrackingStatus":"NotStarted","contractTrackingHistory":[]},{"id":508,"projectCode":"25-042-01","divisionCode":"05-500","divisionDescription":"Metal Fabrications","isStandard":true,"originalBudget":85000,"estimatedTax":5950,"totalBudget":90950,"subcontractorName":"","contractValue":null,"overUnder":null,"enrolledInSDI":false,"bondRequired":false,"loiSentDate":null,"loiReturnedDate":null,"contractSentDate":null,"contractExecutedDate":null,"insuranceCOIReceivedDate":null,"status":"Not Started","notes":"","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-06-01T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":509,"projectCode":"25-042-01","divisionCode":"07-200","divisionDescription":"Thermal Insulation","isStandard":true,"originalBudget":65000,"estimatedTax":4550,"totalBudget":69550,"subcontractorName":"","contractValue":null,"overUnder":null,"enrolledInSDI":false,"bondRequired":false,"loiSentDate":null,"loiReturnedDate":null,"contractSentDate":null,"contractExecutedDate":null,"insuranceCOIReceivedDate":null,"status":"Not Started","notes":"","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-06-01T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":510,"projectCode":"25-042-01","divisionCode":"07-400","divisionDescription":"Roofing","isStandard":true,"originalBudget":220000,"estimatedTax":15400,"totalBudget":235400,"subcontractorName":"","contractValue":null,"overUnder":null,"enrolledInSDI":false,"bondRequired":false,"loiSentDate":null,"loiReturnedDate":null,"contractSentDate":null,"contractExecutedDate":null,"insuranceCOIReceivedDate":null,"status":"Not Started","notes":"","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-06-01T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":511,"projectCode":"25-042-01","divisionCode":"08-100","divisionDescription":"Doors & Frames","isStandard":true,"originalBudget":95000,"estimatedTax":6650,"totalBudget":101650,"subcontractorName":"","contractValue":null,"overUnder":null,"enrolledInSDI":false,"bondRequired":false,"loiSentDate":null,"loiReturnedDate":null,"contractSentDate":null,"contractExecutedDate":null,"insuranceCOIReceivedDate":null,"status":"Not Started","notes":"","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-06-01T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":512,"projectCode":"25-042-01","divisionCode":"09-200","divisionDescription":"Plaster & Gypsum Board","isStandard":true,"originalBudget":175000,"estimatedTax":12250,"totalBudget":187250,"subcontractorName":"","contractValue":null,"overUnder":null,"enrolledInSDI":false,"bondRequired":false,"loiSentDate":null,"loiReturnedDate":null,"contractSentDate":null,"contractExecutedDate":null,"insuranceCOIReceivedDate":null,"status":"Not Started","notes":"","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-06-01T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":513,"projectCode":"25-042-01","divisionCode":"15-000","divisionDescription":"Mechanical / HVAC","isStandard":true,"originalBudget":890000,"estimatedTax":62300,"totalBudget":952300,"subcontractorName":"Advanced MEP Solutions","contractValue":925000,"overUnder":27300,"enrolledInSDI":true,"bondRequired":true,"loiSentDate":"2025-06-20","loiReturnedDate":"2025-06-25","contractSentDate":"2025-07-01","contractExecutedDate":null,"insuranceCOIReceivedDate":"2025-06-28","status":"Awarded","notes":"Scope includes HVAC, ductwork, and controls.","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-07-05T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":514,"projectCode":"25-042-01","divisionCode":"16-000","divisionDescription":"Electrical","isStandard":true,"originalBudget":780000,"estimatedTax":54600,"totalBudget":834600,"subcontractorName":"PowerLine Electric Inc.","contractValue":810000,"overUnder":24600,"enrolledInSDI":true,"bondRequired":true,"loiSentDate":"2025-06-22","loiReturnedDate":null,"contractSentDate":null,"contractExecutedDate":null,"insuranceCOIReceivedDate":null,"status":"In Progress","notes":"LOI sent, awaiting return.","createdDate":"2025-06-01T00:00:00.000Z","modifiedDate":"2025-07-08T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]},{"id":515,"projectCode":"25-042-01","divisionCode":"09-300","divisionDescription":"Tile Work","isStandard":false,"originalBudget":110000,"estimatedTax":7700,"totalBudget":117700,"subcontractorName":"","contractValue":null,"overUnder":null,"enrolledInSDI":false,"bondRequired":false,"loiSentDate":null,"loiReturnedDate":null,"contractSentDate":null,"contractExecutedDate":null,"insuranceCOIReceivedDate":null,"status":"Not Started","notes":"Custom division added for specialty tile scope.","createdDate":"2025-07-01T00:00:00.000Z","modifiedDate":"2025-07-01T00:00:00.000Z","commitmentStatus":"Budgeted","waiverRequired":false,"approvalHistory":[]}]'),scheduleActivities_namespaceObject=JSON.parse('[{"id":1,"projectCode":"TWNU07","importId":1,"taskCode":"SITEWORK-10","wbsCode":"TWNU07.8.8.2","activityName":"MOBILIZATION","activityType":"Task Dependent","status":"Completed","originalDuration":2,"remainingDuration":0,"actualDuration":2,"baselineStartDate":"2024-10-29T08:00:00.000Z","baselineFinishDate":"2024-10-30T16:00:00.000Z","plannedStartDate":"2024-10-29T08:00:00.000Z","plannedFinishDate":"2024-10-30T16:00:00.000Z","actualStartDate":"2024-10-29T08:00:00.000Z","actualFinishDate":"2024-10-30T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["PRECON-30","SM-NTP"],"successors":["SITEWORK-40","SITEWORK-20"],"successorDetails":[{"taskCode":"SITEWORK-40","relationshipType":"FS","lag":0},{"taskCode":"SITEWORK-20","relationshipType":"SS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":2,"projectCode":"TWNU07","importId":1,"taskCode":"SITEWORK-50","wbsCode":"TWNU07.8.8.2","activityName":"BUILD PAD","activityType":"Task Dependent","status":"Completed","originalDuration":23,"remainingDuration":0,"actualDuration":43,"baselineStartDate":"2024-11-11T08:00:00.000Z","baselineFinishDate":"2024-12-13T16:00:00.000Z","plannedStartDate":"2024-11-11T08:00:00.000Z","plannedFinishDate":"2024-12-13T16:00:00.000Z","actualStartDate":"2024-11-11T08:00:00.000Z","actualFinishDate":"2025-01-14T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["SITEWORK-40","SITEWORK-70"],"successors":["SITEUTLS-10","SITEUTLS-40"],"successorDetails":[{"taskCode":"SITEUTLS-10","relationshipType":"FS","lag":0},{"taskCode":"SITEUTLS-40","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":0,"finishVarianceDays":22,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":3,"projectCode":"TWNU07","importId":1,"taskCode":"SITEWORK-70","wbsCode":"TWNU07.8.8.2","activityName":"SITE DEVELOPMENT TO BUILDING PAD","activityType":"Task Dependent","status":"Completed","originalDuration":10,"remainingDuration":0,"actualDuration":22,"baselineStartDate":"2024-11-11T08:00:00.000Z","baselineFinishDate":"2024-11-22T16:00:00.000Z","plannedStartDate":"2024-11-11T08:00:00.000Z","plannedFinishDate":"2024-11-22T16:00:00.000Z","actualStartDate":"2024-11-11T08:00:00.000Z","actualFinishDate":"2024-12-12T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["SITEWORK-30"],"successors":["P1A-C1-FNDS-10","SITEUTLS-20","SITEWORK-50"],"successorDetails":[{"taskCode":"P1A-C1-FNDS-10","relationshipType":"FS","lag":0},{"taskCode":"SITEUTLS-20","relationshipType":"FS","lag":0},{"taskCode":"SITEWORK-50","relationshipType":"FF","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":0,"finishVarianceDays":14,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":4,"projectCode":"TWNU07","importId":1,"taskCode":"SITEWORK-60","wbsCode":"TWNU07.8.8.2","activityName":"EXCAVATE LAKE","activityType":"Task Dependent","status":"Completed","originalDuration":5,"remainingDuration":0,"actualDuration":5,"baselineStartDate":"2024-12-19T08:00:00.000Z","baselineFinishDate":"2024-12-26T16:00:00.000Z","plannedStartDate":"2024-12-19T08:00:00.000Z","plannedFinishDate":"2024-12-26T16:00:00.000Z","actualStartDate":"2024-12-19T08:00:00.000Z","actualFinishDate":"2024-12-26T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["PERMIT-40"],"successors":["SITEUTLS-10","SITEUTLS-40"],"successorDetails":[{"taskCode":"SITEUTLS-10","relationshipType":"FS","lag":0},{"taskCode":"SITEUTLS-40","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":5,"projectCode":"TWNU07","importId":1,"taskCode":"SITEUTLS-10","wbsCode":"TWNU07.8.8.2","activityName":"STORM","activityType":"Task Dependent","status":"In Progress","originalDuration":8,"remainingDuration":3,"actualDuration":66,"baselineStartDate":"2025-01-15T08:00:00.000Z","baselineFinishDate":"2025-01-24T16:00:00.000Z","plannedStartDate":"2025-01-15T08:00:00.000Z","plannedFinishDate":"2025-01-24T16:00:00.000Z","actualStartDate":"2025-01-15T08:00:00.000Z","actualFinishDate":null,"remainingFloat":136,"freeFloat":0,"predecessors":["SITEWORK-50","SITEWORK-60"],"successors":["SITEUTLS-40","SITEUTLS-30"],"successorDetails":[{"taskCode":"SITEUTLS-40","relationshipType":"FS","lag":0},{"taskCode":"SITEUTLS-30","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":96,"startVarianceDays":0,"finishVarianceDays":null,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":6,"projectCode":"TWNU07","importId":1,"taskCode":"SITEUTLS-40","wbsCode":"TWNU07.8.8.2","activityName":"WATER DISTRIBUTION & INSPECT","activityType":"Task Dependent","status":"Not Started","originalDuration":7,"remainingDuration":7,"actualDuration":0,"baselineStartDate":"2025-05-07T08:00:00.000Z","baselineFinishDate":"2025-05-15T16:00:00.000Z","plannedStartDate":"2025-05-07T08:00:00.000Z","plannedFinishDate":"2025-05-15T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":130,"freeFloat":0,"predecessors":["SITEWORK-50","SITEWORK-60","SITEUTLS-10","SITEUTLS-30"],"successors":["SITEUTLS-50"],"successorDetails":[{"taskCode":"SITEUTLS-50","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":7,"projectCode":"TWNU07","importId":1,"taskCode":"SITEWORK-30","wbsCode":"TWNU07.8.8.2","activityName":"TREE RELOCATION","activityType":"Task Dependent","status":"Completed","originalDuration":17,"remainingDuration":0,"actualDuration":17,"baselineStartDate":"2024-11-19T08:00:00.000Z","baselineFinishDate":"2024-12-13T16:00:00.000Z","plannedStartDate":"2024-11-19T08:00:00.000Z","plannedFinishDate":"2024-12-13T16:00:00.000Z","actualStartDate":"2024-11-19T08:00:00.000Z","actualFinishDate":"2024-12-13T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["SITEWORK-20"],"successors":["SITEWORK-70"],"successorDetails":[{"taskCode":"SITEWORK-70","relationshipType":"FF","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":8,"projectCode":"TWNU07","importId":1,"taskCode":"SITEWORK-40","wbsCode":"TWNU07.8.8.2","activityName":"SITE CLEARING","activityType":"Task Dependent","status":"Completed","originalDuration":18,"remainingDuration":0,"actualDuration":18,"baselineStartDate":"2024-10-29T08:00:00.000Z","baselineFinishDate":"2024-11-21T16:00:00.000Z","plannedStartDate":"2024-10-29T08:00:00.000Z","plannedFinishDate":"2024-11-21T16:00:00.000Z","actualStartDate":"2024-10-29T08:00:00.000Z","actualFinishDate":"2024-11-21T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["SITEWORK-10","SITEWORK-20"],"successors":["SITEWORK-50"],"successorDetails":[{"taskCode":"SITEWORK-50","relationshipType":"FF","lag":5}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":9,"projectCode":"TWNU07","importId":1,"taskCode":"SITEUTLS-30","wbsCode":"TWNU07.8.8.2","activityName":"FIRE LINES","activityType":"Task Dependent","status":"Not Started","originalDuration":7,"remainingDuration":7,"actualDuration":0,"baselineStartDate":"2025-04-30T08:00:00.000Z","baselineFinishDate":"2025-05-08T16:00:00.000Z","plannedStartDate":"2025-04-30T08:00:00.000Z","plannedFinishDate":"2025-05-08T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":130,"freeFloat":0,"predecessors":["SITEUTLS-20","PERMIT-20","SITEUTLS-10"],"successors":["SITEUTLS-40"],"successorDetails":[{"taskCode":"SITEUTLS-40","relationshipType":"FF","lag":5}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":10,"projectCode":"TWNU07","importId":1,"taskCode":"SITEUTLS-20","wbsCode":"TWNU07.8.8.2","activityName":"SANITARY","activityType":"Task Dependent","status":"In Progress","originalDuration":8,"remainingDuration":9,"actualDuration":28,"baselineStartDate":"2025-03-10T08:00:00.000Z","baselineFinishDate":"2025-03-19T16:00:00.000Z","plannedStartDate":"2025-03-10T08:00:00.000Z","plannedFinishDate":"2025-03-19T16:00:00.000Z","actualStartDate":"2025-03-10T08:00:00.000Z","actualFinishDate":null,"remainingFloat":-50,"freeFloat":0,"predecessors":["SITEWORK-70","PERMIT-20"],"successors":["SITEUTLS-30","SITEUTLS-80"],"successorDetails":[{"taskCode":"SITEUTLS-30","relationshipType":"FS","lag":0},{"taskCode":"SITEUTLS-80","relationshipType":"SS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":76,"startVarianceDays":0,"finishVarianceDays":null,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":11,"projectCode":"TWNU07","importId":1,"taskCode":"SITEUTLS-50","wbsCode":"TWNU07.8.8.2","activityName":"WATER METER & BACKFLOW","activityType":"Task Dependent","status":"Not Started","originalDuration":5,"remainingDuration":5,"actualDuration":0,"baselineStartDate":"2025-05-16T08:00:00.000Z","baselineFinishDate":"2025-05-22T16:00:00.000Z","plannedStartDate":"2025-05-16T08:00:00.000Z","plannedFinishDate":"2025-05-22T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":130,"freeFloat":0,"predecessors":["SITEUTLS-40"],"successors":["SITEUTLS-60"],"successorDetails":[{"taskCode":"SITEUTLS-60","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":12,"projectCode":"TWNU07","importId":1,"taskCode":"SITEUTLS-60","wbsCode":"TWNU07.8.8.2","activityName":"IRRIGATION MAIN LINE","activityType":"Task Dependent","status":"Not Started","originalDuration":10,"remainingDuration":10,"actualDuration":0,"baselineStartDate":"2025-05-23T08:00:00.000Z","baselineFinishDate":"2025-06-05T16:00:00.000Z","plannedStartDate":"2025-05-23T08:00:00.000Z","plannedFinishDate":"2025-06-05T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":120,"freeFloat":0,"predecessors":["SITEUTLS-50"],"successors":["SITEUTLS-70"],"successorDetails":[{"taskCode":"SITEUTLS-70","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":13,"projectCode":"TWNU07","importId":1,"taskCode":"SITEUTLS-70","wbsCode":"TWNU07.8.8.2","activityName":"IRRIGATION LATERALS & HEADS","activityType":"Task Dependent","status":"Not Started","originalDuration":15,"remainingDuration":15,"actualDuration":0,"baselineStartDate":"2025-06-06T08:00:00.000Z","baselineFinishDate":"2025-06-26T16:00:00.000Z","plannedStartDate":"2025-06-06T08:00:00.000Z","plannedFinishDate":"2025-06-26T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":105,"freeFloat":0,"predecessors":["SITEUTLS-60"],"successors":["LANDSCAPE-10"],"successorDetails":[{"taskCode":"LANDSCAPE-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":14,"projectCode":"TWNU07","importId":1,"taskCode":"SITEWORK-20","wbsCode":"TWNU07.8.8.2","activityName":"EROSION CONTROL / SILT FENCE","activityType":"Task Dependent","status":"Completed","originalDuration":27,"remainingDuration":0,"actualDuration":32,"baselineStartDate":"2024-11-05T08:00:00.000Z","baselineFinishDate":"2024-12-13T16:00:00.000Z","plannedStartDate":"2024-11-05T08:00:00.000Z","plannedFinishDate":"2024-12-13T16:00:00.000Z","actualStartDate":"2024-11-05T08:00:00.000Z","actualFinishDate":"2024-12-20T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["SITEWORK-10"],"successors":["SITEWORK-40","SITEWORK-30"],"successorDetails":[{"taskCode":"SITEWORK-40","relationshipType":"SS","lag":0},{"taskCode":"SITEWORK-30","relationshipType":"SS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":0,"finishVarianceDays":5,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":15,"projectCode":"TWNU07","importId":1,"taskCode":"SITEUTLS-80","wbsCode":"TWNU07.8.8.2","activityName":"GREASE TRAP","activityType":"Task Dependent","status":"Completed","originalDuration":3,"remainingDuration":0,"actualDuration":3,"baselineStartDate":"2025-03-10T08:00:00.000Z","baselineFinishDate":"2025-03-12T16:00:00.000Z","plannedStartDate":"2025-03-10T08:00:00.000Z","plannedFinishDate":"2025-03-12T16:00:00.000Z","actualStartDate":"2025-03-10T08:00:00.000Z","actualFinishDate":"2025-03-12T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["SITEUTLS-20"],"successors":["SITEUTLS-90"],"successorDetails":[{"taskCode":"SITEUTLS-90","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":16,"projectCode":"TWNU07","importId":1,"taskCode":"SITEUTLS-90","wbsCode":"TWNU07.8.8.2","activityName":"LIFT STATION","activityType":"Task Dependent","status":"Completed","originalDuration":5,"remainingDuration":0,"actualDuration":5,"baselineStartDate":"2025-03-13T08:00:00.000Z","baselineFinishDate":"2025-03-19T16:00:00.000Z","plannedStartDate":"2025-03-13T08:00:00.000Z","plannedFinishDate":"2025-03-19T16:00:00.000Z","actualStartDate":"2025-03-13T08:00:00.000Z","actualFinishDate":"2025-03-19T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["SITEUTLS-80"],"successors":["P1A-PLMB-10"],"successorDetails":[{"taskCode":"P1A-PLMB-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":17,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-FNDS-10","wbsCode":"TWNU07.8.8.3","activityName":"FOUNDATIONS - PHASE 1A","activityType":"Task Dependent","status":"Completed","originalDuration":20,"remainingDuration":0,"actualDuration":25,"baselineStartDate":"2024-12-13T08:00:00.000Z","baselineFinishDate":"2025-01-10T16:00:00.000Z","plannedStartDate":"2024-12-13T08:00:00.000Z","plannedFinishDate":"2025-01-10T16:00:00.000Z","actualStartDate":"2024-12-16T08:00:00.000Z","actualFinishDate":"2025-01-21T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["SITEWORK-70"],"successors":["P1A-C1-SLAB-10"],"successorDetails":[{"taskCode":"P1A-C1-SLAB-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":1,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":18,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-SLAB-10","wbsCode":"TWNU07.8.8.3","activityName":"SLAB ON GRADE - PHASE 1A","activityType":"Task Dependent","status":"In Progress","originalDuration":15,"remainingDuration":4,"actualDuration":18,"baselineStartDate":"2025-01-13T08:00:00.000Z","baselineFinishDate":"2025-01-31T16:00:00.000Z","plannedStartDate":"2025-01-22T08:00:00.000Z","plannedFinishDate":"2025-02-11T16:00:00.000Z","actualStartDate":"2025-01-22T08:00:00.000Z","actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-C1-FNDS-10"],"successors":["P1A-C1-FRAMING-10"],"successorDetails":[{"taskCode":"P1A-C1-FRAMING-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":82,"startVarianceDays":7,"finishVarianceDays":null,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":19,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-FRAMING-10","wbsCode":"TWNU07.8.8.3","activityName":"WOOD FRAMING - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":30,"remainingDuration":30,"actualDuration":0,"baselineStartDate":"2025-02-03T08:00:00.000Z","baselineFinishDate":"2025-03-14T16:00:00.000Z","plannedStartDate":"2025-02-12T08:00:00.000Z","plannedFinishDate":"2025-03-25T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-C1-SLAB-10"],"successors":["P1A-C1-ROOF-10","P1A-C1-ROUGH-10"],"successorDetails":[{"taskCode":"P1A-C1-ROOF-10","relationshipType":"FS","lag":0},{"taskCode":"P1A-C1-ROUGH-10","relationshipType":"SS","lag":10}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":20,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-ROOF-10","wbsCode":"TWNU07.8.8.3","activityName":"ROOF SHEATHING & DRY-IN - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":12,"remainingDuration":12,"actualDuration":0,"baselineStartDate":"2025-03-17T08:00:00.000Z","baselineFinishDate":"2025-04-01T16:00:00.000Z","plannedStartDate":"2025-03-26T08:00:00.000Z","plannedFinishDate":"2025-04-10T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-C1-FRAMING-10"],"successors":["P1A-EXT-STUCCO-10","P1A-C1-ROOF-20"],"successorDetails":[{"taskCode":"P1A-EXT-STUCCO-10","relationshipType":"FS","lag":0},{"taskCode":"P1A-C1-ROOF-20","relationshipType":"FS","lag":5}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":21,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-ROOF-20","wbsCode":"TWNU07.8.8.3","activityName":"ROOF TILE INSTALL - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":15,"remainingDuration":15,"actualDuration":0,"baselineStartDate":"2025-04-08T08:00:00.000Z","baselineFinishDate":"2025-04-28T16:00:00.000Z","plannedStartDate":"2025-04-17T08:00:00.000Z","plannedFinishDate":"2025-05-07T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-3,"freeFloat":0,"predecessors":["P1A-C1-ROOF-10"],"successors":["P1A-EXT-GUTTER-10"],"successorDetails":[{"taskCode":"P1A-EXT-GUTTER-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":22,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-ROUGH-10","wbsCode":"TWNU07.8.8.3","activityName":"ROUGH PLUMBING - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":10,"remainingDuration":10,"actualDuration":0,"baselineStartDate":"2025-02-17T08:00:00.000Z","baselineFinishDate":"2025-02-28T16:00:00.000Z","plannedStartDate":"2025-02-26T08:00:00.000Z","plannedFinishDate":"2025-03-11T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-FRAMING-10"],"successors":["P1A-C1-ROUGH-20"],"successorDetails":[{"taskCode":"P1A-C1-ROUGH-20","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":23,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-ROUGH-20","wbsCode":"TWNU07.8.8.3","activityName":"ROUGH ELECTRICAL - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":10,"remainingDuration":10,"actualDuration":0,"baselineStartDate":"2025-03-03T08:00:00.000Z","baselineFinishDate":"2025-03-14T16:00:00.000Z","plannedStartDate":"2025-03-12T08:00:00.000Z","plannedFinishDate":"2025-03-25T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-ROUGH-10"],"successors":["P1A-C1-ROUGH-30"],"successorDetails":[{"taskCode":"P1A-C1-ROUGH-30","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":24,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-ROUGH-30","wbsCode":"TWNU07.8.8.3","activityName":"ROUGH HVAC - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":8,"remainingDuration":8,"actualDuration":0,"baselineStartDate":"2025-03-17T08:00:00.000Z","baselineFinishDate":"2025-03-26T16:00:00.000Z","plannedStartDate":"2025-03-26T08:00:00.000Z","plannedFinishDate":"2025-04-04T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-ROUGH-20"],"successors":["P1A-C1-INSUL-10"],"successorDetails":[{"taskCode":"P1A-C1-INSUL-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":25,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-INSUL-10","wbsCode":"TWNU07.8.8.3","activityName":"INSULATION - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":5,"remainingDuration":5,"actualDuration":0,"baselineStartDate":"2025-03-27T08:00:00.000Z","baselineFinishDate":"2025-04-02T16:00:00.000Z","plannedStartDate":"2025-04-07T08:00:00.000Z","plannedFinishDate":"2025-04-11T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-ROUGH-30"],"successors":["P1A-C1-DRYWALL-10"],"successorDetails":[{"taskCode":"P1A-C1-DRYWALL-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":26,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-EXT-STUCCO-10","wbsCode":"TWNU07.8.8.4","activityName":"STUCCO LATH & SCRATCH - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":15,"remainingDuration":15,"actualDuration":0,"baselineStartDate":"2025-04-02T08:00:00.000Z","baselineFinishDate":"2025-04-22T16:00:00.000Z","plannedStartDate":"2025-04-11T08:00:00.000Z","plannedFinishDate":"2025-05-01T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-C1-ROOF-10"],"successors":["P1A-EXT-STUCCO-20"],"successorDetails":[{"taskCode":"P1A-EXT-STUCCO-20","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":27,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-EXT-STUCCO-20","wbsCode":"TWNU07.8.8.4","activityName":"STUCCO BROWN & FINISH - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":12,"remainingDuration":12,"actualDuration":0,"baselineStartDate":"2025-04-23T08:00:00.000Z","baselineFinishDate":"2025-05-08T16:00:00.000Z","plannedStartDate":"2025-05-02T08:00:00.000Z","plannedFinishDate":"2025-05-19T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-EXT-STUCCO-10"],"successors":["P1A-EXT-PAINT-10"],"successorDetails":[{"taskCode":"P1A-EXT-PAINT-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":28,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-EXT-PAINT-10","wbsCode":"TWNU07.8.8.4","activityName":"EXTERIOR PAINT - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":10,"remainingDuration":10,"actualDuration":0,"baselineStartDate":"2025-05-09T08:00:00.000Z","baselineFinishDate":"2025-05-22T16:00:00.000Z","plannedStartDate":"2025-05-20T08:00:00.000Z","plannedFinishDate":"2025-06-02T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-EXT-STUCCO-20"],"successors":["P1A-EXT-AWNING-10","P1A-EXT-SHUTTER-10"],"successorDetails":[{"taskCode":"P1A-EXT-AWNING-10","relationshipType":"FS","lag":0},{"taskCode":"P1A-EXT-SHUTTER-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":29,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-EXT-AWNING-10","wbsCode":"TWNU07.8.8.4","activityName":"AWNINGS & CANOPIES - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":8,"remainingDuration":8,"actualDuration":0,"baselineStartDate":"2025-05-23T08:00:00.000Z","baselineFinishDate":"2025-06-03T16:00:00.000Z","plannedStartDate":"2025-06-03T08:00:00.000Z","plannedFinishDate":"2025-06-12T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-EXT-PAINT-10"],"successors":["P1A-EXT-STOREFRONT-10"],"successorDetails":[{"taskCode":"P1A-EXT-STOREFRONT-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":30,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-EXT-SHUTTER-10","wbsCode":"TWNU07.8.8.4","activityName":"SHUTTERS & TRIM - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":6,"remainingDuration":6,"actualDuration":0,"baselineStartDate":"2025-05-23T08:00:00.000Z","baselineFinishDate":"2025-06-02T16:00:00.000Z","plannedStartDate":"2025-06-03T08:00:00.000Z","plannedFinishDate":"2025-06-10T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":2,"freeFloat":2,"predecessors":["P1A-EXT-PAINT-10"],"successors":["P1A-EXT-STOREFRONT-10"],"successorDetails":[{"taskCode":"P1A-EXT-STOREFRONT-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":6,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":31,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-EXT-GUTTER-10","wbsCode":"TWNU07.8.8.4","activityName":"GUTTERS & DOWNSPOUTS - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":5,"remainingDuration":5,"actualDuration":0,"baselineStartDate":"2025-04-29T08:00:00.000Z","baselineFinishDate":"2025-05-05T16:00:00.000Z","plannedStartDate":"2025-05-08T08:00:00.000Z","plannedFinishDate":"2025-05-14T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":15,"freeFloat":5,"predecessors":["P1A-C1-ROOF-20"],"successors":["P1A-EXT-STOREFRONT-10"],"successorDetails":[{"taskCode":"P1A-EXT-STOREFRONT-10","relationshipType":"FS","lag":10}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":32,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-EXT-STOREFRONT-10","wbsCode":"TWNU07.8.8.4","activityName":"STOREFRONT GLAZING - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":10,"remainingDuration":10,"actualDuration":0,"baselineStartDate":"2025-06-04T08:00:00.000Z","baselineFinishDate":"2025-06-17T16:00:00.000Z","plannedStartDate":"2025-06-13T08:00:00.000Z","plannedFinishDate":"2025-06-26T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-EXT-AWNING-10","P1A-EXT-SHUTTER-10","P1A-EXT-GUTTER-10"],"successors":["P1A-EXT-BRICK-10"],"successorDetails":[{"taskCode":"P1A-EXT-BRICK-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":33,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-EXT-BRICK-10","wbsCode":"TWNU07.8.8.4","activityName":"BRICK VENEER - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":15,"remainingDuration":15,"actualDuration":0,"baselineStartDate":"2025-06-18T08:00:00.000Z","baselineFinishDate":"2025-07-08T16:00:00.000Z","plannedStartDate":"2025-06-27T08:00:00.000Z","plannedFinishDate":"2025-07-17T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-EXT-STOREFRONT-10"],"successors":["P1A-EXT-BRICK-20"],"successorDetails":[{"taskCode":"P1A-EXT-BRICK-20","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":34,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-EXT-BRICK-20","wbsCode":"TWNU07.8.8.4","activityName":"BRICK CAPS & SILLS - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":5,"remainingDuration":5,"actualDuration":0,"baselineStartDate":"2025-07-09T08:00:00.000Z","baselineFinishDate":"2025-07-15T16:00:00.000Z","plannedStartDate":"2025-07-18T08:00:00.000Z","plannedFinishDate":"2025-07-24T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-EXT-BRICK-10"],"successors":["P1A-EXT-CLEAN-10"],"successorDetails":[{"taskCode":"P1A-EXT-CLEAN-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":35,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-EXT-CLEAN-10","wbsCode":"TWNU07.8.8.4","activityName":"EXTERIOR CLEAN & PUNCH - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":5,"remainingDuration":5,"actualDuration":0,"baselineStartDate":"2025-07-16T08:00:00.000Z","baselineFinishDate":"2025-07-22T16:00:00.000Z","plannedStartDate":"2025-07-25T08:00:00.000Z","plannedFinishDate":"2025-07-31T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-EXT-BRICK-20"],"successors":["P1A-FINAL-10"],"successorDetails":[{"taskCode":"P1A-FINAL-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":36,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-DRYWALL-10","wbsCode":"TWNU07.8.8.3","activityName":"DRYWALL HANG - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":10,"remainingDuration":10,"actualDuration":0,"baselineStartDate":"2025-04-03T08:00:00.000Z","baselineFinishDate":"2025-04-16T16:00:00.000Z","plannedStartDate":"2025-04-14T08:00:00.000Z","plannedFinishDate":"2025-04-25T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-INSUL-10"],"successors":["P1A-C1-DRYWALL-20"],"successorDetails":[{"taskCode":"P1A-C1-DRYWALL-20","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":37,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-DRYWALL-20","wbsCode":"TWNU07.8.8.3","activityName":"DRYWALL TAPE & FINISH - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":8,"remainingDuration":8,"actualDuration":0,"baselineStartDate":"2025-04-17T08:00:00.000Z","baselineFinishDate":"2025-04-28T16:00:00.000Z","plannedStartDate":"2025-04-28T08:00:00.000Z","plannedFinishDate":"2025-05-07T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-DRYWALL-10"],"successors":["P1A-C1-INTPAINT-10"],"successorDetails":[{"taskCode":"P1A-C1-INTPAINT-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":38,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-INTPAINT-10","wbsCode":"TWNU07.8.8.3","activityName":"INTERIOR PAINT PRIME & 1ST COAT - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":7,"remainingDuration":7,"actualDuration":0,"baselineStartDate":"2025-04-29T08:00:00.000Z","baselineFinishDate":"2025-05-07T16:00:00.000Z","plannedStartDate":"2025-05-08T08:00:00.000Z","plannedFinishDate":"2025-05-16T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-DRYWALL-20"],"successors":["P1A-C1-TILE-10","P1A-C1-CABINETS-10"],"successorDetails":[{"taskCode":"P1A-C1-TILE-10","relationshipType":"FS","lag":0},{"taskCode":"P1A-C1-CABINETS-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":39,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-TILE-10","wbsCode":"TWNU07.8.8.3","activityName":"TILE FLOOR & WALL - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":10,"remainingDuration":10,"actualDuration":0,"baselineStartDate":"2025-05-08T08:00:00.000Z","baselineFinishDate":"2025-05-21T16:00:00.000Z","plannedStartDate":"2025-05-19T08:00:00.000Z","plannedFinishDate":"2025-05-30T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-INTPAINT-10"],"successors":["P1A-C1-FLOORING-10"],"successorDetails":[{"taskCode":"P1A-C1-FLOORING-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":40,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-CABINETS-10","wbsCode":"TWNU07.8.8.3","activityName":"CABINETS & MILLWORK - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":8,"remainingDuration":8,"actualDuration":0,"baselineStartDate":"2025-05-08T08:00:00.000Z","baselineFinishDate":"2025-05-19T16:00:00.000Z","plannedStartDate":"2025-05-19T08:00:00.000Z","plannedFinishDate":"2025-05-28T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":7,"freeFloat":2,"predecessors":["P1A-C1-INTPAINT-10"],"successors":["P1A-C1-COUNTERTOP-10"],"successorDetails":[{"taskCode":"P1A-C1-COUNTERTOP-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":41,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-FLOORING-10","wbsCode":"TWNU07.8.8.3","activityName":"LVP FLOORING - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":8,"remainingDuration":8,"actualDuration":0,"baselineStartDate":"2025-05-22T08:00:00.000Z","baselineFinishDate":"2025-06-02T16:00:00.000Z","plannedStartDate":"2025-06-02T08:00:00.000Z","plannedFinishDate":"2025-06-11T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-TILE-10"],"successors":["P1A-C1-TRIM-10"],"successorDetails":[{"taskCode":"P1A-C1-TRIM-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":42,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-COUNTERTOP-10","wbsCode":"TWNU07.8.8.3","activityName":"COUNTERTOPS - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":5,"remainingDuration":5,"actualDuration":0,"baselineStartDate":"2025-05-20T08:00:00.000Z","baselineFinishDate":"2025-05-26T16:00:00.000Z","plannedStartDate":"2025-05-29T08:00:00.000Z","plannedFinishDate":"2025-06-04T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":12,"freeFloat":5,"predecessors":["P1A-C1-CABINETS-10"],"successors":["P1A-C1-TRIM-10"],"successorDetails":[{"taskCode":"P1A-C1-TRIM-10","relationshipType":"FS","lag":3}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":43,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-TRIM-10","wbsCode":"TWNU07.8.8.3","activityName":"FINISH TRIM & HARDWARE - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":10,"remainingDuration":10,"actualDuration":0,"baselineStartDate":"2025-06-03T08:00:00.000Z","baselineFinishDate":"2025-06-16T16:00:00.000Z","plannedStartDate":"2025-06-12T08:00:00.000Z","plannedFinishDate":"2025-06-25T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-FLOORING-10","P1A-C1-COUNTERTOP-10"],"successors":["P1A-C1-INTPAINT-20"],"successorDetails":[{"taskCode":"P1A-C1-INTPAINT-20","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":44,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-INTPAINT-20","wbsCode":"TWNU07.8.8.3","activityName":"INTERIOR PAINT FINAL COAT - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":5,"remainingDuration":5,"actualDuration":0,"baselineStartDate":"2025-06-17T08:00:00.000Z","baselineFinishDate":"2025-06-23T16:00:00.000Z","plannedStartDate":"2025-06-26T08:00:00.000Z","plannedFinishDate":"2025-07-02T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-TRIM-10"],"successors":["P1A-C1-MEPFINAL-10"],"successorDetails":[{"taskCode":"P1A-C1-MEPFINAL-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":45,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-MEPFINAL-10","wbsCode":"TWNU07.8.8.3","activityName":"MEP TRIM & FINALS - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":7,"remainingDuration":7,"actualDuration":0,"baselineStartDate":"2025-06-24T08:00:00.000Z","baselineFinishDate":"2025-07-02T16:00:00.000Z","plannedStartDate":"2025-07-03T08:00:00.000Z","plannedFinishDate":"2025-07-11T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-INTPAINT-20"],"successors":["P1A-C1-CLEAN-10"],"successorDetails":[{"taskCode":"P1A-C1-CLEAN-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":46,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-C1-CLEAN-10","wbsCode":"TWNU07.8.8.3","activityName":"INTERIOR CLEAN & PUNCH - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":5,"remainingDuration":5,"actualDuration":0,"baselineStartDate":"2025-07-03T08:00:00.000Z","baselineFinishDate":"2025-07-09T16:00:00.000Z","plannedStartDate":"2025-07-14T08:00:00.000Z","plannedFinishDate":"2025-07-18T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":5,"freeFloat":0,"predecessors":["P1A-C1-MEPFINAL-10"],"successors":["P1A-FINAL-10"],"successorDetails":[{"taskCode":"P1A-FINAL-10","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":false,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":47,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-FINAL-10","wbsCode":"TWNU07.8.8.5","activityName":"FINAL INSPECTIONS - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":5,"remainingDuration":5,"actualDuration":0,"baselineStartDate":"2025-07-23T08:00:00.000Z","baselineFinishDate":"2025-07-29T16:00:00.000Z","plannedStartDate":"2025-08-01T08:00:00.000Z","plannedFinishDate":"2025-08-07T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-EXT-CLEAN-10","P1A-C1-CLEAN-10"],"successors":["P1A-FINAL-20"],"successorDetails":[{"taskCode":"P1A-FINAL-20","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":48,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-FINAL-20","wbsCode":"TWNU07.8.8.5","activityName":"TCO / CO - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":3,"remainingDuration":3,"actualDuration":0,"baselineStartDate":"2025-07-30T08:00:00.000Z","baselineFinishDate":"2025-08-01T16:00:00.000Z","plannedStartDate":"2025-08-08T08:00:00.000Z","plannedFinishDate":"2025-08-12T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-FINAL-10"],"successors":["P1A-FINAL-30"],"successorDetails":[{"taskCode":"P1A-FINAL-30","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":49,"projectCode":"TWNU07","importId":1,"taskCode":"P1A-FINAL-30","wbsCode":"TWNU07.8.8.5","activityName":"OWNER TURNOVER - PHASE 1A","activityType":"Task Dependent","status":"Not Started","originalDuration":2,"remainingDuration":2,"actualDuration":0,"baselineStartDate":"2025-08-04T08:00:00.000Z","baselineFinishDate":"2025-08-05T16:00:00.000Z","plannedStartDate":"2025-08-13T08:00:00.000Z","plannedFinishDate":"2025-08-14T16:00:00.000Z","actualStartDate":null,"actualFinishDate":null,"remainingFloat":-8,"freeFloat":0,"predecessors":["P1A-FINAL-20"],"successors":[],"successorDetails":[],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":0,"startVarianceDays":7,"finishVarianceDays":7,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"},{"id":50,"projectCode":"TWNU07","importId":1,"taskCode":"PERMIT-40","wbsCode":"TWNU07.8.8.1","activityName":"LAKE EXCAVATION PERMIT","activityType":"Task Dependent","status":"Completed","originalDuration":30,"remainingDuration":0,"actualDuration":30,"baselineStartDate":"2024-11-04T08:00:00.000Z","baselineFinishDate":"2024-12-16T16:00:00.000Z","plannedStartDate":"2024-11-04T08:00:00.000Z","plannedFinishDate":"2024-12-16T16:00:00.000Z","actualStartDate":"2024-11-04T08:00:00.000Z","actualFinishDate":"2024-12-16T16:00:00.000Z","remainingFloat":null,"freeFloat":null,"predecessors":["SM-NTP"],"successors":["SITEWORK-60"],"successorDetails":[{"taskCode":"SITEWORK-60","relationshipType":"FS","lag":0}],"resources":"","calendarName":"5D w/Hol 1222-1226","primaryConstraint":"","secondaryConstraint":"","isCritical":true,"percentComplete":100,"startVarianceDays":0,"finishVarianceDays":0,"deleteFlag":false,"createdDate":"2025-01-15T10:00:00.000Z","modifiedDate":"2025-01-15T10:00:00.000Z"}]'),scheduleImports_namespaceObject=JSON.parse('[{"id":1,"projectCode":"TWNU07","fileName":"TWNU07_Schedule_2025-01-15.csv","format":"P6-CSV","importDate":"2025-01-15T10:00:00.000Z","importedBy":"John Smith","activityCount":50,"notes":"Initial P6 schedule import"}]'),constraintLogs_namespaceObject=JSON.parse('[{"id":1,"projectCode":"HBC-2024-001","constraintNumber":1,"category":"Permits","description":"Building permit approval pending from City of West Palm Beach","status":"Open","assignedTo":"John Smith","dateIdentified":"2024-09-15","dueDate":"2024-11-01","reference":"BP-2024-4521","budgetImpactCost":0,"comments":"Submitted 9/15, awaiting plan review comments"},{"id":2,"projectCode":"HBC-2024-001","constraintNumber":2,"category":"AHJ Coordination","description":"Fire marshal review for sprinkler system design","status":"Open","assignedTo":"Mike Johnson","dateIdentified":"2024-09-20","dueDate":"2024-10-15","reference":"FM-REV-2024-089","budgetImpactCost":15000,"comments":"Requires revised hydraulic calculations"},{"id":3,"projectCode":"HBC-2024-001","constraintNumber":3,"category":"Material Procurement","description":"Structural steel delivery delayed â€” rolling mill backlog","status":"Open","assignedTo":"Sarah Davis","dateIdentified":"2024-10-01","dueDate":"2024-12-01","reference":"PO-2024-0312","budgetImpactCost":45000,"comments":"Expediting fee may apply; evaluating alternate suppliers"},{"id":4,"projectCode":"HBC-2024-001","constraintNumber":4,"category":"Utility Coordination","description":"FPL transformer installation coordination","status":"Closed","assignedTo":"Tom Wilson","dateIdentified":"2024-08-01","dueDate":"2024-09-30","dateClosed":"2024-09-28","reference":"FPL-WO-88421","budgetImpactCost":0,"comments":"Completed on schedule"},{"id":5,"projectCode":"HBC-2024-001","constraintNumber":5,"category":"Owner Decisions","description":"Owner pending decision on lobby finish materials","status":"Open","assignedTo":"Lisa Chen","dateIdentified":"2024-10-10","dueDate":"2024-10-25","budgetImpactCost":85000,"comments":"Three options presented; owner reviewing with interior designer"},{"id":6,"projectCode":"HBC-2024-001","constraintNumber":6,"category":"Design Completion","description":"MEP coordination drawings incomplete for floors 3-5","status":"Open","assignedTo":"Robert Garcia","dateIdentified":"2024-10-05","dueDate":"2024-11-15","reference":"RFI-2024-045","budgetImpactCost":0,"comments":"Engineer of record reviewing clash detection report"},{"id":7,"projectCode":"HBC-2024-001","constraintNumber":7,"category":"Environmental","description":"Dewatering permit required for foundation excavation","status":"Closed","assignedTo":"Tom Wilson","dateIdentified":"2024-07-15","dueDate":"2024-08-30","dateClosed":"2024-08-25","reference":"SFWMD-2024-1122","budgetImpactCost":12000,"comments":"Permit obtained; dewatering system installed"},{"id":8,"projectCode":"HBC-2024-001","constraintNumber":8,"category":"Subcontractor Mobilization","description":"Mechanical subcontractor delayed mobilization â€” workforce shortage","status":"Open","assignedTo":"Sarah Davis","dateIdentified":"2024-10-12","dueDate":"2024-11-01","budgetImpactCost":25000,"comments":"Exploring acceleration options; backup sub identified"},{"id":9,"projectCode":"HBC-2024-002","constraintNumber":1,"category":"Permits","description":"Zoning variance approval for parking structure height","status":"Open","assignedTo":"Amanda Brown","dateIdentified":"2024-09-01","dueDate":"2024-11-30","reference":"ZV-2024-0088","budgetImpactCost":0,"comments":"Hearing scheduled for November"},{"id":10,"projectCode":"HBC-2024-002","constraintNumber":2,"category":"Site Access","description":"Temporary road closure permit for crane mobilization","status":"Closed","assignedTo":"James Taylor","dateIdentified":"2024-08-15","dueDate":"2024-09-15","dateClosed":"2024-09-10","reference":"RC-2024-0556","budgetImpactCost":5000,"comments":"Permit granted; crane mobilized successfully"},{"id":11,"projectCode":"HBC-2024-002","constraintNumber":3,"category":"Material Procurement","description":"Custom curtain wall panels â€” extended lead time","status":"Open","assignedTo":"Amanda Brown","dateIdentified":"2024-10-01","dueDate":"2025-01-15","reference":"PO-2024-0445","budgetImpactCost":120000,"comments":"16-week lead time from manufacturer; shop drawings under review"},{"id":12,"projectCode":"HBC-2024-002","constraintNumber":4,"category":"AHJ Coordination","description":"FDOT right-of-way encroachment review","status":"Closed","assignedTo":"James Taylor","dateIdentified":"2024-07-20","dueDate":"2024-09-20","dateClosed":"2024-09-18","reference":"FDOT-ROW-2024-331","budgetImpactCost":8000,"comments":"Approval received with conditions"}]'),permits_namespaceObject=JSON.parse('[{"id":1,"projectCode":"HBC-2024-001","refNumber":"1","location":"Site","type":"PRIMARY","permitNumber":"B-2024-031340-0000","description":"Master Building Permit","responsibleContractor":"Hedrick Brothers Construction","address":"100 E Boynton Beach Blvd","dateRequired":"2024-06-15","dateSubmitted":"2024-06-10","dateReceived":"2024-07-20","dateExpires":"2025-07-20","status":"Active","ahj":"PBC Building","comments":"Master permit for full site development"},{"id":2,"projectCode":"HBC-2024-001","refNumber":"02E","parentRefNumber":"1","location":"Building","type":"SUB","permitNumber":"E-2024-031340-0001","description":"Electrical â€” Main Service & Distribution","responsibleContractor":"PowerTech Electric Inc.","address":"100 E Boynton Beach Blvd","dateRequired":"2024-07-01","dateSubmitted":"2024-07-15","dateReceived":"2024-08-20","dateExpires":"2025-08-20","status":"Active","ahj":"PBC Building","comments":"Includes main switchgear and panel schedules"},{"id":3,"projectCode":"HBC-2024-001","refNumber":"02P","parentRefNumber":"1","location":"Building","type":"SUB","permitNumber":"P-2024-031340-0002","description":"Plumbing â€” Domestic Water & Sanitary","responsibleContractor":"AllFlow Plumbing LLC","address":"100 E Boynton Beach Blvd","dateRequired":"2024-07-01","dateSubmitted":"2024-07-18","dateReceived":"2024-08-25","dateExpires":"2025-08-25","status":"Active","ahj":"PBC Building"},{"id":4,"projectCode":"HBC-2024-001","refNumber":"02M","parentRefNumber":"1","location":"Building","type":"SUB","permitNumber":"M-2024-031340-0003","description":"Mechanical â€” HVAC Systems","responsibleContractor":"CoolAir Mechanical Corp.","address":"100 E Boynton Beach Blvd","dateRequired":"2024-07-15","dateSubmitted":"2024-07-22","dateReceived":"2024-09-01","dateExpires":"2025-09-01","status":"Active","ahj":"PBC Building"},{"id":5,"projectCode":"HBC-2024-001","refNumber":"3","location":"Site","type":"PRIMARY","permitNumber":"B-2024-032100-0000","description":"Site Work â€” Grading, Paving & Utilities","responsibleContractor":"Hedrick Brothers Construction","address":"100 E Boynton Beach Blvd","dateRequired":"2024-05-01","dateSubmitted":"2024-04-28","dateReceived":"2024-06-05","dateExpires":"2025-06-05","status":"Active","ahj":"PBC Building","comments":"Includes earthwork, paving, storm drainage"},{"id":6,"projectCode":"HBC-2024-001","refNumber":"4","location":"Site","type":"PRIMARY","permitNumber":"Not Issued","description":"Water & Sewer Connection","responsibleContractor":"AllFlow Plumbing LLC","address":"100 E Boynton Beach Blvd","dateRequired":"2024-08-01","dateSubmitted":"2024-07-25","status":"Pending Application","ahj":"PBCWUD","comments":"Awaiting utility review â€” 6-8 week timeline"},{"id":7,"projectCode":"HBC-2024-001","refNumber":"5","location":"Building","type":"PRIMARY","permitNumber":"B-2024-033200-0000","description":"Fire Alarm System","responsibleContractor":"Guardian Fire Protection","address":"100 E Boynton Beach Blvd","dateRequired":"2024-08-15","dateSubmitted":"2024-08-12","dateReceived":"2024-09-18","dateExpires":"2025-09-18","status":"Active","ahj":"PBC Building"},{"id":8,"projectCode":"HBC-2024-001","refNumber":"05FA","parentRefNumber":"5","location":"Building","type":"SUB","permitNumber":"FA-2024-033200-0001","description":"Fire Alarm â€” Notification Appliances","responsibleContractor":"Guardian Fire Protection","address":"100 E Boynton Beach Blvd","dateRequired":"2024-09-01","dateSubmitted":"2024-09-05","status":"Pending Revision","ahj":"PBC Building","comments":"Returned for revised NAC circuit calculations"},{"id":9,"projectCode":"HBC-2024-001","refNumber":"6","location":"Pool","type":"PRIMARY","permitNumber":"B-2024-034500-0000","description":"Swimming Pool & Deck","responsibleContractor":"AquaBuild Pools Inc.","address":"100 E Boynton Beach Blvd","dateRequired":"2024-09-01","dateSubmitted":"2024-08-28","dateReceived":"2024-10-10","dateExpires":"2025-10-10","status":"Active","ahj":"PBC Building"},{"id":10,"projectCode":"HBC-2024-001","refNumber":"7","location":"Site","type":"PRIMARY","permitNumber":"ROW-2024-0891","description":"Right-of-Way Permit â€” Temporary Road Closure","responsibleContractor":"Hedrick Brothers Construction","address":"100 E Boynton Beach Blvd","dateRequired":"2024-06-01","dateSubmitted":"2024-05-20","dateReceived":"2024-06-01","dateExpires":"2024-12-31","status":"Active","ahj":"City of Boynton Beach","comments":"Lane closure on Boynton Beach Blvd for crane operations"},{"id":11,"projectCode":"HBC-2024-001","refNumber":"T1","location":"Site","type":"TEMP","permitNumber":"TCP-2024-00445","description":"Temporary Construction Power","responsibleContractor":"PowerTech Electric Inc.","address":"100 E Boynton Beach Blvd","dateRequired":"2024-05-15","dateSubmitted":"2024-05-10","dateReceived":"2024-05-20","dateExpires":"2025-05-20","status":"Active","ahj":"PBC Building"},{"id":12,"projectCode":"HBC-2024-001","refNumber":"T2","location":"Site","type":"TEMP","permitNumber":"TCP-2024-00512","description":"Temporary Water Service","responsibleContractor":"AllFlow Plumbing LLC","address":"100 E Boynton Beach Blvd","dateRequired":"2024-05-15","dateSubmitted":"2024-05-12","dateReceived":"2024-05-22","dateExpires":"2025-05-22","status":"Active","ahj":"PBCWUD"},{"id":13,"projectCode":"HBC-2024-001","refNumber":"16FA","parentRefNumber":"5","location":"Building","type":"SUB","permitNumber":"Not Issued","description":"Fire Sprinkler â€” Standpipe System","responsibleContractor":"Guardian Fire Protection","address":"100 E Boynton Beach Blvd","dateRequired":"2024-10-01","status":"Pending Application","ahj":"PBC Building","comments":"Drawings under review by engineer"},{"id":14,"projectCode":"HBC-2024-001","refNumber":"8","location":"Building","type":"PRIMARY","permitNumber":"V-2024-0001","description":"Elevator Installation","responsibleContractor":"ThyssenKrupp Elevator","address":"100 E Boynton Beach Blvd","dateRequired":"2024-10-15","dateSubmitted":"2024-10-10","dateReceived":"2024-11-15","dateExpires":"2025-11-15","status":"Active","ahj":"PBC Building"},{"id":15,"projectCode":"HBC-2024-001","refNumber":"9","location":"Site","type":"PRIMARY","permitNumber":"VOID-2024-0088","description":"Demolition Permit â€” Existing Structures","responsibleContractor":"Hedrick Brothers Construction","address":"100 E Boynton Beach Blvd","dateRequired":"2024-04-01","dateSubmitted":"2024-03-25","dateReceived":"2024-04-15","status":"VOID","ahj":"PBC Building","comments":"Voided â€” scope revised to renovation instead of demo"},{"id":16,"projectCode":"25-042-01","refNumber":"1","location":"Site","type":"PRIMARY","permitNumber":"B-2025-010200-0000","description":"Master Building Permit","responsibleContractor":"Hedrick Brothers Construction","address":"500 N Federal Hwy, Boca Raton","dateRequired":"2025-01-15","dateSubmitted":"2025-01-10","dateReceived":"2025-02-20","dateExpires":"2026-02-20","status":"Active","ahj":"City of Boca Raton"},{"id":17,"projectCode":"25-042-01","refNumber":"01E","parentRefNumber":"1","location":"Building","type":"SUB","permitNumber":"E-2025-010200-0001","description":"Electrical â€” Main Distribution","responsibleContractor":"PowerTech Electric Inc.","address":"500 N Federal Hwy, Boca Raton","dateRequired":"2025-02-01","dateSubmitted":"2025-02-05","dateReceived":"2025-03-10","dateExpires":"2026-03-10","status":"Active","ahj":"City of Boca Raton"},{"id":18,"projectCode":"25-042-01","refNumber":"2","location":"Site","type":"PRIMARY","permitNumber":"Not Issued","description":"Environmental â€” Dewatering Permit","responsibleContractor":"Hedrick Brothers Construction","address":"500 N Federal Hwy, Boca Raton","dateRequired":"2025-03-01","dateSubmitted":"2025-02-15","status":"Pending Application","ahj":"SFWMD","comments":"Awaiting SFWMD review; 8-10 week processing"},{"id":19,"projectCode":"25-042-01","refNumber":"T1","location":"Site","type":"TEMP","permitNumber":"TCP-2025-00102","description":"Temporary Construction Fence","responsibleContractor":"Hedrick Brothers Construction","address":"500 N Federal Hwy, Boca Raton","dateRequired":"2025-01-01","dateSubmitted":"2024-12-20","dateReceived":"2025-01-05","dateExpires":"2026-01-05","status":"Active","ahj":"City of Boca Raton"},{"id":20,"projectCode":"25-042-01","refNumber":"3","location":"Building","type":"PRIMARY","permitNumber":"Not Issued","description":"Interior Build-Out â€” Floors 1-3","responsibleContractor":"Hedrick Brothers Construction","address":"500 N Federal Hwy, Boca Raton","dateRequired":"2025-04-01","status":"Inactive","ahj":"City of Boca Raton","comments":"On hold pending owner design decisions"}]'),templateSiteConfig_namespaceObject=JSON.parse('{"id":1,"TemplateSiteUrl":"https://hedrickbrotherscom.sharepoint.com/sites/HBC-Templates","LastSnapshotHash":"sha256:initial-baseline-hash","LastSnapshotDate":"2026-01-01T00:00:00Z","GitHubRepoOwner":"RMF112018","GitHubRepoName":"Project-Controls","GitHubBranch":"main","Active":true}');var templateRegistry=__webpack_require__("./packages/hbc-sp-services/src/mock/templateRegistry.json");const TEMPLATE_ITEMS=[{section:"managing",task:"Finalize Subcontractor Bid List in BC"},{section:"managing",task:"Send ITB to Subcontractors"},{section:"managing",task:"Phone Calls to improve Sub coverage"},{section:"managing",task:"Send Mass Messages in Building Connected to improve Sub coverage"},{section:"managing",task:"Complete Scope Sheets"},{section:"managing",task:"RFI Management (Point Person)"},{section:"managing",task:"Invite Project Team to Procore"},{section:"managing",task:"Request Bid Bond from CFO"},{section:"managing",task:"Request CCIP proposal from CFO"},{section:"managing",task:"Request financials from CFO"},{section:"managing",task:"AIA Contract Review by Legal"},{section:"managing",task:"Are there bid forms to be used?"},{section:"managing",task:"Submit/obtain Builders Risk Insurance Quote"},{section:"managing",task:"Review other ITB Requirements (Self Performance, SBE, etc.)"},{section:"managing",task:"Add Warranty line item?"},{section:"managing",task:"Milestone Schedule"},{section:"managing",task:"Detailed Precon Schedule"},{section:"managing",task:"Detailed Project Schedule"},{section:"managing",task:"Site Logistics Plan"},{section:"managing",task:"BIM Modeling or Scanning"},{section:"managing",task:"Request Revit Files from Owner/Architect"},{section:"managing",task:"Assemble Closure Document Books"},{section:"managing",task:"Submit Permit and NOC"},{section:"deliverables_standard",task:"Front Cover",tabRequired:!0},{section:"deliverables_standard",task:"Executive Summary",tabRequired:!0},{section:"deliverables_standard",task:"Cost Summary",tabRequired:!0},{section:"deliverables_standard",task:"Detailed GC/GC Breakdown (optional)"},{section:"deliverables_standard",task:"Detailed COW Breakdown (optional)"},{section:"deliverables_standard",task:"List of Allowances",tabRequired:!0},{section:"deliverables_standard",task:"Clarifications and Assumptions",tabRequired:!0},{section:"deliverables_standard",task:"Value Analysis log",tabRequired:!0},{section:"deliverables_standard",task:"Schedule",tabRequired:!0},{section:"deliverables_standard",task:"Logistics Plan",tabRequired:!0},{section:"deliverables_standard",task:"List of Documents",tabRequired:!0},{section:"deliverables_standard",task:"Team Organization Chart and Resumes"},{section:"deliverables_standard",task:"Previous Experience"},{section:"deliverables_standard",task:"By Who List"},{section:"deliverables_standard",task:"Back Cover",tabRequired:!0},{section:"deliverables_nonstandard",task:"Financials"},{section:"deliverables_nonstandard",task:"GC License"},{section:"deliverables_nonstandard",task:"BIM"},{section:"deliverables_nonstandard",task:"Contract"},{section:"deliverables_nonstandard",task:"Bid Bond"},{section:"deliverables_nonstandard",task:"Business Terms"},{section:"deliverables_nonstandard",task:"Other",isCustom:!0},{section:"deliverables_nonstandard",task:"Other",isCustom:!0},{section:"deliverables_nonstandard",task:"Other",isCustom:!0}],createEstimatingKickoffTemplate=()=>{let nextId=1;return TEMPLATE_ITEMS.map((entry,index)=>{var _a;return{id:nextId++,section:entry.section,task:entry.task,status:null,responsibleParty:"",deadline:"",frequency:"",notes:"",tabRequired:entry.tabRequired,isCustom:null!==(_a=entry.isCustom)&&void 0!==_a&&_a,sortOrder:index+1}})},STANDARD_BUYOUT_DIVISIONS=[{divisionCode:"02-300",divisionDescription:"Staking"},{divisionCode:"02-310",divisionDescription:"Site Clearing"},{divisionCode:"02-320",divisionDescription:"Earthwork"},{divisionCode:"03-100",divisionDescription:"Concrete Formwork"},{divisionCode:"03-200",divisionDescription:"Concrete Reinforcement"},{divisionCode:"03-300",divisionDescription:"Cast-in-Place Concrete"},{divisionCode:"05-120",divisionDescription:"Structural Steel"},{divisionCode:"05-500",divisionDescription:"Metal Fabrications"},{divisionCode:"07-200",divisionDescription:"Thermal Insulation"},{divisionCode:"07-400",divisionDescription:"Roofing"},{divisionCode:"08-100",divisionDescription:"Doors & Frames"},{divisionCode:"09-200",divisionDescription:"Plaster & Gypsum Board"},{divisionCode:"15-000",divisionDescription:"Mechanical / HVAC"},{divisionCode:"16-000",divisionDescription:"Electrical"}],TOOL_DEFINITIONS=[{toolKey:"marketing_dashboard",toolGroup:"marketing",label:"Marketing Dashboard",description:"Marketing dashboard and reporting",levels:{NONE:[],READ_ONLY:["marketing:dashboard:view"],STANDARD:["marketing:dashboard:view","marketing:edit"],ADMIN:["marketing:dashboard:view","marketing:edit"]},granularFlags:[]},{toolKey:"project_record",toolGroup:"marketing",label:"Marketing Project Record",description:"Project record management for marketing team",levels:{NONE:[],READ_ONLY:["projectrecord:edit"],STANDARD:["projectrecord:edit","projectrecord:ops:edit"],ADMIN:["projectrecord:edit","projectrecord:ops:edit"]},granularFlags:[]},{toolKey:"leads",toolGroup:"preconstruction",label:"Lead Management",description:"Create, edit, and manage project leads",levels:{NONE:[],READ_ONLY:["lead:read"],STANDARD:["lead:read","lead:edit","lead:create"],ADMIN:["lead:read","lead:edit","lead:create","lead:delete"]},granularFlags:[{key:"can_delete_leads",label:"Delete Leads",description:"Allow deleting leads from the system",permissions:["lead:delete"]},{key:"can_decide_gonogo",label:"Go/No-Go Decision",description:"Allow making Go/No-Go final decisions",permissions:["gonogo:decide"]}]},{toolKey:"gonogo",toolGroup:"preconstruction",label:"Go/No-Go Scorecard",description:"Score and evaluate project opportunities",levels:{NONE:[],READ_ONLY:["gonogo:read"],STANDARD:["gonogo:read","gonogo:score:originator","gonogo:submit"],ADMIN:["gonogo:read","gonogo:score:originator","gonogo:score:committee","gonogo:submit","gonogo:decide"]},granularFlags:[{key:"can_score_committee",label:"Committee Scoring",description:"Allow entering committee scores",permissions:["gonogo:score:committee"]}]},{toolKey:"estimating",toolGroup:"preconstruction",label:"Estimating Tracker",description:"Track estimating activities and pursuits",levels:{NONE:[],READ_ONLY:["estimating:read","precon:read"],STANDARD:["estimating:read","estimating:edit","precon:read","precon:edit"],ADMIN:["estimating:read","estimating:edit","precon:read","precon:edit","precon:hub:view"]},granularFlags:[]},{toolKey:"pipeline",toolGroup:"preconstruction",label:"Pipeline Dashboard",description:"Pipeline visualization and reporting",levels:{NONE:[],READ_ONLY:["precon:read"],STANDARD:["precon:read","precon:hub:view"],ADMIN:["precon:read","precon:hub:view"]},granularFlags:[]},{toolKey:"kickoff",toolGroup:"preconstruction",label:"Estimating Kick-Off",description:"Estimating kick-off checklists and meetings",levels:{NONE:[],READ_ONLY:["kickoff:view"],STANDARD:["kickoff:view","kickoff:edit"],ADMIN:["kickoff:view","kickoff:edit","kickoff:template:edit"]},granularFlags:[]},{toolKey:"autopsy",toolGroup:"preconstruction",label:"Post-Bid Autopsy",description:"Loss analysis and post-bid review",levels:{NONE:[],READ_ONLY:["autopsy:view"],STANDARD:["autopsy:view","autopsy:edit"],ADMIN:["autopsy:view","autopsy:edit","autopsy:schedule"]},granularFlags:[]},{toolKey:"job_number",toolGroup:"preconstruction",label:"Job Number Request",description:"Request and manage job numbers",levels:{NONE:[],READ_ONLY:[],STANDARD:["job_number_request:create"],ADMIN:["job_number_request:create","job_number_request:finalize"]},granularFlags:[]},{toolKey:"accounting_queue",toolGroup:"preconstruction",label:"Accounting Queue",description:"Job number finalization and accounting queue",levels:{NONE:[],READ_ONLY:["accounting_queue:view"],STANDARD:["accounting_queue:view","job_number_request:finalize"],ADMIN:["accounting_queue:view","job_number_request:finalize"]},granularFlags:[]},{toolKey:"active_projects",toolGroup:"operations",label:"Active Projects",description:"Active project portfolio dashboard",levels:{NONE:[],READ_ONLY:["active_projects:view"],STANDARD:["active_projects:view"],ADMIN:["active_projects:view","active_projects:sync"]},granularFlags:[]},{toolKey:"startup_checklist",toolGroup:"operations",label:"Startup Checklist",description:"Project startup checklist management",levels:{NONE:[],READ_ONLY:[],STANDARD:["startup:checklist:edit"],ADMIN:["startup:checklist:edit","startup:checklist:signoff"]},granularFlags:[]},{toolKey:"pmp",toolGroup:"operations",label:"Management Plan",description:"Project Management Plan (PMP) lifecycle",levels:{NONE:[],READ_ONLY:[],STANDARD:["pmp:edit","pmp:sign"],ADMIN:["pmp:edit","pmp:approve","pmp:final:approve","pmp:sign"]},granularFlags:[{key:"can_final_approve",label:"Final Approve",description:"Allow final PMP approval",permissions:["pmp:final:approve"]},{key:"can_bypass_signatures",label:"Bypass Signatures",description:"Allow bypassing signature requirements",permissions:[]}]},{toolKey:"superintendent_plan",toolGroup:"operations",label:"Superintendent's Plan",description:"Superintendent's project execution plan",levels:{NONE:[],READ_ONLY:[],STANDARD:["superintendent:plan:edit"],ADMIN:["superintendent:plan:edit"]},granularFlags:[]},{toolKey:"responsibility_matrices",toolGroup:"operations",label:"Responsibility Matrices",description:"Internal, owner contract, and sub-contract matrices",levels:{NONE:[],READ_ONLY:[],STANDARD:["matrix:edit"],ADMIN:["matrix:edit"]},granularFlags:[]},{toolKey:"buyout_log",toolGroup:"operations",label:"Buyout Log & Commitments",description:"Buyout tracking and commitment approval workflow",levels:{NONE:[],READ_ONLY:["buyout:view"],STANDARD:["buyout:view","buyout:edit","commitment:submit"],ADMIN:["buyout:view","buyout:edit","buyout:manage","commitment:submit","commitment:approve:px","commitment:approve:cfo","commitment:escalate"]},granularFlags:[{key:"can_bypass_workflow",label:"Bypass Approval",description:"Allow bypassing commitment approval workflow",permissions:[]},{key:"can_edit_closed_items",label:"Edit Closed",description:"Allow editing closed buyout items",permissions:[]},{key:"can_approve_compliance",label:"Compliance Approval",description:"Allow compliance review approval",permissions:["commitment:approve:compliance"]}]},{toolKey:"risk_cost",toolGroup:"operations",label:"Risk & Cost",description:"Risk and cost management tracking",levels:{NONE:[],READ_ONLY:[],STANDARD:["risk:edit"],ADMIN:["risk:edit"]},granularFlags:[]},{toolKey:"quality_safety",toolGroup:"operations",label:"Quality & Safety",description:"Quality concerns and safety tracking",levels:{NONE:[],READ_ONLY:[],STANDARD:["quality:edit","safety:edit"],ADMIN:["quality:edit","safety:edit"]},granularFlags:[]},{toolKey:"schedule",toolGroup:"operations",label:"Project Schedule",description:"Project schedule and critical path management",levels:{NONE:[],READ_ONLY:[],STANDARD:["schedule:edit"],ADMIN:["schedule:edit"]},granularFlags:[]},{toolKey:"monthly_review",toolGroup:"operations",label:"Monthly Review",description:"Monthly project review workflow",levels:{NONE:[],READ_ONLY:[],STANDARD:["monthly:review:pm"],ADMIN:["monthly:review:pm","monthly:review:px","monthly:review:create"]},granularFlags:[{key:"can_create_reviews",label:"Create Reviews",description:"Allow creating new monthly reviews",permissions:["monthly:review:create"]}]},{toolKey:"lessons_learned",toolGroup:"operations",label:"Lessons Learned",description:"Project lessons learned documentation",levels:{NONE:[],READ_ONLY:[],STANDARD:["lessons:edit"],ADMIN:["lessons:edit"]},granularFlags:[]},{toolKey:"admin_panel",toolGroup:"admin",label:"Admin Panel",description:"System administration and configuration",levels:{NONE:[],READ_ONLY:["admin:config"],STANDARD:["admin:config","admin:flags"],ADMIN:["admin:roles","admin:flags","admin:config","admin:connections","admin:provisioning","permission:templates:manage","permission:project_team:manage"]},granularFlags:[{key:"can_manage_provisioning",label:"Manage Provisioning",description:"Allow managing site provisioning",permissions:["admin:provisioning"]}]},{toolKey:"workflow_definitions",toolGroup:"admin",label:"Workflow Definitions",description:"Workflow definition and approval chain configuration",levels:{NONE:[],READ_ONLY:[],STANDARD:["workflow:manage"],ADMIN:["workflow:manage"]},granularFlags:[]}];function resolveToolPermissions(toolAccess,toolDefinitions=TOOL_DEFINITIONS){const permissions=new Set;for(const access of toolAccess){const def=toolDefinitions.find(t=>t.toolKey===access.toolKey);if(!def)continue;const levelPerms=def.levels[access.level]||[];for(const p of levelPerms)permissions.add(p);if(access.granularFlags)for(const flagKey of access.granularFlags){const flagDef=def.granularFlags.find(f=>f.key===flagKey);if(flagDef)for(const p of flagDef.permissions)permissions.add(p)}}return permissions.add("meeting:read"),permissions.add("precon:read"),permissions.add("proposal:read"),permissions.add("winloss:read"),permissions.add("contract:read"),permissions.add("turnover:read"),permissions.add("closeout:read"),Array.from(permissions)}const workflowDefinitions_namespaceObject=JSON.parse('[{"id":1,"workflowKey":"GO_NO_GO","name":"Go/No-Go Decision","description":"Approval chain for evaluating whether to pursue a lead opportunity.","isActive":true,"lastModifiedBy":"Mike Hedrick","lastModifiedDate":"2026-01-15T10:00:00.000Z","steps":[{"id":1,"workflowId":1,"stepOrder":1,"name":"BD Rep Submits","description":"Business Development representative submits the lead for Go/No-Go evaluation.","assignmentType":"ProjectRole","projectRole":"BD Representative","conditionalAssignees":[],"isConditional":false,"actionLabel":"Submit for Evaluation","canChairMeeting":false},{"id":2,"workflowId":1,"stepOrder":2,"name":"Precon Director Review","description":"Preconstruction Director reviews the submission and prepares for committee meeting.","assignmentType":"NamedPerson","defaultAssignee":{"userId":"12","displayName":"David Park","email":"dpark@hedrickbrothers.com"},"conditionalAssignees":[],"isConditional":false,"actionLabel":"Review & Schedule Meeting","canChairMeeting":true,"featureFlagName":"MeetingScheduler","isSkippable":true},{"id":3,"workflowId":1,"stepOrder":3,"name":"Committee Scoring Meeting","description":"Go/No-Go committee meets to score and decide on the opportunity.","assignmentType":"NamedPerson","defaultAssignee":{"userId":"12","displayName":"David Park","email":"dpark@hedrickbrothers.com"},"conditionalAssignees":[],"isConditional":false,"actionLabel":"Score & Decide","canChairMeeting":true}]},{"id":2,"workflowKey":"PMP_APPROVAL","name":"PMP Approval","description":"Approval chain for the Project Management Plan review and sign-off.","isActive":true,"lastModifiedBy":"Mike Hedrick","lastModifiedDate":"2026-01-15T10:00:00.000Z","steps":[{"id":4,"workflowId":2,"stepOrder":1,"name":"PM Prepares","description":"Project Manager prepares the PMP document and collects startup signatures.","assignmentType":"ProjectRole","projectRole":"Operations Team","conditionalAssignees":[],"isConditional":false,"actionLabel":"Submit for Review","canChairMeeting":false},{"id":5,"workflowId":2,"stepOrder":2,"name":"PX Review","description":"Project Executive reviews the PMP and provides feedback.","assignmentType":"ProjectRole","projectRole":"Executive Leadership","conditionalAssignees":[],"isConditional":false,"actionLabel":"Approve or Return","canChairMeeting":false},{"id":6,"workflowId":2,"stepOrder":3,"name":"Division Head Approval","description":"Division head provides final approval based on project division.","assignmentType":"NamedPerson","defaultAssignee":{"userId":"1","displayName":"Mike Hedrick","email":"mhedrick@hedrickbrothers.com"},"conditionalAssignees":[{"id":1,"stepId":6,"conditions":[{"field":"Division","operator":"equals","value":"Commercial"}],"assignee":{"userId":"1","displayName":"Mike Hedrick","email":"mhedrick@hedrickbrothers.com"},"priority":1},{"id":2,"stepId":6,"conditions":[{"field":"Division","operator":"equals","value":"Luxury Residential"}],"assignee":{"userId":"2","displayName":"Tom Hedrick","email":"thedrick@hedrickbrothers.com"},"priority":2}],"isConditional":true,"conditionDescription":"Assigned based on project Division","actionLabel":"Final Approve","canChairMeeting":false}]},{"id":3,"workflowKey":"MONTHLY_REVIEW","name":"Monthly Project Review","description":"Monthly review cycle for project health assessment and leadership reporting.","isActive":true,"lastModifiedBy":"Mike Hedrick","lastModifiedDate":"2026-01-15T10:00:00.000Z","steps":[{"id":7,"workflowId":3,"stepOrder":1,"name":"Director Initiates","description":"Director initiates the monthly review cycle and sends notifications.","assignmentType":"NamedPerson","defaultAssignee":{"userId":"12","displayName":"David Park","email":"dpark@hedrickbrothers.com"},"conditionalAssignees":[],"isConditional":false,"actionLabel":"Initiate Review","canChairMeeting":false},{"id":8,"workflowId":3,"stepOrder":2,"name":"PM Compiles","description":"Project Manager compiles project data and completes checklist items.","assignmentType":"ProjectRole","projectRole":"Operations Team","conditionalAssignees":[],"isConditional":false,"actionLabel":"Submit to PX","canChairMeeting":false},{"id":9,"workflowId":3,"stepOrder":3,"name":"PX Reviews","description":"Project Executive reviews PM submissions and adds PX comments.","assignmentType":"ProjectRole","projectRole":"Executive Leadership","conditionalAssignees":[],"isConditional":false,"actionLabel":"Approve or Return","canChairMeeting":false},{"id":10,"workflowId":3,"stepOrder":4,"name":"Leadership Meeting","description":"Director presents monthly review summary to leadership team.","assignmentType":"NamedPerson","defaultAssignee":{"userId":"12","displayName":"David Park","email":"dpark@hedrickbrothers.com"},"conditionalAssignees":[],"isConditional":false,"actionLabel":"Present to Leadership","canChairMeeting":true}]},{"id":4,"workflowKey":"COMMITMENT_APPROVAL","name":"Commitment Approval","description":"Risk-based approval chain for subcontractor commitments and buyout entries.","isActive":true,"lastModifiedBy":"Mike Hedrick","lastModifiedDate":"2026-01-15T10:00:00.000Z","steps":[{"id":11,"workflowId":4,"stepOrder":1,"name":"PM Submits","description":"Project Manager submits the commitment for approval.","assignmentType":"ProjectRole","projectRole":"Operations Team","conditionalAssignees":[],"isConditional":false,"actionLabel":"Submit for Approval","canChairMeeting":false},{"id":12,"workflowId":4,"stepOrder":2,"name":"PX Approval","description":"Project Executive reviews and approves the commitment.","assignmentType":"ProjectRole","projectRole":"Executive Leadership","conditionalAssignees":[],"isConditional":false,"actionLabel":"Approve or Reject","canChairMeeting":false},{"id":13,"workflowId":4,"stepOrder":3,"name":"Compliance Review","description":"Compliance manager reviews if compliance flags are triggered.","assignmentType":"NamedPerson","defaultAssignee":{"userId":"15","displayName":"Jennifer Adams","email":"jadams@hedrickbrothers.com"},"conditionalAssignees":[],"isConditional":true,"conditionDescription":"Only if compliance flagged (e.g., missing E-Verify, bond waiver)","actionLabel":"Review Compliance","canChairMeeting":false},{"id":14,"workflowId":4,"stepOrder":4,"name":"CFO Approval","description":"CFO reviews commitments exceeding $250K threshold.","assignmentType":"NamedPerson","defaultAssignee":{"userId":"1","displayName":"Mike Hedrick","email":"mhedrick@hedrickbrothers.com"},"conditionalAssignees":[],"isConditional":true,"conditionDescription":"Only if commitment exceeds $250K","actionLabel":"Final Approve","canChairMeeting":false}]},{"id":5,"workflowKey":"TURNOVER_APPROVAL","name":"Turnover to Operations","description":"Signature chain for the estimating-to-operations turnover meeting agenda.","isActive":true,"lastModifiedBy":"Mike Hedrick","lastModifiedDate":"2026-02-09T10:00:00.000Z","steps":[{"id":15,"workflowId":5,"stepOrder":1,"name":"Lead Estimator Signs","description":"Lead Estimator certifies the accuracy of the estimate and turnover package.","assignmentType":"ProjectRole","projectRole":"Estimating Coordinator","conditionalAssignees":[],"isConditional":false,"actionLabel":"Sign as Lead Estimator","canChairMeeting":false},{"id":16,"workflowId":5,"stepOrder":2,"name":"Project Executive Signs","description":"Project Executive reviews and signs the turnover package.","assignmentType":"ProjectRole","projectRole":"Executive Leadership","conditionalAssignees":[],"isConditional":false,"actionLabel":"Sign as Project Executive","canChairMeeting":false},{"id":17,"workflowId":5,"stepOrder":3,"name":"Project Manager Signs","description":"Project Manager accepts the turnover and confirms readiness to execute.","assignmentType":"ProjectRole","projectRole":"Operations Team","conditionalAssignees":[],"isConditional":false,"actionLabel":"Sign as Project Manager","canChairMeeting":false},{"id":18,"workflowId":5,"stepOrder":4,"name":"Superintendent Signs","description":"Superintendent confirms field readiness and site logistics review.","assignmentType":"ProjectRole","projectRole":"Operations Team","conditionalAssignees":[],"isConditional":false,"actionLabel":"Sign as Superintendent","canChairMeeting":false}]},{"id":6,"workflowKey":"CONTRACT_TRACKING","name":"Contract Tracking","description":"4-step subcontract approval workflow for tracking committed buyout entries through APM/PA, PM, Risk Manager, and Project Executive review.","isActive":true,"lastModifiedBy":"Mike Hedrick","lastModifiedDate":"2026-02-17T10:00:00.000Z","steps":[{"id":19,"workflowId":6,"stepOrder":1,"name":"APM/PA Review","description":"Assistant Project Manager or Project Administrator reviews the subcontract package.","assignmentType":"ProjectRole","projectRole":"Operations Team","conditionalAssignees":[],"isConditional":false,"actionLabel":"Review & Approve","canChairMeeting":false,"isSkippable":true},{"id":20,"workflowId":6,"stepOrder":2,"name":"Project Manager Approval","description":"Project Manager reviews and approves the subcontract.","assignmentType":"ProjectRole","projectRole":"Operations Team","conditionalAssignees":[],"isConditional":false,"actionLabel":"Approve or Reject","canChairMeeting":false},{"id":21,"workflowId":6,"stepOrder":3,"name":"Risk Manager Review","description":"Risk Manager reviews subcontract for compliance and risk exposure.","assignmentType":"ProjectRole","projectRole":"Risk Management","conditionalAssignees":[],"isConditional":false,"actionLabel":"Review & Approve","canChairMeeting":false},{"id":22,"workflowId":6,"stepOrder":4,"name":"Project Executive Approval","description":"Project Executive provides final approval for the subcontract.","assignmentType":"ProjectRole","projectRole":"Executive Leadership","conditionalAssignees":[],"isConditional":false,"actionLabel":"Final Approve","canChairMeeting":false}]}]'),workflowStepOverrides_namespaceObject=[],turnoverAgendas_namespaceObject=JSON.parse('{"agendas":[{"id":1,"projectCode":"25-042-01","leadId":14,"status":"Complete","projectName":"Palm Beach County Convention Center Expansion","meetingDate":"2026-01-10T14:00:00.000Z","recordingUrl":"https://teams.microsoft.com/recording/turnover-25-042-01","turnoverFolderUrl":"https://hedrickbrothers.sharepoint.com/sites/25-042-01/00_Project_Admin/Turnover","bcPublished":true,"pmName":"Carlos Rivera","apmName":"Sarah Mitchell","createdBy":"Rachel Kim","createdDate":"2025-12-15T09:00:00.000Z","lastModifiedBy":"Mike Hedrick","lastModifiedDate":"2026-01-10T16:30:00.000Z"},{"id":2,"projectCode":"25-115-01","leadId":7,"status":"PrerequisitesInProgress","projectName":"Tallahassee State Office Complex","meetingDate":"2026-02-20T10:00:00.000Z","createdBy":"David Park","createdDate":"2026-02-01T08:00:00.000Z"}],"headers":[{"id":1,"turnoverAgendaId":1,"projectName":"Palm Beach County Convention Center Expansion","projectCode":"25-042-01","clientName":"Palm Beach County","projectValue":42000000,"deliveryMethod":"GMP","projectExecutive":"Mike Hedrick","projectManager":"Carlos Rivera","leadEstimator":"Rachel Kim","overrides":{}},{"id":2,"turnoverAgendaId":2,"projectName":"Tallahassee State Office Complex","projectCode":"25-115-01","clientName":"State of Florida DMS","projectValue":28500000,"deliveryMethod":"Precon w/ GMP Amend","projectExecutive":"Tom Hedrick","projectManager":"","leadEstimator":"David Park","overrides":{}}],"estimateOverviews":[{"id":1,"turnoverAgendaId":1,"contractAmount":42000000,"originalEstimate":41250000,"buyoutTarget":38000000,"estimatedFee":2100000,"estimatedGrossMargin":3150000,"contingency":630000,"notes":"Fee at 5%. Buyout target reflects aggressive sub pricing from BC coverage.","overrides":{}},{"id":2,"turnoverAgendaId":2,"contractAmount":28500000,"originalEstimate":27800000,"buyoutTarget":25500000,"estimatedFee":1425000,"estimatedGrossMargin":2137500,"contingency":427500,"notes":"","overrides":{}}],"prerequisites":[{"id":1,"turnoverAgendaId":1,"sortOrder":1,"label":"Estimate File Complete","description":"Estimate file has been reviewed and finalized by the Lead Estimator.","completed":true,"completedBy":"Rachel Kim","completedDate":"2025-12-20T10:00:00.000Z"},{"id":2,"turnoverAgendaId":1,"sortOrder":2,"label":"Contract Executed","description":"Owner contract has been fully executed and filed.","completed":true,"completedBy":"Legal Team","completedDate":"2025-12-22T14:00:00.000Z"},{"id":3,"turnoverAgendaId":1,"sortOrder":3,"label":"Job Number Assigned","description":"Official job number has been issued by Accounting.","completed":true,"completedBy":"Accounting","completedDate":"2025-12-18T09:00:00.000Z"},{"id":4,"turnoverAgendaId":1,"sortOrder":4,"label":"Site Visit Completed","description":"Operations team has completed an initial site visit.","completed":true,"completedBy":"Carlos Rivera","completedDate":"2026-01-05T16:00:00.000Z"},{"id":5,"turnoverAgendaId":2,"sortOrder":1,"label":"Estimate File Complete","description":"Estimate file has been reviewed and finalized by the Lead Estimator.","completed":true,"completedBy":"David Park","completedDate":"2026-01-28T11:00:00.000Z"},{"id":6,"turnoverAgendaId":2,"sortOrder":2,"label":"Contract Executed","description":"Owner contract has been fully executed and filed.","completed":true,"completedBy":"Legal Team","completedDate":"2026-01-30T10:00:00.000Z"},{"id":7,"turnoverAgendaId":2,"sortOrder":3,"label":"Job Number Assigned","description":"Official job number has been issued by Accounting.","completed":true,"completedBy":"Accounting","completedDate":"2026-01-29T09:00:00.000Z"},{"id":8,"turnoverAgendaId":2,"sortOrder":4,"label":"Site Visit Completed","description":"Operations team has completed an initial site visit.","completed":false}],"discussionItems":[{"id":1,"turnoverAgendaId":1,"sortOrder":1,"label":"Scope of Work","description":"Review the full scope of work, inclusions, and exclusions.","discussed":true,"notes":"Full scope reviewed including 150,000 SF expansion, new ballroom, and parking structure. Self-perform concrete and site work."},{"id":2,"turnoverAgendaId":1,"sortOrder":2,"label":"Budget & Cost Review","description":"Walk through the estimate, GC costs, contingencies, and fee structure.","discussed":true,"notes":"GMP at $42M. GC costs at 8.2%. Contingency at 1.5%. Fee locked at 5%."},{"id":3,"turnoverAgendaId":1,"sortOrder":3,"label":"Schedule Overview","description":"Review project milestones, critical dates, and long-lead items.","discussed":true,"notes":"18-month construction schedule. Long-lead: curtain wall (16 weeks), elevators (20 weeks). Substantial completion by Q3 2027."},{"id":4,"turnoverAgendaId":1,"sortOrder":4,"label":"Subcontractor Strategy","description":"Discuss subcontractor selections, bid coverage, and procurement plan.","discussed":true,"notes":"6 major trades identified. MEP package going to 3 bidders each. Concrete self-perform confirmed."},{"id":5,"turnoverAgendaId":1,"sortOrder":5,"label":"Risk Items","description":"Identify known risks, allowances, exclusions, and potential change orders.","discussed":true,"notes":"Soil conditions flagged â€” geotech report shows potential dewatering needs. $350K allowance for unforeseen conditions."},{"id":6,"turnoverAgendaId":1,"sortOrder":6,"label":"Contract Requirements","description":"Review key contract terms, insurance, bonding, and compliance requirements.","discussed":true,"notes":"100% P&P bond required. CCIP program in place. Liquidated damages at $5K/day."},{"id":7,"turnoverAgendaId":1,"sortOrder":7,"label":"Safety Considerations","description":"Discuss site-specific safety concerns and safety plan requirements.","discussed":true,"notes":"Active convention center adjacent â€” need full perimeter fencing and separate construction entrance. Noise restrictions after 6PM."},{"id":8,"turnoverAgendaId":1,"sortOrder":8,"label":"Quality Requirements","description":"Review quality standards, special inspections, and testing requirements.","discussed":true,"notes":"County-mandated third-party inspections for structural steel. LEED Silver target."},{"id":9,"turnoverAgendaId":1,"sortOrder":9,"label":"Client Expectations","description":"Discuss client communication preferences, reporting, and relationship dynamics.","discussed":true,"notes":"Monthly OAC meetings. Weekly progress reports to County PM. Client prefers email over Teams."},{"id":10,"turnoverAgendaId":1,"sortOrder":10,"label":"Open Items & Action Items","description":"Capture outstanding questions, open items, and next steps for the team.","discussed":true,"notes":"1) Finalize dewatering scope by 1/20. 2) Confirm curtain wall vendor by 1/25. 3) Schedule pre-con meeting with County."},{"id":11,"turnoverAgendaId":2,"sortOrder":1,"label":"Scope of Work","description":"Review the full scope of work, inclusions, and exclusions.","discussed":false,"notes":""},{"id":12,"turnoverAgendaId":2,"sortOrder":2,"label":"Budget & Cost Review","description":"Walk through the estimate, GC costs, contingencies, and fee structure.","discussed":false,"notes":""},{"id":13,"turnoverAgendaId":2,"sortOrder":3,"label":"Schedule Overview","description":"Review project milestones, critical dates, and long-lead items.","discussed":false,"notes":""},{"id":14,"turnoverAgendaId":2,"sortOrder":4,"label":"Subcontractor Strategy","description":"Discuss subcontractor selections, bid coverage, and procurement plan.","discussed":false,"notes":""},{"id":15,"turnoverAgendaId":2,"sortOrder":5,"label":"Risk Items","description":"Identify known risks, allowances, exclusions, and potential change orders.","discussed":false,"notes":""},{"id":16,"turnoverAgendaId":2,"sortOrder":6,"label":"Contract Requirements","description":"Review key contract terms, insurance, bonding, and compliance requirements.","discussed":false,"notes":""},{"id":17,"turnoverAgendaId":2,"sortOrder":7,"label":"Safety Considerations","description":"Discuss site-specific safety concerns and safety plan requirements.","discussed":false,"notes":""},{"id":18,"turnoverAgendaId":2,"sortOrder":8,"label":"Quality Requirements","description":"Review quality standards, special inspections, and testing requirements.","discussed":false,"notes":""},{"id":19,"turnoverAgendaId":2,"sortOrder":9,"label":"Client Expectations","description":"Discuss client communication preferences, reporting, and relationship dynamics.","discussed":false,"notes":""},{"id":20,"turnoverAgendaId":2,"sortOrder":10,"label":"Open Items & Action Items","description":"Capture outstanding questions, open items, and next steps for the team.","discussed":false,"notes":""}],"subcontractors":[{"id":1,"turnoverAgendaId":1,"trade":"Mechanical/HVAC","subcontractorName":"Southeast Mechanical","contactName":"John Torres","contactPhone":"561-555-0101","contactEmail":"jtorres@southeastmech.com","qScore":92,"isPreferred":true,"isRequired":false,"notes":"Long-standing relationship"},{"id":2,"turnoverAgendaId":1,"trade":"Electrical","subcontractorName":"Palm Coast Electric","contactName":"Maria Santos","contactPhone":"561-555-0102","contactEmail":"msantos@palmcoastelec.com","qScore":88,"isPreferred":true,"isRequired":false,"notes":""},{"id":3,"turnoverAgendaId":1,"trade":"Plumbing","subcontractorName":"All-Florida Plumbing","contactName":"Robert Chen","contactPhone":"561-555-0103","contactEmail":"rchen@allfloridaplumb.com","qScore":85,"isPreferred":false,"isRequired":false,"notes":""},{"id":4,"turnoverAgendaId":1,"trade":"Structural Steel","subcontractorName":"Atlantic Steel Fabricators","contactName":"David Wilson","contactPhone":"561-555-0104","contactEmail":"dwilson@atlanticsteel.com","qScore":90,"isPreferred":false,"isRequired":true,"notes":"Owner-specified per contract"},{"id":5,"turnoverAgendaId":1,"trade":"Curtain Wall","subcontractorName":"Glass Solutions Inc","contactName":"Lisa Park","contactPhone":"561-555-0105","contactEmail":"lpark@glasssolutions.com","qScore":87,"isPreferred":false,"isRequired":false,"notes":"16-week lead time"},{"id":6,"turnoverAgendaId":1,"trade":"Fire Protection","subcontractorName":"Guardian Fire Systems","contactName":"James Brown","contactPhone":"561-555-0106","contactEmail":"jbrown@guardianfire.com","qScore":91,"isPreferred":true,"isRequired":false,"notes":""},{"id":7,"turnoverAgendaId":2,"trade":"Mechanical/HVAC","subcontractorName":"Capital City Mechanical","contactName":"Andy Reed","contactPhone":"850-555-0201","contactEmail":"areed@capitalcitymech.com","qScore":84,"isPreferred":false,"isRequired":false,"notes":""},{"id":8,"turnoverAgendaId":2,"trade":"Electrical","subcontractorName":"Tallahassee Electric Co","contactName":"Nina Cruz","contactPhone":"850-555-0202","contactEmail":"ncruz@tallyelec.com","qScore":86,"isPreferred":true,"isRequired":false,"notes":""}],"exhibits":[{"id":1,"turnoverAgendaId":1,"sortOrder":1,"label":"Executed Contract","isDefault":true,"reviewed":true,"reviewedBy":"Rachel Kim","reviewedDate":"2026-01-10T14:15:00.000Z","linkedDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/25-042-01/Contracts/Executed_Contract.pdf"},{"id":2,"turnoverAgendaId":1,"sortOrder":2,"label":"Final Estimate / GMP","isDefault":true,"reviewed":true,"reviewedBy":"Rachel Kim","reviewedDate":"2026-01-10T14:20:00.000Z","linkedDocumentUrl":"https://hedrickbrothers.sharepoint.com/sites/25-042-01/Estimates/GMP_Final.xlsx"},{"id":3,"turnoverAgendaId":1,"sortOrder":3,"label":"Project Schedule","isDefault":true,"reviewed":true,"reviewedBy":"Carlos Rivera","reviewedDate":"2026-01-10T14:25:00.000Z"},{"id":4,"turnoverAgendaId":1,"sortOrder":4,"label":"Subcontractor Bid Tabulation","isDefault":true,"reviewed":true,"reviewedBy":"Rachel Kim","reviewedDate":"2026-01-10T14:30:00.000Z"},{"id":5,"turnoverAgendaId":1,"sortOrder":5,"label":"Allowance Log","isDefault":true,"reviewed":true,"reviewedBy":"Rachel Kim","reviewedDate":"2026-01-10T14:35:00.000Z"},{"id":6,"turnoverAgendaId":1,"sortOrder":6,"label":"Value Engineering Log","isDefault":true,"reviewed":true,"reviewedBy":"Rachel Kim","reviewedDate":"2026-01-10T14:40:00.000Z"},{"id":7,"turnoverAgendaId":1,"sortOrder":7,"label":"Insurance & Bonding Docs","isDefault":true,"reviewed":true,"reviewedBy":"Legal Team","reviewedDate":"2026-01-10T14:45:00.000Z"},{"id":8,"turnoverAgendaId":1,"sortOrder":8,"label":"Site Logistics Plan","isDefault":true,"reviewed":true,"reviewedBy":"Carlos Rivera","reviewedDate":"2026-01-10T14:50:00.000Z"},{"id":9,"turnoverAgendaId":1,"sortOrder":9,"label":"Permit & NOC Status","isDefault":true,"reviewed":true,"reviewedBy":"Sarah Mitchell","reviewedDate":"2026-01-10T14:55:00.000Z"},{"id":10,"turnoverAgendaId":1,"sortOrder":10,"label":"Project Directory","isDefault":true,"reviewed":true,"reviewedBy":"Sarah Mitchell","reviewedDate":"2026-01-10T15:00:00.000Z"},{"id":11,"turnoverAgendaId":1,"sortOrder":11,"label":"Geotech Report Addendum","isDefault":false,"reviewed":true,"reviewedBy":"Carlos Rivera","reviewedDate":"2026-01-10T15:05:00.000Z","uploadedFileName":"Geotech_Addendum_Dec2025.pdf","uploadedFileUrl":"https://hedrickbrothers.sharepoint.com/sites/25-042-01/Turnover/Geotech_Addendum_Dec2025.pdf"},{"id":12,"turnoverAgendaId":2,"sortOrder":1,"label":"Executed Contract","isDefault":true,"reviewed":false},{"id":13,"turnoverAgendaId":2,"sortOrder":2,"label":"Final Estimate / GMP","isDefault":true,"reviewed":false},{"id":14,"turnoverAgendaId":2,"sortOrder":3,"label":"Project Schedule","isDefault":true,"reviewed":false},{"id":15,"turnoverAgendaId":2,"sortOrder":4,"label":"Subcontractor Bid Tabulation","isDefault":true,"reviewed":false},{"id":16,"turnoverAgendaId":2,"sortOrder":5,"label":"Allowance Log","isDefault":true,"reviewed":false},{"id":17,"turnoverAgendaId":2,"sortOrder":6,"label":"Value Engineering Log","isDefault":true,"reviewed":false},{"id":18,"turnoverAgendaId":2,"sortOrder":7,"label":"Insurance & Bonding Docs","isDefault":true,"reviewed":false},{"id":19,"turnoverAgendaId":2,"sortOrder":8,"label":"Site Logistics Plan","isDefault":true,"reviewed":false},{"id":20,"turnoverAgendaId":2,"sortOrder":9,"label":"Permit & NOC Status","isDefault":true,"reviewed":false},{"id":21,"turnoverAgendaId":2,"sortOrder":10,"label":"Project Directory","isDefault":true,"reviewed":false}],"signatures":[{"id":1,"turnoverAgendaId":1,"sortOrder":1,"role":"Lead Estimator","signerName":"Rachel Kim","signerEmail":"rkim@hedrickbrothers.com","affidavitText":"I certify that I have reviewed the turnover package and accept responsibility for the information transferred. I understand that any discrepancies or omissions should be reported immediately.","signed":true,"signedDate":"2026-01-10T15:30:00.000Z","comment":"All estimate data verified."},{"id":2,"turnoverAgendaId":1,"sortOrder":2,"role":"Project Executive","signerName":"Mike Hedrick","signerEmail":"mhedrick@hedrickbrothers.com","affidavitText":"I certify that I have reviewed the turnover package and accept responsibility for the information transferred. I understand that any discrepancies or omissions should be reported immediately.","signed":true,"signedDate":"2026-01-10T15:45:00.000Z","comment":"Approved."},{"id":3,"turnoverAgendaId":1,"sortOrder":3,"role":"Project Manager","signerName":"Carlos Rivera","signerEmail":"crivera@hedrickbrothers.com","affidavitText":"I certify that I have reviewed the turnover package and accept responsibility for the information transferred. I understand that any discrepancies or omissions should be reported immediately.","signed":true,"signedDate":"2026-01-10T16:00:00.000Z","comment":"Ready to mobilize."},{"id":4,"turnoverAgendaId":1,"sortOrder":4,"role":"Superintendent","signerName":"James Rodriguez","signerEmail":"jrodriguez@hedrickbrothers.com","affidavitText":"I certify that I have reviewed the turnover package and accept responsibility for the information transferred. I understand that any discrepancies or omissions should be reported immediately.","signed":true,"signedDate":"2026-01-10T16:15:00.000Z","comment":"Site plan reviewed."},{"id":5,"turnoverAgendaId":2,"sortOrder":1,"role":"Lead Estimator","signerName":"David Park","signerEmail":"dpark@hedrickbrothers.com","affidavitText":"I certify that I have reviewed the turnover package and accept responsibility for the information transferred. I understand that any discrepancies or omissions should be reported immediately.","signed":false},{"id":6,"turnoverAgendaId":2,"sortOrder":2,"role":"Project Executive","signerName":"Tom Hedrick","signerEmail":"thedrick@hedrickbrothers.com","affidavitText":"I certify that I have reviewed the turnover package and accept responsibility for the information transferred. I understand that any discrepancies or omissions should be reported immediately.","signed":false},{"id":7,"turnoverAgendaId":2,"sortOrder":3,"role":"Project Manager","signerName":"","signerEmail":"","affidavitText":"I certify that I have reviewed the turnover package and accept responsibility for the information transferred. I understand that any discrepancies or omissions should be reported immediately.","signed":false},{"id":8,"turnoverAgendaId":2,"sortOrder":4,"role":"Superintendent","signerName":"","signerEmail":"","affidavitText":"I certify that I have reviewed the turnover package and accept responsibility for the information transferred. I understand that any discrepancies or omissions should be reported immediately.","signed":false}],"attachments":[{"id":1,"discussionItemId":5,"fileName":"Risk_Register_25-042-01.xlsx","fileUrl":"https://hedrickbrothers.sharepoint.com/sites/25-042-01/Turnover/Risk_Register.xlsx","uploadedBy":"Rachel Kim","uploadedDate":"2026-01-08T11:00:00.000Z"},{"id":2,"discussionItemId":3,"fileName":"Master_Schedule_v3.mpp","fileUrl":"https://hedrickbrothers.sharepoint.com/sites/25-042-01/Turnover/Master_Schedule_v3.mpp","uploadedBy":"Carlos Rivera","uploadedDate":"2026-01-09T14:00:00.000Z"}]}'),permissionTemplates_namespaceObject=JSON.parse('[{"id":1,"name":"President / VP Operations","description":"Full system access with global visibility across all projects and sectors","isGlobal":true,"globalAccess":true,"identityType":"Internal","toolAccess":[{"toolKey":"marketing_dashboard","level":"ADMIN"},{"toolKey":"project_record","level":"ADMIN"},{"toolKey":"leads","level":"ADMIN","granularFlags":["can_delete_leads","can_decide_gonogo"]},{"toolKey":"gonogo","level":"ADMIN","granularFlags":["can_score_committee"]},{"toolKey":"estimating","level":"ADMIN"},{"toolKey":"pipeline","level":"ADMIN"},{"toolKey":"kickoff","level":"ADMIN"},{"toolKey":"autopsy","level":"ADMIN"},{"toolKey":"job_number","level":"ADMIN"},{"toolKey":"accounting_queue","level":"ADMIN"},{"toolKey":"active_projects","level":"ADMIN"},{"toolKey":"startup_checklist","level":"ADMIN"},{"toolKey":"pmp","level":"ADMIN","granularFlags":["can_final_approve"]},{"toolKey":"superintendent_plan","level":"ADMIN"},{"toolKey":"responsibility_matrices","level":"ADMIN"},{"toolKey":"buyout_log","level":"ADMIN","granularFlags":["can_bypass_workflow","can_edit_closed_items"]},{"toolKey":"risk_cost","level":"ADMIN"},{"toolKey":"quality_safety","level":"ADMIN"},{"toolKey":"schedule","level":"ADMIN"},{"toolKey":"monthly_review","level":"ADMIN","granularFlags":["can_create_reviews"]},{"toolKey":"lessons_learned","level":"ADMIN"},{"toolKey":"admin_panel","level":"ADMIN","granularFlags":["can_manage_provisioning"]},{"toolKey":"workflow_definitions","level":"ADMIN"}],"isDefault":false,"isActive":true,"version":1,"createdBy":"System","createdDate":"2025-01-01T00:00:00Z","lastModifiedBy":"System","lastModifiedDate":"2025-01-01T00:00:00Z"},{"id":2,"name":"OpEx Manager","description":"Operations Excellence manager with full admin access and global visibility","isGlobal":true,"globalAccess":true,"identityType":"Internal","toolAccess":[{"toolKey":"marketing_dashboard","level":"ADMIN"},{"toolKey":"project_record","level":"ADMIN"},{"toolKey":"leads","level":"ADMIN","granularFlags":["can_delete_leads"]},{"toolKey":"gonogo","level":"ADMIN","granularFlags":["can_score_committee"]},{"toolKey":"estimating","level":"ADMIN"},{"toolKey":"pipeline","level":"ADMIN"},{"toolKey":"kickoff","level":"ADMIN"},{"toolKey":"autopsy","level":"ADMIN"},{"toolKey":"job_number","level":"ADMIN"},{"toolKey":"accounting_queue","level":"ADMIN"},{"toolKey":"active_projects","level":"ADMIN"},{"toolKey":"startup_checklist","level":"ADMIN"},{"toolKey":"pmp","level":"ADMIN","granularFlags":["can_final_approve"]},{"toolKey":"superintendent_plan","level":"ADMIN"},{"toolKey":"responsibility_matrices","level":"ADMIN"},{"toolKey":"buyout_log","level":"ADMIN","granularFlags":["can_bypass_workflow"]},{"toolKey":"risk_cost","level":"ADMIN"},{"toolKey":"quality_safety","level":"ADMIN"},{"toolKey":"schedule","level":"ADMIN"},{"toolKey":"monthly_review","level":"ADMIN","granularFlags":["can_create_reviews"]},{"toolKey":"lessons_learned","level":"ADMIN"},{"toolKey":"admin_panel","level":"ADMIN","granularFlags":["can_manage_provisioning"]},{"toolKey":"workflow_definitions","level":"ADMIN"}],"isDefault":false,"isActive":true,"version":1,"createdBy":"System","createdDate":"2025-01-01T00:00:00Z","lastModifiedBy":"System","lastModifiedDate":"2025-01-01T00:00:00Z"},{"id":3,"name":"Project Executive","description":"Senior project oversight with operations admin and limited preconstruction access","isGlobal":false,"globalAccess":false,"identityType":"Internal","toolAccess":[{"toolKey":"marketing_dashboard","level":"READ_ONLY"},{"toolKey":"project_record","level":"READ_ONLY"},{"toolKey":"leads","level":"READ_ONLY"},{"toolKey":"gonogo","level":"ADMIN","granularFlags":["can_score_committee"]},{"toolKey":"estimating","level":"READ_ONLY"},{"toolKey":"pipeline","level":"READ_ONLY"},{"toolKey":"kickoff","level":"READ_ONLY"},{"toolKey":"autopsy","level":"READ_ONLY"},{"toolKey":"job_number","level":"NONE"},{"toolKey":"accounting_queue","level":"NONE"},{"toolKey":"active_projects","level":"ADMIN"},{"toolKey":"startup_checklist","level":"ADMIN"},{"toolKey":"pmp","level":"ADMIN","granularFlags":["can_final_approve"]},{"toolKey":"superintendent_plan","level":"STANDARD"},{"toolKey":"responsibility_matrices","level":"STANDARD"},{"toolKey":"buyout_log","level":"ADMIN"},{"toolKey":"risk_cost","level":"STANDARD"},{"toolKey":"quality_safety","level":"STANDARD"},{"toolKey":"schedule","level":"STANDARD"},{"toolKey":"monthly_review","level":"ADMIN","granularFlags":["can_create_reviews"]},{"toolKey":"lessons_learned","level":"STANDARD"},{"toolKey":"admin_panel","level":"NONE"},{"toolKey":"workflow_definitions","level":"NONE"}],"isDefault":false,"isActive":true,"version":1,"createdBy":"System","createdDate":"2025-01-01T00:00:00Z","lastModifiedBy":"System","lastModifiedDate":"2025-01-01T00:00:00Z"},{"id":4,"name":"Project Manager","description":"Day-to-day project management with standard operations access","isGlobal":false,"globalAccess":false,"identityType":"Internal","toolAccess":[{"toolKey":"marketing_dashboard","level":"NONE"},{"toolKey":"project_record","level":"READ_ONLY"},{"toolKey":"leads","level":"READ_ONLY"},{"toolKey":"gonogo","level":"READ_ONLY"},{"toolKey":"estimating","level":"READ_ONLY"},{"toolKey":"pipeline","level":"READ_ONLY"},{"toolKey":"kickoff","level":"READ_ONLY"},{"toolKey":"autopsy","level":"READ_ONLY"},{"toolKey":"job_number","level":"NONE"},{"toolKey":"accounting_queue","level":"NONE"},{"toolKey":"active_projects","level":"STANDARD"},{"toolKey":"startup_checklist","level":"STANDARD"},{"toolKey":"pmp","level":"STANDARD"},{"toolKey":"superintendent_plan","level":"STANDARD"},{"toolKey":"responsibility_matrices","level":"STANDARD"},{"toolKey":"buyout_log","level":"STANDARD"},{"toolKey":"risk_cost","level":"STANDARD"},{"toolKey":"quality_safety","level":"STANDARD"},{"toolKey":"schedule","level":"STANDARD"},{"toolKey":"monthly_review","level":"STANDARD"},{"toolKey":"lessons_learned","level":"STANDARD"},{"toolKey":"admin_panel","level":"NONE"},{"toolKey":"workflow_definitions","level":"NONE"}],"isDefault":false,"isActive":true,"version":1,"createdBy":"System","createdDate":"2025-01-01T00:00:00Z","lastModifiedBy":"System","lastModifiedDate":"2025-01-01T00:00:00Z"},{"id":5,"name":"Estimating Coordinator","description":"Preconstruction estimating focus with read-only operations access","isGlobal":false,"globalAccess":false,"identityType":"Internal","toolAccess":[{"toolKey":"marketing_dashboard","level":"NONE"},{"toolKey":"project_record","level":"NONE"},{"toolKey":"leads","level":"READ_ONLY"},{"toolKey":"gonogo","level":"STANDARD"},{"toolKey":"estimating","level":"STANDARD"},{"toolKey":"pipeline","level":"STANDARD"},{"toolKey":"kickoff","level":"ADMIN"},{"toolKey":"autopsy","level":"ADMIN"},{"toolKey":"job_number","level":"STANDARD"},{"toolKey":"accounting_queue","level":"NONE"},{"toolKey":"active_projects","level":"NONE"},{"toolKey":"startup_checklist","level":"NONE"},{"toolKey":"pmp","level":"NONE"},{"toolKey":"superintendent_plan","level":"NONE"},{"toolKey":"responsibility_matrices","level":"NONE"},{"toolKey":"buyout_log","level":"NONE"},{"toolKey":"risk_cost","level":"NONE"},{"toolKey":"quality_safety","level":"NONE"},{"toolKey":"schedule","level":"NONE"},{"toolKey":"monthly_review","level":"NONE"},{"toolKey":"lessons_learned","level":"NONE"},{"toolKey":"admin_panel","level":"NONE"},{"toolKey":"workflow_definitions","level":"NONE"}],"isDefault":false,"isActive":true,"version":1,"createdBy":"System","createdDate":"2025-01-01T00:00:00Z","lastModifiedBy":"System","lastModifiedDate":"2025-01-01T00:00:00Z"},{"id":6,"name":"BD Representative","description":"Business development with lead management and scoring capabilities","isGlobal":false,"globalAccess":false,"identityType":"Internal","toolAccess":[{"toolKey":"marketing_dashboard","level":"NONE"},{"toolKey":"project_record","level":"NONE"},{"toolKey":"leads","level":"STANDARD"},{"toolKey":"gonogo","level":"STANDARD"},{"toolKey":"estimating","level":"READ_ONLY"},{"toolKey":"pipeline","level":"READ_ONLY"},{"toolKey":"kickoff","level":"READ_ONLY"},{"toolKey":"autopsy","level":"READ_ONLY"},{"toolKey":"job_number","level":"NONE"},{"toolKey":"accounting_queue","level":"NONE"},{"toolKey":"active_projects","level":"NONE"},{"toolKey":"startup_checklist","level":"NONE"},{"toolKey":"pmp","level":"NONE"},{"toolKey":"superintendent_plan","level":"NONE"},{"toolKey":"responsibility_matrices","level":"NONE"},{"toolKey":"buyout_log","level":"NONE"},{"toolKey":"risk_cost","level":"NONE"},{"toolKey":"quality_safety","level":"NONE"},{"toolKey":"schedule","level":"NONE"},{"toolKey":"monthly_review","level":"NONE"},{"toolKey":"lessons_learned","level":"NONE"},{"toolKey":"admin_panel","level":"NONE"},{"toolKey":"workflow_definitions","level":"NONE"}],"isDefault":false,"isActive":true,"version":1,"createdBy":"System","createdDate":"2025-01-01T00:00:00Z","lastModifiedBy":"System","lastModifiedDate":"2025-01-01T00:00:00Z"},{"id":7,"name":"Accounting Controller","description":"Accounting queue authority with financial visibility","isGlobal":false,"globalAccess":false,"identityType":"Internal","toolAccess":[{"toolKey":"marketing_dashboard","level":"NONE"},{"toolKey":"project_record","level":"NONE"},{"toolKey":"leads","level":"READ_ONLY"},{"toolKey":"gonogo","level":"READ_ONLY"},{"toolKey":"estimating","level":"READ_ONLY"},{"toolKey":"pipeline","level":"READ_ONLY"},{"toolKey":"kickoff","level":"NONE"},{"toolKey":"autopsy","level":"NONE"},{"toolKey":"job_number","level":"ADMIN"},{"toolKey":"accounting_queue","level":"ADMIN"},{"toolKey":"active_projects","level":"READ_ONLY"},{"toolKey":"startup_checklist","level":"NONE"},{"toolKey":"pmp","level":"NONE"},{"toolKey":"superintendent_plan","level":"NONE"},{"toolKey":"responsibility_matrices","level":"NONE"},{"toolKey":"buyout_log","level":"READ_ONLY"},{"toolKey":"risk_cost","level":"NONE"},{"toolKey":"quality_safety","level":"NONE"},{"toolKey":"schedule","level":"NONE"},{"toolKey":"monthly_review","level":"NONE"},{"toolKey":"lessons_learned","level":"NONE"},{"toolKey":"admin_panel","level":"NONE"},{"toolKey":"workflow_definitions","level":"NONE"}],"isDefault":false,"isActive":true,"version":1,"createdBy":"System","createdDate":"2025-01-01T00:00:00Z","lastModifiedBy":"System","lastModifiedDate":"2025-01-01T00:00:00Z"},{"id":8,"name":"Read-Only Observer","description":"View-only access across all modules with no edit capabilities","isGlobal":true,"globalAccess":false,"identityType":"Internal","toolAccess":[{"toolKey":"marketing_dashboard","level":"READ_ONLY"},{"toolKey":"project_record","level":"READ_ONLY"},{"toolKey":"leads","level":"READ_ONLY"},{"toolKey":"gonogo","level":"READ_ONLY"},{"toolKey":"estimating","level":"READ_ONLY"},{"toolKey":"pipeline","level":"READ_ONLY"},{"toolKey":"kickoff","level":"READ_ONLY"},{"toolKey":"autopsy","level":"READ_ONLY"},{"toolKey":"job_number","level":"NONE"},{"toolKey":"accounting_queue","level":"READ_ONLY"},{"toolKey":"active_projects","level":"READ_ONLY"},{"toolKey":"startup_checklist","level":"READ_ONLY"},{"toolKey":"pmp","level":"READ_ONLY"},{"toolKey":"superintendent_plan","level":"READ_ONLY"},{"toolKey":"responsibility_matrices","level":"READ_ONLY"},{"toolKey":"buyout_log","level":"READ_ONLY"},{"toolKey":"risk_cost","level":"READ_ONLY"},{"toolKey":"quality_safety","level":"READ_ONLY"},{"toolKey":"schedule","level":"READ_ONLY"},{"toolKey":"monthly_review","level":"READ_ONLY"},{"toolKey":"lessons_learned","level":"READ_ONLY"},{"toolKey":"admin_panel","level":"NONE"},{"toolKey":"workflow_definitions","level":"NONE"}],"isDefault":true,"isActive":true,"version":1,"createdBy":"System","createdDate":"2025-01-01T00:00:00Z","lastModifiedBy":"System","lastModifiedDate":"2025-01-01T00:00:00Z"},{"id":9,"name":"SharePoint Admin","description":"IT/SharePoint administrator with full admin access across all tools and modules","isGlobal":true,"globalAccess":true,"identityType":"Internal","toolAccess":[{"toolKey":"marketing_dashboard","level":"ADMIN"},{"toolKey":"project_record","level":"ADMIN"},{"toolKey":"leads","level":"ADMIN","granularFlags":["can_delete_leads","can_decide_gonogo"]},{"toolKey":"gonogo","level":"ADMIN","granularFlags":["can_score_committee"]},{"toolKey":"estimating","level":"ADMIN"},{"toolKey":"pipeline","level":"ADMIN"},{"toolKey":"kickoff","level":"ADMIN"},{"toolKey":"autopsy","level":"ADMIN"},{"toolKey":"job_number","level":"ADMIN"},{"toolKey":"accounting_queue","level":"ADMIN"},{"toolKey":"active_projects","level":"ADMIN"},{"toolKey":"startup_checklist","level":"ADMIN"},{"toolKey":"pmp","level":"ADMIN","granularFlags":["can_final_approve"]},{"toolKey":"superintendent_plan","level":"ADMIN"},{"toolKey":"responsibility_matrices","level":"ADMIN"},{"toolKey":"buyout_log","level":"ADMIN","granularFlags":["can_bypass_workflow","can_edit_closed_items"]},{"toolKey":"risk_cost","level":"ADMIN"},{"toolKey":"quality_safety","level":"ADMIN"},{"toolKey":"schedule","level":"ADMIN"},{"toolKey":"monthly_review","level":"ADMIN","granularFlags":["can_create_reviews"]},{"toolKey":"lessons_learned","level":"ADMIN"},{"toolKey":"admin_panel","level":"ADMIN","granularFlags":["can_manage_provisioning"]},{"toolKey":"workflow_definitions","level":"ADMIN"}],"isDefault":false,"isActive":true,"version":1,"createdBy":"System","createdDate":"2025-01-01T00:00:00Z","lastModifiedBy":"System","lastModifiedDate":"2025-01-01T00:00:00Z"}]'),securityGroupMappings_namespaceObject=JSON.parse('[{"id":1,"securityGroupId":"aad-group-001","securityGroupName":"HBC - Executive Leadership","defaultTemplateId":1,"isActive":true},{"id":2,"securityGroupId":"aad-group-002","securityGroupName":"HBC - Operations Excellence","defaultTemplateId":2,"isActive":true},{"id":3,"securityGroupId":"aad-group-003","securityGroupName":"HBC - Project Executives","defaultTemplateId":3,"isActive":true},{"id":4,"securityGroupId":"aad-group-004","securityGroupName":"HBC - Project Managers","defaultTemplateId":4,"isActive":true},{"id":5,"securityGroupId":"aad-group-005","securityGroupName":"HBC - Estimating","defaultTemplateId":5,"isActive":true},{"id":6,"securityGroupId":"aad-group-006","securityGroupName":"HBC - Business Development","defaultTemplateId":6,"isActive":true},{"id":7,"securityGroupId":"aad-group-007","securityGroupName":"HBC - Accounting","defaultTemplateId":7,"isActive":true},{"id":8,"securityGroupId":"aad-group-008","securityGroupName":"HBC - Read Only","defaultTemplateId":8,"isActive":true},{"id":9,"securityGroupId":"aad-group-009","securityGroupName":"HBC - SharePoint Admins","defaultTemplateId":9,"isActive":true}]'),projectTeamAssignments_namespaceObject=JSON.parse('[{"id":1,"projectCode":"25-042-01","userId":"user-mhedrick","userDisplayName":"Mike Hedrick","userEmail":"mhedrick@hedrickbrothers.com","assignedRole":"Principal-in-Charge","assignedBy":"System","assignedDate":"2025-01-15T00:00:00Z","isActive":true},{"id":2,"projectCode":"25-042-01","userId":"user-bcashin","userDisplayName":"Bob Cashin","userEmail":"bcashin@hedrickbrothers.com","assignedRole":"Project Executive","templateOverrideId":3,"assignedBy":"Mike Hedrick","assignedDate":"2025-01-15T00:00:00Z","isActive":true},{"id":3,"projectCode":"25-042-01","userId":"user-jchen","userDisplayName":"James Chen","userEmail":"jchen@hedrickbrothers.com","assignedRole":"Lead PM","templateOverrideId":4,"assignedBy":"Bob Cashin","assignedDate":"2025-01-16T00:00:00Z","isActive":true},{"id":4,"projectCode":"25-042-01","userId":"user-amartin","userDisplayName":"Angela Martin","userEmail":"amartin@hedrickbrothers.com","assignedRole":"Assistant PM","assignedBy":"James Chen","assignedDate":"2025-01-16T00:00:00Z","isActive":true},{"id":5,"projectCode":"25-042-01","userId":"user-rjohnson","userDisplayName":"Robert Johnson","userEmail":"rjohnson@hedrickbrothers.com","assignedRole":"Lead Superintendent","assignedBy":"Bob Cashin","assignedDate":"2025-01-16T00:00:00Z","isActive":true},{"id":6,"projectCode":"25-042-01","userId":"user-thickman","userDisplayName":"Tacara Hickman","userEmail":"thickman@hedrickbrothers.com","assignedRole":"Project Accountant","templateOverrideId":7,"assignedBy":"Bob Cashin","assignedDate":"2025-01-17T00:00:00Z","isActive":true},{"id":7,"projectCode":"25-042-01","userId":"user-dpark","userDisplayName":"David Park","userEmail":"dpark@hedrickbrothers.com","assignedRole":"Director of Preconstruction","granularFlagOverrides":[{"toolKey":"gonogo","flags":["can_score_committee"]}],"assignedBy":"Mike Hedrick","assignedDate":"2025-01-15T00:00:00Z","isActive":true},{"id":8,"projectCode":"25-042-01","userId":"user-smitchell","userDisplayName":"Sarah Mitchell","userEmail":"smitchell@hedrickbrothers.com","assignedRole":"BD Representative","assignedBy":"Mike Hedrick","assignedDate":"2025-01-15T00:00:00Z","isActive":true},{"id":9,"projectCode":"25-115-01","userId":"user-mhedrick","userDisplayName":"Mike Hedrick","userEmail":"mhedrick@hedrickbrothers.com","assignedRole":"Principal-in-Charge","assignedBy":"System","assignedDate":"2025-03-01T00:00:00Z","isActive":true},{"id":10,"projectCode":"25-115-01","userId":"user-bcashin","userDisplayName":"Bob Cashin","userEmail":"bcashin@hedrickbrothers.com","assignedRole":"Project Executive","templateOverrideId":3,"assignedBy":"Mike Hedrick","assignedDate":"2025-03-01T00:00:00Z","isActive":true},{"id":11,"projectCode":"25-115-01","userId":"user-amartin","userDisplayName":"Angela Martin","userEmail":"amartin@hedrickbrothers.com","assignedRole":"Lead PM","templateOverrideId":4,"assignedBy":"Bob Cashin","assignedDate":"2025-03-02T00:00:00Z","isActive":true},{"id":12,"projectCode":"25-115-01","userId":"user-rjohnson","userDisplayName":"Robert Johnson","userEmail":"rjohnson@hedrickbrothers.com","assignedRole":"Superintendent","assignedBy":"Bob Cashin","assignedDate":"2025-03-02T00:00:00Z","isActive":true},{"id":13,"projectCode":"25-115-01","userId":"user-dpark","userDisplayName":"David Park","userEmail":"dpark@hedrickbrothers.com","assignedRole":"Director of Preconstruction","assignedBy":"Mike Hedrick","assignedDate":"2025-03-01T00:00:00Z","isActive":true},{"id":14,"projectCode":"25-115-01","userId":"user-smitchell","userDisplayName":"Sarah Mitchell","userEmail":"smitchell@hedrickbrothers.com","assignedRole":"BD Representative","assignedBy":"Mike Hedrick","assignedDate":"2025-03-01T00:00:00Z","isActive":true},{"id":15,"projectCode":"25-042-01","userId":"user-lgarcia","userDisplayName":"Lisa Garcia","userEmail":"lgarcia@hedrickbrothers.com","assignedRole":"Safety Officer","granularFlagOverrides":[{"toolKey":"quality_safety","flags":[]}],"assignedBy":"Bob Cashin","assignedDate":"2025-01-20T00:00:00Z","isActive":true}]'),environmentConfig_namespaceObject=JSON.parse('{"currentTier":"dev","label":"Development","color":"#3B82F6","isReadOnly":false,"promotionHistory":[]}'),sectorDefinitions_namespaceObject=JSON.parse('[{"id":1,"code":"AIRPORT","label":"Airport","isActive":true,"sortOrder":1},{"id":2,"code":"CITY","label":"City","isActive":true,"sortOrder":2},{"id":3,"code":"COMMERCIAL","label":"Commercial","isActive":true,"sortOrder":3},{"id":4,"code":"COUNTY","label":"County","isActive":true,"sortOrder":4},{"id":5,"code":"FEDERAL","label":"Federal","isActive":true,"sortOrder":5},{"id":6,"code":"GOLF_CLUB_COURSE","label":"Golf Club/Course","isActive":true,"sortOrder":6},{"id":7,"code":"MIXED_USE","label":"Mixed-Use","isActive":true,"sortOrder":7},{"id":8,"code":"MULTI_FAMILY","label":"Multi-Family","isActive":true,"sortOrder":8},{"id":9,"code":"MUNICIPAL","label":"Municipal","isActive":true,"sortOrder":9},{"id":10,"code":"PARKING_GARAGE","label":"Parking Garage","isActive":true,"sortOrder":10},{"id":11,"code":"STATE","label":"State","isActive":true,"sortOrder":11},{"id":12,"code":"WAREHOUSE","label":"Warehouse","isActive":true,"sortOrder":12}]'),assignmentMappings_namespaceObject=JSON.parse('[{"id":1,"region":"Miami","sector":"All Sectors","assignmentType":"Director","assignee":{"userId":"dpark","displayName":"David Park","email":"dpark@hedrickbrothers.com"}},{"id":2,"region":"West Palm Beach","sector":"All Sectors","assignmentType":"Director","assignee":{"userId":"dpark","displayName":"David Park","email":"dpark@hedrickbrothers.com"}},{"id":3,"region":"Miami","sector":"All Sectors","assignmentType":"Estimator","assignee":{"userId":"jthompson","displayName":"Jason Thompson","email":"jthompson@hedrickbrothers.com"}},{"id":4,"region":"All Regions","sector":"All Sectors","assignmentType":"Director","assignee":{"userId":"dpark","displayName":"David Park","email":"dpark@hedrickbrothers.com"}}]'),helpGuides_namespaceObject=JSON.parse('[{"id":1,"moduleKey":"dashboard","title":"Dashboard Overview","content":"The Dashboard is your central hub for project controls. View action items awaiting your attention, key performance indicators, and quick access to recent projects. Use the Project Picker in the sidebar to select a specific project for detailed operations.","guideType":"walkthrough","sortOrder":1,"targetSelector":"[data-help=\'dashboard-kpis\']","isActive":true,"lastModifiedBy":"System","lastModifiedDate":"2026-02-15T00:00:00Z"},{"id":2,"moduleKey":"pipeline","title":"Pipeline & Go/No-Go Tracker","content":"The Pipeline page visualizes all leads by stage. Use the Pipeline tab to see the funnel view and the Go/No-Go Tracker tab to monitor scorecard statuses. Filter by Region, Sector, BD Rep, or Status. Click any lead row to navigate to its detail page.","guideType":"walkthrough","sortOrder":1,"targetSelector":"[data-help=\'pipeline-chart\']","isActive":true,"lastModifiedBy":"System","lastModifiedDate":"2026-02-15T00:00:00Z"},{"id":3,"moduleKey":"lead-form","title":"Creating a New Lead","content":"Fill in the required fields marked with an asterisk (*): Project Name, Client Name, City, and State. The system will auto-populate City Location from your City entry. After submission, a BD Leads folder is automatically created in the document library.","guideType":"walkthrough","sortOrder":1,"targetSelector":"[data-help=\'lead-form\']","isActive":true,"lastModifiedBy":"System","lastModifiedDate":"2026-02-14T00:00:00Z"},{"id":4,"moduleKey":"gonogo","title":"Go/No-Go Scorecard Process","content":"The Go/No-Go scorecard follows a multi-step workflow: BD Rep drafts and submits scores, the Director reviews (approve/return/reject), then the Committee scores and makes a final Go, No-Go, or Conditional Go decision. Scores are based on 13 criteria totaling 92 points maximum.","guideType":"walkthrough","sortOrder":1,"targetSelector":"[data-help=\'gonogo-criteria\']","isActive":true,"lastModifiedBy":"System","lastModifiedDate":"2026-02-15T00:00:00Z"},{"id":5,"moduleKey":"estimating","title":"Estimating Dashboard","content":"The Estimating Dashboard has three tabs: Current Pursuits (active estimates), Precon Tracker (preconstruction engagements), and Estimate Log (historical). Click any row to edit inline. Use the Request New Project Number button to initiate a job number request for Go decisions.","guideType":"walkthrough","sortOrder":1,"targetSelector":"[data-help=\'estimating-table\']","isActive":true,"lastModifiedBy":"System","lastModifiedDate":"2026-02-15T00:00:00Z"},{"id":6,"moduleKey":"buyout-log","title":"Buyout Log & Commitments","content":"The Buyout Log tracks subcontractor commitments by CSI division. Each entry flows through a commitment approval workflow: submit for approval, PX review, compliance check (if waiver needed), and CFO escalation for high-value items. E-Verify status is tracked per subcontractor.","guideType":"article","sortOrder":1,"isActive":true,"lastModifiedBy":"System","lastModifiedDate":"2026-02-14T00:00:00Z"},{"id":7,"moduleKey":"admin","title":"Admin Panel Overview","content":"The Admin Panel provides system configuration across multiple tabs: Connections (SP hub URL), Roles, Feature Flags, Provisioning logs, Workflows (approval chains and assignment mappings), Permissions (templates and security groups), Sectors, Assignments (project team management), and Audit Log.","guideType":"article","sortOrder":1,"isActive":true,"lastModifiedBy":"System","lastModifiedDate":"2026-02-14T00:00:00Z"},{"id":8,"moduleKey":"pmp","title":"Project Management Plan","content":"The PMP consolidates 16 sections of project planning information. It pulls data from standalone modules (Risk/Cost, Schedule, Quality, Safety, Superintendent Plan). The PMP follows a signature and approval workflow: team signatures, then division-based approval cycles.","guideType":"article","sortOrder":1,"isActive":true,"lastModifiedBy":"System","lastModifiedDate":"2026-02-14T00:00:00Z"}]'),TURNOVER_SIGNATURE_AFFIDAVIT="I certify that I have reviewed the turnover package and accept responsibility for the information transferred. I understand that any discrepancies or omissions should be reported immediately.",DEFAULT_PREREQUISITES=[{sortOrder:1,label:"Estimate File Complete",description:"Estimate file has been reviewed and finalized by the Lead Estimator."},{sortOrder:2,label:"Contract Executed",description:"Owner contract has been fully executed and filed."},{sortOrder:3,label:"Job Number Assigned",description:"Official job number has been issued by Accounting."},{sortOrder:4,label:"Site Visit Completed",description:"Operations team has completed an initial site visit."}],DEFAULT_DISCUSSION_ITEMS=[{sortOrder:1,label:"Scope of Work",description:"Review the full scope of work, inclusions, and exclusions."},{sortOrder:2,label:"Budget & Cost Review",description:"Walk through the estimate, GC costs, contingencies, and fee structure."},{sortOrder:3,label:"Schedule Overview",description:"Review project milestones, critical dates, and long-lead items."},{sortOrder:4,label:"Subcontractor Strategy",description:"Discuss subcontractor selections, bid coverage, and procurement plan."},{sortOrder:5,label:"Risk Items",description:"Identify known risks, allowances, exclusions, and potential change orders."},{sortOrder:6,label:"Contract Requirements",description:"Review key contract terms, insurance, bonding, and compliance requirements."},{sortOrder:7,label:"Safety Considerations",description:"Discuss site-specific safety concerns and safety plan requirements."},{sortOrder:8,label:"Quality Requirements",description:"Review quality standards, special inspections, and testing requirements."},{sortOrder:9,label:"Client Expectations",description:"Discuss client communication preferences, reporting, and relationship dynamics."},{sortOrder:10,label:"Open Items & Action Items",description:"Capture outstanding questions, open items, and next steps for the team."}],DEFAULT_EXHIBITS=[{sortOrder:1,label:"Executed Contract",isDefault:!0},{sortOrder:2,label:"Final Estimate / GMP",isDefault:!0},{sortOrder:3,label:"Project Schedule",isDefault:!0},{sortOrder:4,label:"Subcontractor Bid Tabulation",isDefault:!0},{sortOrder:5,label:"Allowance Log",isDefault:!0},{sortOrder:6,label:"Value Engineering Log",isDefault:!0},{sortOrder:7,label:"Insurance & Bonding Docs",isDefault:!0},{sortOrder:8,label:"Site Logistics Plan",isDefault:!0},{sortOrder:9,label:"Permit & NOC Status",isDefault:!0},{sortOrder:10,label:"Project Directory",isDefault:!0}],DEFAULT_SIGNATURES=[{sortOrder:1,role:"Lead Estimator"},{sortOrder:2,role:"Project Executive"},{sortOrder:3,role:"Project Manager"},{sortOrder:4,role:"Superintendent"}],delay=()=>new Promise(r=>setTimeout(r,50));class MockDataService{setCurrentUserRole(role){this._currentRole=role}setDevSuperAdminMode(enabled){this._isDevSuperAdmin=enabled}getMockUsers(){return this.users}updateMockUserRoles(userId,roles){const user=this.users.find(u=>u.id===userId);user&&(user.roles=roles)}constructor(){var _a;this._currentRole=enums.RoleName.ExecutiveLeadership,this._isDevSuperAdmin=!1,this.environmentConfig=JSON.parse(JSON.stringify(environmentConfig_namespaceObject)),this.sectorDefinitions=JSON.parse(JSON.stringify(sectorDefinitions_namespaceObject)),this.bdLeadFolders=new Set,this.assignmentMappings=JSON.parse(JSON.stringify(assignmentMappings_namespaceObject)),this._supportConfig={supportEmail:"support@hedrickbrothers.com",supportPhone:"(561) 844-2922",knowledgeBaseUrl:"https://hedrickbrotherscom.sharepoint.com/sites/HBCentral/SitePages/Help.aspx",feedbackFormUrl:"https://forms.office.com/r/HBCFeedback",responseTimeHours:24},this.leads=JSON.parse(JSON.stringify(leads_namespaceObject));const rawScorecardsData=JSON.parse(JSON.stringify(scorecards_namespaceObject));this.scorecardApprovalCycles=rawScorecardsData.scorecardApprovalCycles||[],this.scorecardApprovalSteps=rawScorecardsData.scorecardApprovalSteps||[],this.scorecardVersions=rawScorecardsData.scorecardVersions||[],this.scorecards=rawScorecardsData.scorecards.map(sc=>this.assembleScorecard(sc)),this.estimatingRecords=JSON.parse(JSON.stringify(estimating_namespaceObject)),this.users=JSON.parse(JSON.stringify(users_namespaceObject)),this.featureFlags=JSON.parse(JSON.stringify(featureFlags_namespaceObject)),this.calendarAvailability=JSON.parse(JSON.stringify(calendarAvailability_namespaceObject)),this.teamMembers=JSON.parse(JSON.stringify(teamMembers_namespaceObject)),this.deliverables=JSON.parse(JSON.stringify(deliverables_namespaceObject)),this.turnoverItems=JSON.parse(JSON.stringify(turnoverItems_namespaceObject)),this.closeoutItems=JSON.parse(JSON.stringify(closeoutItems_namespaceObject)),this.meetings=[],this.notifications=[],this.auditLog=[],this.provisioningLogs=[],this.hubSiteUrl=DEFAULT_HUB_SITE_URL,this.interviewPreps=[],this.contractInfos=[],this.lossAutopsies=JSON.parse(JSON.stringify(lossAutopsies_namespaceObject)),this.checklistItems=JSON.parse(JSON.stringify(startupChecklist_namespaceObject));const matrixData=JSON.parse(JSON.stringify(internalMatrix_namespaceObject));this.internalMatrixTasks=matrixData.tasks,this.teamRoleAssignments=matrixData.teamAssignments,this.ownerContractArticles=JSON.parse(JSON.stringify(ownerContractMatrix_namespaceObject)),this.subContractClauses=JSON.parse(JSON.stringify(subContractMatrix_namespaceObject)),this.marketingRecords=JSON.parse(JSON.stringify(marketingProjectRecords_namespaceObject));const rawRiskCost=JSON.parse(JSON.stringify(riskCostManagement_namespaceObject));this.riskCostItems=[];for(const rc of rawRiskCost)for(const item of[...rc.buyoutOpportunities,...rc.potentialRisks,...rc.potentialSavings])this.riskCostItems.push(Object.assign(Object.assign({},item),{projectCode:rc.projectCode,riskCostId:rc.id}));this.riskCostRecords=rawRiskCost,this.qualityConcerns=JSON.parse(JSON.stringify(qualityConcerns_namespaceObject)),this.safetyConcerns=JSON.parse(JSON.stringify(safetyConcerns_namespaceObject));const rawSchedules=JSON.parse(JSON.stringify(projectScheduleCriticalPath_namespaceObject));this.criticalPathItems=[];for(const s of rawSchedules)for(const item of s.criticalPathConcerns)this.criticalPathItems.push(Object.assign(Object.assign({},item),{projectCode:s.projectCode,scheduleId:s.id}));this.scheduleRecords=rawSchedules;const rawSuperPlans=JSON.parse(JSON.stringify(superintendentPlan_namespaceObject));this.superintendentPlanSections=[];for(const p of rawSuperPlans)for(const sec of p.sections)this.superintendentPlanSections.push(Object.assign(Object.assign({},sec),{superintendentPlanId:p.id,projectCode:p.projectCode}));this.superintendentPlans=rawSuperPlans,this.lessonsLearned=JSON.parse(JSON.stringify(lessonsLearned_namespaceObject)),this.lessonsLearnedHub=[];const rawPMPs=JSON.parse(JSON.stringify(projectManagementPlans_namespaceObject));this.pmpSignatures=[],this.pmpApprovalCycles=[],this.pmpApprovalSteps=[];for(const pmp of rawPMPs){for(const sig of[...pmp.startupSignatures,...pmp.completionSignatures])this.pmpSignatures.push(Object.assign(Object.assign({},sig),{pmpId:pmp.id}));for(const cycle of pmp.approvalCycles){const cycleId=null!==(_a=cycle.id)&&void 0!==_a?_a:100*pmp.id+cycle.cycleNumber;this.pmpApprovalCycles.push(Object.assign(Object.assign({},cycle),{id:cycleId,pmpId:pmp.id,projectCode:pmp.projectCode}));for(const step of cycle.steps)this.pmpApprovalSteps.push(Object.assign(Object.assign({},step),{approvalCycleId:cycleId}))}}this.pmps=rawPMPs,this.divisionApprovers=JSON.parse(JSON.stringify(divisionApprovers_namespaceObject));const rawMonthlyReviews=JSON.parse(JSON.stringify(monthlyProjectReviews_namespaceObject));this.monthlyChecklistItems=[],this.monthlyFollowUps=[];for(const r of rawMonthlyReviews){for(const item of r.checklistItems)this.monthlyChecklistItems.push(Object.assign(Object.assign({},item),{reviewId:r.id}));for(const fu of r.followUps)this.monthlyFollowUps.push(Object.assign(Object.assign({},fu),{reviewId:r.id}))}this.monthlyReviews=rawMonthlyReviews,this.boilerplate=JSON.parse(JSON.stringify(pmpBoilerplate_namespaceObject)),this.jobNumberRequests=JSON.parse(JSON.stringify(jobNumberRequests_namespaceObject));const kickoffData=JSON.parse(JSON.stringify(estimatingKickoffs_namespaceObject));this.estimatingKickoffItems=[],this.estimatingKickoffs=kickoffData.map(k=>{const items=k.items&&k.items.length>0?k.items:createEstimatingKickoffTemplate();for(const item of items)this.estimatingKickoffItems.push(Object.assign(Object.assign({},item),{kickoffId:k.id,projectCode:k.ProjectCode}));return Object.assign(Object.assign({},k),{items})}),this.checklistActivityLog=[];let activityLogId=5e3;for(const ci of this.checklistItems)for(const entry of ci.activityLog)this.checklistActivityLog.push(Object.assign(Object.assign({},entry),{id:activityLogId++,checklistItemId:ci.id,projectCode:ci.projectCode}));this.buyoutEntries=this.enrichBuyoutEntriesWithEVerify(JSON.parse(JSON.stringify(buyoutEntries_namespaceObject))),this.scheduleActivities=JSON.parse(JSON.stringify(scheduleActivities_namespaceObject)),this.scheduleImports=JSON.parse(JSON.stringify(scheduleImports_namespaceObject)),this.constraintLogs=JSON.parse(JSON.stringify(constraintLogs_namespaceObject)),this.permits=JSON.parse(JSON.stringify(permits_namespaceObject)),this.activeProjects=this.generateMockActiveProjects(),this.workflowDefinitions=JSON.parse(JSON.stringify(workflowDefinitions_namespaceObject)),this.workflowStepOverrides=JSON.parse(JSON.stringify(workflowStepOverrides_namespaceObject));const rawTurnoverData=JSON.parse(JSON.stringify(turnoverAgendas_namespaceObject));this.turnoverAgendas=rawTurnoverData.agendas,this.turnoverHeaders=rawTurnoverData.headers,this.turnoverEstimateOverviews=rawTurnoverData.estimateOverviews,this.turnoverPrerequisites=rawTurnoverData.prerequisites,this.turnoverDiscussionItems=rawTurnoverData.discussionItems,this.turnoverSubcontractors=rawTurnoverData.subcontractors,this.turnoverExhibits=rawTurnoverData.exhibits,this.turnoverSignatures=rawTurnoverData.signatures,this.turnoverAttachments=rawTurnoverData.attachments,this.permissionTemplates=JSON.parse(JSON.stringify(permissionTemplates_namespaceObject)),this.securityGroupMappings=JSON.parse(JSON.stringify(securityGroupMappings_namespaceObject)),this.projectTeamAssignments=JSON.parse(JSON.stringify(projectTeamAssignments_namespaceObject)),this.performanceLogs=[],this.helpGuides=JSON.parse(JSON.stringify(helpGuides_namespaceObject)),this.dataMartRecords=[],this.nextId=1e3}generateMockActiveProjects(){return[{id:1,jobNumber:"22-140-01",projectCode:"22-140-01",projectName:"Caretta",status:"Construction",sector:"Commercial",region:"West Palm Beach",personnel:{projectExecutive:"Bob Cashin",leadPM:"Matt Cox",additionalPM:"Ashlie Larson, Pawan Wadhwani",projectAccountant:"Tacara Hickman",projectAssistant:"Yolanda Donado",leadSuper:"JT Torres",superintendent:"Ronnie Poliseo, Chris Carr, Francois DePreist",assistantSuper:"Mardiel Cuesta"},financials:{originalContract:45e6,changeOrders:25e5,currentContractValue:475e5,billingsToDate:32e6,unbilled:45e5,projectedFee:2375e3,projectedFeePct:5,remainingValue:155e5},schedule:{startDate:"2024-02-01",substantialCompletionDate:"2026-08-31",nocExpiration:"2026-06-28",currentPhase:"Vertical Construction",percentComplete:67},riskMetrics:{averageQScore:85,openWaiverCount:1,pendingCommitments:3,complianceStatus:"Green"},statusComments:"On track for August completion",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:2,jobNumber:"20-174-01",projectCode:"20-174-01",projectName:"P&W Olympus",status:"Construction",sector:"Commercial",region:"Orlando",personnel:{projectExecutive:"Arthur Miller",leadPM:"Shligton Estime",projectAccountant:"Tyler Everett",projectAssistant:"Monica Crowley",leadSuper:"Eric Carlson Jr."},financials:{originalContract:78e6,changeOrders:52e5,currentContractValue:832e5,billingsToDate:71e6,unbilled:85e5,projectedFee:416e4,projectedFeePct:5,remainingValue:122e5},schedule:{startDate:"2022-03-01",substantialCompletionDate:"2025-11-30",nocExpiration:"2026-12-31",currentPhase:"Final Finishes",percentComplete:85},riskMetrics:{averageQScore:78,openWaiverCount:0,pendingCommitments:1,complianceStatus:"Yellow"},statusComments:"Nearing completion, punch list in progress",hasUnbilledAlert:!0,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:3,jobNumber:"23-435-01",projectCode:"23-435-01",projectName:"Tropical World Nursery",status:"Construction",sector:"Commercial",region:"Miami",personnel:{projectExecutive:"Bobby Fetting",leadPM:"James Jackson",assistantPM:"Milan Mistry",projectAccountant:"Betty Jo Yorio",leadSuper:"Fred Mangum",superintendent:"Jesus Avila, Anthony Lilly, Mike Morris",assistantSuper:"Rameau Morency"},financials:{originalContract:125e5,changeOrders:85e4,currentContractValue:1335e4,billingsToDate:62e5,unbilled:12e5,projectedFee:667500,projectedFeePct:5,remainingValue:715e4},schedule:{startDate:"2024-10-01",substantialCompletionDate:"2026-05-31",nocExpiration:"2026-10-15",currentPhase:"Structural",percentComplete:46},riskMetrics:{averageQScore:92,openWaiverCount:0,pendingCommitments:5,complianceStatus:"Green"},statusComments:"Progressing well",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:4,jobNumber:"25-745-01",projectCode:"25-745-01",projectName:"Rybovich Safe Harbor",status:"Construction",sector:"Commercial",region:"West Palm Beach",personnel:{projectExecutive:"Paul Fulks",leadPM:"Bob Joy",assistantPM:"Justin Molina",projectAccountant:"Michelle Carlson",projectAssistant:"Ashley Kronshage",leadSuper:"Rene Fernandez",superintendent:"Kevin Watterud, Adam Headrick"},financials:{originalContract:85e5,changeOrders:32e4,currentContractValue:882e4,billingsToDate:21e5,unbilled:65e4,projectedFee:441e3,projectedFeePct:5,remainingValue:672e4},schedule:{startDate:"2025-06-01",substantialCompletionDate:"2026-03-31",nocExpiration:"2026-12-31",currentPhase:"Foundation",percentComplete:24},riskMetrics:{averageQScore:88,openWaiverCount:0,pendingCommitments:8,complianceStatus:"Green"},statusComments:"Early stage, on schedule",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:5,jobNumber:"21-456-01",projectCode:"21-456-01",projectName:"Hanging Moss",status:"Construction",sector:"Residential",region:"Orlando",personnel:{projectExecutive:"Jay Monaghan",leadPM:"Dan Miller",additionalPM:"Jim Pearce",assistantPM:"Clayton Kolar",projectAccountant:"Lori Shanks",leadSuper:"Chris Lineberger",superintendent:"Lucio Salcedo"},financials:{originalContract:35e6,changeOrders:18e5,currentContractValue:368e5,billingsToDate:85e5,unbilled:21e5,projectedFee:184e4,projectedFeePct:5,remainingValue:283e5},schedule:{startDate:"2025-06-01",substantialCompletionDate:"2027-03-31",currentPhase:"Site Work",percentComplete:23},riskMetrics:{averageQScore:82,openWaiverCount:2,pendingCommitments:12,complianceStatus:"Yellow"},statusComments:"In Permitting phase",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:6,jobNumber:"23-145-01",projectCode:"23-145-01",projectName:"Perla",status:"Construction",sector:"Residential",region:"Miami",personnel:{projectExecutive:"Jay Monaghan",leadPM:"Jeff Malone",additionalPM:"Steve Wackes, Fred Young",assistantPM:"Kim Spivey, Patrick Rapport",projectAccountant:"Lori Shanks",leadSuper:"Joe Caliendo",superintendent:"Frank Bobko, Jake Cowan, Michele Wortham",assistantSuper:"Matthew Balkom"},financials:{originalContract:125e6,changeOrders:85e5,currentContractValue:1335e5,billingsToDate:15e6,unbilled:52e5,projectedFee:6675e3,projectedFeePct:5,remainingValue:1185e5},schedule:{startDate:"2026-07-01",substantialCompletionDate:"2028-09-01",nocExpiration:"2026-09-01",currentPhase:"Pre-Construction",percentComplete:11},riskMetrics:{averageQScore:90,openWaiverCount:0,pendingCommitments:4,complianceStatus:"Green"},statusComments:"Mobilizing for start",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:7,jobNumber:"20-535-01",projectCode:"20-535-01",projectName:"PBC MDC PH IV West Tower",status:"Construction",sector:"Commercial",region:"West Palm Beach",personnel:{projectExecutive:"Jack Ullrich",leadPM:"John Richardson",assistantPM:"Yasser Ghareeb",projectAccountant:"Monica Crowley",leadSuper:"John Varney"},financials:{originalContract:95e6,changeOrders:12e6,currentContractValue:107e6,billingsToDate:28e6,unbilled:95e5,projectedFee:535e4,projectedFeePct:5,remainingValue:79e6},schedule:{startDate:"2025-04-01",substantialCompletionDate:"2029-04-30",currentPhase:"Foundation",percentComplete:26},riskMetrics:{averageQScore:75,openWaiverCount:3,pendingCommitments:6,complianceStatus:"Yellow"},statusComments:"Long-term project, progressing",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:8,jobNumber:"24-183-01",projectCode:"24-183-01",projectName:"El's Rec & Aquatics",status:"Construction",sector:"Commercial",region:"West Palm Beach",personnel:{projectExecutive:"Bob Cashin",leadPM:"Amber Wangle",additionalPM:"Andrew Covel",projectAccountant:"Craig Nelson",leadSuper:"Andy Gutierrez"},financials:{originalContract:185e5,changeOrders:95e4,currentContractValue:1945e4,billingsToDate:42e5,unbilled:18e5,projectedFee:972500,projectedFeePct:5,remainingValue:1525e4},schedule:{startDate:"2025-10-01",substantialCompletionDate:"2026-12-31",nocExpiration:"2026-06-26",currentPhase:"Site Work",percentComplete:22},riskMetrics:{averageQScore:86,openWaiverCount:0,pendingCommitments:7,complianceStatus:"Green"},statusComments:"New project, ramping up",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:9,jobNumber:"21-801-01",projectCode:"21-801-01",projectName:"NoRa",status:"Construction",sector:"Residential",region:"Miami",personnel:{projectExecutive:"Bob Cashin",leadPM:"Bill West",additionalPM:"Laura Ratliff",assistantPM:"Jill Voorhees",projectAccountant:"Brad Harrison",leadSuper:"Eric Hudson"},financials:{originalContract:52e6,changeOrders:38e5,currentContractValue:558e5,billingsToDate:485e5,unbilled:32e5,projectedFee:279e4,projectedFeePct:5,remainingValue:73e5},schedule:{startDate:"2023-07-01",substantialCompletionDate:"2025-08-31",nocExpiration:"2026-06-06",currentPhase:"Final Finishes",percentComplete:87},riskMetrics:{averageQScore:81,openWaiverCount:1,pendingCommitments:2,complianceStatus:"Green"},statusComments:"Nearing substantial completion",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:10,jobNumber:"24-011-01",projectCode:"24-011-01",projectName:"Family Church",status:"Construction",sector:"Commercial",region:"West Palm Beach",personnel:{projectExecutive:"Paul Fulks",leadPM:"Boris Lopez",assistantPM:"Jill Voorhees",leadSuper:"Vinny Viaggio",superintendent:"Sam Platovsky"},financials:{originalContract:62e5,changeOrders:28e4,currentContractValue:648e4,billingsToDate:48e5,unbilled:85e4,projectedFee:324e3,projectedFeePct:5,remainingValue:168e4},schedule:{startDate:"2025-06-01",substantialCompletionDate:"2025-12-31",nocExpiration:"2026-05-30",currentPhase:"Interior Finishes",percentComplete:74},riskMetrics:{averageQScore:94,openWaiverCount:0,pendingCommitments:1,complianceStatus:"Green"},statusComments:"On track for year-end completion",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:11,jobNumber:"24-606-01",projectCode:"24-606-01",projectName:"Hilltop Gardens",status:"Precon",sector:"Residential",region:"West Palm Beach",personnel:{projectExecutive:"Bobby Fetting"},financials:{originalContract:28e6,projectedFee:14e5,projectedFeePct:5},schedule:{currentPhase:"Estimating",percentComplete:0},riskMetrics:{complianceStatus:"Green"},statusComments:"In preconstruction",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:12,jobNumber:"25-445-01",projectCode:"25-445-01",projectName:"Keiser Student Housing",status:"Precon",sector:"Commercial",region:"West Palm Beach",personnel:{projectExecutive:"Joe Keating",leadPM:"Bill West",additionalPM:"Tony Mish, Ben Coats",projectAccountant:"Betty Jo Yorio",projectAssistant:"Stacey Helmes",leadSuper:"Ronnie Poliseo"},financials:{originalContract:42e6,projectedFee:21e5,projectedFeePct:5},schedule:{currentPhase:"GMP Development",percentComplete:0},riskMetrics:{complianceStatus:"Green"},statusComments:"GMP in development",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:13,jobNumber:"21-575-01",projectCode:"21-575-01",projectName:"Stuart Middle School - Phase 1",status:"Final Payment",sector:"Commercial",region:"Martin County",personnel:{projectExecutive:"Joe Keating",leadPM:"Ben Coats",projectAccountant:"Tacara Hickman"},financials:{originalContract:158e5,changeOrders:12e5,currentContractValue:17e6,billingsToDate:1685e4,unbilled:15e4,projectedFee:85e4,projectedFeePct:5,remainingValue:15e4},schedule:{startDate:"2022-06-01",substantialCompletionDate:"2024-08-31",currentPhase:"Closeout",percentComplete:99},riskMetrics:{averageQScore:88,openWaiverCount:0,pendingCommitments:0,complianceStatus:"Green"},statusComments:"Awaiting final payment",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()},{id:14,jobNumber:"18-789-01",projectCode:"18-789-01",projectName:"YMCA of the Palm Beaches",status:"Construction",sector:"Commercial",region:"West Palm Beach",personnel:{projectExecutive:"Joe Keating",leadPM:"Dave Rawdon",projectAccountant:"Tanya Stiles",leadSuper:"Tom Holt"},financials:{originalContract:22e6,changeOrders:15e5,currentContractValue:235e5,billingsToDate:52e5,unbilled:18e5,projectedFee:1175e3,projectedFeePct:5,remainingValue:183e5},schedule:{startDate:"2025-07-01",nocExpiration:"2026-12-31",currentPhase:"Foundation",percentComplete:22},riskMetrics:{averageQScore:83,openWaiverCount:1,pendingCommitments:9,complianceStatus:"Green"},statusComments:"New construction underway",hasUnbilledAlert:!1,hasScheduleAlert:!1,hasFeeErosionAlert:!1,lastSyncDate:(new Date).toISOString()}].map(project=>{const unbilledPct=project.financials.currentContractValue?(project.financials.unbilled||0)/project.financials.currentContractValue*100:0;return Object.assign(Object.assign({},project),{hasUnbilledAlert:unbilledPct>=DEFAULT_ALERT_THRESHOLDS_unbilledWarningPct})})}getNextId(){return++this.nextId}async getLeads(options){var _a,_b;await delay();let filtered=[...this.leads];if(null==options?void 0:options.filter){const filterStr=options.filter,stageMatch=filterStr.match(/Stage\s+eq\s+'([^']+)'/i);if(stageMatch){const stageValue=stageMatch[1];filtered=filtered.filter(l=>l.Stage===stageValue)}else{const genericMatch=filterStr.match(/(\w+)\s+eq\s+'([^']+)'/i);if(genericMatch){const fieldName=genericMatch[1],fieldValue=genericMatch[2];filtered=filtered.filter(l=>{const val=l[fieldName];return null!=val&&String(val)===fieldValue})}}}if(null==options?void 0:options.orderBy){const key=options.orderBy,asc=!1!==options.orderAscending;filtered.sort((a,b)=>{const aVal=a[key],bVal=b[key];return null==aVal?1:null==bVal?-1:aVal<bVal?asc?-1:1:aVal>bVal?asc?1:-1:0})}const totalCount=filtered.length,skip=null!==(_a=null==options?void 0:options.skip)&&void 0!==_a?_a:0,top=null!==(_b=null==options?void 0:options.top)&&void 0!==_b?_b:filtered.length;return{items:filtered.slice(skip,skip+top),totalCount,hasMore:skip+top<totalCount}}async getLeadById(id){var _a;return await delay(),null!==(_a=this.leads.find(l=>l.id===id))&&void 0!==_a?_a:null}async getLeadsByStage(stage){return await delay(),this.leads.filter(l=>l.Stage===stage)}async createLead(data){var _a;await delay();const newLead=Object.assign(Object.assign({},data),{id:this.getNextId(),DateOfEvaluation:(new Date).toISOString().split("T")[0],Originator:"kfoster@hedrickbrothers.com",OriginatorId:5,Stage:null!==(_a=data.Stage)&&void 0!==_a?_a:enums.Stage.LeadDiscovery});return this.leads.push(newLead),Object.assign({},newLead)}async updateLead(id,data){await delay();const index=this.leads.findIndex(l=>l.id===id);if(-1===index)throw new Error(`Lead with id ${id} not found`);return this.leads[index]=Object.assign(Object.assign({},this.leads[index]),data),Object.assign({},this.leads[index])}async deleteLead(id){await delay();const index=this.leads.findIndex(l=>l.id===id);if(-1===index)throw new Error(`Lead with id ${id} not found`);this.leads.splice(index,1)}async searchLeads(query){await delay();const q=query.toLowerCase();return this.leads.filter(l=>{var _a,_b,_c;const title=(null!==(_a=l.Title)&&void 0!==_a?_a:"").toLowerCase(),client=(null!==(_b=l.ClientName)&&void 0!==_b?_b:"").toLowerCase(),code=(null!==(_c=l.ProjectCode)&&void 0!==_c?_c:"").toLowerCase();return title.includes(q)||client.includes(q)||code.includes(q)})}assembleScorecard(sc){var _a;const cycles=this.scorecardApprovalCycles.filter(c=>c.scorecardId===sc.id).map(c=>Object.assign(Object.assign({},c),{steps:this.scorecardApprovalSteps.filter(s=>s.cycleId===c.id)})),versions=this.scorecardVersions.filter(v=>v.scorecardId===sc.id);return Object.assign(Object.assign({},sc),{scorecardStatus:sc.scorecardStatus||enums.ScorecardStatus.BDDraft,approvalCycles:cycles,versions,currentVersion:sc.currentVersion||1,isLocked:null!==(_a=sc.isLocked)&&void 0!==_a&&_a})}findScorecardOrThrow(id){const index=this.scorecards.findIndex(s=>s.id===id);if(-1===index)throw new Error(`Scorecard with id ${id} not found`);return{scorecard:this.scorecards[index],index}}createVersionSnapshot(sc,reason,createdBy){const origScores={},cmteScores={};for(const[key,val]of Object.entries(sc.scores))void 0!==val.originator&&(origScores[key]=val.originator),void 0!==val.committee&&(cmteScores[key]=val.committee);const version={id:this.getNextId(),scorecardId:sc.id,versionNumber:sc.currentVersion,createdDate:(new Date).toISOString().split("T")[0],createdBy,reason,originalScores:origScores,committeeScores:cmteScores,totalOriginal:sc.TotalScore_Orig,totalCommittee:sc.TotalScore_Cmte,decision:sc.finalDecision,conditions:sc.conditionalGoConditions};return this.scorecardVersions.push(version),sc.versions.push(version),version}async getScorecardByLeadId(leadId){await delay();const sc=this.scorecards.find(s=>s.LeadID===leadId);return sc?this.assembleScorecard(sc):null}async getScorecards(){return await delay(),this.scorecards.map(sc=>this.assembleScorecard(sc))}async createScorecard(data){var _a,_b;await delay();const newScorecard={id:this.getNextId(),LeadID:null!==(_a=data.LeadID)&&void 0!==_a?_a:0,ProjectCode:data.ProjectCode,scores:null!==(_b=data.scores)&&void 0!==_b?_b:{},TotalScore_Orig:data.TotalScore_Orig,TotalScore_Cmte:data.TotalScore_Cmte,OriginatorComments:data.OriginatorComments,CommitteeComments:data.CommitteeComments,ProposalMarketingComments:data.ProposalMarketingComments,ProposalMarketingResources:data.ProposalMarketingResources,ProposalMarketingHours:data.ProposalMarketingHours,EstimatingComments:data.EstimatingComments,EstimatingResources:data.EstimatingResources,EstimatingHours:data.EstimatingHours,DecisionMakingProcess:data.DecisionMakingProcess,HBDifferentiators:data.HBDifferentiators,WinStrategy:data.WinStrategy,StrategicPursuit:data.StrategicPursuit,DecisionMakerAdvocate:data.DecisionMakerAdvocate,Decision:data.Decision,DecisionDate:data.DecisionDate,ScoredBy_Orig:data.ScoredBy_Orig,ScoredBy_Cmte:data.ScoredBy_Cmte,scorecardStatus:enums.ScorecardStatus.BDDraft,approvalCycles:[],currentVersion:1,versions:[],isLocked:!1};return this.scorecards.push(newScorecard),Object.assign({},newScorecard)}async updateScorecard(id,data){await delay();const index=this.scorecards.findIndex(s=>s.id===id);if(-1===index)throw new Error(`Scorecard with id ${id} not found`);const existing=this.scorecards[index],preserved={approvalCycles:existing.approvalCycles,versions:existing.versions,scorecardStatus:existing.scorecardStatus,isLocked:existing.isLocked,currentVersion:existing.currentVersion,currentApprovalStep:existing.currentApprovalStep};return this.scorecards[index]=Object.assign(Object.assign(Object.assign({},existing),data),preserved),Object.assign({},this.scorecards[index])}async submitGoNoGoDecision(scorecardId,decision,projectCode){await delay();const scIndex=this.scorecards.findIndex(s=>s.id===scorecardId);if(-1===scIndex)throw new Error(`Scorecard with id ${scorecardId} not found`);const scorecard=this.scorecards[scIndex];scorecard.Decision=decision,scorecard.DecisionDate=(new Date).toISOString().split("T")[0],projectCode&&(scorecard.ProjectCode=projectCode);const leadIndex=this.leads.findIndex(l=>l.id===scorecard.LeadID);if(-1!==leadIndex){const lead=this.leads[leadIndex];switch(lead.GoNoGoDecision=decision,lead.GoNoGoDecisionDate=scorecard.DecisionDate,decision){case enums.GoNoGoDecision.Go:lead.Stage=enums.Stage.Opportunity,projectCode&&(lead.ProjectCode=projectCode);break;case enums.GoNoGoDecision.NoGo:lead.Stage=enums.Stage.ArchivedNoGo;break;case enums.GoNoGoDecision.ConditionalGo:lead.Stage=enums.Stage.Opportunity}}}async submitScorecard(scorecardId,submittedBy,approverOverride){var _a,_b,_c;await delay();const{scorecard,index}=this.findScorecardOrThrow(scorecardId),directorAssignee=approverOverride||{displayName:"David Park",email:"dpark@hedrickbrothers.com"},cycleId=this.getNextId(),cycle={id:cycleId,scorecardId,cycleNumber:(null!==(_b=null===(_a=scorecard.approvalCycles)||void 0===_a?void 0:_a.length)&&void 0!==_b?_b:0)+1,version:scorecard.currentVersion,steps:[],startedDate:(new Date).toISOString().split("T")[0],status:"Active"},submitterUser=this.users.find(u=>u.email.toLowerCase()===submittedBy.toLowerCase()),step1={id:this.getNextId(),cycleId,stepOrder:1,name:"BD Rep Submission",assigneeEmail:submittedBy,assigneeName:null!==(_c=null==submitterUser?void 0:submitterUser.displayName)&&void 0!==_c?_c:submittedBy,assignmentSource:"Default",status:"Approved",actionDate:(new Date).toISOString().split("T")[0]},step2={id:this.getNextId(),cycleId,stepOrder:2,name:"Director of Precon Review",assigneeEmail:directorAssignee.email,assigneeName:directorAssignee.displayName,assignmentSource:approverOverride?"Override":"Default",status:"Pending"};return cycle.steps=[step1,step2],this.scorecardApprovalCycles.push(cycle),this.scorecardApprovalSteps.push(step1,step2),scorecard.scorecardStatus=enums.ScorecardStatus.AwaitingDirectorReview,scorecard.currentApprovalStep=1,scorecard.approvalCycles=[...scorecard.approvalCycles||[],cycle],1===scorecard.currentVersion&&0===scorecard.versions.length&&this.createVersionSnapshot(scorecard,"Submitted for review",submittedBy),this.scorecards[index]=scorecard,Object.assign({},scorecard)}async respondToScorecardSubmission(scorecardId,approved,comment){var _a,_b;await delay();const{scorecard,index}=this.findScorecardOrThrow(scorecardId);if(scorecard.scorecardStatus!==enums.ScorecardStatus.AwaitingDirectorReview)throw new Error(`Cannot respond: scorecard is in ${scorecard.scorecardStatus} state`);if(!scorecard.approvalCycles||0===scorecard.approvalCycles.length){const reassembled=this.assembleScorecard(scorecard);scorecard.approvalCycles=reassembled.approvalCycles}const activeCycle=null===(_a=scorecard.approvalCycles)||void 0===_a?void 0:_a.find(c=>"Active"===c.status);if(!activeCycle)throw new Error("No active approval cycle found");const pendingStep=null===(_b=activeCycle.steps)||void 0===_b?void 0:_b.find(s=>"Pending"===s.status);if(!pendingStep)throw new Error("No pending approval step found");approved?(pendingStep.status="Approved",pendingStep.actionDate=(new Date).toISOString().split("T")[0],pendingStep.comment=comment||void 0,scorecard.scorecardStatus=enums.ScorecardStatus.AwaitingCommitteeScoring,scorecard.currentApprovalStep=2):(pendingStep.status="Returned",pendingStep.actionDate=(new Date).toISOString().split("T")[0],pendingStep.comment=comment,scorecard.scorecardStatus=enums.ScorecardStatus.DirectorReturnedForRevision);const stepIdx=this.scorecardApprovalSteps.findIndex(s=>s.id===pendingStep.id);return-1!==stepIdx&&(this.scorecardApprovalSteps[stepIdx]=pendingStep),this.scorecards[index]=scorecard,Object.assign({},scorecard)}async enterCommitteeScores(scorecardId,scores,enteredBy){await delay();const{scorecard,index}=this.findScorecardOrThrow(scorecardId);if(scorecard.scorecardStatus!==enums.ScorecardStatus.AwaitingCommitteeScoring)throw new Error(`Cannot enter committee scores: scorecard is in ${scorecard.scorecardStatus} state`);for(const[criterionId,value]of Object.entries(scores))scorecard.scores[Number(criterionId)]||(scorecard.scores[Number(criterionId)]={}),scorecard.scores[Number(criterionId)].committee=value;if(scorecard.TotalScore_Cmte=calculateTotalScore(scorecard.scores,"committee"),scorecard.committeeScoresEnteredBy=enteredBy,scorecard.committeeScoresEnteredDate=(new Date).toISOString().split("T")[0],scorecard.TotalScore_Cmte){const rec=getRecommendedDecision(scorecard.TotalScore_Cmte);scorecard.recommendedDecision=rec.decision}return this.scorecards[index]=scorecard,Object.assign({},scorecard)}async recordFinalDecision(scorecardId,decision,conditions,decidedBy){var _a;await delay();const{scorecard,index}=this.findScorecardOrThrow(scorecardId);if(scorecard.scorecardStatus!==enums.ScorecardStatus.AwaitingCommitteeScoring)throw new Error(`Cannot record decision: scorecard is in ${scorecard.scorecardStatus} state`);const now=(new Date).toISOString().split("T")[0];scorecard.finalDecision=decision,scorecard.finalDecisionBy=decidedBy,scorecard.finalDecisionDate=now,scorecard.Decision=decision,scorecard.DecisionDate=now,decision===enums.GoNoGoDecision.ConditionalGo&&conditions&&(scorecard.conditionalGoConditions=conditions),decision===enums.GoNoGoDecision.Go||decision===enums.GoNoGoDecision.ConditionalGo?scorecard.scorecardStatus=enums.ScorecardStatus.Go:scorecard.scorecardStatus=enums.ScorecardStatus.NoGo,scorecard.isLocked=!0;const activeCycle=null===(_a=scorecard.approvalCycles)||void 0===_a?void 0:_a.find(c=>"Active"===c.status);activeCycle&&(activeCycle.status="Completed",activeCycle.completedDate=now),this.createVersionSnapshot(scorecard,`Decision recorded: ${decision}`,decidedBy||"system");const leadIndex=this.leads.findIndex(l=>l.id===scorecard.LeadID);if(-1!==leadIndex){const lead=this.leads[leadIndex];switch(lead.GoNoGoDecision=decision,lead.GoNoGoDecisionDate=now,lead.GoNoGoScore_Originator=scorecard.TotalScore_Orig,lead.GoNoGoScore_Committee=scorecard.TotalScore_Cmte,decision){case enums.GoNoGoDecision.Go:case enums.GoNoGoDecision.ConditionalGo:lead.Stage=enums.Stage.Opportunity;break;case enums.GoNoGoDecision.NoGo:lead.Stage=enums.Stage.ArchivedNoGo}}return this.scorecards[index]=scorecard,Object.assign({},scorecard)}async unlockScorecard(scorecardId,reason){await delay();const{scorecard,index}=this.findScorecardOrThrow(scorecardId);if(!scorecard.isLocked)throw new Error("Cannot unlock: scorecard is not locked");return this.createVersionSnapshot(scorecard,`Unlocked: ${reason}`,scorecard.finalDecisionBy||"system"),scorecard.isLocked=!1,scorecard.scorecardStatus=enums.ScorecardStatus.Unlocked,scorecard.currentVersion=(scorecard.currentVersion||1)+1,scorecard.unlockedBy=scorecard.finalDecisionBy,scorecard.unlockedDate=(new Date).toISOString().split("T")[0],scorecard.unlockReason=reason,this.scorecards[index]=scorecard,Object.assign({},scorecard)}async relockScorecard(scorecardId,startNewCycle){var _a,_b,_c;await delay();const{scorecard,index}=this.findScorecardOrThrow(scorecardId);if(startNewCycle){const directorAssignee={displayName:"David Park",email:"dpark@hedrickbrothers.com"},cycleId=this.getNextId(),cycle={id:cycleId,scorecardId,cycleNumber:(null!==(_b=null===(_a=scorecard.approvalCycles)||void 0===_a?void 0:_a.length)&&void 0!==_b?_b:0)+1,version:scorecard.currentVersion,steps:[],startedDate:(new Date).toISOString().split("T")[0],status:"Active"},submitterEmail=scorecard.unlockedBy||scorecard.finalDecisionBy||"system",submitterUser=this.users.find(u=>{var _a;return(null===(_a=u.email)||void 0===_a?void 0:_a.toLowerCase())===submitterEmail.toLowerCase()}),step1={id:this.getNextId(),cycleId,stepOrder:1,name:"BD Rep Resubmission",assigneeEmail:submitterEmail,assigneeName:null!==(_c=null==submitterUser?void 0:submitterUser.displayName)&&void 0!==_c?_c:submitterEmail,assignmentSource:"Default",status:"Approved",actionDate:(new Date).toISOString().split("T")[0]},step2={id:this.getNextId(),cycleId,stepOrder:2,name:"Director of Precon Review",assigneeEmail:directorAssignee.email,assigneeName:directorAssignee.displayName,assignmentSource:"Default",status:"Pending"};cycle.steps=[step1,step2],this.scorecardApprovalCycles.push(cycle),this.scorecardApprovalSteps.push(step1,step2),scorecard.approvalCycles=[...scorecard.approvalCycles||[],cycle],scorecard.scorecardStatus=enums.ScorecardStatus.AwaitingDirectorReview,scorecard.currentApprovalStep=1}else scorecard.scorecardStatus=enums.ScorecardStatus.Locked,scorecard.isLocked=!0,this.createVersionSnapshot(scorecard,"Re-locked without re-approval",scorecard.finalDecisionBy||"system");return this.scorecards[index]=scorecard,Object.assign({},scorecard)}async getScorecardVersions(scorecardId){return await delay(),this.scorecardVersions.filter(v=>v.scorecardId===scorecardId)}async getEstimatingRecords(options){var _a,_b;await delay();let filtered=[...this.estimatingRecords];if(null==options?void 0:options.filter){const match=options.filter.match(/(\w+)\s+eq\s+'([^']+)'/i);if(match){const fieldName=match[1],fieldValue=match[2];filtered=filtered.filter(r=>{const val=r[fieldName];return null!=val&&String(val)===fieldValue})}}if(null==options?void 0:options.orderBy){const key=options.orderBy,asc=!1!==options.orderAscending;filtered.sort((a,b)=>{const aVal=a[key],bVal=b[key];return null==aVal?1:null==bVal?-1:aVal<bVal?asc?-1:1:aVal>bVal?asc?1:-1:0})}const totalCount=filtered.length,skip=null!==(_a=null==options?void 0:options.skip)&&void 0!==_a?_a:0,top=null!==(_b=null==options?void 0:options.top)&&void 0!==_b?_b:filtered.length;return{items:filtered.slice(skip,skip+top),totalCount,hasMore:skip+top<totalCount}}async getEstimatingRecordById(id){var _a;return await delay(),null!==(_a=this.estimatingRecords.find(r=>r.id===id))&&void 0!==_a?_a:null}async getEstimatingByLeadId(leadId){var _a;return await delay(),null!==(_a=this.estimatingRecords.find(r=>r.LeadID===leadId))&&void 0!==_a?_a:null}async createEstimatingRecord(data){var _a,_b,_c;await delay();const newRecord={id:this.getNextId(),Title:null!==(_a=data.Title)&&void 0!==_a?_a:"",LeadID:null!==(_b=data.LeadID)&&void 0!==_b?_b:0,ProjectCode:null!==(_c=data.ProjectCode)&&void 0!==_c?_c:"",Source:data.Source,DeliverableType:data.DeliverableType,SubBidsDue:data.SubBidsDue,PreSubmissionReview:data.PreSubmissionReview,WinStrategyMeeting:data.WinStrategyMeeting,DueDate_OutTheDoor:data.DueDate_OutTheDoor,LeadEstimator:data.LeadEstimator,LeadEstimatorId:data.LeadEstimatorId,Contributors:data.Contributors,ContributorIds:data.ContributorIds,PX_ProjectExecutive:data.PX_ProjectExecutive,PX_ProjectExecutiveId:data.PX_ProjectExecutiveId,Chk_BidBond:data.Chk_BidBond,Chk_PPBond:data.Chk_PPBond,Chk_Schedule:data.Chk_Schedule,Chk_Logistics:data.Chk_Logistics,Chk_BIMProposal:data.Chk_BIMProposal,Chk_PreconProposal:data.Chk_PreconProposal,Chk_ProposalTabs:data.Chk_ProposalTabs,Chk_CoordMarketing:data.Chk_CoordMarketing,Chk_BusinessTerms:data.Chk_BusinessTerms,DocSetStage:data.DocSetStage,PreconFee:data.PreconFee,FeePaidToDate:data.FeePaidToDate,DesignBudget:data.DesignBudget,EstimateType:data.EstimateType,EstimatedCostValue:data.EstimatedCostValue,CostPerGSF:data.CostPerGSF,CostPerUnit:data.CostPerUnit,SubmittedDate:data.SubmittedDate,AwardStatus:data.AwardStatus,NotesFeedback:data.NotesFeedback};return this.estimatingRecords.push(newRecord),Object.assign({},newRecord)}async updateEstimatingRecord(id,data){await delay();const index=this.estimatingRecords.findIndex(r=>r.id===id);if(-1===index)throw new Error(`Estimating record with id ${id} not found`);return this.estimatingRecords[index]=Object.assign(Object.assign({},this.estimatingRecords[index]),data),Object.assign({},this.estimatingRecords[index])}async getCurrentPursuits(){return await delay(),this.estimatingRecords.filter(r=>!(r.AwardStatus&&"Pending"!==r.AwardStatus||r.SubmittedDate))}async getPreconEngagements(){return await delay(),this.estimatingRecords.filter(r=>void 0!==r.PreconFee&&null!==r.PreconFee&&r.PreconFee>0)}async getEstimateLog(){return await delay(),this.estimatingRecords.filter(r=>void 0!==r.SubmittedDate&&null!==r.SubmittedDate)}async getCurrentUser(){var _a,_b,_c,_d;if(await delay(),this._isDevSuperAdmin){const allPerms=new Set;for(const perms of Object.values(ROLE_PERMISSIONS))for(const p of perms)allPerms.add(p);return{id:0,displayName:"Dev Super-Admin",email:"superadmin@hedrickbrothers.dev",loginName:"i:0#.f|membership|superadmin@hedrickbrothers.dev",roles:[enums.RoleName.ExecutiveLeadership],permissions:allPerms,photoUrl:void 0}}const roleName=this._currentRole,perms=null!==(_a=ROLE_PERMISSIONS[roleName])&&void 0!==_a?_a:[],matchingUser=this.users.find(u=>u.roles.includes(roleName)),email=null!==(_b=null==matchingUser?void 0:matchingUser.email)&&void 0!==_b?_b:"devuser@hedrickbrothers.com";return{id:null!==(_c=null==matchingUser?void 0:matchingUser.id)&&void 0!==_c?_c:999,displayName:null!==(_d=null==matchingUser?void 0:matchingUser.displayName)&&void 0!==_d?_d:"Dev User",email,loginName:`i:0#.f|membership|${email}`,roles:[roleName],permissions:new Set(perms),photoUrl:void 0}}async getRoles(){await delay();return Object.values(enums.RoleName).map((name,idx)=>{var _a;const matchingUsers=this.users.filter(u=>u.roles.includes(name));return{id:idx+1,Title:name,UserOrGroup:matchingUsers.map(u=>u.email),UserOrGroupIds:matchingUsers.map(u=>u.id),Permissions:null!==(_a=ROLE_PERMISSIONS[name])&&void 0!==_a?_a:[],IsActive:!0}})}async updateRole(id,data){await delay();const role=(await this.getRoles()).find(r=>r.id===id);if(!role)throw new Error(`Role with id ${id} not found`);return Object.assign(Object.assign({},role),data)}async getFeatureFlags(){return await delay(),[...this.featureFlags]}async updateFeatureFlag(id,data){await delay();const index=this.featureFlags.findIndex(f=>f.id===id);if(-1===index)throw new Error(`Feature flag with id ${id} not found`);return this.featureFlags[index]=Object.assign(Object.assign({},this.featureFlags[index]),data),Object.assign({},this.featureFlags[index])}async getCalendarAvailability(emails,_startDate,_endDate){return await delay(),this.calendarAvailability.filter(ca=>emails.includes(ca.email))}async createMeeting(meeting){var _a,_b,_c,_d,_e,_f,_g;await delay();const newMeeting={id:`meeting-${this.getNextId()}`,subject:null!==(_a=meeting.subject)&&void 0!==_a?_a:"Untitled Meeting",type:null!==(_b=meeting.type)&&void 0!==_b?_b:enums.MeetingType.Other,startTime:null!==(_c=meeting.startTime)&&void 0!==_c?_c:(new Date).toISOString(),endTime:null!==(_d=meeting.endTime)&&void 0!==_d?_d:(new Date).toISOString(),attendees:null!==(_e=meeting.attendees)&&void 0!==_e?_e:[],location:meeting.location,teamsLink:null!==(_f=meeting.teamsLink)&&void 0!==_f?_f:`https://teams.microsoft.com/l/meetup-join/${this.getNextId()}`,projectCode:meeting.projectCode,leadId:meeting.leadId,createdBy:null!==(_g=meeting.createdBy)&&void 0!==_g?_g:"kfoster@hedrickbrothers.com",createdAt:(new Date).toISOString()};return this.meetings.push(newMeeting),Object.assign({},newMeeting)}async getMeetings(projectCode){return await delay(),projectCode?this.meetings.filter(m=>m.projectCode===projectCode):[...this.meetings]}async sendNotification(notification){var _a,_b,_c,_d,_e;await delay();const newNotification={id:`notif-${this.getNextId()}`,type:null!==(_a=notification.type)&&void 0!==_a?_a:enums.NotificationType.Email,subject:null!==(_b=notification.subject)&&void 0!==_b?_b:"",body:null!==(_c=notification.body)&&void 0!==_c?_c:"",recipients:null!==(_d=notification.recipients)&&void 0!==_d?_d:[],sentAt:(new Date).toISOString(),sentBy:null!==(_e=notification.sentBy)&&void 0!==_e?_e:"kfoster@hedrickbrothers.com",relatedEntityType:notification.relatedEntityType,relatedEntityId:notification.relatedEntityId,projectCode:notification.projectCode,status:"sent"};return this.notifications.push(newNotification),Object.assign({},newNotification)}async getNotifications(projectCode){return await delay(),projectCode?this.notifications.filter(n=>n.projectCode===projectCode):[...this.notifications]}async logAudit(entry){var _a,_b,_c,_d,_e,_f,_g;await delay();const auditEntry={id:this.getNextId(),Timestamp:null!==(_a=entry.Timestamp)&&void 0!==_a?_a:(new Date).toISOString(),User:null!==(_b=entry.User)&&void 0!==_b?_b:"kfoster@hedrickbrothers.com",UserId:null!==(_c=entry.UserId)&&void 0!==_c?_c:5,Action:null!==(_d=entry.Action)&&void 0!==_d?_d:enums.AuditAction.LeadEdited,EntityType:null!==(_e=entry.EntityType)&&void 0!==_e?_e:enums.EntityType.Lead,EntityId:null!==(_f=entry.EntityId)&&void 0!==_f?_f:"",ProjectCode:entry.ProjectCode,FieldChanged:entry.FieldChanged,PreviousValue:entry.PreviousValue,NewValue:entry.NewValue,Details:null!==(_g=entry.Details)&&void 0!==_g?_g:""};this.auditLog.push(auditEntry)}async getAuditLog(entityType,entityId,startDate,endDate){await delay();let results=[...this.auditLog];if(entityType&&(results=results.filter(e=>e.EntityType===entityType)),entityId&&(results=results.filter(e=>e.EntityId===entityId)),startDate){const start=new Date(startDate).getTime();results=results.filter(e=>new Date(e.Timestamp).getTime()>=start)}if(endDate){const end=new Date(endDate).getTime();results=results.filter(e=>new Date(e.Timestamp).getTime()<=end)}return results.sort((a,b)=>new Date(b.Timestamp).getTime()-new Date(a.Timestamp).getTime())}async triggerProvisioning(leadId,projectCode,projectName,requestedBy,metadata){await delay();const log={id:this.getNextId(),projectCode,projectName,leadId,status:enums.ProvisioningStatus.Queued,currentStep:0,completedSteps:0,retryCount:0,requestedBy,requestedAt:(new Date).toISOString(),division:null==metadata?void 0:metadata.division,region:null==metadata?void 0:metadata.region,clientName:null==metadata?void 0:metadata.clientName};return this.provisioningLogs.push(log),Object.assign({},log)}async getProvisioningStatus(projectCode){await delay();const log=this.provisioningLogs.find(l=>l.projectCode===projectCode);return log?Object.assign({},log):null}async updateProvisioningLog(projectCode,data){await delay();const index=this.provisioningLogs.findIndex(l=>l.projectCode===projectCode);if(-1===index)throw new Error(`Provisioning log for ${projectCode} not found`);return this.provisioningLogs[index]=Object.assign(Object.assign({},this.provisioningLogs[index]),data),Object.assign({},this.provisioningLogs[index])}async getProvisioningLogs(){return await delay(),[...this.provisioningLogs].sort((a,b)=>new Date(b.requestedAt).getTime()-new Date(a.requestedAt).getTime())}async retryProvisioning(projectCode,fromStep){await delay();const index=this.provisioningLogs.findIndex(l=>l.projectCode===projectCode);if(-1===index)throw new Error(`Provisioning log for ${projectCode} not found`);const log=this.provisioningLogs[index];return log.status=enums.ProvisioningStatus.InProgress,log.currentStep=fromStep,log.failedStep=void 0,log.errorMessage=void 0,log.retryCount+=1,Object.assign({},log)}async createProjectSite(projectCode,_projectName,siteAlias){await delay();const siteUrl=`https://hedrickbrotherscom.sharepoint.com/sites/${siteAlias}`;return console.log(`[Mock] Created project site: ${siteUrl} for ${projectCode}`),{siteUrl}}async provisionProjectLists(siteUrl,projectCode){await delay(),console.log(`[Mock] Provisioned 42 lists on ${siteUrl} for ${projectCode}`)}async associateWithHubSite(siteUrl,hubSiteUrl){await delay(),console.log(`[Mock] Associated ${siteUrl} with hub ${hubSiteUrl}`)}async createProjectSecurityGroups(siteUrl,projectCode,division){await delay(),console.log(`[Mock] Created security groups for ${projectCode} (${division}) on ${siteUrl}`)}async copyTemplateFiles(siteUrl,projectCode,division){await delay(),console.log(`[Mock] Copied template files (${division}) to ${siteUrl} for ${projectCode}`)}async copyLeadDataToProjectSite(siteUrl,leadId,projectCode){await delay(),console.log(`[Mock] Copied lead data (ID: ${leadId}) to ${siteUrl} for ${projectCode}`)}async updateSiteProperties(siteUrl,properties){await delay(),console.log(`[Mock] Updated site properties on ${siteUrl}:`,Object.keys(properties))}async createList(siteUrl,listName,_templateType,fields){await delay(),console.log(`[Mock] Created list "${listName}" with ${fields.length} fields on ${siteUrl}`)}async getTemplateSiteConfig(){await delay(),console.log("[Mock] getTemplateSiteConfig");const raw=templateSiteConfig_namespaceObject;return{id:raw.id,templateSiteUrl:raw.TemplateSiteUrl,lastSnapshotHash:raw.LastSnapshotHash,lastSnapshotDate:raw.LastSnapshotDate,githubRepoOwner:raw.GitHubRepoOwner,githubRepoName:raw.GitHubRepoName,githubBranch:raw.GitHubBranch,active:raw.Active}}async updateTemplateSiteConfig(data){await delay(),console.log("[Mock] updateTemplateSiteConfig",data);const current=await this.getTemplateSiteConfig();return Object.assign(Object.assign({},current),data)}async getCommittedTemplateRegistry(){await delay(),console.log("[Mock] getCommittedTemplateRegistry");const raw=templateRegistry;return{version:"1.0.0",lastModified:(new Date).toISOString(),lastModifiedBy:"mock@hedrickbrothers.com",templates:raw.map(r=>{var _a;return{id:String(r.id),templateName:r.TemplateName,sourcePath:r.SourceURL,targetFolder:r.TargetFolder,fileName:null!==(_a=r.SourceURL.split("/").pop())&&void 0!==_a?_a:"",division:r.Division,active:r.Active,fileHash:`sha256:mock-hash-${r.id}`,fileSize:5e4,lastModifiedInTemplateSite:"2026-01-15T10:00:00Z"}})}}async getTemplateSiteFiles(){await delay(),console.log("[Mock] getTemplateSiteFiles");return(await this.getCommittedTemplateRegistry()).templates.map(t=>({sourcePath:t.sourcePath,fileName:t.fileName,fileHash:t.fileHash,fileSize:t.fileSize,lastModified:t.lastModifiedInTemplateSite,division:t.division}))}async applyGitOpsTemplates(siteUrl,division,registry){await delay();const applicable=registry.templates.filter(t=>t.active&&("Both"===t.division||t.division===division));return console.log(`[Mock] applyGitOpsTemplates â†’ siteUrl=${siteUrl}, division=${division}, appliedCount=${applicable.length}`),{appliedCount:applicable.length}}async logTemplateSyncPR(entry){await delay();const id=this.getNextId(),log=Object.assign({id},entry);return console.log("[Mock] logTemplateSyncPR",log),log}async getTeamMembers(projectCode){return await delay(),this.teamMembers.filter(tm=>tm.projectCode===projectCode)}async getDeliverables(projectCode){return await delay(),this.deliverables.filter(d=>d.projectCode===projectCode)}async createDeliverable(data){var _a,_b,_c,_d,_e,_f;await delay();const newItem={id:this.getNextId(),projectCode:null!==(_a=data.projectCode)&&void 0!==_a?_a:"",name:null!==(_b=data.name)&&void 0!==_b?_b:"",department:null!==(_c=data.department)&&void 0!==_c?_c:"BD",assignedTo:null!==(_d=data.assignedTo)&&void 0!==_d?_d:"",assignedToId:data.assignedToId,status:null!==(_e=data.status)&&void 0!==_e?_e:"Not Started",dueDate:null!==(_f=data.dueDate)&&void 0!==_f?_f:(new Date).toISOString().split("T")[0],completedDate:data.completedDate,notes:data.notes};return this.deliverables.push(newItem),Object.assign({},newItem)}async updateDeliverable(id,data){await delay();const index=this.deliverables.findIndex(d=>d.id===id);if(-1===index)throw new Error(`Deliverable with id ${id} not found`);return this.deliverables[index]=Object.assign(Object.assign({},this.deliverables[index]),data),Object.assign({},this.deliverables[index])}async getInterviewPrep(leadId){var _a;return await delay(),null!==(_a=this.interviewPreps.find(ip=>ip.leadId===leadId))&&void 0!==_a?_a:null}async saveInterviewPrep(data){var _a,_b,_c;await delay();const existing=this.interviewPreps.findIndex(ip=>ip.leadId===data.leadId);if(existing>=0)return this.interviewPreps[existing]=Object.assign(Object.assign({},this.interviewPreps[existing]),data),Object.assign({},this.interviewPreps[existing]);const newItem={id:this.getNextId(),leadId:null!==(_a=data.leadId)&&void 0!==_a?_a:0,projectCode:null!==(_b=data.projectCode)&&void 0!==_b?_b:"",interviewDate:data.interviewDate,interviewLocation:data.interviewLocation,panelMembers:null!==(_c=data.panelMembers)&&void 0!==_c?_c:[],presentationTheme:data.presentationTheme,keyMessages:data.keyMessages,teamAssignments:data.teamAssignments,rehearsalDate:data.rehearsalDate,documents:data.documents};return this.interviewPreps.push(newItem),Object.assign({},newItem)}async getContractInfo(projectCode){var _a;return await delay(),null!==(_a=this.contractInfos.find(c=>c.projectCode===projectCode))&&void 0!==_a?_a:null}async saveContractInfo(data){var _a,_b,_c;await delay();const existing=this.contractInfos.findIndex(c=>c.projectCode===data.projectCode);if(existing>=0)return this.contractInfos[existing]=Object.assign(Object.assign({},this.contractInfos[existing]),data),Object.assign({},this.contractInfos[existing]);const newItem={id:this.getNextId(),leadId:null!==(_a=data.leadId)&&void 0!==_a?_a:0,projectCode:null!==(_b=data.projectCode)&&void 0!==_b?_b:"",contractStatus:null!==(_c=data.contractStatus)&&void 0!==_c?_c:"Draft",contractType:data.contractType,contractValue:data.contractValue,insuranceRequirements:data.insuranceRequirements,bondRequirements:data.bondRequirements,executionDate:data.executionDate,noticeToProceed:data.noticeToProceed,substantialCompletion:data.substantialCompletion,finalCompletion:data.finalCompletion,documents:data.documents};return this.contractInfos.push(newItem),Object.assign({},newItem)}async getTurnoverItems(projectCode){return await delay(),this.turnoverItems.filter(t=>t.projectCode===projectCode)}async updateTurnoverItem(id,data){await delay();const index=this.turnoverItems.findIndex(t=>t.id===id);if(-1===index)throw new Error(`Turnover item with id ${id} not found`);return this.turnoverItems[index]=Object.assign(Object.assign({},this.turnoverItems[index]),data),Object.assign({},this.turnoverItems[index])}async getCloseoutItems(projectCode){return await delay(),this.closeoutItems.filter(c=>c.projectCode===projectCode&&!c.isHidden)}async updateCloseoutItem(id,data){await delay();const index=this.closeoutItems.findIndex(c=>c.id===id);if(-1===index)throw new Error(`Closeout item with id ${id} not found`);return this.closeoutItems[index]=Object.assign(Object.assign({},this.closeoutItems[index]),data),Object.assign({},this.closeoutItems[index])}async addCloseoutItem(projectCode,item){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;await delay();const newItem={id:this.getNextId(),projectCode,category:null!==(_b=null!==(_a=item.sectionName)&&void 0!==_a?_a:item.category)&&void 0!==_b?_b:"",description:null!==(_d=null!==(_c=item.label)&&void 0!==_c?_c:item.description)&&void 0!==_d?_d:"Custom item",status:"NoResponse",assignedTo:null!==(_e=item.assignedTo)&&void 0!==_e?_e:"",assignedToId:item.assignedToId,completedDate:void 0,notes:void 0,sectionNumber:null!==(_f=item.sectionNumber)&&void 0!==_f?_f:1,sectionName:null!==(_g=item.sectionName)&&void 0!==_g?_g:"Tasks",itemNumber:null!==(_h=item.itemNumber)&&void 0!==_h?_h:"C.1",label:null!==(_j=item.label)&&void 0!==_j?_j:"Custom item",responseType:null!==(_k=item.responseType)&&void 0!==_k?_k:"yesNoNA",response:null,respondedBy:void 0,respondedDate:void 0,comment:void 0,isHidden:!1,isCustom:!0,sortOrder:null!==(_l=item.sortOrder)&&void 0!==_l?_l:100};return this.closeoutItems.push(newItem),Object.assign({},newItem)}async removeCloseoutItem(projectCode,itemId){await delay();const index=this.closeoutItems.findIndex(c=>c.id===itemId&&c.projectCode===projectCode);if(-1===index)throw new Error(`Closeout item with id ${itemId} not found`);this.closeoutItems[index].isHidden=!0}async getLossAutopsy(leadId){var _a;return await delay(),null!==(_a=this.lossAutopsies.find(la=>la.leadId===leadId))&&void 0!==_a?_a:null}async saveLossAutopsy(data){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s;await delay();const existing=this.lossAutopsies.findIndex(la=>la.leadId===data.leadId);if(existing>=0)return this.lossAutopsies[existing]=Object.assign(Object.assign({},this.lossAutopsies[existing]),data),Object.assign({},this.lossAutopsies[existing]);const newItem={id:this.getNextId(),leadId:null!==(_a=data.leadId)&&void 0!==_a?_a:0,projectCode:data.projectCode,rootCauseAnalysis:data.rootCauseAnalysis,lessonsLearned:data.lessonsLearned,competitiveIntelligence:data.competitiveIntelligence,actionItems:null!==(_b=data.actionItems)&&void 0!==_b?_b:[],meetingNotes:data.meetingNotes,completedDate:data.completedDate,completedBy:data.completedBy,realisticTimeline:null!==(_c=data.realisticTimeline)&&void 0!==_c?_c:null,scopesBeforeProposals:null!==(_d=data.scopesBeforeProposals)&&void 0!==_d?_d:null,threeBidsPerTrade:null!==(_e=data.threeBidsPerTrade)&&void 0!==_e?_e:null,reasonableITBTime:null!==(_f=data.reasonableITBTime)&&void 0!==_f?_f:null,bidsSavedProperly:null!==(_g=data.bidsSavedProperly)&&void 0!==_g?_g:null,multipleSubCommunications:null!==(_h=data.multipleSubCommunications)&&void 0!==_h?_h:null,vettedProposals:null!==(_j=data.vettedProposals)&&void 0!==_j?_j:null,reasonableSpread:null!==(_k=data.reasonableSpread)&&void 0!==_k?_k:null,pricesMatchHistorical:null!==(_l=data.pricesMatchHistorical)&&void 0!==_l?_l:null,veOptionsOffered:null!==(_m=data.veOptionsOffered)&&void 0!==_m?_m:null,deliverablesOnTime:null!==(_o=data.deliverablesOnTime)&&void 0!==_o?_o:null,processScore:null!==(_p=data.processScore)&&void 0!==_p?_p:0,strengths:data.strengths,weaknesses:data.weaknesses,opportunities:data.opportunities,challenges:data.challenges,overallRating:null!==(_q=data.overallRating)&&void 0!==_q?_q:0,meetingScheduledDate:data.meetingScheduledDate,meetingAttendees:null!==(_r=data.meetingAttendees)&&void 0!==_r?_r:[],isFinalized:null!==(_s=data.isFinalized)&&void 0!==_s&&_s,finalizedDate:data.finalizedDate,finalizedBy:data.finalizedBy};return this.lossAutopsies.push(newItem),Object.assign({},newItem)}async finalizeLossAutopsy(leadId,data){var _a;await delay();const index=this.lossAutopsies.findIndex(la=>la.leadId===leadId);if(-1===index)throw new Error(`No autopsy found for lead ${leadId}`);return this.lossAutopsies[index]=Object.assign(Object.assign(Object.assign({},this.lossAutopsies[index]),data),{isFinalized:!0,finalizedDate:(new Date).toISOString(),finalizedBy:null!==(_a=data.finalizedBy)&&void 0!==_a?_a:"system"}),Object.assign({},this.lossAutopsies[index])}async isAutopsyFinalized(leadId){var _a;await delay();const autopsy=this.lossAutopsies.find(la=>la.leadId===leadId);return null!==(_a=null==autopsy?void 0:autopsy.isFinalized)&&void 0!==_a&&_a}async getAllLossAutopsies(){return await delay(),this.lossAutopsies.map(a=>Object.assign({},a))}async getStartupChecklist(projectCode){return await delay(),this.checklistItems.filter(i=>i.projectCode===projectCode&&!i.isHidden)}async updateChecklistItem(projectCode,itemId,data){await delay();const index=this.checklistItems.findIndex(i=>i.id===itemId&&i.projectCode===projectCode);if(-1===index)throw new Error(`Checklist item ${itemId} not found`);return this.checklistItems[index]=Object.assign(Object.assign({},this.checklistItems[index]),data),Object.assign({},this.checklistItems[index])}async addChecklistItem(projectCode,item){var _a,_b,_c,_d,_e,_f;await delay();const newItem={id:this.getNextId(),projectCode,sectionNumber:null!==(_a=item.sectionNumber)&&void 0!==_a?_a:2,sectionName:null!==(_b=item.sectionName)&&void 0!==_b?_b:"Job Start-up",itemNumber:null!==(_c=item.itemNumber)&&void 0!==_c?_c:"C.1",label:null!==(_d=item.label)&&void 0!==_d?_d:"Custom item",responseType:null!==(_e=item.responseType)&&void 0!==_e?_e:"yesNoNA",response:null,status:"NoResponse",respondedBy:null,respondedDate:null,assignedTo:null,assignedToName:null,comment:null,isHidden:!1,isCustom:!0,sortOrder:null!==(_f=item.sortOrder)&&void 0!==_f?_f:100,activityLog:[]};return this.checklistItems.push(newItem),Object.assign({},newItem)}async removeChecklistItem(projectCode,itemId){await delay();const index=this.checklistItems.findIndex(i=>i.id===itemId&&i.projectCode===projectCode);if(-1===index)throw new Error(`Checklist item ${itemId} not found`);this.checklistItems[index].isHidden=!0}async getInternalMatrix(projectCode){return await delay(),this.internalMatrixTasks.filter(t=>t.projectCode===projectCode&&!t.isHidden)}async updateInternalMatrixTask(projectCode,taskId,data){await delay();const index=this.internalMatrixTasks.findIndex(t=>t.id===taskId&&t.projectCode===projectCode);if(-1===index)throw new Error(`Matrix task ${taskId} not found`);return this.internalMatrixTasks[index]=Object.assign(Object.assign({},this.internalMatrixTasks[index]),data),Object.assign({},this.internalMatrixTasks[index])}async addInternalMatrixTask(projectCode,task){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k;await delay();const newTask={id:this.getNextId(),projectCode,sortOrder:null!==(_a=task.sortOrder)&&void 0!==_a?_a:100,taskCategory:null!==(_b=task.taskCategory)&&void 0!==_b?_b:"All",taskDescription:null!==(_c=task.taskDescription)&&void 0!==_c?_c:"Custom task",PX:null!==(_d=task.PX)&&void 0!==_d?_d:"",SrPM:null!==(_e=task.SrPM)&&void 0!==_e?_e:"",PM2:null!==(_f=task.PM2)&&void 0!==_f?_f:"",PM1:null!==(_g=task.PM1)&&void 0!==_g?_g:"",PA:null!==(_h=task.PA)&&void 0!==_h?_h:"",QAQC:null!==(_j=task.QAQC)&&void 0!==_j?_j:"",ProjAcct:null!==(_k=task.ProjAcct)&&void 0!==_k?_k:"",isHidden:!1,isCustom:!0};return this.internalMatrixTasks.push(newTask),Object.assign({},newTask)}async removeInternalMatrixTask(projectCode,taskId){await delay();const index=this.internalMatrixTasks.findIndex(t=>t.id===taskId&&t.projectCode===projectCode);if(-1===index)throw new Error(`Matrix task ${taskId} not found`);this.internalMatrixTasks[index].isHidden=!0}async getTeamRoleAssignments(projectCode){return await delay(),this.teamRoleAssignments.filter(a=>a.projectCode===projectCode)}async updateTeamRoleAssignment(projectCode,role,person,email){await delay();const index=this.teamRoleAssignments.findIndex(a=>a.projectCode===projectCode&&a.roleAbbreviation===role);if(-1!==index)return this.teamRoleAssignments[index].assignedPerson=person,this.teamRoleAssignments[index].assignedPersonEmail=null!=email?email:"",Object.assign({},this.teamRoleAssignments[index]);const newAssignment={projectCode,roleAbbreviation:role,assignedPerson:person,assignedPersonEmail:null!=email?email:""};return this.teamRoleAssignments.push(newAssignment),Object.assign({},newAssignment)}async getOwnerContractMatrix(projectCode){return await delay(),this.ownerContractArticles.filter(a=>a.projectCode===projectCode&&!a.isHidden)}async updateOwnerContractArticle(projectCode,itemId,data){await delay();const index=this.ownerContractArticles.findIndex(a=>a.id===itemId&&a.projectCode===projectCode);if(-1===index)throw new Error(`Owner contract article ${itemId} not found`);return this.ownerContractArticles[index]=Object.assign(Object.assign({},this.ownerContractArticles[index]),data),Object.assign({},this.ownerContractArticles[index])}async addOwnerContractArticle(projectCode,item){var _a,_b,_c,_d,_e;await delay();const newArticle={id:this.getNextId(),projectCode,sortOrder:null!==(_a=item.sortOrder)&&void 0!==_a?_a:100,articleNumber:null!==(_b=item.articleNumber)&&void 0!==_b?_b:"",pageNumber:null!==(_c=item.pageNumber)&&void 0!==_c?_c:"",responsibleParty:null!==(_d=item.responsibleParty)&&void 0!==_d?_d:"",description:null!==(_e=item.description)&&void 0!==_e?_e:"Custom article",isHidden:!1,isCustom:!0};return this.ownerContractArticles.push(newArticle),Object.assign({},newArticle)}async removeOwnerContractArticle(projectCode,itemId){await delay();const index=this.ownerContractArticles.findIndex(a=>a.id===itemId&&a.projectCode===projectCode);if(-1===index)throw new Error(`Owner contract article ${itemId} not found`);this.ownerContractArticles[index].isHidden=!0}async getSubContractMatrix(projectCode){return await delay(),this.subContractClauses.filter(c=>c.projectCode===projectCode&&!c.isHidden)}async updateSubContractClause(projectCode,itemId,data){await delay();const index=this.subContractClauses.findIndex(c=>c.id===itemId&&c.projectCode===projectCode);if(-1===index)throw new Error(`Subcontract clause ${itemId} not found`);return this.subContractClauses[index]=Object.assign(Object.assign({},this.subContractClauses[index]),data),Object.assign({},this.subContractClauses[index])}async addSubContractClause(projectCode,item){var _a,_b,_c,_d,_e,_f,_g,_h,_j;await delay();const newClause={id:this.getNextId(),projectCode,sortOrder:null!==(_a=item.sortOrder)&&void 0!==_a?_a:100,refNumber:null!==(_b=item.refNumber)&&void 0!==_b?_b:"",pageNumber:null!==(_c=item.pageNumber)&&void 0!==_c?_c:"",clauseDescription:null!==(_d=item.clauseDescription)&&void 0!==_d?_d:"Custom clause",ProjExec:null!==(_e=item.ProjExec)&&void 0!==_e?_e:"",ProjMgr:null!==(_f=item.ProjMgr)&&void 0!==_f?_f:"",AsstPM:null!==(_g=item.AsstPM)&&void 0!==_g?_g:"",Super:null!==(_h=item.Super)&&void 0!==_h?_h:"",ProjAdmin:null!==(_j=item.ProjAdmin)&&void 0!==_j?_j:"",isHidden:!1,isCustom:!0};return this.subContractClauses.push(newClause),Object.assign({},newClause)}async removeSubContractClause(projectCode,itemId){await delay();const index=this.subContractClauses.findIndex(c=>c.id===itemId&&c.projectCode===projectCode);if(-1===index)throw new Error(`Subcontract clause ${itemId} not found`);this.subContractClauses[index].isHidden=!0}async getMarketingProjectRecord(projectCode){var _a;return await delay(),null!==(_a=this.marketingRecords.find(r=>r.projectCode===projectCode))&&void 0!==_a?_a:null}async createMarketingProjectRecord(data){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_20,_21,_22,_23,_24,_25,_26,_27,_28,_29,_30,_31,_32,_33,_34,_35,_36,_37,_38,_39;await delay();const newRecord={projectName:null!==(_a=data.projectName)&&void 0!==_a?_a:"",projectCode:null!==(_b=data.projectCode)&&void 0!==_b?_b:"",leadId:null!==(_c=data.leadId)&&void 0!==_c?_c:null,contractType:null!==(_d=data.contractType)&&void 0!==_d?_d:[],deliveryMethod:null!==(_e=data.deliveryMethod)&&void 0!==_e?_e:"",architect:null!==(_f=data.architect)&&void 0!==_f?_f:"",landscapeArchitect:null!==(_g=data.landscapeArchitect)&&void 0!==_g?_g:"",interiorDesigner:null!==(_h=data.interiorDesigner)&&void 0!==_h?_h:"",engineer:null!==(_j=data.engineer)&&void 0!==_j?_j:"",buildingSystemType:null!==(_k=data.buildingSystemType)&&void 0!==_k?_k:"",projectDescription:null!==(_l=data.projectDescription)&&void 0!==_l?_l:"",uniqueCharacteristics:null!==(_m=data.uniqueCharacteristics)&&void 0!==_m?_m:"",renderingUrls:null!==(_o=data.renderingUrls)&&void 0!==_o?_o:[],finalPhotoUrls:null!==(_p=data.finalPhotoUrls)&&void 0!==_p?_p:[],contractBudget:null!==(_q=data.contractBudget)&&void 0!==_q?_q:null,contractFinalCost:null!==(_r=data.contractFinalCost)&&void 0!==_r?_r:null,totalCostPerGSF:null!==(_s=data.totalCostPerGSF)&&void 0!==_s?_s:null,totalBudgetVariance:null!==(_t=data.totalBudgetVariance)&&void 0!==_t?_t:null,budgetExplanation:null!==(_u=data.budgetExplanation)&&void 0!==_u?_u:"",CO_OwnerDirected_Count:null!==(_v=data.CO_OwnerDirected_Count)&&void 0!==_v?_v:null,CO_OwnerDirected_Value:null!==(_w=data.CO_OwnerDirected_Value)&&void 0!==_w?_w:null,CO_MunicipalityDirected_Count:null!==(_x=data.CO_MunicipalityDirected_Count)&&void 0!==_x?_x:null,CO_MunicipalityDirected_Value:null!==(_y=data.CO_MunicipalityDirected_Value)&&void 0!==_y?_y:null,CO_EO_Count:null!==(_z=data.CO_EO_Count)&&void 0!==_z?_z:null,CO_EO_Value:null!==(_0=data.CO_EO_Value)&&void 0!==_0?_0:null,CO_ContractorDirected_Count:null!==(_1=data.CO_ContractorDirected_Count)&&void 0!==_1?_1:null,savingsReturned:null!==(_2=data.savingsReturned)&&void 0!==_2?_2:null,savingsReturnedPct:null!==(_3=data.savingsReturnedPct)&&void 0!==_3?_3:null,scheduleStartAnticipated:null!==(_4=data.scheduleStartAnticipated)&&void 0!==_4?_4:null,scheduleStartActual:null!==(_5=data.scheduleStartActual)&&void 0!==_5?_5:null,scheduleEndAnticipated:null!==(_6=data.scheduleEndAnticipated)&&void 0!==_6?_6:null,scheduleEndActual:null!==(_7=data.scheduleEndActual)&&void 0!==_7?_7:null,onSchedule:null!==(_8=data.onSchedule)&&void 0!==_8?_8:"",scheduleExplanation:null!==(_9=data.scheduleExplanation)&&void 0!==_9?_9:"",substantialCompletionDate:null!==(_10=data.substantialCompletionDate)&&void 0!==_10?_10:null,finalCompletionDate:null!==(_11=data.finalCompletionDate)&&void 0!==_11?_11:null,punchListItems:null!==(_12=data.punchListItems)&&void 0!==_12?_12:null,punchListDaysToComplete:null!==(_13=data.punchListDaysToComplete)&&void 0!==_13?_13:null,innovativeSafetyPrograms:null!==(_14=data.innovativeSafetyPrograms)&&void 0!==_14?_14:"",mwbeRequirement:null!==(_15=data.mwbeRequirement)&&void 0!==_15?_15:"",mwbeAchievement:null!==(_16=data.mwbeAchievement)&&void 0!==_16?_16:"",sbeRequirement:null!==(_17=data.sbeRequirement)&&void 0!==_17?_17:"",sbeAchievement:null!==(_18=data.sbeAchievement)&&void 0!==_18?_18:"",localRequirement:null!==(_19=data.localRequirement)&&void 0!==_19?_19:"",localAchievement:null!==(_20=data.localAchievement)&&void 0!==_20?_20:"",leedDesignation:null!==(_21=data.leedDesignation)&&void 0!==_21?_21:"",sustainabilityFeatures:null!==(_22=data.sustainabilityFeatures)&&void 0!==_22?_22:"",leedAdditionalCost:null!==(_23=data.leedAdditionalCost)&&void 0!==_23?_23:null,CS_Conflicts:null!==(_24=data.CS_Conflicts)&&void 0!==_24?_24:"",CS_CostControl:null!==(_25=data.CS_CostControl)&&void 0!==_25?_25:"",CS_ValueEngineering:null!==(_26=data.CS_ValueEngineering)&&void 0!==_26?_26:"",CS_QualityControl:null!==(_27=data.CS_QualityControl)&&void 0!==_27?_27:"",CS_Schedule:null!==(_28=data.CS_Schedule)&&void 0!==_28?_28:"",CS_Team:null!==(_29=data.CS_Team)&&void 0!==_29?_29:"",CS_Safety:null!==(_30=data.CS_Safety)&&void 0!==_30?_30:"",CS_LEED:null!==(_31=data.CS_LEED)&&void 0!==_31?_31:"",CS_SupplierDiversity:null!==(_32=data.CS_SupplierDiversity)&&void 0!==_32?_32:"",CS_Challenges:null!==(_33=data.CS_Challenges)&&void 0!==_33?_33:"",CS_InnovativeSolutions:null!==(_34=data.CS_InnovativeSolutions)&&void 0!==_34?_34:"",CS_ProductsSystems:null!==(_35=data.CS_ProductsSystems)&&void 0!==_35?_35:"",CS_ClientService:null!==(_36=data.CS_ClientService)&&void 0!==_36?_36:"",CS_LessonsLearned:null!==(_37=data.CS_LessonsLearned)&&void 0!==_37?_37:"",sectionCompletion:null!==(_38=data.sectionCompletion)&&void 0!==_38?_38:{},overallCompletion:null!==(_39=data.overallCompletion)&&void 0!==_39?_39:0,lastUpdatedBy:"kfoster@hedrickbrothers.com",lastUpdatedAt:(new Date).toISOString(),createdBy:"kfoster@hedrickbrothers.com",createdAt:(new Date).toISOString()};return this.marketingRecords.push(newRecord),Object.assign({},newRecord)}async updateMarketingProjectRecord(projectCode,data){await delay();const index=this.marketingRecords.findIndex(r=>r.projectCode===projectCode);if(-1===index)throw new Error(`Marketing record for ${projectCode} not found`);return this.marketingRecords[index]=Object.assign(Object.assign(Object.assign({},this.marketingRecords[index]),data),{lastUpdatedAt:(new Date).toISOString()}),Object.assign({},this.marketingRecords[index])}async getAllMarketingProjectRecords(){return await delay(),[...this.marketingRecords]}assembleRiskCostRecord(record){const items=this.riskCostItems.filter(i=>i.projectCode===record.projectCode);return Object.assign(Object.assign({},record),{buyoutOpportunities:items.filter(i=>"Buyout"===i.category),potentialRisks:items.filter(i=>"Risk"===i.category),potentialSavings:items.filter(i=>"Savings"===i.category)})}async getRiskCostManagement(projectCode){await delay();const record=this.riskCostRecords.find(r=>r.projectCode===projectCode);return record?this.assembleRiskCostRecord(record):null}async updateRiskCostManagement(projectCode,data){await delay();const index=this.riskCostRecords.findIndex(r=>r.projectCode===projectCode);if(-1===index)throw new Error(`Risk/Cost record for ${projectCode} not found`);return this.riskCostRecords[index]=Object.assign(Object.assign(Object.assign({},this.riskCostRecords[index]),data),{lastUpdatedAt:(new Date).toISOString()}),this.assembleRiskCostRecord(this.riskCostRecords[index])}async addRiskCostItem(projectCode,item){var _a,_b,_c,_d,_e,_f;await delay();const record=this.riskCostRecords.find(r=>r.projectCode===projectCode);if(!record)throw new Error(`Risk/Cost record for ${projectCode} not found`);const newItem={id:this.getNextId(),projectCode,riskCostId:record.id,category:null!==(_a=item.category)&&void 0!==_a?_a:"Risk",letter:null!==(_b=item.letter)&&void 0!==_b?_b:"A",description:null!==(_c=item.description)&&void 0!==_c?_c:"",estimatedValue:null!==(_d=item.estimatedValue)&&void 0!==_d?_d:0,status:null!==(_e=item.status)&&void 0!==_e?_e:"Open",notes:null!==(_f=item.notes)&&void 0!==_f?_f:"",createdDate:(new Date).toISOString().split("T")[0],updatedDate:(new Date).toISOString().split("T")[0]};return this.riskCostItems.push(newItem),record.lastUpdatedAt=(new Date).toISOString(),Object.assign({},newItem)}async updateRiskCostItem(projectCode,itemId,data){await delay();const record=this.riskCostRecords.find(r=>r.projectCode===projectCode);if(!record)throw new Error(`Risk/Cost record for ${projectCode} not found`);const idx=this.riskCostItems.findIndex(i=>i.id===itemId);if(-1===idx)throw new Error(`Risk/Cost item ${itemId} not found`);return this.riskCostItems[idx]=Object.assign(Object.assign(Object.assign({},this.riskCostItems[idx]),data),{updatedDate:(new Date).toISOString().split("T")[0]}),record.lastUpdatedAt=(new Date).toISOString(),Object.assign({},this.riskCostItems[idx])}async getQualityConcerns(projectCode){return await delay(),this.qualityConcerns.filter(c=>c.projectCode===projectCode)}async addQualityConcern(projectCode,concern){var _a,_b,_c,_d,_e,_f,_g;await delay();const newConcern={id:this.getNextId(),projectCode,letter:null!==(_a=concern.letter)&&void 0!==_a?_a:"A",description:null!==(_b=concern.description)&&void 0!==_b?_b:"",raisedBy:null!==(_c=concern.raisedBy)&&void 0!==_c?_c:"",raisedDate:null!==(_d=concern.raisedDate)&&void 0!==_d?_d:(new Date).toISOString().split("T")[0],status:null!==(_e=concern.status)&&void 0!==_e?_e:"Open",resolution:null!==(_f=concern.resolution)&&void 0!==_f?_f:"",resolvedDate:null,notes:null!==(_g=concern.notes)&&void 0!==_g?_g:""};return this.qualityConcerns.push(newConcern),Object.assign({},newConcern)}async updateQualityConcern(projectCode,concernId,data){await delay();const index=this.qualityConcerns.findIndex(c=>c.id===concernId&&c.projectCode===projectCode);if(-1===index)throw new Error(`Quality concern ${concernId} not found`);return this.qualityConcerns[index]=Object.assign(Object.assign({},this.qualityConcerns[index]),data),Object.assign({},this.qualityConcerns[index])}async getSafetyConcerns(projectCode){return await delay(),this.safetyConcerns.filter(c=>c.projectCode===projectCode)}async addSafetyConcern(projectCode,concern){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k;await delay();const newConcern={id:this.getNextId(),projectCode,safetyOfficerName:null!==(_a=concern.safetyOfficerName)&&void 0!==_a?_a:"",safetyOfficerEmail:null!==(_b=concern.safetyOfficerEmail)&&void 0!==_b?_b:"",letter:null!==(_c=concern.letter)&&void 0!==_c?_c:"A",description:null!==(_d=concern.description)&&void 0!==_d?_d:"",severity:null!==(_e=concern.severity)&&void 0!==_e?_e:"Medium",raisedBy:null!==(_f=concern.raisedBy)&&void 0!==_f?_f:"",raisedDate:null!==(_g=concern.raisedDate)&&void 0!==_g?_g:(new Date).toISOString().split("T")[0],status:null!==(_h=concern.status)&&void 0!==_h?_h:"Open",resolution:null!==(_j=concern.resolution)&&void 0!==_j?_j:"",resolvedDate:null,notes:null!==(_k=concern.notes)&&void 0!==_k?_k:""};return this.safetyConcerns.push(newConcern),Object.assign({},newConcern)}async updateSafetyConcern(projectCode,concernId,data){await delay();const index=this.safetyConcerns.findIndex(c=>c.id===concernId&&c.projectCode===projectCode);if(-1===index)throw new Error(`Safety concern ${concernId} not found`);return this.safetyConcerns[index]=Object.assign(Object.assign({},this.safetyConcerns[index]),data),Object.assign({},this.safetyConcerns[index])}assembleScheduleRecord(record){return Object.assign(Object.assign({},record),{criticalPathConcerns:this.criticalPathItems.filter(i=>i.projectCode===record.projectCode)})}async getProjectSchedule(projectCode){await delay();const record=this.scheduleRecords.find(s=>s.projectCode===projectCode);return record?this.assembleScheduleRecord(record):null}async updateProjectSchedule(projectCode,data){await delay();const index=this.scheduleRecords.findIndex(s=>s.projectCode===projectCode);if(-1===index)throw new Error(`Schedule for ${projectCode} not found`);return this.scheduleRecords[index]=Object.assign(Object.assign(Object.assign({},this.scheduleRecords[index]),data),{lastUpdatedAt:(new Date).toISOString()}),this.assembleScheduleRecord(this.scheduleRecords[index])}async addCriticalPathItem(projectCode,item){var _a,_b,_c,_d,_e;await delay();const record=this.scheduleRecords.find(s=>s.projectCode===projectCode);if(!record)throw new Error(`Schedule for ${projectCode} not found`);const newItem={id:this.getNextId(),projectCode,scheduleId:record.id,letter:null!==(_a=item.letter)&&void 0!==_a?_a:"A",description:null!==(_b=item.description)&&void 0!==_b?_b:"",impactDescription:null!==(_c=item.impactDescription)&&void 0!==_c?_c:"",status:null!==(_d=item.status)&&void 0!==_d?_d:"Active",mitigationPlan:null!==(_e=item.mitigationPlan)&&void 0!==_e?_e:"",createdDate:(new Date).toISOString().split("T")[0],updatedDate:(new Date).toISOString().split("T")[0]};return this.criticalPathItems.push(newItem),record.lastUpdatedAt=(new Date).toISOString(),Object.assign({},newItem)}assembleSuperintendentPlan(plan){return Object.assign(Object.assign({},plan),{sections:this.superintendentPlanSections.filter(s=>s.superintendentPlanId===plan.id)})}async getSuperintendentPlan(projectCode){await delay();const plan=this.superintendentPlans.find(p=>p.projectCode===projectCode);return plan?this.assembleSuperintendentPlan(plan):null}async updateSuperintendentPlanSection(projectCode,sectionId,data){await delay();const plan=this.superintendentPlans.find(p=>p.projectCode===projectCode);if(!plan)throw new Error(`Superintendent plan for ${projectCode} not found`);const idx=this.superintendentPlanSections.findIndex(s=>s.id===sectionId&&s.superintendentPlanId===plan.id);if(-1===idx)throw new Error(`Section ${sectionId} not found`);return this.superintendentPlanSections[idx]=Object.assign(Object.assign({},this.superintendentPlanSections[idx]),data),plan.lastUpdatedAt=(new Date).toISOString(),Object.assign({},this.superintendentPlanSections[idx])}async createSuperintendentPlan(projectCode,data){var _a;await delay();const planId=this.getNextId(),newPlan={id:planId,projectCode,superintendentName:null!==(_a=data.superintendentName)&&void 0!==_a?_a:"",sections:[],createdBy:"kfoster@hedrickbrothers.com",createdAt:(new Date).toISOString(),lastUpdatedBy:"kfoster@hedrickbrothers.com",lastUpdatedAt:(new Date).toISOString()};if(data.sections)for(const sec of data.sections)this.superintendentPlanSections.push(Object.assign(Object.assign({},sec),{superintendentPlanId:planId,projectCode}));return this.superintendentPlans.push(newPlan),this.assembleSuperintendentPlan(newPlan)}async getLessonsLearned(projectCode){return await delay(),this.lessonsLearned.filter(l=>l.projectCode===projectCode)}async addLessonLearned(projectCode,lesson){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k;await delay();const newLesson={id:this.getNextId(),projectCode,title:null!==(_a=lesson.title)&&void 0!==_a?_a:"",category:null!==(_b=lesson.category)&&void 0!==_b?_b:"Other",impact:null!==(_c=lesson.impact)&&void 0!==_c?_c:"Neutral",description:null!==(_d=lesson.description)&&void 0!==_d?_d:"",recommendation:null!==(_e=lesson.recommendation)&&void 0!==_e?_e:"",raisedBy:null!==(_f=lesson.raisedBy)&&void 0!==_f?_f:"",raisedDate:null!==(_g=lesson.raisedDate)&&void 0!==_g?_g:(new Date).toISOString().split("T")[0],phase:null!==(_h=lesson.phase)&&void 0!==_h?_h:"Construction",isIncludedInFinalRecord:null!==(_j=lesson.isIncludedInFinalRecord)&&void 0!==_j&&_j,tags:null!==(_k=lesson.tags)&&void 0!==_k?_k:[]};return this.lessonsLearned.push(newLesson),Object.assign({},newLesson)}async updateLessonLearned(projectCode,lessonId,data){await delay();const index=this.lessonsLearned.findIndex(l=>l.id===lessonId&&l.projectCode===projectCode);if(-1===index)throw new Error(`Lesson ${lessonId} not found`);return this.lessonsLearned[index]=Object.assign(Object.assign({},this.lessonsLearned[index]),data),Object.assign({},this.lessonsLearned[index])}assemblePMP(pmp){const sigs=this.pmpSignatures.filter(s=>s.pmpId===pmp.id),cycles=this.pmpApprovalCycles.filter(c=>c.pmpId===pmp.id).map(c=>Object.assign(Object.assign({},c),{steps:this.pmpApprovalSteps.filter(s=>s.approvalCycleId===c.id)}));return Object.assign(Object.assign({},pmp),{startupSignatures:sigs.filter(s=>"Startup"===s.signatureType),completionSignatures:sigs.filter(s=>"Completion"===s.signatureType),approvalCycles:cycles})}async getProjectManagementPlan(projectCode){await delay();const pmp=this.pmps.find(p=>p.projectCode===projectCode);return pmp?this.assemblePMP(pmp):null}async updateProjectManagementPlan(projectCode,data){await delay();const index=this.pmps.findIndex(p=>p.projectCode===projectCode);if(-1===index)throw new Error(`PMP for ${projectCode} not found`);return this.pmps[index]=Object.assign(Object.assign(Object.assign({},this.pmps[index]),data),{lastUpdatedAt:(new Date).toISOString()}),this.assemblePMP(this.pmps[index])}async submitPMPForApproval(projectCode,submittedBy){await delay();const pmp=this.pmps.find(p=>p.projectCode===projectCode);if(!pmp)throw new Error(`PMP for ${projectCode} not found`);const newCycle=pmp.currentCycleNumber+1,divApprover=this.divisionApprovers.find(d=>d.division===pmp.division),cycleId=this.getNextId(),steps=[{id:this.getNextId(),approvalCycleId:cycleId,projectCode,stepOrder:1,approverRole:"Project Executive",approverName:"Kim Foster",approverEmail:"kfoster@hedrickbrothers.com",status:"Pending",comment:"",actionDate:null,approvalCycleNumber:newCycle},...divApprover?[{id:this.getNextId(),approvalCycleId:cycleId,projectCode,stepOrder:2,approverRole:"Division Head",approverName:divApprover.approverName,approverEmail:divApprover.approverEmail,status:"Pending",comment:"",actionDate:null,approvalCycleNumber:newCycle}]:[]],cycle={id:cycleId,pmpId:pmp.id,projectCode,cycleNumber:newCycle,submittedBy,submittedDate:(new Date).toISOString(),status:"InProgress",steps,changesFromPrevious:[]};this.pmpApprovalCycles.push(cycle);for(const step of steps)this.pmpApprovalSteps.push(step);return pmp.currentCycleNumber=newCycle,pmp.status="PendingApproval",pmp.lastUpdatedAt=(new Date).toISOString(),this.assemblePMP(pmp)}async respondToPMPApproval(projectCode,stepId,approved,comment){await delay();const pmp=this.pmps.find(p=>p.projectCode===projectCode);if(!pmp)throw new Error(`PMP for ${projectCode} not found`);const stepIdx=this.pmpApprovalSteps.findIndex(s=>s.id===stepId);if(-1===stepIdx)throw new Error(`Approval step ${stepId} not found`);this.pmpApprovalSteps[stepIdx].status=approved?"Approved":"Returned",this.pmpApprovalSteps[stepIdx].comment=comment,this.pmpApprovalSteps[stepIdx].actionDate=(new Date).toISOString();const cycleId=this.pmpApprovalSteps[stepIdx].approvalCycleId,cycleIdx=this.pmpApprovalCycles.findIndex(c=>c.id===cycleId);if(-1!==cycleIdx){const cycleSteps=this.pmpApprovalSteps.filter(s=>s.approvalCycleId===cycleId);approved?cycleSteps.every(s=>"Approved"===s.status)&&(this.pmpApprovalCycles[cycleIdx].status="Approved",pmp.status="Approved"):(this.pmpApprovalCycles[cycleIdx].status="Returned",pmp.status="Returned")}return pmp.lastUpdatedAt=(new Date).toISOString(),this.assemblePMP(pmp)}async signPMP(projectCode,signatureId,comment){await delay();const pmp=this.pmps.find(p=>p.projectCode===projectCode);if(!pmp)throw new Error(`PMP for ${projectCode} not found`);const sigIdx=this.pmpSignatures.findIndex(s=>s.id===signatureId&&s.pmpId===pmp.id);if(-1===sigIdx)throw new Error(`Signature ${signatureId} not found`);return this.pmpSignatures[sigIdx].status="Signed",this.pmpSignatures[sigIdx].signedDate=(new Date).toISOString(),this.pmpSignatures[sigIdx].comment=comment,pmp.lastUpdatedAt=(new Date).toISOString(),this.assemblePMP(pmp)}async getDivisionApprovers(){return await delay(),[...this.divisionApprovers]}async getPMPBoilerplate(){return await delay(),[...this.boilerplate]}assembleMonthlyReview(review){return Object.assign(Object.assign({},review),{checklistItems:this.monthlyChecklistItems.filter(i=>i.reviewId===review.id),followUps:this.monthlyFollowUps.filter(f=>f.reviewId===review.id)})}async getMonthlyReviews(projectCode){return await delay(),this.monthlyReviews.filter(r=>r.projectCode===projectCode).sort((a,b)=>b.reviewMonth.localeCompare(a.reviewMonth)).map(r=>this.assembleMonthlyReview(r))}async getMonthlyReview(reviewId){await delay();const review=this.monthlyReviews.find(r=>r.id===reviewId);return review?this.assembleMonthlyReview(review):null}async updateMonthlyReview(reviewId,data){await delay();const index=this.monthlyReviews.findIndex(r=>r.id===reviewId);if(-1===index)throw new Error(`Monthly review ${reviewId} not found`);if(data.checklistItems){this.monthlyChecklistItems=this.monthlyChecklistItems.filter(i=>i.reviewId!==reviewId);for(const item of data.checklistItems)this.monthlyChecklistItems.push(Object.assign(Object.assign({},item),{reviewId}))}if(data.followUps){this.monthlyFollowUps=this.monthlyFollowUps.filter(f=>f.reviewId!==reviewId);for(const fu of data.followUps)this.monthlyFollowUps.push(Object.assign(Object.assign({},fu),{reviewId}))}return this.monthlyReviews[index]=Object.assign(Object.assign(Object.assign({},this.monthlyReviews[index]),data),{lastUpdatedAt:(new Date).toISOString()}),this.assembleMonthlyReview(this.monthlyReviews[index])}async createMonthlyReview(data){var _a,_b,_c,_d;await delay();const reviewId=this.getNextId(),newReview={id:reviewId,projectCode:null!==(_a=data.projectCode)&&void 0!==_a?_a:"",reviewMonth:null!==(_b=data.reviewMonth)&&void 0!==_b?_b:"",status:"NotStarted",dueDate:null!==(_c=data.dueDate)&&void 0!==_c?_c:"",meetingDate:null!==(_d=data.meetingDate)&&void 0!==_d?_d:null,pmSubmittedDate:null,pxReviewDate:null,pxValidationDate:null,leadershipSubmitDate:null,completedDate:null,checklistItems:[],followUps:[],reportDocumentUrls:[],createdBy:"kfoster@hedrickbrothers.com",createdAt:(new Date).toISOString(),lastUpdatedBy:"kfoster@hedrickbrothers.com",lastUpdatedAt:(new Date).toISOString()};if(data.checklistItems)for(const item of data.checklistItems)this.monthlyChecklistItems.push(Object.assign(Object.assign({},item),{reviewId}));return this.monthlyReviews.push(newReview),this.assembleMonthlyReview(newReview)}async getAppContextConfig(siteUrl){await delay();const configs=[{SiteURL:"https://hedrickbrothers.sharepoint.com/sites/HBCHub",RenderMode:"full",AppTitle:"HBC Project Controls",VisibleModules:["Pipeline","LeadIntake","GoNoGo","Estimating","Executive","Admin"]},{SiteURL:"https://hedrickbrothers.sharepoint.com/sites/HBPrecon",RenderMode:"standalone",AppTitle:"HBC Estimating Tracker",VisibleModules:["EstimatingDashboard","PursuitDetail","GoNoGoTracker"]},{SiteURL:"default-project",RenderMode:"project",AppTitle:"Project Controls",VisibleModules:["ProjectHome","GoNoGo","Kickoff","Deliverables","WinLoss","Contract","Turnover","Closeout"]}],match=configs.find(c=>siteUrl.startsWith(c.SiteURL)||c.SiteURL===siteUrl);if(match)return{RenderMode:match.RenderMode,AppTitle:match.AppTitle,VisibleModules:match.VisibleModules};if(siteUrl.includes("sharepoint.com/sites/")){const projectConfig=configs.find(c=>"default-project"===c.SiteURL);if(projectConfig)return{RenderMode:projectConfig.RenderMode,AppTitle:projectConfig.AppTitle,VisibleModules:projectConfig.VisibleModules}}return null}assembleEstimatingKickoff(kickoff){return Object.assign(Object.assign({},kickoff),{items:this.estimatingKickoffItems.filter(i=>i.kickoffId===kickoff.id)})}async getEstimatingKickoff(projectCode){await delay();const kickoff=this.estimatingKickoffs.find(k=>k.ProjectCode===projectCode);return kickoff?this.assembleEstimatingKickoff(kickoff):null}async getEstimatingKickoffByLeadId(leadId){await delay();const kickoff=this.estimatingKickoffs.find(k=>k.LeadID===leadId);return kickoff?this.assembleEstimatingKickoff(kickoff):null}async createEstimatingKickoff(data){var _a,_b,_c,_d;await delay();const kickoffId=this.getNextId(),items=data.items&&data.items.length>0?data.items:createEstimatingKickoffTemplate(),kickoff={id:kickoffId,LeadID:null!==(_a=data.LeadID)&&void 0!==_a?_a:0,ProjectCode:null!==(_b=data.ProjectCode)&&void 0!==_b?_b:"",Architect:data.Architect,ProposalDueDateTime:data.ProposalDueDateTime,ProposalType:data.ProposalType,RFIFormat:data.RFIFormat,PrimaryOwnerContact:data.PrimaryOwnerContact,ProposalDeliveryMethod:data.ProposalDeliveryMethod,CopiesIfHandDelivered:data.CopiesIfHandDelivered,HBProposalDue:data.HBProposalDue,SubcontractorProposalsDue:data.SubcontractorProposalsDue,PreSubmissionReview:data.PreSubmissionReview,SubcontractorSiteWalkThru:data.SubcontractorSiteWalkThru,OwnerEstimateReview:data.OwnerEstimateReview,items,KickoffMeetingId:data.KickoffMeetingId,KickoffMeetingDate:data.KickoffMeetingDate,CreatedBy:null!==(_c=data.CreatedBy)&&void 0!==_c?_c:"system",CreatedDate:null!==(_d=data.CreatedDate)&&void 0!==_d?_d:(new Date).toISOString(),ModifiedBy:data.ModifiedBy,ModifiedDate:data.ModifiedDate};for(const item of items)this.estimatingKickoffItems.push(Object.assign(Object.assign({},item),{kickoffId,projectCode:kickoff.ProjectCode}));return this.estimatingKickoffs.push(kickoff),this.assembleEstimatingKickoff(kickoff)}async updateEstimatingKickoff(id,data){await delay();const index=this.estimatingKickoffs.findIndex(k=>k.id===id);if(-1===index)throw new Error(`Estimating kickoff ${id} not found`);if(data.items){this.estimatingKickoffItems=this.estimatingKickoffItems.filter(i=>i.kickoffId!==id);for(const item of data.items)this.estimatingKickoffItems.push(Object.assign(Object.assign({},item),{kickoffId:id,projectCode:this.estimatingKickoffs[index].ProjectCode}))}return this.estimatingKickoffs[index]=Object.assign(Object.assign(Object.assign({},this.estimatingKickoffs[index]),data),{ModifiedDate:(new Date).toISOString()}),this.assembleEstimatingKickoff(this.estimatingKickoffs[index])}async updateKickoffItem(kickoffId,itemId,data){await delay();const kickoff=this.estimatingKickoffs.find(k=>k.id===kickoffId);if(!kickoff)throw new Error(`Estimating kickoff ${kickoffId} not found`);const idx=this.estimatingKickoffItems.findIndex(i=>i.id===itemId&&i.kickoffId===kickoffId);if(-1===idx)throw new Error(`Kickoff item ${itemId} not found`);return this.estimatingKickoffItems[idx]=Object.assign(Object.assign({},this.estimatingKickoffItems[idx]),data),kickoff.ModifiedDate=(new Date).toISOString(),Object.assign({},this.estimatingKickoffItems[idx])}async addKickoffItem(kickoffId,item){var _a,_b,_c,_d,_e,_f,_g,_h,_j;await delay();const kickoff=this.estimatingKickoffs.find(k=>k.id===kickoffId);if(!kickoff)throw new Error(`Estimating kickoff ${kickoffId} not found`);const kickoffItems=this.estimatingKickoffItems.filter(i=>i.kickoffId===kickoffId),newItem={id:kickoffItems.length>0?Math.max(...kickoffItems.map(i=>i.id))+1:1,kickoffId,projectCode:kickoff.ProjectCode,section:null!==(_a=item.section)&&void 0!==_a?_a:"managing",task:null!==(_b=item.task)&&void 0!==_b?_b:"New Task",status:null!==(_c=item.status)&&void 0!==_c?_c:null,responsibleParty:null!==(_d=item.responsibleParty)&&void 0!==_d?_d:"",deadline:null!==(_e=item.deadline)&&void 0!==_e?_e:"",frequency:null!==(_f=item.frequency)&&void 0!==_f?_f:"",notes:null!==(_g=item.notes)&&void 0!==_g?_g:"",tabRequired:item.tabRequired,isCustom:null===(_h=item.isCustom)||void 0===_h||_h,sortOrder:null!==(_j=item.sortOrder)&&void 0!==_j?_j:kickoffItems.length+1};return this.estimatingKickoffItems.push(newItem),kickoff.ModifiedDate=(new Date).toISOString(),Object.assign({},newItem)}async removeKickoffItem(kickoffId,itemId){await delay();const kickoff=this.estimatingKickoffs.find(k=>k.id===kickoffId);if(!kickoff)throw new Error(`Estimating kickoff ${kickoffId} not found`);this.estimatingKickoffItems=this.estimatingKickoffItems.filter(i=>!(i.id===itemId&&i.kickoffId===kickoffId)),kickoff.ModifiedDate=(new Date).toISOString()}async updateKickoffKeyPersonnel(kickoffId,personnel){await delay();const kickoff=this.estimatingKickoffs.find(k=>k.id===kickoffId);if(!kickoff)throw new Error(`Estimating kickoff ${kickoffId} not found`);return kickoff.keyPersonnel=personnel,kickoff.ModifiedDate=(new Date).toISOString(),this.assembleEstimatingKickoff(kickoff)}async getJobNumberRequests(status){return await delay(),status?this.jobNumberRequests.filter(r=>r.RequestStatus===status):[...this.jobNumberRequests]}async getJobNumberRequestByLeadId(leadId){await delay();const requests=this.jobNumberRequests.filter(r=>r.LeadID===leadId).sort((a,b)=>new Date(b.RequestDate).getTime()-new Date(a.RequestDate).getTime());return requests.length>0?Object.assign({},requests[0]):null}async createJobNumberRequest(data){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;await delay();const request={id:this.getNextId(),LeadID:null!==(_a=data.LeadID)&&void 0!==_a?_a:0,RequestDate:null!==(_b=data.RequestDate)&&void 0!==_b?_b:(new Date).toISOString().split("T")[0],Originator:null!==(_c=data.Originator)&&void 0!==_c?_c:"",RequiredByDate:null!==(_d=data.RequiredByDate)&&void 0!==_d?_d:"",ProjectAddress:null!==(_e=data.ProjectAddress)&&void 0!==_e?_e:"",ProjectExecutive:null!==(_f=data.ProjectExecutive)&&void 0!==_f?_f:"",ProjectManager:data.ProjectManager,ProjectType:null!==(_g=data.ProjectType)&&void 0!==_g?_g:"",ProjectTypeLabel:null!==(_h=data.ProjectTypeLabel)&&void 0!==_h?_h:"",IsEstimatingOnly:null!==(_j=data.IsEstimatingOnly)&&void 0!==_j&&_j,RequestedCostCodes:null!==(_k=data.RequestedCostCodes)&&void 0!==_k?_k:[],RequestStatus:JobNumberRequestStatus.Pending,SiteProvisioningHeld:null===(_l=data.SiteProvisioningHeld)||void 0===_l||_l,TempProjectCode:data.TempProjectCode,Notes:data.Notes};this.jobNumberRequests.push(request);const leadIndex=this.leads.findIndex(l=>l.id===request.LeadID);return-1!==leadIndex&&(this.leads[leadIndex].JobNumberRequestId=request.id),Object.assign({},request)}async finalizeJobNumber(requestId,jobNumber,assignedBy){await delay();const index=this.jobNumberRequests.findIndex(r=>r.id===requestId);if(-1===index)throw new Error(`Job number request ${requestId} not found`);const request=this.jobNumberRequests[index];request.RequestStatus=JobNumberRequestStatus.Completed,request.AssignedJobNumber=jobNumber,request.AssignedBy=assignedBy,request.AssignedDate=(new Date).toISOString().split("T")[0];const leadIndex=this.leads.findIndex(l=>l.id===request.LeadID);return-1!==leadIndex&&(this.leads[leadIndex].OfficialJobNumber=jobNumber,this.leads[leadIndex].ProjectExecutive=request.ProjectExecutive,this.leads[leadIndex].ProjectManager=request.ProjectManager),Object.assign({},request)}async getProjectTypes(){return await delay(),JSON.parse(JSON.stringify(projectTypes_namespaceObject))}async getStandardCostCodes(){return await delay(),JSON.parse(JSON.stringify(standardCostCodes_namespaceObject))}async getBuyoutEntries(projectCode){return await delay(),this.buyoutEntries.filter(e=>e.projectCode===projectCode).sort((a,b)=>a.divisionCode.localeCompare(b.divisionCode))}async initializeBuyoutLog(projectCode){await delay();const existing=this.buyoutEntries.filter(e=>e.projectCode===projectCode);if(existing.length>0)return existing;const now=(new Date).toISOString(),newEntries=STANDARD_BUYOUT_DIVISIONS.map(div=>({id:this.getNextId(),projectCode,divisionCode:div.divisionCode,divisionDescription:div.divisionDescription,isStandard:!0,originalBudget:0,estimatedTax:0,totalBudget:0,enrolledInSDI:!1,bondRequired:!1,commitmentStatus:"Budgeted",waiverRequired:!1,approvalHistory:[],status:"Not Started",createdDate:now,modifiedDate:now}));return this.buyoutEntries.push(...newEntries),newEntries}async addBuyoutEntry(projectCode,entry){var _a,_b,_c,_d,_e;await delay();const now=(new Date).toISOString(),totalBudget=(entry.originalBudget||0)+(entry.estimatedTax||0),overUnder=null!=entry.contractValue?totalBudget-entry.contractValue:void 0,newEntry={id:this.getNextId(),projectCode,divisionCode:entry.divisionCode||"",divisionDescription:entry.divisionDescription||"",isStandard:null!==(_a=entry.isStandard)&&void 0!==_a&&_a,originalBudget:entry.originalBudget||0,estimatedTax:entry.estimatedTax||0,totalBudget,subcontractorName:entry.subcontractorName,contractValue:entry.contractValue,overUnder,enrolledInSDI:null!==(_b=entry.enrolledInSDI)&&void 0!==_b&&_b,bondRequired:null!==(_c=entry.bondRequired)&&void 0!==_c&&_c,commitmentStatus:entry.commitmentStatus||"Budgeted",waiverRequired:null!==(_d=entry.waiverRequired)&&void 0!==_d&&_d,approvalHistory:null!==(_e=entry.approvalHistory)&&void 0!==_e?_e:[],loiSentDate:entry.loiSentDate,loiReturnedDate:entry.loiReturnedDate,contractSentDate:entry.contractSentDate,contractExecutedDate:entry.contractExecutedDate,insuranceCOIReceivedDate:entry.insuranceCOIReceivedDate,status:entry.status||"Not Started",notes:entry.notes,createdDate:now,modifiedDate:now};return this.buyoutEntries.push(newEntry),newEntry}async updateBuyoutEntry(projectCode,entryId,data){await delay();const idx=this.buyoutEntries.findIndex(e=>e.id===entryId&&e.projectCode===projectCode);if(-1===idx)throw new Error(`Buyout entry ${entryId} not found`);const current=this.buyoutEntries[idx],updated=Object.assign(Object.assign(Object.assign({},current),data),{modifiedDate:(new Date).toISOString()});return updated.totalBudget=updated.originalBudget+updated.estimatedTax,null!=updated.contractValue&&(updated.overUnder=updated.totalBudget-updated.contractValue),this.buyoutEntries[idx]=updated,updated}async removeBuyoutEntry(projectCode,entryId){await delay();const idx=this.buyoutEntries.findIndex(e=>e.id===entryId&&e.projectCode===projectCode);if(-1===idx)throw new Error(`Buyout entry ${entryId} not found`);this.buyoutEntries.splice(idx,1)}async submitCommitmentForApproval(projectCode,entryId,submittedBy){await delay();const idx=this.buyoutEntries.findIndex(e=>e.id===entryId&&e.projectCode===projectCode);if(-1===idx)throw new Error(`Buyout entry ${entryId} not found`);const entry=this.buyoutEntries[idx],{evaluateCommitmentRisk,determineWaiverType}=__webpack_require__("./packages/hbc-sp-services/src/utils/riskEngine.ts"),risk=evaluateCommitmentRisk(entry),approvalStep={id:this.getNextId(),buyoutEntryId:entryId,projectCode,step:"PX",approverName:"Kim Foster",approverEmail:"kfoster@hedrickbrothers.com",status:"Pending",waiverType:risk.requiresWaiver?determineWaiverType(entry):void 0};return entry.waiverRequired=risk.requiresWaiver,entry.waiverType=risk.requiresWaiver?determineWaiverType(entry):void 0,entry.commitmentStatus=risk.requiresWaiver?"WaiverPending":"PendingReview",entry.currentApprovalStep="PX",entry.approvalHistory=[...entry.approvalHistory||[],approvalStep],entry.modifiedDate=(new Date).toISOString(),this.buyoutEntries[idx]=entry,Object.assign({},entry)}async respondToCommitmentApproval(projectCode,entryId,approved,comment,escalate){var _a;await delay();const idx=this.buyoutEntries.findIndex(e=>e.id===entryId&&e.projectCode===projectCode);if(-1===idx)throw new Error(`Buyout entry ${entryId} not found`);const entry=this.buyoutEntries[idx],now=(new Date).toISOString(),pendingIdx=(entry.approvalHistory||[]).findIndex(a=>"Pending"===a.status);if(-1===pendingIdx)throw new Error("No pending approval step found");const pendingStep=entry.approvalHistory[pendingIdx];if(pendingStep.actionDate=now,pendingStep.comment=comment,approved)if(escalate&&"ComplianceManager"===pendingStep.step){pendingStep.status="Escalated";const cfoStep={id:this.getNextId(),buyoutEntryId:entryId,projectCode,step:"CFO",approverName:"CFO",approverEmail:"cfo@hedrickbrothers.com",status:"Pending",waiverType:entry.waiverType};entry.approvalHistory.push(cfoStep),entry.commitmentStatus="CFOReview",entry.currentApprovalStep="CFO"}else if("PX"===pendingStep.step&&entry.waiverRequired&&(null!==(_a=entry.contractValue)&&void 0!==_a?_a:0)>=25e4){pendingStep.status="Approved";const complianceStep={id:this.getNextId(),buyoutEntryId:entryId,projectCode,step:"ComplianceManager",approverName:"Compliance Manager",approverEmail:"compliance@hedrickbrothers.com",status:"Pending",waiverType:entry.waiverType};entry.approvalHistory.push(complianceStep),entry.commitmentStatus="ComplianceReview",entry.currentApprovalStep="ComplianceManager"}else pendingStep.status="Approved",entry.commitmentStatus="Committed",entry.currentApprovalStep=void 0,entry.status="Executed";else pendingStep.status="Rejected",entry.commitmentStatus="Rejected",entry.currentApprovalStep=void 0;return entry.modifiedDate=now,this.buyoutEntries[idx]=entry,Object.assign({},entry)}async getCommitmentApprovalHistory(projectCode,entryId){await delay();const entry=this.buyoutEntries.find(e=>e.id===entryId&&e.projectCode===projectCode);if(!entry)throw new Error(`Buyout entry ${entryId} not found`);return[...entry.approvalHistory||[]]}getNextTrackingStep(current){const steps=MockDataService.TRACKING_STEP_ORDER,idx=steps.indexOf(current);return idx<steps.length-1?steps[idx+1]:null}resolveTrackingStepApprover(chain,step){var _a;const stepOrder=MockDataService.TRACKING_STEP_TO_ORDER[step],resolved=chain.find(s=>s.stepOrder===stepOrder);return(null===(_a=null==resolved?void 0:resolved.assignee)||void 0===_a?void 0:_a.email)?{name:resolved.assignee.displayName,email:resolved.assignee.email}:MockDataService.TRACKING_STEP_APPROVERS[step]}async submitContractTracking(projectCode,entryId,_submittedBy){await delay();const idx=this.buyoutEntries.findIndex(e=>e.id===entryId&&e.projectCode===projectCode);if(-1===idx)throw new Error(`Buyout entry ${entryId} not found`);const entry=this.buyoutEntries[idx];let firstStep="APM_PA",chain=null;try{chain=await this.resolveWorkflowChain(enums.WorkflowKey.CONTRACT_TRACKING,projectCode);const apmStep=chain.find(s=>1===s.stepOrder);if(null==apmStep?void 0:apmStep.skipped){firstStep="ProjectManager";const skippedApprover=this.resolveTrackingStepApprover(chain,"APM_PA"),skippedRecord={id:this.getNextId(),buyoutEntryId:entryId,projectCode,step:"APM_PA",approverName:skippedApprover.name,approverEmail:skippedApprover.email,status:"Skipped",actionDate:(new Date).toISOString(),skippedReason:"No APM/PA assigned for this project"};entry.contractTrackingHistory=[...entry.contractTrackingHistory||[],skippedRecord]}}catch(_a){}const approver=chain?this.resolveTrackingStepApprover(chain,firstStep):MockDataService.TRACKING_STEP_APPROVERS[firstStep],approvalRecord={id:this.getNextId(),buyoutEntryId:entryId,projectCode,step:firstStep,approverName:approver.name,approverEmail:approver.email,status:"Pending"};return entry.contractTrackingStatus=MockDataService.TRACKING_STEP_STATUS[firstStep],entry.currentContractTrackingStep=firstStep,entry.contractTrackingHistory=[...entry.contractTrackingHistory||[],approvalRecord],entry.modifiedDate=(new Date).toISOString(),this.buyoutEntries[idx]=entry,this.logAudit({Action:enums.AuditAction.ContractTrackingSubmitted,EntityType:enums.EntityType.ContractTracking,EntityId:String(entryId),Details:`Contract tracking submitted for ${entry.divisionDescription}`}),Object.assign({},entry)}async respondToContractTracking(projectCode,entryId,approved,comment){await delay();const idx=this.buyoutEntries.findIndex(e=>e.id===entryId&&e.projectCode===projectCode);if(-1===idx)throw new Error(`Buyout entry ${entryId} not found`);const entry=this.buyoutEntries[idx],now=(new Date).toISOString(),history=entry.contractTrackingHistory||[],pendingIdx=history.findIndex(a=>"Pending"===a.status);if(-1===pendingIdx)throw new Error("No pending contract tracking step found");const pendingStep=Object.assign({},history[pendingIdx]);if(pendingStep.actionDate=now,pendingStep.comment=comment,approved){pendingStep.status="Approved";const nextStep=this.getNextTrackingStep(pendingStep.step);if(nextStep){let approver=MockDataService.TRACKING_STEP_APPROVERS[nextStep];try{const chain=await this.resolveWorkflowChain(enums.WorkflowKey.CONTRACT_TRACKING,projectCode);approver=this.resolveTrackingStepApprover(chain,nextStep)}catch(_a){}const nextRecord={id:this.getNextId(),buyoutEntryId:entryId,projectCode,step:nextStep,approverName:approver.name,approverEmail:approver.email,status:"Pending"};history.push(nextRecord),entry.contractTrackingStatus=MockDataService.TRACKING_STEP_STATUS[nextStep],entry.currentContractTrackingStep=nextStep,this.logAudit({Action:enums.AuditAction.ContractTrackingApproved,EntityType:enums.EntityType.ContractTracking,EntityId:String(entryId),Details:`Contract tracking approved at ${pendingStep.step}, advancing to ${nextStep}`})}else entry.contractTrackingStatus="Tracked",entry.currentContractTrackingStep=void 0,this.logAudit({Action:enums.AuditAction.ContractTrackingApproved,EntityType:enums.EntityType.ContractTracking,EntityId:String(entryId),Details:"Contract tracking fully approved â€” status: Tracked"})}else pendingStep.status="Rejected",entry.contractTrackingStatus="Rejected",entry.currentContractTrackingStep=void 0,this.logAudit({Action:enums.AuditAction.ContractTrackingRejected,EntityType:enums.EntityType.ContractTracking,EntityId:String(entryId),Details:`Contract tracking rejected at ${pendingStep.step}`});return history[pendingIdx]=pendingStep,entry.contractTrackingHistory=history,entry.modifiedDate=now,this.buyoutEntries[idx]=entry,Object.assign({},entry)}async getContractTrackingHistory(projectCode,entryId){await delay();const entry=this.buyoutEntries.find(e=>e.id===entryId&&e.projectCode===projectCode);if(!entry)throw new Error(`Buyout entry ${entryId} not found`);return[...entry.contractTrackingHistory||[]]}async uploadCommitmentDocument(projectCode,entryId,file){await delay();const entry=this.buyoutEntries.find(e=>e.id===entryId&&e.projectCode===projectCode);if(!entry)throw new Error(`Buyout entry ${entryId} not found`);const fileId=`file-${Date.now()}`,fileName=`${projectCode}_${entryId}_${file.name}`,fileUrl=`/sites/${projectCode}/Shared Documents/Commitments/${fileName}`;return entry.compiledCommitmentFileId=fileId,entry.compiledCommitmentFileName=fileName,entry.compiledCommitmentPdfUrl=fileUrl,entry.modifiedDate=(new Date).toISOString(),{fileId,fileName,fileUrl}}async getComplianceLog(filters){await delay();let entries=this.buyoutEntries.filter(e=>!!e.subcontractorName);if((null==filters?void 0:filters.projectCode)&&(entries=entries.filter(e=>e.projectCode===filters.projectCode)),(null==filters?void 0:filters.commitmentStatus)&&(entries=entries.filter(e=>e.commitmentStatus===filters.commitmentStatus)),(null==filters?void 0:filters.eVerifyStatus)&&(entries=entries.filter(e=>(e.eVerifyStatus||"Not Sent")===filters.eVerifyStatus)),null==filters?void 0:filters.searchQuery){const q=filters.searchQuery.toLowerCase();entries=entries.filter(e=>(e.subcontractorName||"").toLowerCase().includes(q)||e.projectCode.toLowerCase().includes(q)||e.divisionDescription.toLowerCase().includes(q))}return entries.map(e=>this.mapBuyoutToComplianceEntry(e))}async getComplianceSummary(){await delay();const entries=await this.getComplianceLog();return{totalCommitments:entries.length,fullyCompliant:entries.filter(e=>e.overallCompliant).length,eVerifyPending:entries.filter(e=>"Sent"===e.eVerifyStatus||"Reminder Sent"===e.eVerifyStatus||"Not Sent"===e.eVerifyStatus).length,eVerifyOverdue:entries.filter(e=>"Overdue"===e.eVerifyStatus).length,waiversPending:entries.filter(e=>"WaiverPending"===e.commitmentStatus).length,documentsMissing:entries.filter(e=>!e.documentsCompliant).length}}mapBuyoutToComplianceEntry(entry){const riskCompliant=null!=entry.qScore&&entry.qScore>=70&&"Approved"===entry.compassPreQualStatus,documentsCompliant=!0===entry.scopeMatchesBudget&&!0===entry.exhibitCInsuranceConfirmed&&!0===entry.exhibitDScheduleConfirmed&&!0===entry.exhibitESafetyConfirmed,hasDoc=!(!entry.compiledCommitmentPdfUrl&&!entry.compiledCommitmentFileId),insuranceCompliant=entry.enrolledInSDI&&!!entry.insuranceCOIReceivedDate,eVerifyCompliant="Received"===entry.eVerifyStatus,overallCompliant=riskCompliant&&documentsCompliant&&hasDoc&&insuranceCompliant&&eVerifyCompliant,lead=this.leads.find(l=>l.ProjectCode===entry.projectCode);return{id:entry.id,projectCode:entry.projectCode,projectName:(null==lead?void 0:lead.Title)||entry.projectCode,divisionCode:entry.divisionCode,divisionDescription:entry.divisionDescription,subcontractorName:entry.subcontractorName||"",contractValue:entry.contractValue||0,riskCompliant,qScore:entry.qScore,compassStatus:entry.compassPreQualStatus,documentsCompliant,scopeMatch:!0===entry.scopeMatchesBudget,exhibitC:!0===entry.exhibitCInsuranceConfirmed,exhibitD:!0===entry.exhibitDScheduleConfirmed,exhibitE:!0===entry.exhibitESafetyConfirmed,hasCommitmentDocument:hasDoc,insuranceCompliant,sdiEnrolled:entry.enrolledInSDI,bondRequired:entry.bondRequired,coiReceived:!!entry.insuranceCOIReceivedDate,eVerifyCompliant,eVerifyStatus:entry.eVerifyStatus||"Not Sent",eVerifyContractNumber:entry.eVerifyContractNumber,eVerifySentDate:entry.eVerifySentDate,eVerifyReminderDate:entry.eVerifyReminderDate,eVerifyReceivedDate:entry.eVerifyReceivedDate,commitmentStatus:entry.commitmentStatus,overallCompliant}}enrichBuyoutEntriesWithEVerify(entries){const eVerifyStatuses=["Received","Sent","Reminder Sent","Not Sent","Overdue"],compassStatuses=["Approved","Approved","Approved","Pending","Expired"];return entries.map((entry,idx)=>{var _a,_b,_c,_d,_e,_f,_g;const hasSubcontractor=!!entry.subcontractorName;if(!hasSubcontractor)return entry;const evStatus=eVerifyStatuses[idx%eVerifyStatuses.length],compassStatus=compassStatuses[idx%compassStatuses.length];return Object.assign(Object.assign({},entry),{qScore:null!==(_a=entry.qScore)&&void 0!==_a?_a:60+Math.floor(35*Math.random()),compassPreQualStatus:null!==(_b=entry.compassPreQualStatus)&&void 0!==_b?_b:compassStatus,scopeMatchesBudget:null!==(_c=entry.scopeMatchesBudget)&&void 0!==_c?_c:idx%4!=3,exhibitCInsuranceConfirmed:null!==(_d=entry.exhibitCInsuranceConfirmed)&&void 0!==_d?_d:idx%5!=4,exhibitDScheduleConfirmed:null!==(_e=entry.exhibitDScheduleConfirmed)&&void 0!==_e?_e:idx%6!=5,exhibitESafetyConfirmed:null!==(_f=entry.exhibitESafetyConfirmed)&&void 0!==_f?_f:idx%7!=6,compiledCommitmentPdfUrl:null!==(_g=entry.compiledCommitmentPdfUrl)&&void 0!==_g?_g:idx%3!=2?`/sites/${entry.projectCode}/Shared Documents/Commitments/${entry.divisionCode}_commitment.pdf`:void 0,compiledCommitmentFileId:entry.compiledCommitmentPdfUrl?`file-${entry.id}`:void 0,compiledCommitmentFileName:entry.compiledCommitmentPdfUrl?`${entry.divisionCode}_commitment.pdf`:void 0,eVerifyContractNumber:hasSubcontractor?`SC-${entry.projectCode}-${entry.divisionCode}`:void 0,eVerifySentDate:"Not Sent"!==evStatus?"2025-11-01":void 0,eVerifyReminderDate:"Reminder Sent"===evStatus||"Received"===evStatus||"Overdue"===evStatus?"2025-11-15":void 0,eVerifyReceivedDate:"Received"===evStatus?"2025-11-20":void 0,eVerifyStatus:evStatus})})}async rekeyProjectCode(oldCode,newCode,leadId){await delay();const leadIndex=this.leads.findIndex(l=>l.id===leadId);-1!==leadIndex&&(this.leads[leadIndex].ProjectCode=newCode,this.leads[leadIndex].OfficialJobNumber=newCode);for(const rec of this.estimatingRecords)rec.ProjectCode===oldCode&&(rec.ProjectCode=newCode);for(const tm of this.teamMembers)tm.projectCode===oldCode&&(tm.projectCode=newCode);for(const d of this.deliverables)d.projectCode===oldCode&&(d.projectCode=newCode);for(const t of this.turnoverItems)t.projectCode===oldCode&&(t.projectCode=newCode);for(const c of this.closeoutItems)c.projectCode===oldCode&&(c.projectCode=newCode);for(const ci of this.checklistItems)ci.projectCode===oldCode&&(ci.projectCode=newCode);for(const mt of this.internalMatrixTasks)mt.projectCode===oldCode&&(mt.projectCode=newCode);for(const tra of this.teamRoleAssignments)tra.projectCode===oldCode&&(tra.projectCode=newCode);for(const oca of this.ownerContractArticles)oca.projectCode===oldCode&&(oca.projectCode=newCode);for(const scc of this.subContractClauses)scc.projectCode===oldCode&&(scc.projectCode=newCode);for(const mr of this.marketingRecords)mr.projectCode===oldCode&&(mr.projectCode=newCode);for(const rc of this.riskCostRecords)rc.projectCode===oldCode&&(rc.projectCode=newCode);for(const qc of this.qualityConcerns)qc.projectCode===oldCode&&(qc.projectCode=newCode);for(const sc of this.safetyConcerns)sc.projectCode===oldCode&&(sc.projectCode=newCode);for(const sr of this.scheduleRecords)sr.projectCode===oldCode&&(sr.projectCode=newCode);for(const sp of this.superintendentPlans)sp.projectCode===oldCode&&(sp.projectCode=newCode);for(const ll of this.lessonsLearned)ll.projectCode===oldCode&&(ll.projectCode=newCode);for(const pmp of this.pmps)pmp.projectCode===oldCode&&(pmp.projectCode=newCode);for(const mr of this.monthlyReviews)mr.projectCode===oldCode&&(mr.projectCode=newCode);for(const pl of this.provisioningLogs)pl.projectCode===oldCode&&(pl.projectCode=newCode);for(const be of this.buyoutEntries)be.projectCode===oldCode&&(be.projectCode=newCode)}async getTemplates(){await delay();try{return __webpack_require__("./packages/hbc-sp-services/src/mock/templateRegistry.json")}catch(_a){return[]}}async getRegions(){await delay();const{Region}=__webpack_require__("./packages/hbc-sp-services/src/models/enums.ts");return Object.values(Region)}async getSectors(){await delay();const{Sector}=__webpack_require__("./packages/hbc-sp-services/src/models/enums.ts");return Object.values(Sector)}async getActiveProjects(options){var _a,_b;await delay();let filtered=[...this.activeProjects];if((null==options?void 0:options.status)&&(filtered=filtered.filter(p=>p.status===options.status)),(null==options?void 0:options.sector)&&(filtered=filtered.filter(p=>p.sector===options.sector)),(null==options?void 0:options.projectExecutive)&&(filtered=filtered.filter(p=>p.personnel.projectExecutive===options.projectExecutive)),(null==options?void 0:options.projectManager)&&(filtered=filtered.filter(p=>p.personnel.leadPM===options.projectManager)),(null==options?void 0:options.region)&&(filtered=filtered.filter(p=>p.region===options.region)),(null==options?void 0:options.hasAlerts)&&(filtered=filtered.filter(p=>p.hasUnbilledAlert||p.hasScheduleAlert||p.hasFeeErosionAlert)),null==options?void 0:options.orderBy){const key=options.orderBy,asc=!1!==options.orderAscending;filtered.sort((a,b)=>{const aVal=a[key],bVal=b[key];return null==aVal?1:null==bVal?-1:aVal<bVal?asc?-1:1:aVal>bVal?asc?1:-1:0})}const skip=null!==(_a=null==options?void 0:options.skip)&&void 0!==_a?_a:0,top=null!==(_b=null==options?void 0:options.top)&&void 0!==_b?_b:filtered.length;return filtered.slice(skip,skip+top)}async getActiveProjectById(id){var _a;return await delay(),null!==(_a=this.activeProjects.find(p=>p.id===id))&&void 0!==_a?_a:null}async syncActiveProject(projectCode){await delay();const existing=this.activeProjects.find(p=>p.projectCode===projectCode);if(existing)return existing.lastSyncDate=(new Date).toISOString(),Object.assign({},existing);throw new Error(`Project ${projectCode} not found`)}async updateActiveProject(id,data){await delay();const index=this.activeProjects.findIndex(p=>p.id===id);if(-1===index)throw new Error(`Active project ${id} not found`);return this.activeProjects[index]=Object.assign(Object.assign(Object.assign({},this.activeProjects[index]),data),{lastModified:(new Date).toISOString()}),Object.assign({},this.activeProjects[index])}async getPortfolioSummary(filters){await delay();let projects=[...this.activeProjects];(null==filters?void 0:filters.status)&&(projects=projects.filter(p=>p.status===filters.status)),(null==filters?void 0:filters.sector)&&(projects=projects.filter(p=>p.sector===filters.sector)),(null==filters?void 0:filters.projectExecutive)&&(projects=projects.filter(p=>p.personnel.projectExecutive===filters.projectExecutive)),(null==filters?void 0:filters.projectManager)&&(projects=projects.filter(p=>p.personnel.leadPM===filters.projectManager)),(null==filters?void 0:filters.region)&&(projects=projects.filter(p=>p.region===filters.region));const totalBacklog=projects.reduce((sum,p)=>sum+(p.financials.remainingValue||0),0),totalOriginalContract=projects.reduce((sum,p)=>sum+(p.financials.originalContract||0),0),totalBillingsToDate=projects.reduce((sum,p)=>sum+(p.financials.billingsToDate||0),0),totalUnbilled=projects.reduce((sum,p)=>sum+(p.financials.unbilled||0),0),projectsWithFee=projects.filter(p=>null!=p.financials.projectedFeePct),averageFeePct=projectsWithFee.length>0?projectsWithFee.reduce((sum,p)=>sum+(p.financials.projectedFeePct||0),0)/projectsWithFee.length:0,monthlyBurnRate=totalBillingsToDate/12,projectsByStatus={Precon:projects.filter(p=>"Precon"===p.status).length,Construction:projects.filter(p=>"Construction"===p.status).length,"Final Payment":projects.filter(p=>"Final Payment"===p.status).length},projectsBySector={Commercial:projects.filter(p=>"Commercial"===p.sector).length,Residential:projects.filter(p=>"Residential"===p.sector).length},projectsWithAlerts=projects.filter(p=>p.hasUnbilledAlert||p.hasScheduleAlert||p.hasFeeErosionAlert).length;return{totalBacklog,totalOriginalContract,totalBillingsToDate,totalUnbilled,averageFeePct,monthlyBurnRate,projectCount:projects.length,projectsByStatus,projectsBySector,projectsWithAlerts}}async getPersonnelWorkload(role){await delay();const workloadMap=new Map;for(const project of this.activeProjects){if((!role||"PX"===role)&&project.personnel.projectExecutive){const name=project.personnel.projectExecutive,existing=workloadMap.get(`PX-${name}`)||{name,email:project.personnel.projectExecutiveEmail,role:"PX",projectCount:0,totalContractValue:0,projects:[]};existing.projectCount++,existing.totalContractValue+=project.financials.currentContractValue||project.financials.originalContract||0,existing.projects.push(project),workloadMap.set(`PX-${name}`,existing)}if((!role||"PM"===role)&&project.personnel.leadPM){const name=project.personnel.leadPM,existing=workloadMap.get(`PM-${name}`)||{name,email:project.personnel.leadPMEmail,role:"PM",projectCount:0,totalContractValue:0,projects:[]};existing.projectCount++,existing.totalContractValue+=project.financials.currentContractValue||project.financials.originalContract||0,existing.projects.push(project),workloadMap.set(`PM-${name}`,existing)}if((!role||"Super"===role)&&project.personnel.leadSuper){const name=project.personnel.leadSuper,existing=workloadMap.get(`Super-${name}`)||{name,role:"Super",projectCount:0,totalContractValue:0,projects:[]};existing.projectCount++,existing.totalContractValue+=project.financials.currentContractValue||project.financials.originalContract||0,existing.projects.push(project),workloadMap.set(`Super-${name}`,existing)}}return Array.from(workloadMap.values()).sort((a,b)=>b.projectCount-a.projectCount)}async triggerPortfolioSync(){await delay();const now=(new Date).toISOString();for(const project of this.activeProjects)project.lastSyncDate=now}async purgeOldAuditEntries(olderThanDays){await delay();const cutoff=Date.now()-24*olderThanDays*60*60*1e3,before=this.auditLog.length;return this.auditLog=this.auditLog.filter(e=>new Date(e.Timestamp).getTime()>=cutoff),before-this.auditLog.length}async syncDenormalizedFields(leadId){var _a,_b;await delay();const lead=this.leads.find(l=>l.id===leadId);if(lead){for(const est of this.estimatingRecords)est.LeadID===leadId&&(est.Title=lead.Title);for(const pmp of this.pmps)pmp.projectCode===lead.ProjectCode&&(pmp.projectName=lead.Title);for(const mr of this.marketingRecords)mr.projectCode===lead.ProjectCode&&(mr.projectName=lead.Title);for(const pl of this.provisioningLogs)pl.projectCode===lead.ProjectCode&&(pl.projectName=lead.Title);for(const jnr of this.jobNumberRequests)jnr.LeadID===leadId&&(jnr.ProjectExecutive=null!==(_a=lead.ProjectExecutive)&&void 0!==_a?_a:jnr.ProjectExecutive,jnr.ProjectManager=null!==(_b=lead.ProjectManager)&&void 0!==_b?_b:jnr.ProjectManager)}}async promoteToHub(projectCode){await delay();const projectLessons=this.lessonsLearned.filter(l=>l.projectCode===projectCode&&l.isIncludedInFinalRecord);for(const lesson of projectLessons){this.lessonsLearnedHub.some(l=>l.projectCode===lesson.projectCode&&l.id===lesson.id)||this.lessonsLearnedHub.push(Object.assign({},lesson))}const pmpIndex=this.pmps.findIndex(p=>p.projectCode===projectCode);-1!==pmpIndex&&"Closed"!==this.pmps[pmpIndex].status&&(this.pmps[pmpIndex].status="Closed",this.pmps[pmpIndex].lastUpdatedAt=(new Date).toISOString())}async getWorkflowDefinitions(){return await delay(),JSON.parse(JSON.stringify(this.workflowDefinitions))}async getWorkflowDefinition(workflowKey){await delay();const def=this.workflowDefinitions.find(w=>w.workflowKey===workflowKey);return def?JSON.parse(JSON.stringify(def)):null}async updateWorkflowStep(workflowId,stepId,data){await delay();const workflow=this.workflowDefinitions.find(w=>w.id===workflowId);if(!workflow)throw new Error(`Workflow ${workflowId} not found`);const stepIndex=workflow.steps.findIndex(s=>s.id===stepId);if(-1===stepIndex)throw new Error(`Step ${stepId} not found`);return workflow.steps[stepIndex]=Object.assign(Object.assign(Object.assign({},workflow.steps[stepIndex]),data),{id:stepId,workflowId}),workflow.lastModifiedDate=(new Date).toISOString(),JSON.parse(JSON.stringify(workflow.steps[stepIndex]))}async addConditionalAssignment(stepId,assignment){await delay();for(const workflow of this.workflowDefinitions){const step=workflow.steps.find(s=>s.id===stepId);if(step){const newAssignment={id:this.getNextId(),stepId,conditions:assignment.conditions||[],assignee:assignment.assignee||{userId:"",displayName:"",email:""},priority:assignment.priority||step.conditionalAssignees.length+1};return step.conditionalAssignees.push(newAssignment),workflow.lastModifiedDate=(new Date).toISOString(),JSON.parse(JSON.stringify(newAssignment))}}throw new Error(`Step ${stepId} not found`)}async updateConditionalAssignment(assignmentId,data){await delay();for(const workflow of this.workflowDefinitions)for(const step of workflow.steps){const idx=step.conditionalAssignees.findIndex(a=>a.id===assignmentId);if(-1!==idx)return step.conditionalAssignees[idx]=Object.assign(Object.assign(Object.assign({},step.conditionalAssignees[idx]),data),{id:assignmentId}),workflow.lastModifiedDate=(new Date).toISOString(),JSON.parse(JSON.stringify(step.conditionalAssignees[idx]))}throw new Error(`Conditional assignment ${assignmentId} not found`)}async removeConditionalAssignment(assignmentId){await delay();for(const workflow of this.workflowDefinitions)for(const step of workflow.steps){const idx=step.conditionalAssignees.findIndex(a=>a.id===assignmentId);if(-1!==idx)return step.conditionalAssignees.splice(idx,1),void(workflow.lastModifiedDate=(new Date).toISOString())}throw new Error(`Conditional assignment ${assignmentId} not found`)}async getWorkflowOverrides(projectCode){return await delay(),JSON.parse(JSON.stringify(this.workflowStepOverrides.filter(o=>o.projectCode===projectCode)))}async setWorkflowStepOverride(override){await delay(),this.workflowStepOverrides=this.workflowStepOverrides.filter(o=>!(o.projectCode===override.projectCode&&o.stepId===override.stepId));const newOverride={id:this.getNextId(),projectCode:override.projectCode||"",workflowKey:override.workflowKey||enums.WorkflowKey.GO_NO_GO,stepId:override.stepId||0,overrideAssignee:override.overrideAssignee||{userId:"",displayName:"",email:""},overrideReason:override.overrideReason,overriddenBy:override.overriddenBy||"",overriddenDate:(new Date).toISOString()};return this.workflowStepOverrides.push(newOverride),JSON.parse(JSON.stringify(newOverride))}async removeWorkflowStepOverride(overrideId){await delay();const idx=this.workflowStepOverrides.findIndex(o=>o.id===overrideId);if(-1===idx)throw new Error(`Override ${overrideId} not found`);this.workflowStepOverrides.splice(idx,1)}async resolveWorkflowChain(workflowKey,projectCode){await delay();const workflow=this.workflowDefinitions.find(w=>w.workflowKey===workflowKey);if(!workflow)return[];const overrides=this.workflowStepOverrides.filter(o=>o.projectCode===projectCode&&o.workflowKey===workflowKey),teamMembers=this.teamMembers.filter(tm=>tm.projectCode===projectCode),lead=this.leads.find(l=>l.ProjectCode===projectCode),resolved=[];for(const step of workflow.steps){if(step.featureFlagName){const flag=this.featureFlags.find(f=>f.FeatureName===step.featureFlagName);if(!(!flag||flag.Enabled)){step.isSkippable&&resolved.push({stepId:step.id,stepOrder:step.stepOrder,name:step.name,assignee:{userId:"",displayName:"(Skipped)",email:""},assignmentSource:"Default",isConditional:!1,conditionMet:!1,actionLabel:step.actionLabel,canChairMeeting:!1,skipped:!0,skipReason:`Feature flag '${step.featureFlagName}' is disabled`});continue}}const override=overrides.find(o=>o.stepId===step.id);if(override)resolved.push({stepId:step.id,stepOrder:step.stepOrder,name:step.name,assignee:override.overrideAssignee,assignmentSource:"Override",isConditional:step.isConditional,conditionMet:!0,actionLabel:step.actionLabel,canChairMeeting:step.canChairMeeting||!1});else{if(step.assignmentType===enums.StepAssignmentType.ProjectRole&&step.projectRole){const member=teamMembers.find(tm=>tm.role===step.projectRole);member?resolved.push({stepId:step.id,stepOrder:step.stepOrder,name:step.name,assignee:{userId:String(member.id),displayName:member.name,email:member.email},assignmentSource:"ProjectRole",isConditional:step.isConditional,conditionMet:!0,actionLabel:step.actionLabel,canChairMeeting:step.canChairMeeting||!1}):resolved.push({stepId:step.id,stepOrder:step.stepOrder,name:step.name,assignee:{userId:"",displayName:`(No ${step.projectRole} assigned)`,email:""},assignmentSource:"ProjectRole",isConditional:step.isConditional,conditionMet:!1,actionLabel:step.actionLabel,canChairMeeting:step.canChairMeeting||!1});continue}if(step.assignmentType===enums.StepAssignmentType.NamedPerson){let assignee=step.defaultAssignee,source="Default",conditionMet=!step.isConditional;if(step.conditionalAssignees.length>0&&lead){const sorted=[...step.conditionalAssignees].sort((a,b)=>a.priority-b.priority);for(const ca of sorted){if(ca.conditions.every(cond=>this.getLeadFieldValue(lead,cond.field)===cond.value)){assignee=ca.assignee,source="Condition",conditionMet=!0;break}}}resolved.push({stepId:step.id,stepOrder:step.stepOrder,name:step.name,assignee:assignee||{userId:"",displayName:"(Unassigned)",email:""},assignmentSource:source,isConditional:step.isConditional,conditionMet,actionLabel:step.actionLabel,canChairMeeting:step.canChairMeeting||!1});continue}}}return resolved}getLeadFieldValue(lead,field){switch(field){case enums.ConditionField.Division:return lead.Division||"";case enums.ConditionField.Region:return lead.Region||"";case enums.ConditionField.Sector:return lead.Sector||"";default:return""}}assembleTurnoverAgenda(agendaId){const agenda=this.turnoverAgendas.find(a=>a.id===agendaId);if(!agenda)return null;const header=this.turnoverHeaders.find(h=>h.turnoverAgendaId===agendaId),overview=this.turnoverEstimateOverviews.find(e=>e.turnoverAgendaId===agendaId),prereqs=this.turnoverPrerequisites.filter(p=>p.turnoverAgendaId===agendaId).sort((a,b)=>a.sortOrder-b.sortOrder),items=this.turnoverDiscussionItems.filter(d=>d.turnoverAgendaId===agendaId).sort((a,b)=>a.sortOrder-b.sortOrder),subs=this.turnoverSubcontractors.filter(s=>s.turnoverAgendaId===agendaId),exhibits=this.turnoverExhibits.filter(e=>e.turnoverAgendaId===agendaId).sort((a,b)=>a.sortOrder-b.sortOrder),sigs=this.turnoverSignatures.filter(s=>s.turnoverAgendaId===agendaId).sort((a,b)=>a.sortOrder-b.sortOrder),itemsWithAttachments=items.map(item=>Object.assign(Object.assign({},item),{attachments:this.turnoverAttachments.filter(a=>a.discussionItemId===item.id)}));return JSON.parse(JSON.stringify(Object.assign(Object.assign({},agenda),{header:header||{},estimateOverview:overview||{},prerequisites:prereqs,discussionItems:itemsWithAttachments,subcontractors:subs,exhibits,signatures:sigs})))}async getTurnoverAgenda(projectCode){await delay();const agenda=this.turnoverAgendas.find(a=>a.projectCode===projectCode);return agenda?this.assembleTurnoverAgenda(agenda.id):null}async createTurnoverAgenda(projectCode,leadId){await delay();const lead=this.leads.find(l=>l.id===leadId),agendaId=++this.nextId,newAgenda={id:agendaId,projectCode,leadId,status:enums.TurnoverStatus.Draft,projectName:(null==lead?void 0:lead.Title)||"",header:{},estimateOverview:{},prerequisites:[],discussionItems:[],subcontractors:[],exhibits:[],signatures:[],createdBy:"Current User",createdDate:(new Date).toISOString()};this.turnoverAgendas.push(newAgenda);const headerId=++this.nextId;this.turnoverHeaders.push({id:headerId,turnoverAgendaId:agendaId,projectName:(null==lead?void 0:lead.Title)||"",projectCode,clientName:(null==lead?void 0:lead.ClientName)||"",projectValue:(null==lead?void 0:lead.ProjectValue)||0,deliveryMethod:(null==lead?void 0:lead.DeliveryMethod)||"",projectExecutive:(null==lead?void 0:lead.ProjectExecutive)||"",projectManager:(null==lead?void 0:lead.ProjectManager)||"",leadEstimator:"",overrides:{}});const overviewId=++this.nextId,projectValue=(null==lead?void 0:lead.ProjectValue)||0,feePct=(null==lead?void 0:lead.AnticipatedFeePct)||5;this.turnoverEstimateOverviews.push({id:overviewId,turnoverAgendaId:agendaId,contractAmount:projectValue,originalEstimate:projectValue,buyoutTarget:Math.round(.9*projectValue),estimatedFee:Math.round(projectValue*(feePct/100)),estimatedGrossMargin:(null==lead?void 0:lead.AnticipatedGrossMargin)||0,contingency:Math.round(.015*projectValue),notes:"",overrides:{}});for(const prereq of DEFAULT_PREREQUISITES)this.turnoverPrerequisites.push({id:++this.nextId,turnoverAgendaId:agendaId,sortOrder:prereq.sortOrder,label:prereq.label,description:prereq.description,completed:!1});for(const item of DEFAULT_DISCUSSION_ITEMS)this.turnoverDiscussionItems.push({id:++this.nextId,turnoverAgendaId:agendaId,sortOrder:item.sortOrder,label:item.label,description:item.description,discussed:!1,notes:"",attachments:[]});for(const exhibit of DEFAULT_EXHIBITS)this.turnoverExhibits.push({id:++this.nextId,turnoverAgendaId:agendaId,sortOrder:exhibit.sortOrder,label:exhibit.label,isDefault:exhibit.isDefault,reviewed:!1});const teamMembers=this.teamMembers.filter(tm=>tm.projectCode===projectCode);for(const sig of DEFAULT_SIGNATURES){let signerName="",signerEmail="";if("Lead Estimator"===sig.role){const estCoord=teamMembers.find(tm=>tm.role===enums.RoleName.EstimatingCoordinator);signerName=(null==estCoord?void 0:estCoord.name)||"",signerEmail=(null==estCoord?void 0:estCoord.email)||""}else if("Project Executive"===sig.role){signerName=(null==lead?void 0:lead.ProjectExecutive)||"";const px=teamMembers.find(tm=>tm.role===enums.RoleName.ExecutiveLeadership);signerEmail=(null==px?void 0:px.email)||""}else if("Project Manager"===sig.role){signerName=(null==lead?void 0:lead.ProjectManager)||"";const pm=teamMembers.find(tm=>tm.role===enums.RoleName.OperationsTeam&&"Project Management"===tm.department);signerEmail=(null==pm?void 0:pm.email)||""}else if("Superintendent"===sig.role){const super_=teamMembers.find(tm=>tm.role===enums.RoleName.OperationsTeam&&"Field Operations"===tm.department);signerName=(null==super_?void 0:super_.name)||"",signerEmail=(null==super_?void 0:super_.email)||""}this.turnoverSignatures.push({id:++this.nextId,turnoverAgendaId:agendaId,sortOrder:sig.sortOrder,role:sig.role,signerName,signerEmail,affidavitText:TURNOVER_SIGNATURE_AFFIDAVIT,signed:!1})}return this.assembleTurnoverAgenda(agendaId)}async updateTurnoverAgenda(projectCode,data){await delay();const idx=this.turnoverAgendas.findIndex(a=>a.projectCode===projectCode);if(-1===idx)throw new Error("Turnover agenda not found");return this.turnoverAgendas[idx]=Object.assign(Object.assign(Object.assign({},this.turnoverAgendas[idx]),data),{lastModifiedDate:(new Date).toISOString()}),this.assembleTurnoverAgenda(this.turnoverAgendas[idx].id)}async updateTurnoverPrerequisite(prerequisiteId,data){await delay();const idx=this.turnoverPrerequisites.findIndex(p=>p.id===prerequisiteId);if(-1===idx)throw new Error("Prerequisite not found");return this.turnoverPrerequisites[idx]=Object.assign(Object.assign({},this.turnoverPrerequisites[idx]),data),JSON.parse(JSON.stringify(this.turnoverPrerequisites[idx]))}async updateTurnoverDiscussionItem(itemId,data){await delay();const idx=this.turnoverDiscussionItems.findIndex(d=>d.id===itemId);if(-1===idx)throw new Error("Discussion item not found");this.turnoverDiscussionItems[idx]=Object.assign(Object.assign({},this.turnoverDiscussionItems[idx]),data);const item=this.turnoverDiscussionItems[idx];return JSON.parse(JSON.stringify(Object.assign(Object.assign({},item),{attachments:this.turnoverAttachments.filter(a=>a.discussionItemId===item.id)})))}async addTurnoverDiscussionAttachment(itemId,_file){await delay();const attachment={id:++this.nextId,discussionItemId:itemId,fileName:_file.name,fileUrl:`https://hedrickbrothers.sharepoint.com/sites/mock/Turnover/${_file.name}`,uploadedBy:"Current User",uploadedDate:(new Date).toISOString()};return this.turnoverAttachments.push(attachment),JSON.parse(JSON.stringify(attachment))}async removeTurnoverDiscussionAttachment(attachmentId){await delay();const idx=this.turnoverAttachments.findIndex(a=>a.id===attachmentId);-1!==idx&&this.turnoverAttachments.splice(idx,1)}async addTurnoverSubcontractor(turnoverAgendaId,data){var _a,_b,_c;await delay();const sub={id:++this.nextId,turnoverAgendaId,trade:data.trade||"",subcontractorName:data.subcontractorName||"",contactName:data.contactName||"",contactPhone:data.contactPhone||"",contactEmail:data.contactEmail||"",qScore:null!==(_a=data.qScore)&&void 0!==_a?_a:null,isPreferred:null!==(_b=data.isPreferred)&&void 0!==_b&&_b,isRequired:null!==(_c=data.isRequired)&&void 0!==_c&&_c,notes:data.notes||""};return this.turnoverSubcontractors.push(sub),JSON.parse(JSON.stringify(sub))}async updateTurnoverSubcontractor(subId,data){await delay();const idx=this.turnoverSubcontractors.findIndex(s=>s.id===subId);if(-1===idx)throw new Error("Subcontractor not found");return this.turnoverSubcontractors[idx]=Object.assign(Object.assign({},this.turnoverSubcontractors[idx]),data),JSON.parse(JSON.stringify(this.turnoverSubcontractors[idx]))}async removeTurnoverSubcontractor(subId){await delay();const idx=this.turnoverSubcontractors.findIndex(s=>s.id===subId);-1!==idx&&this.turnoverSubcontractors.splice(idx,1)}async updateTurnoverExhibit(exhibitId,data){await delay();const idx=this.turnoverExhibits.findIndex(e=>e.id===exhibitId);if(-1===idx)throw new Error("Exhibit not found");return this.turnoverExhibits[idx]=Object.assign(Object.assign({},this.turnoverExhibits[idx]),data),JSON.parse(JSON.stringify(this.turnoverExhibits[idx]))}async addTurnoverExhibit(turnoverAgendaId,data){await delay();const existing=this.turnoverExhibits.filter(e=>e.turnoverAgendaId===turnoverAgendaId),maxOrder=existing.length>0?Math.max(...existing.map(e=>e.sortOrder)):0,exhibit=Object.assign({id:++this.nextId,turnoverAgendaId,sortOrder:maxOrder+1,label:data.label||"Custom Exhibit",isDefault:!1,reviewed:!1},data);return this.turnoverExhibits.push(exhibit),JSON.parse(JSON.stringify(exhibit))}async removeTurnoverExhibit(exhibitId){await delay();const idx=this.turnoverExhibits.findIndex(e=>e.id===exhibitId);-1!==idx&&this.turnoverExhibits.splice(idx,1)}async uploadTurnoverExhibitFile(exhibitId,_file){await delay();const idx=this.turnoverExhibits.findIndex(e=>e.id===exhibitId);if(-1===idx)throw new Error("Exhibit not found");const fileUrl=`https://hedrickbrothers.sharepoint.com/sites/mock/Turnover/${_file.name}`;return this.turnoverExhibits[idx]=Object.assign(Object.assign({},this.turnoverExhibits[idx]),{uploadedFileName:_file.name,uploadedFileUrl:fileUrl}),{fileUrl,fileName:_file.name}}async signTurnoverAgenda(signatureId,comment){await delay();const idx=this.turnoverSignatures.findIndex(s=>s.id===signatureId);if(-1===idx)throw new Error("Signature not found");return this.turnoverSignatures[idx]=Object.assign(Object.assign({},this.turnoverSignatures[idx]),{signed:!0,signedDate:(new Date).toISOString(),comment:comment||""}),JSON.parse(JSON.stringify(this.turnoverSignatures[idx]))}async updateTurnoverEstimateOverview(projectCode,data){await delay();const agenda=this.turnoverAgendas.find(a=>a.projectCode===projectCode);if(!agenda)throw new Error("Turnover agenda not found");const idx=this.turnoverEstimateOverviews.findIndex(e=>e.turnoverAgendaId===agenda.id);if(-1===idx)throw new Error("Estimate overview not found");return this.turnoverEstimateOverviews[idx]=Object.assign(Object.assign({},this.turnoverEstimateOverviews[idx]),data),JSON.parse(JSON.stringify(this.turnoverEstimateOverviews[idx]))}async getHubSiteUrl(){return await delay(),this.hubSiteUrl}async setHubSiteUrl(url){await delay(),this.hubSiteUrl=url}async getActionItems(userEmail){var _a,_b,_c,_d,_e,_f,_g,_h,_j;await delay();const items=[],email=userEmail.toLowerCase(),now=new Date,computePriority=dateStr=>{const days=Math.floor((now.getTime()-new Date(dateStr).getTime())/864e5);return days>7?enums.ActionPriority.Urgent:days>=1?enums.ActionPriority.Normal:enums.ActionPriority.New},computeDays=dateStr=>Math.max(0,Math.floor((now.getTime()-new Date(dateStr).getTime())/864e5));for(const sc of this.scorecards){const assembled=this.assembleScorecard(sc);if(!(null===(_a=assembled.approvalCycles)||void 0===_a?void 0:_a.length))continue;const activeCycle=assembled.approvalCycles.find(c=>"Active"===c.status);if(!activeCycle)continue;const pendingStep=null===(_b=activeCycle.steps)||void 0===_b?void 0:_b.find(s=>{var _a;return"Pending"===s.status&&(null===(_a=s.assigneeEmail)||void 0===_a?void 0:_a.toLowerCase())===email});if(pendingStep){const lead=this.leads.find(l=>l.id===sc.LeadID),prevStep=null===(_c=activeCycle.steps)||void 0===_c?void 0:_c.find(s=>s.stepOrder===pendingStep.stepOrder-1),requestedDate=(null==prevStep?void 0:prevStep.actionDate)||activeCycle.startedDate||now.toISOString().split("T")[0];items.push({id:`gonogo-${sc.id}-${pendingStep.id}`,workflowType:1===pendingStep.stepOrder?enums.WorkflowActionType.GoNoGoRevision:enums.WorkflowActionType.GoNoGoReview,actionLabel:1===pendingStep.stepOrder?"Revise Go/No-Go Scorecard":"Review Go/No-Go Scorecard",projectCode:(null==lead?void 0:lead.ProjectCode)||"",projectName:(null==lead?void 0:lead.Title)||`Lead ${sc.LeadID}`,entityId:sc.id,requestedBy:(null==prevStep?void 0:prevStep.assigneeName)||"System",requestedByEmail:(null==prevStep?void 0:prevStep.assigneeEmail)||"",requestedDate,waitingDays:computeDays(requestedDate),routePath:`/lead/${sc.LeadID}/gonogo`,priority:computePriority(requestedDate)})}}for(const pmp of this.pmps){const assembled=this.assemblePMP(pmp);if(!(null===(_d=assembled.approvalCycles)||void 0===_d?void 0:_d.length))continue;const activeCycle=assembled.approvalCycles.find(c=>"InProgress"===c.status);if(!activeCycle)continue;const pendingStep=null===(_e=activeCycle.steps)||void 0===_e?void 0:_e.find(s=>{var _a;return"Pending"===s.status&&(null===(_a=s.approverEmail)||void 0===_a?void 0:_a.toLowerCase())===email});if(pendingStep){const requestedDate=activeCycle.submittedDate||now.toISOString().split("T")[0];items.push({id:`pmp-approval-${pmp.id}-${pendingStep.id}`,workflowType:enums.WorkflowActionType.PMPApproval,actionLabel:"Approve Project Management Plan",projectCode:pmp.projectCode,projectName:pmp.projectName||pmp.projectCode,entityId:pmp.id,requestedBy:activeCycle.submittedBy||"Unknown",requestedByEmail:"",requestedDate,waitingDays:computeDays(requestedDate),routePath:"/operations/management-plan",priority:computePriority(requestedDate)})}}for(const pmp of this.pmps){const assembled=this.assemblePMP(pmp),pendingSigs=[...assembled.startupSignatures||[],...assembled.completionSignatures||[]].filter(s=>{var _a;return"Pending"===s.status&&(null===(_a=s.personEmail)||void 0===_a?void 0:_a.toLowerCase())===email});for(const sig of pendingSigs){const requestedDate=pmp.lastUpdatedAt||pmp.createdAt||now.toISOString().split("T")[0];items.push({id:`pmp-sig-${pmp.id}-${sig.id}`,workflowType:enums.WorkflowActionType.PMPSignature,actionLabel:`Sign PMP (${sig.signatureType})`,projectCode:pmp.projectCode,projectName:pmp.projectName||pmp.projectCode,entityId:pmp.id,requestedBy:pmp.createdBy||"Unknown",requestedByEmail:"",requestedDate,waitingDays:computeDays(requestedDate),routePath:"/operations/management-plan",priority:computePriority(requestedDate)})}}for(const review of this.monthlyReviews){const assembled=this.assembleMonthlyReview(review),status=assembled.status;if("PendingPXReview"===status||"PendingPXValidation"===status){const currentUserData=this.users.find(u=>{var _a;return(null===(_a=u.email)||void 0===_a?void 0:_a.toLowerCase())===email});if((null===(_f=null==currentUserData?void 0:currentUserData.roles)||void 0===_f?void 0:_f.includes(enums.RoleName.ExecutiveLeadership))||(null===(_g=null==currentUserData?void 0:currentUserData.roles)||void 0===_g?void 0:_g.includes(enums.RoleName.DepartmentDirector))){const requestedDate=assembled.lastUpdatedAt||assembled.createdAt||now.toISOString().split("T")[0];items.push({id:`monthly-review-${assembled.id}`,workflowType:enums.WorkflowActionType.MonthlyReviewValidation,actionLabel:"PendingPXReview"===status?"Review Monthly Report":"Validate Monthly Report",projectCode:assembled.projectCode,projectName:assembled.projectCode,entityId:assembled.id,requestedBy:assembled.createdBy||"PM",requestedByEmail:"",requestedDate,waitingDays:computeDays(requestedDate),routePath:"/operations/monthly-review",priority:computePriority(requestedDate)})}}if(("PMRevising"===status||"InProgress"===status||"FollowUpPending"===status)&&(null===(_h=assembled.createdBy)||void 0===_h?void 0:_h.toLowerCase())===email){const requestedDate=assembled.lastUpdatedAt||assembled.createdAt||now.toISOString().split("T")[0];items.push({id:`monthly-input-${assembled.id}`,workflowType:enums.WorkflowActionType.MonthlyReviewInput,actionLabel:"FollowUpPending"===status?"Respond to Follow-Ups":"Complete Monthly Review",projectCode:assembled.projectCode,projectName:assembled.projectCode,entityId:assembled.id,requestedBy:"Project Executive",requestedByEmail:"",requestedDate,waitingDays:computeDays(requestedDate),routePath:"/operations/monthly-review",priority:computePriority(requestedDate)})}}for(const entry of this.buyoutEntries){if(!(null===(_j=entry.approvalHistory)||void 0===_j?void 0:_j.length))continue;const pendingApproval=entry.approvalHistory.find(a=>{var _a;return"Pending"===a.status&&(null===(_a=a.approverEmail)||void 0===_a?void 0:_a.toLowerCase())===email});if(pendingApproval){const previousSteps=entry.approvalHistory.filter(a=>"Approved"===a.status&&a.actionDate),lastApprovedDate=previousSteps.length>0?previousSteps.sort((a,b)=>new Date(b.actionDate).getTime()-new Date(a.actionDate).getTime())[0].actionDate:now.toISOString().split("T")[0];items.push({id:`commitment-${entry.id}-${pendingApproval.id}`,workflowType:enums.WorkflowActionType.CommitmentApproval,actionLabel:`Approve Commitment: ${entry.divisionDescription||entry.divisionCode}`,projectCode:entry.projectCode,projectName:entry.projectCode,entityId:entry.id,requestedBy:previousSteps.length>0?previousSteps[0].approverName:"Unknown",requestedByEmail:previousSteps.length>0?previousSteps[0].approverEmail:"",requestedDate:lastApprovedDate,waitingDays:computeDays(lastApprovedDate),routePath:"/operations/buyout-log",priority:computePriority(lastApprovedDate)})}}for(const agenda of this.turnoverAgendas){if(agenda.status!==enums.TurnoverStatus.PendingSignatures)continue;const unsignedSigs=this.turnoverSignatures.filter(s=>{var _a;return s.turnoverAgendaId===agenda.id&&!s.signed&&(null===(_a=s.signerEmail)||void 0===_a?void 0:_a.toLowerCase())===email});for(const sig of unsignedSigs){const lead=this.leads.find(l=>l.id===agenda.leadId),requestedDate=now.toISOString().split("T")[0];items.push({id:`turnover-sig-${agenda.id}-${sig.id}`,workflowType:enums.WorkflowActionType.TurnoverSignature,actionLabel:"Sign Turnover Agenda",projectCode:agenda.projectCode,projectName:(null==lead?void 0:lead.Title)||agenda.projectCode,entityId:agenda.id,requestedBy:"System",requestedByEmail:"",requestedDate,waitingDays:computeDays(requestedDate),routePath:`/preconstruction/pursuit/${agenda.leadId}/turnover`,priority:computePriority(requestedDate)})}}const priorityOrder={Urgent:0,Normal:1,New:2};return items.sort((a,b)=>priorityOrder[a.priority]!==priorityOrder[b.priority]?priorityOrder[a.priority]-priorityOrder[b.priority]:new Date(a.requestedDate).getTime()-new Date(b.requestedDate).getTime())}async getPermissionTemplates(){return await delay(),JSON.parse(JSON.stringify(this.permissionTemplates))}async getPermissionTemplate(id){await delay();const t=this.permissionTemplates.find(t=>t.id===id);return t?JSON.parse(JSON.stringify(t)):null}async createPermissionTemplate(data){var _a,_b,_c,_d,_e;await delay();const newTemplate={id:++this.nextId,name:data.name||"New Template",description:data.description||"",isGlobal:null!==(_a=data.isGlobal)&&void 0!==_a&&_a,globalAccess:null!==(_b=data.globalAccess)&&void 0!==_b&&_b,identityType:data.identityType||"Internal",toolAccess:data.toolAccess||[],isDefault:null!==(_c=data.isDefault)&&void 0!==_c&&_c,isActive:null===(_d=data.isActive)||void 0===_d||_d,version:null!==(_e=data.version)&&void 0!==_e?_e:1,createdBy:data.createdBy||"System",createdDate:(new Date).toISOString(),lastModifiedBy:data.lastModifiedBy||data.createdBy||"System",lastModifiedDate:(new Date).toISOString()};return this.permissionTemplates.push(newTemplate),JSON.parse(JSON.stringify(newTemplate))}async updatePermissionTemplate(id,data){await delay();const idx=this.permissionTemplates.findIndex(t=>t.id===id);if(-1===idx)throw new Error(`Template ${id} not found`);return this.permissionTemplates[idx]=Object.assign(Object.assign(Object.assign({},this.permissionTemplates[idx]),data),{id,lastModifiedDate:(new Date).toISOString()}),JSON.parse(JSON.stringify(this.permissionTemplates[idx]))}async deletePermissionTemplate(id){await delay();const idx=this.permissionTemplates.findIndex(t=>t.id===id);if(-1===idx)throw new Error(`Template ${id} not found`);this.permissionTemplates.splice(idx,1)}async getSecurityGroupMappings(){return await delay(),JSON.parse(JSON.stringify(this.securityGroupMappings))}async createSecurityGroupMapping(data){var _a;await delay();const newMapping={id:++this.nextId,securityGroupId:data.securityGroupId||"",securityGroupName:data.securityGroupName||"",defaultTemplateId:data.defaultTemplateId||0,isActive:null===(_a=data.isActive)||void 0===_a||_a};return this.securityGroupMappings.push(newMapping),JSON.parse(JSON.stringify(newMapping))}async updateSecurityGroupMapping(id,data){await delay();const idx=this.securityGroupMappings.findIndex(m=>m.id===id);if(-1===idx)throw new Error(`Security group mapping ${id} not found`);return this.securityGroupMappings[idx]=Object.assign(Object.assign(Object.assign({},this.securityGroupMappings[idx]),data),{id}),JSON.parse(JSON.stringify(this.securityGroupMappings[idx]))}async getProjectTeamAssignments(projectCode){return await delay(),JSON.parse(JSON.stringify(this.projectTeamAssignments.filter(a=>a.projectCode===projectCode&&a.isActive)))}async getMyProjectAssignments(userEmail){await delay();const email=userEmail.toLowerCase();return JSON.parse(JSON.stringify(this.projectTeamAssignments.filter(a=>a.userEmail.toLowerCase()===email&&a.isActive)))}async createProjectTeamAssignment(data){var _a;await delay();const newAssignment={id:++this.nextId,projectCode:data.projectCode||"",userId:data.userId||"",userDisplayName:data.userDisplayName||"",userEmail:data.userEmail||"",assignedRole:data.assignedRole||"",templateOverrideId:data.templateOverrideId,granularFlagOverrides:data.granularFlagOverrides,assignedBy:data.assignedBy||"System",assignedDate:(new Date).toISOString(),isActive:null===(_a=data.isActive)||void 0===_a||_a};return this.projectTeamAssignments.push(newAssignment),JSON.parse(JSON.stringify(newAssignment))}async updateProjectTeamAssignment(id,data){await delay();const idx=this.projectTeamAssignments.findIndex(a=>a.id===id);if(-1===idx)throw new Error(`Project team assignment ${id} not found`);return this.projectTeamAssignments[idx]=Object.assign(Object.assign(Object.assign({},this.projectTeamAssignments[idx]),data),{id}),JSON.parse(JSON.stringify(this.projectTeamAssignments[idx]))}async removeProjectTeamAssignment(id){await delay();const idx=this.projectTeamAssignments.findIndex(a=>a.id===id);if(-1===idx)throw new Error(`Project team assignment ${id} not found`);this.projectTeamAssignments[idx].isActive=!1}async getAllProjectTeamAssignments(){return await delay(),JSON.parse(JSON.stringify(this.projectTeamAssignments.filter(a=>a.isActive)))}async inviteToProjectSiteGroup(projectCode,userEmail,role){console.log(`[Mock] Would invite ${userEmail} to SP group for project ${projectCode} with role ${role}`)}async resolveUserPermissions(userEmail,projectCode){await delay();const email=userEmail.toLowerCase();if(this._isDevSuperAdmin){const allPerms=new Set;for(const perms of Object.values(ROLE_PERMISSIONS))for(const p of perms)allPerms.add(p);return{userId:email,projectCode,templateId:0,templateName:"Dev Super-Admin",source:"SecurityGroupDefault",toolLevels:{},granularFlags:{},permissions:allPerms,globalAccess:!0}}const groupName={"Executive Leadership":"HBC - Executive Leadership","Department Director":"HBC - Project Executives","Operations Team":"HBC - Project Managers","Preconstruction Team":"HBC - Estimating","BD Representative":"HBC - Business Development","Estimating Coordinator":"HBC - Estimating","Accounting Manager":"HBC - Accounting",Legal:"HBC - Read Only","Risk Management":"HBC - Read Only",Marketing:"HBC - Read Only","Quality Control":"HBC - Read Only",Safety:"HBC - Read Only",IDS:"HBC - Read Only","SharePoint Admin":"HBC - SharePoint Admins"}[this._currentRole]||"HBC - Read Only",groupMapping=this.securityGroupMappings.find(m=>m.securityGroupName===groupName&&m.isActive);let templateId=(null==groupMapping?void 0:groupMapping.defaultTemplateId)||8,source="SecurityGroupDefault";if(projectCode){const assignment=this.projectTeamAssignments.find(a=>a.userEmail.toLowerCase()===email&&a.projectCode===projectCode&&a.isActive);(null==assignment?void 0:assignment.templateOverrideId)&&(templateId=assignment.templateOverrideId,source="ProjectOverride")}const template=this.permissionTemplates.find(t=>t.id===templateId);if(!template)return{userId:email,projectCode,templateId:0,templateName:"Unknown",source,toolLevels:{},granularFlags:{},permissions:new Set,globalAccess:!1};const toolAccess=[...template.toolAccess];if(projectCode){const assignment=this.projectTeamAssignments.find(a=>a.userEmail.toLowerCase()===email&&a.projectCode===projectCode&&a.isActive);if(null==assignment?void 0:assignment.granularFlagOverrides)for(const override of assignment.granularFlagOverrides){const existingTool=toolAccess.find(ta=>ta.toolKey===override.toolKey);existingTool&&(existingTool.granularFlags=[...existingTool.granularFlags||[],...override.flags])}}const permissionStrings=resolveToolPermissions(toolAccess,TOOL_DEFINITIONS),permissions=new Set(permissionStrings),toolLevels={},granularFlags={};for(const ta of toolAccess)toolLevels[ta.toolKey]=ta.level,ta.granularFlags&&ta.granularFlags.length>0&&(granularFlags[ta.toolKey]=ta.granularFlags);return console.log("[PermissionEngine] resolved",{email,projectCode,templateName:template.name,source,globalAccess:template.globalAccess,permissionCount:permissions.size}),{userId:email,projectCode,templateId:template.id,templateName:template.name,source,toolLevels,granularFlags,permissions,globalAccess:template.globalAccess}}async getAccessibleProjects(userEmail){await delay();const email=userEmail.toLowerCase();if((await this.resolveUserPermissions(email,null)).globalAccess)return[...new Set(this.leads.filter(l=>l.ProjectCode).map(l=>l.ProjectCode))];const assignments=this.projectTeamAssignments.filter(a=>a.userEmail.toLowerCase()===email&&a.isActive);return[...new Set(assignments.map(a=>a.projectCode))]}async getEnvironmentConfig(){return await new Promise(r=>setTimeout(r,100)),JSON.parse(JSON.stringify(this.environmentConfig))}async promoteTemplates(fromTier,toTier,promotedBy){await new Promise(r=>setTimeout(r,500));for(const tpl of this.permissionTemplates)tpl.isActive&&(tpl.version=(tpl.version||1)+1,tpl.promotedFromTier=fromTier,tpl.lastModifiedBy=promotedBy,tpl.lastModifiedDate=(new Date).toISOString());this.environmentConfig.promotionHistory||(this.environmentConfig.promotionHistory=[]),this.environmentConfig.promotionHistory.push({fromTier,toTier,promotedBy,promotedDate:(new Date).toISOString(),templateCount:this.permissionTemplates.filter(t=>t.isActive).length})}async getSectorDefinitions(){return await new Promise(r=>setTimeout(r,100)),JSON.parse(JSON.stringify(this.sectorDefinitions.sort((a,b)=>a.sortOrder-b.sortOrder)))}async createSectorDefinition(data){var _a,_b,_c;await new Promise(r=>setTimeout(r,200));const maxId=this.sectorDefinitions.reduce((max,s)=>Math.max(max,s.id),0),maxSort=this.sectorDefinitions.reduce((max,s)=>Math.max(max,s.sortOrder),0),newSector={id:maxId+1,code:data.code||(null===(_a=data.label)||void 0===_a?void 0:_a.toUpperCase().replace(/[^A-Z0-9]/g,"_"))||"NEW",label:data.label||"New Sector",isActive:null===(_b=data.isActive)||void 0===_b||_b,parentDivision:data.parentDivision,sortOrder:null!==(_c=data.sortOrder)&&void 0!==_c?_c:maxSort+1};return this.sectorDefinitions.push(newSector),JSON.parse(JSON.stringify(newSector))}async updateSectorDefinition(id,data){await new Promise(r=>setTimeout(r,200));const idx=this.sectorDefinitions.findIndex(s=>s.id===id);if(-1===idx)throw new Error(`Sector definition ${id} not found`);return this.sectorDefinitions[idx]=Object.assign(Object.assign({},this.sectorDefinitions[idx]),data),JSON.parse(JSON.stringify(this.sectorDefinitions[idx]))}async createBdLeadFolder(leadTitle,originatorName){await delay();const parentPath=`BD Leads/${(new Date).getFullYear()}`,leadFolderPath=`${parentPath}/${leadTitle} - ${originatorName}`;this.bdLeadFolders.add(parentPath),this.bdLeadFolders.add(leadFolderPath);const subfolders=["Client Information","Correspondence","Proposal Documents","Site and Project Plans","Financial Estimates","Evaluations and Scorecards","Contracts and Legal","Media and Visuals","Archives"];for(const sub of subfolders)this.bdLeadFolders.add(`${leadFolderPath}/${sub}`)}async checkFolderExists(path){return await delay(),this.bdLeadFolders.has(path)}async createFolder(path){await delay(),this.bdLeadFolders.add(path)}async renameFolder(oldPath,newPath){await delay();const toRemove=[],toAdd=[];for(const existing of this.bdLeadFolders)(existing===oldPath||existing.startsWith(oldPath+"/"))&&(toRemove.push(existing),toAdd.push(newPath+existing.substring(oldPath.length)));for(const r of toRemove)this.bdLeadFolders.delete(r);for(const a of toAdd)this.bdLeadFolders.add(a)}async getAssignmentMappings(){return await delay(),JSON.parse(JSON.stringify(this.assignmentMappings))}async createAssignmentMapping(data){await delay();const newMapping={id:this.assignmentMappings.reduce((max,m)=>Math.max(max,m.id),0)+1,region:data.region||"All Regions",sector:data.sector||"All Sectors",assignmentType:data.assignmentType||"Director",assignee:data.assignee||{userId:"",displayName:"",email:""}};return this.assignmentMappings.push(newMapping),JSON.parse(JSON.stringify(newMapping))}async updateAssignmentMapping(id,data){await delay();const idx=this.assignmentMappings.findIndex(m=>m.id===id);if(-1===idx)throw new Error(`Assignment mapping ${id} not found`);return this.assignmentMappings[idx]=Object.assign(Object.assign({},this.assignmentMappings[idx]),data),JSON.parse(JSON.stringify(this.assignmentMappings[idx]))}async deleteAssignmentMapping(id){await delay();const idx=this.assignmentMappings.findIndex(m=>m.id===id);if(-1===idx)throw new Error(`Assignment mapping ${id} not found`);this.assignmentMappings.splice(idx,1)}async rejectScorecard(scorecardId,reason){var _a,_b;await delay();const{scorecard,index}=this.findScorecardOrThrow(scorecardId);scorecard.scorecardStatus=enums.ScorecardStatus.Rejected,scorecard.isLocked=!0,scorecard.finalDecision=enums.GoNoGoDecision.NoGo,scorecard.finalDecisionDate=(new Date).toISOString().split("T")[0];const activeCycle=null===(_a=scorecard.approvalCycles)||void 0===_a?void 0:_a.find(c=>"Active"===c.status);if(activeCycle){activeCycle.status="Completed",activeCycle.completedDate=(new Date).toISOString().split("T")[0];const pendingStep=null===(_b=activeCycle.steps)||void 0===_b?void 0:_b.find(s=>"Pending"===s.status);pendingStep&&(pendingStep.status="Returned",pendingStep.comment=`Rejected: ${reason}`,pendingStep.actionDate=(new Date).toISOString().split("T")[0])}return this.createVersionSnapshot(scorecard,`Rejected: ${reason}`,scorecard.finalDecisionBy||"system"),this.scorecards[index]=scorecard,Object.assign({},scorecard)}setProjectSiteUrl(_siteUrl){}async archiveScorecard(scorecardId,archivedBy){await delay();const{scorecard,index}=this.findScorecardOrThrow(scorecardId);scorecard.isArchived=!0,scorecard.archivedDate=(new Date).toISOString().split("T")[0],scorecard.archivedBy=archivedBy;const lead=this.leads.find(l=>l.id===scorecard.LeadID);if(lead){const oldPath=`BD Leads/${(new Date).getFullYear().toString()}/${lead.Title}`;this.bdLeadFolders.has(oldPath)&&await this.renameFolder(oldPath,`${oldPath}-ARCHIVED`)}return this.scorecards[index]=scorecard,Object.assign({},scorecard)}async logPerformanceEntry(entry){var _a,_b,_c,_d;await delay();const log={id:this.nextId++,SessionId:entry.SessionId||"unknown",Timestamp:entry.Timestamp||(new Date).toISOString(),UserEmail:entry.UserEmail||"unknown",SiteUrl:entry.SiteUrl||"",ProjectCode:entry.ProjectCode,IsProjectSite:null!==(_a=entry.IsProjectSite)&&void 0!==_a&&_a,WebPartLoadMs:null!==(_b=entry.WebPartLoadMs)&&void 0!==_b?_b:0,AppInitMs:null!==(_c=entry.AppInitMs)&&void 0!==_c?_c:0,DataFetchMs:entry.DataFetchMs,TotalLoadMs:null!==(_d=entry.TotalLoadMs)&&void 0!==_d?_d:0,Marks:entry.Marks||[],UserAgent:entry.UserAgent||"unknown",SpfxVersion:entry.SpfxVersion||"1.0.0",Notes:entry.Notes};return this.performanceLogs.push(log),JSON.parse(JSON.stringify(log))}async getPerformanceLogs(options){await delay();let logs=[...this.performanceLogs];return(null==options?void 0:options.startDate)&&(logs=logs.filter(l=>l.Timestamp>=options.startDate)),(null==options?void 0:options.endDate)&&(logs=logs.filter(l=>l.Timestamp<=options.endDate)),(null==options?void 0:options.siteUrl)&&(logs=logs.filter(l=>l.SiteUrl===options.siteUrl)),(null==options?void 0:options.projectCode)&&(logs=logs.filter(l=>l.ProjectCode===options.projectCode)),logs.sort((a,b)=>b.Timestamp.localeCompare(a.Timestamp)),(null==options?void 0:options.limit)&&options.limit>0&&(logs=logs.slice(0,options.limit)),JSON.parse(JSON.stringify(logs))}async getPerformanceSummary(options){var _a;const logs=await this.getPerformanceLogs(options);if(0===logs.length)return{avgTotalLoadMs:0,avgWebPartLoadMs:0,avgAppInitMs:0,p95TotalLoadMs:0,totalSessions:0,slowSessionCount:0,byDay:[]};const totalLoads=logs.map(l=>l.TotalLoadMs),sorted=[...totalLoads].sort((a,b)=>a-b),p95Index=Math.floor(.95*sorted.length),avgTotal=Math.round(totalLoads.reduce((a,b)=>a+b,0)/logs.length),avgWebPart=Math.round(logs.reduce((a,l)=>a+l.WebPartLoadMs,0)/logs.length),avgAppInit=Math.round(logs.reduce((a,l)=>a+l.AppInitMs,0)/logs.length),dayMap=new Map;for(const log of logs){const day=log.Timestamp.split("T")[0],existing=dayMap.get(day)||{total:0,count:0};existing.total+=log.TotalLoadMs,existing.count+=1,dayMap.set(day,existing)}const byDay=Array.from(dayMap.entries()).map(([date,{total,count}])=>({date,avgMs:Math.round(total/count),count})).sort((a,b)=>a.date.localeCompare(b.date));return{avgTotalLoadMs:avgTotal,avgWebPartLoadMs:avgWebPart,avgAppInitMs:avgAppInit,p95TotalLoadMs:null!==(_a=sorted[p95Index])&&void 0!==_a?_a:sorted[sorted.length-1],totalSessions:logs.length,slowSessionCount:logs.filter(l=>l.TotalLoadMs>5e3).length,byDay}}async getHelpGuides(moduleKey){await delay();let guides=this.helpGuides.filter(g=>g.isActive);return moduleKey&&(guides=guides.filter(g=>g.moduleKey===moduleKey)),guides.sort((a,b)=>a.sortOrder-b.sortOrder),JSON.parse(JSON.stringify(guides))}async getHelpGuideById(id){await delay();const guide=this.helpGuides.find(g=>g.id===id);return guide?JSON.parse(JSON.stringify(guide)):null}async getSupportConfig(){return await delay(),Object.assign({},this._supportConfig)}async updateHelpGuide(id,data){await delay();const idx=this.helpGuides.findIndex(g=>g.id===id);if(-1===idx)throw new Error(`Help guide not found: ${id}`);return this.helpGuides[idx]=Object.assign(Object.assign(Object.assign({},this.helpGuides[idx]),data),{lastModifiedDate:(new Date).toISOString()}),JSON.parse(JSON.stringify(this.helpGuides[idx]))}async sendSupportEmail(to,subject,htmlBody,fromUserEmail){await delay(),console.log("[MockDataService] Support email sent:",{to,subject,from:fromUserEmail,bodyLength:htmlBody.length})}async updateSupportConfig(config){return await delay(),this._supportConfig=Object.assign(Object.assign({},this._supportConfig),config),Object.assign({},this._supportConfig)}async syncToDataMart(projectCode){await delay();const now=(new Date).toISOString(),activeProject=this.activeProjects.find(p=>p.projectCode===projectCode);if(!activeProject)return{projectCode,success:!1,syncedAt:now,error:`Project ${projectCode} not found in portfolio`};const buyouts=this.buyoutEntries.filter(b=>b.projectCode===projectCode),executedBuyouts=buyouts.filter(b=>"Executed"===b.status),buyoutCommittedTotal=executedBuyouts.reduce((sum,b)=>sum+(b.contractValue||0),0),qScores=buyouts.filter(b=>null!=b.qScore).map(b=>b.qScore),averageQScore=qScores.length>0?qScores.reduce((s,v)=>s+v,0)/qScores.length:0,openWaiverCount=buyouts.filter(b=>b.waiverRequired&&"Committed"!==b.commitmentStatus).length,pendingCommitments=buyouts.filter(b=>"Committed"!==b.commitmentStatus).length,openQuality=this.qualityConcerns.filter(c=>c.projectCode===projectCode).filter(c=>"Open"===c.status||"Monitoring"===c.status).length,openSafety=this.safetyConcerns.filter(c=>c.projectCode===projectCode).filter(c=>"Open"===c.status||"Monitoring"===c.status).length,schedule=this.scheduleRecords.find(s=>s.projectCode===projectCode),activeCriticalPaths=this.criticalPathItems.filter(c=>c.projectCode===projectCode&&"Active"===c.status).length,completionDate=(null==schedule?void 0:schedule.substantialCompletionDate)||activeProject.schedule.substantialCompletionDate,daysVariance=completionDate?Math.round((new Date(completionDate).getTime()-Date.now())/864e5):0,latestReview=this.monthlyReviews.filter(r=>r.projectCode===projectCode).sort((a,b)=>(b.meetingDate||"").localeCompare(a.meetingDate||""))[0],turnover=this.turnoverAgendas.find(t=>t.projectCode===projectCode),pmp=this.pmps.find(p=>p.projectCode===projectCode),originalContract=activeProject.financials.originalContract||0,changeOrders=activeProject.financials.changeOrders||0,currentContractValue=originalContract+changeOrders,billingsToDate=activeProject.financials.billingsToDate||0,unbilledAmount=currentContractValue-billingsToDate,projectedFee=activeProject.financials.projectedFee||0,projectedFeePct=activeProject.financials.projectedFeePct||0,hasUnbilledAlert=(currentContractValue>0?unbilledAmount/currentContractValue*100:0)>=DEFAULT_ALERT_THRESHOLDS_unbilledWarningPct,hasScheduleAlert=daysVariance<-DEFAULT_ALERT_THRESHOLDS_scheduleDelayDays,hasFeeErosionAlert=projectedFeePct<DEFAULT_ALERT_THRESHOLDS_feeErosionPct,complianceStatus=openWaiverCount>3||averageQScore<60?"Red":openWaiverCount>1||averageQScore<75?"Yellow":"Green",dimensions=[complianceStatus];hasUnbilledAlert&&dimensions.push("Red"),hasScheduleAlert&&dimensions.push("Red"),hasFeeErosionAlert&&dimensions.push("Yellow"),openQuality>5||openSafety>3?dimensions.push("Red"):(openQuality>2||openSafety>1)&&dimensions.push("Yellow");const overallHealth=dimensions.includes("Red")?"Red":dimensions.includes("Yellow")?"Yellow":"Green",record={id:this.nextId++,projectCode,jobNumber:activeProject.jobNumber,projectName:activeProject.projectName,status:activeProject.status,sector:activeProject.sector,region:activeProject.region||"",projectExecutive:activeProject.personnel.projectExecutive||"",projectExecutiveEmail:activeProject.personnel.projectExecutiveEmail||"",leadPM:activeProject.personnel.leadPM||"",leadPMEmail:activeProject.personnel.leadPMEmail||"",leadSuperintendent:activeProject.personnel.leadSuper||"",leadSuperintendentEmail:"",originalContract,changeOrders,currentContractValue,billingsToDate,unbilledAmount,projectedFee,projectedFeePct,buyoutCommittedTotal,buyoutExecutedCount:executedBuyouts.length,buyoutOpenCount:buyouts.length-executedBuyouts.length,startDate:(null==schedule?void 0:schedule.startDate)||activeProject.schedule.startDate||null,substantialCompletionDate:completionDate||null,percentComplete:activeProject.schedule.percentComplete||0,criticalPathItemCount:activeCriticalPaths,scheduleDaysVariance:daysVariance,openQualityConcerns:openQuality,openSafetyConcerns:openSafety,averageQScore:Math.round(10*averageQScore)/10,openWaiverCount,pendingCommitments,complianceStatus,overallHealth,hasUnbilledAlert,hasScheduleAlert,hasFeeErosionAlert,monthlyReviewStatus:(null==latestReview?void 0:latestReview.status)||"",lastMonthlyReviewDate:(null==latestReview?void 0:latestReview.meetingDate)||null,turnoverStatus:(null==turnover?void 0:turnover.status)||"",pmpStatus:(null==pmp?void 0:pmp.status)||"",lastSyncDate:now,lastSyncBy:"MockDataService"},existingIdx=this.dataMartRecords.findIndex(r=>r.projectCode===projectCode);return existingIdx>=0?(record.id=this.dataMartRecords[existingIdx].id,this.dataMartRecords[existingIdx]=record):this.dataMartRecords.push(record),{projectCode,success:!0,syncedAt:now}}async getDataMartRecords(filters){await delay();let results=[...this.dataMartRecords];return(null==filters?void 0:filters.status)&&(results=results.filter(r=>r.status===filters.status)),(null==filters?void 0:filters.sector)&&(results=results.filter(r=>r.sector===filters.sector)),(null==filters?void 0:filters.region)&&(results=results.filter(r=>r.region===filters.region)),(null==filters?void 0:filters.projectExecutive)&&(results=results.filter(r=>r.projectExecutive===filters.projectExecutive)),(null==filters?void 0:filters.overallHealth)&&(results=results.filter(r=>r.overallHealth===filters.overallHealth)),(null==filters?void 0:filters.hasAlerts)&&(results=results.filter(r=>r.hasUnbilledAlert||r.hasScheduleAlert||r.hasFeeErosionAlert)),results}async getDataMartRecord(projectCode){var _a;return await delay(),null!==(_a=this.dataMartRecords.find(r=>r.projectCode===projectCode))&&void 0!==_a?_a:null}async triggerDataMartSync(){await delay();const results=[];for(const project of this.activeProjects){const result=await this.syncToDataMart(project.projectCode);results.push(result)}return results}async getScheduleActivities(projectCode){return await delay(),this.scheduleActivities.filter(a=>a.projectCode===projectCode).map(a=>Object.assign({},a))}async importScheduleActivities(projectCode,activities,importMeta){await delay();const now=(new Date).toISOString(),importId=Math.max(0,...this.scheduleImports.map(i=>i.id))+1,importRecord={id:importId,projectCode,fileName:importMeta.fileName||"import.csv",format:importMeta.format||"P6-CSV",importDate:now,importedBy:importMeta.importedBy||"Unknown",activityCount:activities.length,notes:importMeta.notes||""};this.scheduleImports.push(importRecord),this.scheduleActivities=this.scheduleActivities.filter(a=>a.projectCode!==projectCode);let nextId=Math.max(0,...this.scheduleActivities.map(a=>a.id))+1;const imported=activities.map(a=>Object.assign(Object.assign({},a),{id:nextId++,projectCode,importId,createdDate:now,modifiedDate:now}));return this.scheduleActivities.push(...imported),this.logAudit({Action:enums.AuditAction.ScheduleActivitiesImported,EntityType:enums.EntityType.ScheduleActivity,EntityId:String(importId),Details:`Imported ${activities.length} activities for ${projectCode}`}),imported}async updateScheduleActivity(projectCode,activityId,data){await delay();const idx=this.scheduleActivities.findIndex(a=>a.id===activityId&&a.projectCode===projectCode);if(-1===idx)throw new Error(`Schedule activity ${activityId} not found`);const updated=Object.assign(Object.assign(Object.assign({},this.scheduleActivities[idx]),data),{modifiedDate:(new Date).toISOString()});return this.scheduleActivities[idx]=updated,this.logAudit({Action:enums.AuditAction.ScheduleActivityUpdated,EntityType:enums.EntityType.ScheduleActivity,EntityId:String(activityId),Details:`Updated activity ${updated.taskCode}`}),Object.assign({},updated)}async deleteScheduleActivity(projectCode,activityId){await delay();const idx=this.scheduleActivities.findIndex(a=>a.id===activityId&&a.projectCode===projectCode);if(-1===idx)throw new Error(`Schedule activity ${activityId} not found`);const activity=this.scheduleActivities[idx];this.scheduleActivities.splice(idx,1),this.logAudit({Action:enums.AuditAction.ScheduleActivityDeleted,EntityType:enums.EntityType.ScheduleActivity,EntityId:String(activityId),Details:`Deleted activity ${activity.taskCode}`})}async getScheduleImports(projectCode){return await delay(),this.scheduleImports.filter(i=>i.projectCode===projectCode).map(i=>Object.assign({},i))}async getScheduleMetrics(projectCode){await delay();return computeScheduleMetrics(this.scheduleActivities.filter(a=>a.projectCode===projectCode))}async getAllConstraints(){return await delay(),this.constraintLogs.map(c=>Object.assign({},c))}async getConstraints(projectCode){return await delay(),this.constraintLogs.filter(c=>c.projectCode===projectCode).map(c=>Object.assign({},c))}async addConstraint(projectCode,constraint){await delay();const projectConstraints=this.constraintLogs.filter(c=>c.projectCode===projectCode),nextNumber=projectConstraints.length>0?Math.max(...projectConstraints.map(c=>c.constraintNumber))+1:1,id=Math.max(0,...this.constraintLogs.map(c=>c.id))+1,created={id,projectCode,constraintNumber:nextNumber,category:constraint.category||"Other",description:constraint.description||"",status:constraint.status||"Open",assignedTo:constraint.assignedTo||"",dateIdentified:constraint.dateIdentified||(new Date).toISOString().split("T")[0],dueDate:constraint.dueDate||"",dateClosed:constraint.dateClosed,reference:constraint.reference,closureDocument:constraint.closureDocument,budgetImpactCost:constraint.budgetImpactCost,comments:constraint.comments};return this.constraintLogs.push(created),this.logAudit({Action:enums.AuditAction.ConstraintUpdated,EntityType:enums.EntityType.Constraint,EntityId:String(id),Details:`Added constraint #${nextNumber} for ${projectCode}`}),Object.assign({},created)}async updateConstraint(projectCode,constraintId,data){await delay();const idx=this.constraintLogs.findIndex(c=>c.id===constraintId&&c.projectCode===projectCode);if(-1===idx)throw new Error(`Constraint ${constraintId} not found`);const updated=Object.assign(Object.assign({},this.constraintLogs[idx]),data);return this.constraintLogs[idx]=updated,this.logAudit({Action:enums.AuditAction.ConstraintUpdated,EntityType:enums.EntityType.Constraint,EntityId:String(constraintId),Details:`Updated constraint #${updated.constraintNumber}`}),Object.assign({},updated)}async removeConstraint(projectCode,constraintId){await delay();const idx=this.constraintLogs.findIndex(c=>c.id===constraintId&&c.projectCode===projectCode);if(-1===idx)throw new Error(`Constraint ${constraintId} not found`);const removed=this.constraintLogs[idx];this.constraintLogs.splice(idx,1),this.logAudit({Action:enums.AuditAction.ConstraintUpdated,EntityType:enums.EntityType.Constraint,EntityId:String(constraintId),Details:`Removed constraint #${removed.constraintNumber}`})}async getPermits(projectCode){return await delay(),this.permits.filter(p=>p.projectCode===projectCode).map(p=>Object.assign({},p))}async addPermit(projectCode,permit){await delay();const id=Math.max(0,...this.permits.map(p=>p.id))+1,created={id,projectCode,refNumber:permit.refNumber||String(id),parentRefNumber:permit.parentRefNumber,location:permit.location||"",type:permit.type||"PRIMARY",permitNumber:permit.permitNumber||"Not Issued",description:permit.description||"",responsibleContractor:permit.responsibleContractor||"",address:permit.address||"",dateRequired:permit.dateRequired,dateSubmitted:permit.dateSubmitted,dateReceived:permit.dateReceived,dateExpires:permit.dateExpires,status:permit.status||"Pending Application",ahj:permit.ahj||"",comments:permit.comments};return this.permits.push(created),this.logAudit({Action:enums.AuditAction.PermitUpdated,EntityType:enums.EntityType.Permit,EntityId:String(id),Details:`Added permit ${created.refNumber} for ${projectCode}`}),Object.assign({},created)}async updatePermit(projectCode,permitId,data){await delay();const idx=this.permits.findIndex(p=>p.id===permitId&&p.projectCode===projectCode);if(-1===idx)throw new Error(`Permit ${permitId} not found`);const updated=Object.assign(Object.assign({},this.permits[idx]),data);return this.permits[idx]=updated,this.logAudit({Action:enums.AuditAction.PermitUpdated,EntityType:enums.EntityType.Permit,EntityId:String(permitId),Details:`Updated permit ${updated.refNumber}`}),Object.assign({},updated)}async removePermit(projectCode,permitId){await delay();const idx=this.permits.findIndex(p=>p.id===permitId&&p.projectCode===projectCode);if(-1===idx)throw new Error(`Permit ${permitId} not found`);const removed=this.permits[idx];this.permits.splice(idx,1),this.logAudit({Action:enums.AuditAction.PermitUpdated,EntityType:enums.EntityType.Permit,EntityId:String(permitId),Details:`Removed permit ${removed.refNumber}`})}}MockDataService.TRACKING_STEP_ORDER=["APM_PA","ProjectManager","RiskManager","ProjectExecutive"],MockDataService.TRACKING_STEP_STATUS={APM_PA:"PendingAPM",ProjectManager:"PendingPM",RiskManager:"PendingRiskMgr",ProjectExecutive:"PendingPX"},MockDataService.TRACKING_STEP_APPROVERS={APM_PA:{name:"Sarah Johnson",email:"sjohnson@hedrickbrothers.com"},ProjectManager:{name:"Robert Davis",email:"rdavis@hedrickbrothers.com"},RiskManager:{name:"Jennifer Adams",email:"jadams@hedrickbrothers.com"},ProjectExecutive:{name:"Kim Foster",email:"kfoster@hedrickbrothers.com"}},MockDataService.TRACKING_STEP_TO_ORDER={APM_PA:1,ProjectManager:2,RiskManager:3,ProjectExecutive:4};class DataServiceError extends Error{constructor(method,message,options){const innerMsg=(null==options?void 0:options.innerError)instanceof Error?options.innerError.message:(null==options?void 0:options.innerError)?String(options.innerError):void 0;super(innerMsg?`${method}: ${message} â€” ${innerMsg}`:`${method}: ${message}`),this.name="DataServiceError",this.method=method,this.entityType=null==options?void 0:options.entityType,this.entityId=null==options?void 0:options.entityId,this.innerError=null==options?void 0:options.innerError}}const performanceService=new class PerformanceService{constructor(){this.marks=new Map,this.completedMarks=[],this.logFn=null,this.initStartTime="undefined"!=typeof performance?performance.now():Date.now(),this.sessionId=this.generateSessionId()}generateSessionId(){return"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,c=>{const r=16*Math.random()|0;return("x"===c?r:3&r|8).toString(16)})}now(){return"undefined"!=typeof performance?performance.now():Date.now()}initialize(logFunction){this.logFn=logFunction}startMark(name){this.marks.set(name,this.now())}endMark(name){const startTime=this.marks.get(name);if(void 0===startTime)return;const endTime=this.now();this.completedMarks.push({name,startTime,endTime,duration:Math.round(endTime-startTime)}),this.marks.delete(name)}getMark(name){return this.completedMarks.find(m=>m.name===name)}getAllMarks(){return[...this.completedMarks]}getSessionId(){return this.sessionId}async logWebPartLoad(context){var _a,_b;if(!this.logFn)return console.warn("[PerformanceService] logFn not initialized â€” skipping log"),null;if(Math.random()>PERFORMANCE_THRESHOLDS_SAMPLE_RATE)return null;const webPartInit=this.getMark("webpart:onInit"),appInit=this.getMark("app:contextInit"),userFlagsFetch=this.getMark("app:userFlagsFetch"),totalEnd=this.now(),entry={SessionId:this.sessionId,Timestamp:(new Date).toISOString(),UserEmail:context.userEmail,SiteUrl:context.siteUrl,ProjectCode:context.projectCode,IsProjectSite:context.isProjectSite,WebPartLoadMs:null!==(_a=null==webPartInit?void 0:webPartInit.duration)&&void 0!==_a?_a:0,AppInitMs:null!==(_b=null==appInit?void 0:appInit.duration)&&void 0!==_b?_b:0,DataFetchMs:null==userFlagsFetch?void 0:userFlagsFetch.duration,TotalLoadMs:Math.round(totalEnd-this.initStartTime),Marks:this.completedMarks,UserAgent:"undefined"!=typeof navigator?navigator.userAgent:"unknown",SpfxVersion:"1.0.0"};try{return await this.logFn(entry)}catch(err){return console.warn("[PerformanceService] Failed to log performance entry:",err),null}}reset(){this.marks.clear(),this.completedMarks=[],this.sessionId=this.generateSessionId(),this.initStartTime=this.now()}},PROVISIONING_LOG_COLUMNS=(Object.assign({},{id:"ID",Timestamp:"Timestamp",User:"User",UserId:"UserId",Action:"Action",EntityType:"EntityType",EntityId:"EntityId",ProjectCode:"ProjectCode",FieldChanged:"FieldChanged",PreviousValue:"PreviousValue",NewValue:"NewValue",Details:"Details"}),{id:"ID",projectCode:"projectCode",projectName:"projectName",leadId:"leadId",status:"status",currentStep:"currentStep",completedSteps:"completedSteps",failedStep:"failedStep",errorMessage:"errorMessage",retryCount:"retryCount",siteUrl:"siteUrl",requestedBy:"requestedBy",requestedAt:"requestedAt",completedAt:"completedAt",hubNavLinkStatus:"hubNavLinkStatus",division:"division",region:"region",clientName:"clientName"}),GONOGO_SCORECARD_COLUMNS={id:"ID",LeadID:"LeadID",ProjectCode:"ProjectCode",scores:"scores",TotalScore_Orig:"TotalScore_Orig",TotalScore_Cmte:"TotalScore_Cmte",OriginatorComments:"OriginatorComments",CommitteeComments:"CommitteeComments",ProposalMarketingComments:"ProposalMarketingComments",ProposalMarketingResources:"ProposalMarketingResources",ProposalMarketingHours:"ProposalMarketingHours",EstimatingComments:"EstimatingComments",EstimatingResources:"EstimatingResources",EstimatingHours:"EstimatingHours",DecisionMakingProcess:"DecisionMakingProcess",HBDifferentiators:"HBDifferentiators",WinStrategy:"WinStrategy",StrategicPursuit:"StrategicPursuit",DecisionMakerAdvocate:"DecisionMakerAdvocate",Decision:"Decision",DecisionDate:"DecisionDate",ScoredBy_Orig:"ScoredBy_Orig",ScoredBy_Cmte:"ScoredBy_Cmte",scorecardStatus:"scorecardStatus",currentApprovalStep:"currentApprovalStep",committeeScoresEnteredBy:"committeeScoresEnteredBy",committeeScoresEnteredDate:"committeeScoresEnteredDate",committeeMeetingDate:"committeeMeetingDate",recommendedDecision:"recommendedDecision",finalDecision:"finalDecision",finalDecisionBy:"finalDecisionBy",finalDecisionDate:"finalDecisionDate",conditionalGoConditions:"conditionalGoConditions",currentVersion:"currentVersion",isLocked:"isLocked",unlockedBy:"unlockedBy",unlockedDate:"unlockedDate",unlockReason:"unlockReason"},SCORECARD_APPROVAL_CYCLES_COLUMNS={id:"ID",scorecardId:"scorecardId",cycleNumber:"cycleNumber",version:"version",startedDate:"startedDate",completedDate:"completedDate",status:"status"},SCORECARD_APPROVAL_STEPS_COLUMNS={id:"ID",cycleId:"cycleId",stepOrder:"stepOrder",name:"name",assigneeEmail:"assigneeEmail",assigneeName:"assigneeName",assignmentSource:"assignmentSource",status:"status",actionDate:"actionDate",comment:"comment"},SCORECARD_VERSIONS_COLUMNS={id:"ID",scorecardId:"scorecardId",versionNumber:"versionNumber",createdDate:"createdDate",createdBy:"createdBy",reason:"reason",originalScores:"originalScores",committeeScores:"committeeScores",totalOriginal:"totalOriginal",totalCommittee:"totalCommittee",decision:"decision",conditions:"conditions"},TEMPLATE_REGISTRY_COLUMNS={id:"ID",TemplateName:"TemplateName",SourceURL:"SourceURL",TargetFolder:"TargetFolder",Division:"Division",Active:"Active"},JOB_NUMBER_REQUESTS_COLUMNS={id:"ID",LeadID:"LeadID",RequestDate:"RequestDate",Originator:"Originator",RequiredByDate:"RequiredByDate",ProjectAddress:"ProjectAddress",ProjectExecutive:"ProjectExecutive",ProjectManager:"ProjectManager",ProjectType:"ProjectType",ProjectTypeLabel:"ProjectTypeLabel",IsEstimatingOnly:"IsEstimatingOnly",RequestedCostCodes:"RequestedCostCodes",RequestStatus:"RequestStatus",AssignedJobNumber:"AssignedJobNumber",AssignedBy:"AssignedBy",AssignedDate:"AssignedDate",SiteProvisioningHeld:"SiteProvisioningHeld",TempProjectCode:"TempProjectCode",Notes:"Notes"},ESTIMATING_KICKOFFS_COLUMNS={id:"ID",LeadID:"LeadID",ProjectCode:"ProjectCode",Architect:"Architect",ProposalDueDateTime:"ProposalDueDateTime",ProposalType:"ProposalType",RFIFormat:"RFIFormat",PrimaryOwnerContact:"PrimaryOwnerContact",ProposalDeliveryMethod:"ProposalDeliveryMethod",CopiesIfHandDelivered:"CopiesIfHandDelivered",HBProposalDue:"HBProposalDue",SubcontractorProposalsDue:"SubcontractorProposalsDue",PreSubmissionReview:"PreSubmissionReview",SubcontractorSiteWalkThru:"SubcontractorSiteWalkThru",OwnerEstimateReview:"OwnerEstimateReview",KeyPersonnel:"KeyPersonnel",KickoffMeetingId:"KickoffMeetingId",KickoffMeetingDate:"KickoffMeetingDate",CreatedBy:"CreatedBy",CreatedDate:"CreatedDate",ModifiedBy:"ModifiedBy",ModifiedDate:"ModifiedDate"},ESTIMATING_KICKOFF_ITEMS_COLUMNS={id:"ID",kickoffId:"kickoffId",projectCode:"projectCode",section:"section",task:"task",status:"status",responsibleParty:"responsibleParty",Assignees:"Assignees",deadline:"deadline",frequency:"frequency",notes:"notes",tabRequired:"tabRequired",isCustom:"isCustom",sortOrder:"sortOrder"},MARKETING_PROJECT_RECORDS_COLUMNS={projectName:"projectName",projectCode:"projectCode",leadId:"leadId",contractType:"contractType",deliveryMethod:"deliveryMethod",architect:"architect",landscapeArchitect:"landscapeArchitect",interiorDesigner:"interiorDesigner",engineer:"engineer",buildingSystemType:"buildingSystemType",projectDescription:"projectDescription",uniqueCharacteristics:"uniqueCharacteristics",renderingUrls:"renderingUrls",finalPhotoUrls:"finalPhotoUrls",contractBudget:"contractBudget",contractFinalCost:"contractFinalCost",totalCostPerGSF:"totalCostPerGSF",totalBudgetVariance:"totalBudgetVariance",budgetExplanation:"budgetExplanation",CO_OwnerDirected_Count:"CO_OwnerDirected_Count",CO_OwnerDirected_Value:"CO_OwnerDirected_Value",CO_MunicipalityDirected_Count:"CO_MunicipalityDirected_Count",CO_MunicipalityDirected_Value:"CO_MunicipalityDirected_Value",CO_EO_Count:"CO_EO_Count",CO_EO_Value:"CO_EO_Value",CO_ContractorDirected_Count:"CO_ContractorDirected_Count",savingsReturned:"savingsReturned",savingsReturnedPct:"savingsReturnedPct",scheduleStartAnticipated:"scheduleStartAnticipated",scheduleStartActual:"scheduleStartActual",scheduleEndAnticipated:"scheduleEndAnticipated",scheduleEndActual:"scheduleEndActual",onSchedule:"onSchedule",scheduleExplanation:"scheduleExplanation",substantialCompletionDate:"substantialCompletionDate",finalCompletionDate:"finalCompletionDate",punchListItems:"punchListItems",punchListDaysToComplete:"punchListDaysToComplete",innovativeSafetyPrograms:"innovativeSafetyPrograms",mwbeRequirement:"mwbeRequirement",mwbeAchievement:"mwbeAchievement",sbeRequirement:"sbeRequirement",sbeAchievement:"sbeAchievement",localRequirement:"localRequirement",localAchievement:"localAchievement",leedDesignation:"leedDesignation",sustainabilityFeatures:"sustainabilityFeatures",leedAdditionalCost:"leedAdditionalCost",CS_Conflicts:"CS_Conflicts",CS_CostControl:"CS_CostControl",CS_ValueEngineering:"CS_ValueEngineering",CS_QualityControl:"CS_QualityControl",CS_Schedule:"CS_Schedule",CS_Team:"CS_Team",CS_Safety:"CS_Safety",CS_LEED:"CS_LEED",CS_SupplierDiversity:"CS_SupplierDiversity",CS_Challenges:"CS_Challenges",CS_InnovativeSolutions:"CS_InnovativeSolutions",CS_ProductsSystems:"CS_ProductsSystems",CS_ClientService:"CS_ClientService",CS_LessonsLearned:"CS_LessonsLearned",sectionCompletion:"sectionCompletion",overallCompletion:"overallCompletion",lastUpdatedBy:"lastUpdatedBy",lastUpdatedAt:"lastUpdatedAt",createdBy:"createdBy",createdAt:"createdAt"},PROJECT_TYPES_COLUMNS={code:"code",label:"label",office:"office"},STANDARD_COST_CODES_COLUMNS={id:"id",description:"description",phase:"phase",division:"division",isDefault:"isDefault"},STARTUP_CHECKLIST_COLUMNS={id:"ID",projectCode:"projectCode",sectionNumber:"sectionNumber",sectionName:"sectionName",itemNumber:"itemNumber",label:"label",responseType:"responseType",response:"response",status:"status",respondedBy:"respondedBy",respondedDate:"respondedDate",assignedTo:"assignedTo",assignedToName:"assignedToName",comment:"comment",isHidden:"isHidden",isCustom:"isCustom",sortOrder:"sortOrder",hbShare:"hbShare",amount:"amount",period:"period",dateValue:"dateValue",calculatedFrom:"calculatedFrom",placeholder:"placeholder",details:"details"},CHECKLIST_ACTIVITY_LOG_COLUMNS={id:"ID",checklistItemId:"checklistItemId",projectCode:"projectCode",timestamp:"timestamp",user:"user",previousValue:"previousValue",newValue:"newValue",comment:"comment"},INTERNAL_MATRIX_COLUMNS={id:"ID",projectCode:"projectCode",sortOrder:"sortOrder",taskCategory:"taskCategory",taskDescription:"taskDescription",PX:"PX",SrPM:"SrPM",PM2:"PM2",PM1:"PM1",PA:"PA",QAQC:"QAQC",ProjAcct:"ProjAcct",isHidden:"isHidden",isCustom:"isCustom"},OWNER_CONTRACT_MATRIX_COLUMNS={id:"ID",projectCode:"projectCode",sortOrder:"sortOrder",articleNumber:"articleNumber",pageNumber:"pageNumber",responsibleParty:"responsibleParty",description:"description",isHidden:"isHidden",isCustom:"isCustom"},SUB_CONTRACT_MATRIX_COLUMNS={id:"ID",projectCode:"projectCode",sortOrder:"sortOrder",refNumber:"refNumber",pageNumber:"pageNumber",clauseDescription:"clauseDescription",ProjExec:"ProjExec",ProjMgr:"ProjMgr",AsstPM:"AsstPM",Super:"Super",ProjAdmin:"ProjAdmin",isHidden:"isHidden",isCustom:"isCustom"},TEAM_ROLE_ASSIGNMENTS_COLUMNS={projectCode:"ProjectCode",roleAbbreviation:"RoleAbbreviation",assignedPerson:"AssignedPerson",assignedPersonEmail:"AssignedPersonEmail"},RISK_COST_MANAGEMENT_COLUMNS={id:"ID",projectCode:"projectCode",contractType:"contractType",contractAmount:"contractAmount",createdBy:"createdBy",createdAt:"createdAt",lastUpdatedBy:"lastUpdatedBy",lastUpdatedAt:"lastUpdatedAt"},RISK_COST_ITEMS_COLUMNS={id:"ID",projectCode:"projectCode",riskCostId:"riskCostId",category:"category",letter:"letter",description:"description",estimatedValue:"estimatedValue",status:"status",notes:"notes",createdDate:"createdDate",updatedDate:"updatedDate"},QUALITY_CONCERNS_COLUMNS={id:"ID",projectCode:"projectCode",letter:"letter",description:"description",raisedBy:"raisedBy",raisedDate:"raisedDate",status:"status",resolution:"resolution",resolvedDate:"resolvedDate",notes:"notes"},SAFETY_CONCERNS_COLUMNS={id:"ID",projectCode:"projectCode",safetyOfficerName:"safetyOfficerName",safetyOfficerEmail:"safetyOfficerEmail",letter:"letter",description:"description",severity:"severity",raisedBy:"raisedBy",raisedDate:"raisedDate",status:"status",resolution:"resolution",resolvedDate:"resolvedDate",notes:"notes"},PROJECT_SCHEDULE_COLUMNS={id:"ID",projectCode:"projectCode",startDate:"startDate",substantialCompletionDate:"substantialCompletionDate",ntpDate:"ntpDate",nocDate:"nocDate",contractCalendarDays:"contractCalendarDays",contractBasisType:"contractBasisType",teamGoalDaysAhead:"teamGoalDaysAhead",teamGoalDescription:"teamGoalDescription",hasLiquidatedDamages:"hasLiquidatedDamages",liquidatedDamagesAmount:"liquidatedDamagesAmount",liquidatedDamagesTerms:"liquidatedDamagesTerms",createdBy:"createdBy",createdAt:"createdAt",lastUpdatedBy:"lastUpdatedBy",lastUpdatedAt:"lastUpdatedAt"},CRITICAL_PATH_ITEMS_COLUMNS={id:"ID",projectCode:"projectCode",scheduleId:"scheduleId",letter:"letter",description:"description",impactDescription:"impactDescription",status:"status",mitigationPlan:"mitigationPlan",createdDate:"createdDate",updatedDate:"updatedDate"},SUPERINTENDENT_PLAN_COLUMNS={id:"ID",projectCode:"projectCode",superintendentName:"superintendentName",createdBy:"createdBy",createdAt:"createdAt",lastUpdatedBy:"lastUpdatedBy",lastUpdatedAt:"lastUpdatedAt"},SUPERINTENDENT_PLAN_SECTIONS_COLUMNS={id:"ID",superintendentPlanId:"superintendentPlanId",projectCode:"projectCode",sectionKey:"sectionKey",sectionTitle:"sectionTitle",content:"content",attachmentUrls:"attachmentUrls",isComplete:"isComplete"},LESSONS_LEARNED_COLUMNS={id:"ID",projectCode:"projectCode",title:"title",category:"category",impact:"impact",description:"description",recommendation:"recommendation",raisedBy:"raisedBy",raisedDate:"raisedDate",phase:"phase",isIncludedInFinalRecord:"isIncludedInFinalRecord",tags:"tags"},PMP_COLUMNS={id:"ID",projectCode:"projectCode",projectName:"projectName",jobNumber:"jobNumber",status:"status",currentCycleNumber:"currentCycleNumber",division:"division",superintendentPlan:"superintendentPlan",preconMeetingNotes:"preconMeetingNotes",siteManagementNotes:"siteManagementNotes",projectAdminBuyoutDate:"projectAdminBuyoutDate",attachmentUrls:"attachmentUrls",riskCostData:"riskCostData",qualityConcerns:"qualityConcerns",safetyConcerns:"safetyConcerns",scheduleData:"scheduleData",superintendentPlanData:"superintendentPlanData",lessonsLearned:"lessonsLearned",teamAssignments:"teamAssignments",boilerplate:"boilerplate",createdBy:"createdBy",createdAt:"createdAt",lastUpdatedBy:"lastUpdatedBy",lastUpdatedAt:"lastUpdatedAt"},PMP_SIGNATURES_COLUMNS={id:"ID",pmpId:"pmpId",projectCode:"projectCode",signatureType:"signatureType",role:"role",personName:"personName",personEmail:"personEmail",isRequired:"isRequired",isLead:"isLead",status:"status",signedDate:"signedDate",affidavitText:"affidavitText",comment:"comment"},PMP_APPROVAL_CYCLES_COLUMNS={id:"ID",pmpId:"pmpId",projectCode:"projectCode",cycleNumber:"cycleNumber",submittedBy:"submittedBy",submittedDate:"submittedDate",status:"status",changesFromPrevious:"changesFromPrevious"},PMP_APPROVAL_STEPS_COLUMNS={id:"ID",approvalCycleId:"approvalCycleId",projectCode:"projectCode",stepOrder:"stepOrder",approverRole:"approverRole",approverName:"approverName",approverEmail:"approverEmail",status:"status",comment:"comment",actionDate:"actionDate",approvalCycleNumber:"approvalCycleNumber"},MONTHLY_REVIEWS_COLUMNS={id:"ID",projectCode:"projectCode",reviewMonth:"reviewMonth",status:"status",dueDate:"dueDate",meetingDate:"meetingDate",pmSubmittedDate:"pmSubmittedDate",pxReviewDate:"pxReviewDate",pxValidationDate:"pxValidationDate",leadershipSubmitDate:"leadershipSubmitDate",completedDate:"completedDate",reportDocumentUrls:"reportDocumentUrls",createdBy:"createdBy",createdAt:"createdAt",lastUpdatedBy:"lastUpdatedBy",lastUpdatedAt:"lastUpdatedAt"},MONTHLY_CHECKLIST_ITEMS_COLUMNS={id:"ID",reviewId:"reviewId",sectionKey:"sectionKey",sectionTitle:"sectionTitle",itemKey:"itemKey",itemDescription:"itemDescription",pmComment:"pmComment",pxComment:"pxComment",pxInitial:"pxInitial"},MONTHLY_FOLLOW_UPS_COLUMNS={id:"ID",reviewId:"reviewId",question:"question",requestedBy:"requestedBy",requestedDate:"requestedDate",pmResponse:"pmResponse",responseDate:"responseDate",pxForwardedDate:"pxForwardedDate",status:"status"},CLOSEOUT_ITEMS_COLUMNS={id:"ID",projectCode:"projectCode",category:"category",description:"description",status:"status",assignedTo:"assignedTo",assignedToId:"assignedToId",completedDate:"completedDate",notes:"notes",sectionNumber:"sectionNumber",sectionName:"sectionName",itemNumber:"itemNumber",label:"label",responseType:"responseType",response:"response",respondedBy:"respondedBy",respondedDate:"respondedDate",comment:"comment",isHidden:"isHidden",isCustom:"isCustom",sortOrder:"sortOrder",dateValue:"dateValue",calculatedFrom:"calculatedFrom",placeholder:"placeholder",details:"details"},WORKFLOW_DEFINITIONS_COLUMNS_id=(Object.assign({},MARKETING_PROJECT_RECORDS_COLUMNS),"ID"),WORKFLOW_DEFINITIONS_COLUMNS_workflowKey="WorkflowKey",WORKFLOW_DEFINITIONS_COLUMNS_name="Title",WORKFLOW_DEFINITIONS_COLUMNS_description="Description",WORKFLOW_DEFINITIONS_COLUMNS_isActive="IsActive",WORKFLOW_DEFINITIONS_COLUMNS_lastModifiedBy="LastModifiedBy",WORKFLOW_DEFINITIONS_COLUMNS_lastModifiedDate="LastModifiedDate",WORKFLOW_STEPS_COLUMNS_id="ID",WORKFLOW_STEPS_COLUMNS_workflowId="WorkflowId",WORKFLOW_STEPS_COLUMNS_stepOrder="StepOrder",WORKFLOW_STEPS_COLUMNS_name="Title",WORKFLOW_STEPS_COLUMNS_description="Description",WORKFLOW_STEPS_COLUMNS_assignmentType="AssignmentType",WORKFLOW_STEPS_COLUMNS_projectRole="ProjectRole",WORKFLOW_STEPS_COLUMNS_defaultAssignee="DefaultAssignee",WORKFLOW_STEPS_COLUMNS_isConditional="IsConditional",WORKFLOW_STEPS_COLUMNS_conditionDescription="ConditionDescription",WORKFLOW_STEPS_COLUMNS_actionLabel="ActionLabel",WORKFLOW_STEPS_COLUMNS_canChairMeeting="CanChairMeeting",WORKFLOW_STEPS_COLUMNS_featureFlagName="FeatureFlagName",WORKFLOW_STEPS_COLUMNS_isSkippable="IsSkippable",WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_id="ID",WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_stepId="StepId",WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_conditions="Conditions",WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_assignee="Assignee",WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_priority="Priority",WORKFLOW_STEP_OVERRIDES_COLUMNS_id="ID",WORKFLOW_STEP_OVERRIDES_COLUMNS_projectCode="ProjectCode",WORKFLOW_STEP_OVERRIDES_COLUMNS_workflowKey="WorkflowKey",WORKFLOW_STEP_OVERRIDES_COLUMNS_stepId="StepId",WORKFLOW_STEP_OVERRIDES_COLUMNS_overrideAssignee="OverrideAssignee",WORKFLOW_STEP_OVERRIDES_COLUMNS_overrideReason="OverrideReason",WORKFLOW_STEP_OVERRIDES_COLUMNS_overriddenBy="OverriddenBy",WORKFLOW_STEP_OVERRIDES_COLUMNS_overriddenDate="OverriddenDate",TURNOVER_AGENDAS_COLUMNS={id:"ID",projectCode:"ProjectCode",leadId:"LeadId",status:"Status",projectName:"Title",meetingDate:"MeetingDate",recordingUrl:"RecordingUrl",turnoverFolderUrl:"TurnoverFolderUrl",bcPublished:"BCPublished",pmName:"PMName",apmName:"APMName",createdBy:"CreatedBy",createdDate:"CreatedDate",lastModifiedBy:"LastModifiedBy",lastModifiedDate:"LastModifiedDate",headerOverrides:"HeaderOverrides"},TURNOVER_PREREQUISITES_COLUMNS={id:"ID",turnoverAgendaId:"TurnoverAgendaId",sortOrder:"SortOrder",label:"Title",description:"Description",completed:"Completed",completedBy:"CompletedBy",completedDate:"CompletedDate"},TURNOVER_DISCUSSION_ITEMS_COLUMNS={id:"ID",turnoverAgendaId:"TurnoverAgendaId",sortOrder:"SortOrder",label:"Title",description:"Description",discussed:"Discussed",notes:"Notes"},TURNOVER_SUBCONTRACTORS_COLUMNS={id:"ID",turnoverAgendaId:"TurnoverAgendaId",trade:"Trade",subcontractorName:"Title",contactName:"ContactName",contactPhone:"ContactPhone",contactEmail:"ContactEmail",qScore:"QScore",isPreferred:"IsPreferred",isRequired:"IsRequired",notes:"Notes"},TURNOVER_EXHIBITS_COLUMNS={id:"ID",turnoverAgendaId:"TurnoverAgendaId",sortOrder:"SortOrder",label:"Title",isDefault:"IsDefault",reviewed:"Reviewed",reviewedBy:"ReviewedBy",reviewedDate:"ReviewedDate",linkedDocumentUrl:"LinkedDocumentUrl",uploadedFileName:"UploadedFileName",uploadedFileUrl:"UploadedFileUrl"},TURNOVER_SIGNATURES_COLUMNS={id:"ID",turnoverAgendaId:"TurnoverAgendaId",sortOrder:"SortOrder",role:"Role",signerName:"SignerName",signerEmail:"SignerEmail",affidavitText:"AffidavitText",signed:"Signed",signedDate:"SignedDate",comment:"Comment"},TURNOVER_ATTACHMENTS_COLUMNS={id:"ID",discussionItemId:"DiscussionItemId",fileName:"Title",fileUrl:"FileUrl",uploadedBy:"UploadedBy",uploadedDate:"UploadedDate"},TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS={id:"ID",turnoverAgendaId:"TurnoverAgendaId",contractAmount:"ContractAmount",originalEstimate:"OriginalEstimate",buyoutTarget:"BuyoutTarget",estimatedFee:"EstimatedFee",estimatedGrossMargin:"EstimatedGrossMargin",contingency:"Contingency",notes:"Notes",overrides:"Overrides"},PERMISSION_TEMPLATES_COLUMNS_id="ID",PERMISSION_TEMPLATES_COLUMNS_name="Title",PERMISSION_TEMPLATES_COLUMNS_description="Description",PERMISSION_TEMPLATES_COLUMNS_isGlobal="IsGlobal",PERMISSION_TEMPLATES_COLUMNS_globalAccess="GlobalAccess",PERMISSION_TEMPLATES_COLUMNS_identityType="IdentityType",PERMISSION_TEMPLATES_COLUMNS_toolAccess="ToolAccess",PERMISSION_TEMPLATES_COLUMNS_isDefault="IsDefault",PERMISSION_TEMPLATES_COLUMNS_isActive="IsActive",PERMISSION_TEMPLATES_COLUMNS_createdBy="CreatedBy",PERMISSION_TEMPLATES_COLUMNS_createdDate="CreatedDate",PERMISSION_TEMPLATES_COLUMNS_lastModifiedBy="LastModifiedBy",PERMISSION_TEMPLATES_COLUMNS_lastModifiedDate="LastModifiedDate",SECURITY_GROUP_MAPPINGS_COLUMNS_id="ID",SECURITY_GROUP_MAPPINGS_COLUMNS_securityGroupId="SecurityGroupId",SECURITY_GROUP_MAPPINGS_COLUMNS_securityGroupName="Title",SECURITY_GROUP_MAPPINGS_COLUMNS_defaultTemplateId="DefaultTemplateId",SECURITY_GROUP_MAPPINGS_COLUMNS_isActive="IsActive",PROJECT_TEAM_ASSIGNMENTS_COLUMNS={id:"ID",projectCode:"ProjectCode",userId:"UserId",userDisplayName:"Title",userEmail:"UserEmail",assignedRole:"AssignedRole",templateOverrideId:"TemplateOverrideId",granularFlagOverrides:"GranularFlagOverrides",assignedBy:"AssignedBy",assignedDate:"AssignedDate",isActive:"IsActive"},SECTOR_DEFINITIONS_COLUMNS={id:"ID",code:"Code",label:"Title",isActive:"IsActive",parentDivision:"ParentDivision",sortOrder:"SortOrder"},ASSIGNMENT_MAPPINGS_COLUMNS={id:"ID",region:"Region",sector:"Sector",assignmentType:"AssignmentType",assigneeUserId:"AssigneeUserId",assigneeDisplayName:"AssigneeDisplayName",assigneeEmail:"AssigneeEmail"},PERFORMANCE_LOGS_COLUMNS={id:"ID",SessionId:"SessionId",Timestamp:"Timestamp",UserEmail:"UserEmail",SiteUrl:"SiteUrl",ProjectCode:"ProjectCode",IsProjectSite:"IsProjectSite",WebPartLoadMs:"WebPartLoadMs",AppInitMs:"AppInitMs",DataFetchMs:"DataFetchMs",TotalLoadMs:"TotalLoadMs",Marks:"Marks",UserAgent:"UserAgent",SpfxVersion:"SpfxVersion",Notes:"Notes"},DIVISION_APPROVERS_COLUMNS={id:"ID",division:"division",approverName:"approverName",approverEmail:"approverEmail",approverTitle:"approverTitle"},PMP_BOILERPLATE_COLUMNS={sectionNumber:"sectionNumber",sectionTitle:"sectionTitle",content:"content",sourceDocumentUrl:"sourceDocumentUrl",lastSourceUpdate:"lastSourceUpdate"},HELP_GUIDES_COLUMNS={id:"ID",moduleKey:"ModuleKey",title:"Title",content:"Content",guideType:"GuideType",sortOrder:"SortOrder",targetSelector:"TargetSelector",videoUrl:"VideoUrl",isActive:"IsActive",lastModifiedBy:"LastModifiedBy",lastModifiedDate:"LastModifiedDate"},PROJECT_DATA_MART_COLUMNS={id:"ID",projectCode:"ProjectCode",jobNumber:"JobNumber",projectName:"Title",status:"Status",sector:"Sector",region:"Region",projectExecutive:"ProjectExecutive",projectExecutiveEmail:"ProjectExecutiveEmail",leadPM:"LeadPM",leadPMEmail:"LeadPMEmail",leadSuperintendent:"LeadSuperintendent",leadSuperintendentEmail:"LeadSuperintendentEmail",originalContract:"OriginalContract",changeOrders:"ChangeOrders",currentContractValue:"CurrentContractValue",billingsToDate:"BillingsToDate",unbilledAmount:"UnbilledAmount",projectedFee:"ProjectedFee",projectedFeePct:"ProjectedFeePct",buyoutCommittedTotal:"BuyoutCommittedTotal",buyoutExecutedCount:"BuyoutExecutedCount",buyoutOpenCount:"BuyoutOpenCount",startDate:"StartDate",substantialCompletionDate:"SubstantialCompletionDate",percentComplete:"PercentComplete",criticalPathItemCount:"CriticalPathItemCount",scheduleDaysVariance:"ScheduleDaysVariance",openQualityConcerns:"OpenQualityConcerns",openSafetyConcerns:"OpenSafetyConcerns",averageQScore:"AverageQScore",openWaiverCount:"OpenWaiverCount",pendingCommitments:"PendingCommitments",complianceStatus:"ComplianceStatus",overallHealth:"OverallHealth",hasUnbilledAlert:"HasUnbilledAlert",hasScheduleAlert:"HasScheduleAlert",hasFeeErosionAlert:"HasFeeErosionAlert",monthlyReviewStatus:"MonthlyReviewStatus",lastMonthlyReviewDate:"LastMonthlyReviewDate",turnoverStatus:"TurnoverStatus",pmpStatus:"PmpStatus",lastSyncDate:"LastSyncDate",lastSyncBy:"LastSyncBy"},CONSTRAINTS_LOG_COLUMNS={id:"ID",projectCode:"ProjectCode",constraintNumber:"ConstraintNumber",category:"Category",description:"Description",status:"Status",assignedTo:"AssignedTo",dateIdentified:"DateIdentified",dueDate:"DueDate",dateClosed:"DateClosed",reference:"Reference",closureDocument:"ClosureDocument",budgetImpactCost:"BudgetImpactCost",comments:"Comments"},SCHEDULE_ACTIVITIES_COLUMNS={id:"ID",projectCode:"ProjectCode",importId:"ImportId",taskCode:"Title",wbsCode:"WbsCode",activityName:"ActivityName",activityType:"ActivityType",status:"Status",originalDuration:"OriginalDuration",remainingDuration:"RemainingDuration",actualDuration:"ActualDuration",baselineStartDate:"BaselineStartDate",baselineFinishDate:"BaselineFinishDate",plannedStartDate:"PlannedStartDate",plannedFinishDate:"PlannedFinishDate",actualStartDate:"ActualStartDate",actualFinishDate:"ActualFinishDate",remainingFloat:"RemainingFloat",freeFloat:"FreeFloat",predecessors:"Predecessors",successors:"Successors",successorDetails:"SuccessorDetails",resources:"Resources",calendarName:"CalendarName",primaryConstraint:"PrimaryConstraint",secondaryConstraint:"SecondaryConstraint",isCritical:"IsCritical",percentComplete:"PercentComplete",startVarianceDays:"StartVarianceDays",finishVarianceDays:"FinishVarianceDays",deleteFlag:"DeleteFlag",createdDate:"Created",modifiedDate:"Modified"},SCHEDULE_IMPORTS_COLUMNS={id:"ID",projectCode:"ProjectCode",fileName:"Title",format:"Format",importDate:"ImportDate",importedBy:"ImportedBy",activityCount:"ActivityCount",notes:"Notes"},PERMITS_LOG_COLUMNS={id:"ID",projectCode:"ProjectCode",refNumber:"RefNumber",parentRefNumber:"ParentRefNumber",location:"Location",type:"PermitType",permitNumber:"PermitNumber",description:"Description",responsibleContractor:"ResponsibleContractor",address:"Address",dateRequired:"DateRequired",dateSubmitted:"DateSubmitted",dateReceived:"DateReceived",dateExpires:"DateExpires",status:"Status",ahj:"AHJ",comments:"Comments"},TEMPLATE_SITE_CONFIG_COLUMNS_id="ID",TEMPLATE_SITE_CONFIG_COLUMNS_TemplateSiteUrl="TemplateSiteUrl",TEMPLATE_SITE_CONFIG_COLUMNS_LastSnapshotHash="LastSnapshotHash",TEMPLATE_SITE_CONFIG_COLUMNS_LastSnapshotDate="LastSnapshotDate",TEMPLATE_SITE_CONFIG_COLUMNS_GitHubRepoOwner="GitHubRepoOwner",TEMPLATE_SITE_CONFIG_COLUMNS_GitHubRepoName="GitHubRepoName",TEMPLATE_SITE_CONFIG_COLUMNS_GitHubBranch="GitHubBranch",TEMPLATE_SITE_CONFIG_COLUMNS_Active="Active",TEMPLATE_MANIFEST_LOG_COLUMNS_SyncDate="SyncDate",TEMPLATE_MANIFEST_LOG_COLUMNS_TriggeredBy="TriggeredBy",TEMPLATE_MANIFEST_LOG_COLUMNS_DiffSummary="DiffSummary",TEMPLATE_MANIFEST_LOG_COLUMNS_PRNumber="PRNumber",TEMPLATE_MANIFEST_LOG_COLUMNS_PRUrl="PRUrl",TEMPLATE_MANIFEST_LOG_COLUMNS_Status="Status";const cacheService=new class CacheService{constructor(defaultTTLMs=9e5){this.memoryCache=new Map,this.defaultTTL=defaultTTLMs}get(key){const memEntry=this.memoryCache.get(key);if(memEntry&&Date.now()<memEntry.expiry)return memEntry.data;try{const stored=sessionStorage.getItem(key);if(stored){const entry=JSON.parse(stored);if(Date.now()<entry.expiry)return this.memoryCache.set(key,entry),entry.data;sessionStorage.removeItem(key)}}catch(_a){}return this.memoryCache.delete(key),null}set(key,data,ttlMs){const entry={data,expiry:Date.now()+(ttlMs||this.defaultTTL)};this.memoryCache.set(key,entry);try{sessionStorage.setItem(key,JSON.stringify(entry))}catch(_a){}}remove(key){this.memoryCache.delete(key);try{sessionStorage.removeItem(key)}catch(_a){}}removeByPrefix(prefix){for(const key of this.memoryCache.keys())key.startsWith(prefix)&&this.memoryCache.delete(key);try{const keysToRemove=[];for(let i=0;i<sessionStorage.length;i++){const key=sessionStorage.key(i);key&&key.startsWith(prefix)&&keysToRemove.push(key)}keysToRemove.forEach(k=>sessionStorage.removeItem(k))}catch(_a){}}invalidateByTags(tags,projectCode){tags.forEach(tag=>{this.removeByPrefix(tag),projectCode&&this.removeByPrefix(`${tag}_${projectCode}`)})}invalidatePlan(plan){var _a,_b;this.invalidateByTags(null!==(_a=plan.cacheTags)&&void 0!==_a?_a:[],plan.projectCode),(null!==(_b=plan.cachePrefixes)&&void 0!==_b?_b:[]).forEach(prefix=>this.removeByPrefix(prefix))}clear(){this.memoryCache.clear();try{const keysToRemove=[];for(let i=0;i<sessionStorage.length;i++){const key=sessionStorage.key(i);key&&key.startsWith("hbc_")&&keysToRemove.push(key)}keysToRemove.forEach(k=>sessionStorage.removeItem(k))}catch(_a){}}has(key){return null!==this.get(key)}};function projectListSchemas_text(internalName,displayName,opts){return Object.assign({internalName,displayName,fieldType:"Text"},opts)}function note(internalName,displayName){return{internalName,displayName,fieldType:"Note"}}function num(internalName,displayName,opts){return Object.assign({internalName,displayName,fieldType:"Number"},opts)}function currency(internalName,displayName){return{internalName,displayName,fieldType:"Currency"}}function dateTime(internalName,displayName){return{internalName,displayName,fieldType:"DateTime"}}function bool(internalName,displayName){return{internalName,displayName,fieldType:"Boolean"}}function choice(internalName,displayName,choices){return{internalName,displayName,fieldType:"Choice",choices}}function url(internalName,displayName){return{internalName,displayName,fieldType:"URL"}}const PROJECT_INFO={listName:"Project_Info",description:"Project-level metadata and configuration",templateType:100,fields:[projectListSchemas_text("ProjectCode","Project Code",{indexed:!0}),num("LeadID","Lead ID"),url("ProjectSiteURL","Project Site URL")]},TEAM_MEMBERS={listName:"Team_Members",description:"Project team member assignments",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("name","Name"),projectListSchemas_text("email","Email"),choice("role","Role",["BD Representative","Estimating Coordinator","Accounting Manager","Preconstruction Team","Operations Team","Executive Leadership","Legal","Risk Management","Marketing","Quality Control","Safety","IDS","Department Director","SharePoint Admin"]),projectListSchemas_text("department","Department"),projectListSchemas_text("phone","Phone")]},DELIVERABLES={listName:"Deliverables",description:"Project deliverables tracking",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("name","Name"),choice("department","Department",[]),projectListSchemas_text("assignedTo","Assigned To"),num("assignedToId","Assigned To ID"),choice("status","Status",["Not Started","In Progress","In Review","Complete"]),dateTime("dueDate","Due Date"),dateTime("completedDate","Completed Date"),note("notes","Notes")]},ACTION_ITEMS={listName:"Action_Items",description:"Project and autopsy action items",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("autopsyId","Autopsy ID"),projectListSchemas_text("description","Description"),projectListSchemas_text("assignee","Assignee"),num("assigneeId","Assignee ID"),dateTime("dueDate","Due Date"),choice("status","Status",["Open","In Progress","Complete"]),dateTime("completedDate","Completed Date")]},TURNOVER_CHECKLIST={listName:"Turnover_Checklist",description:"Turnover checklist items",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),choice("category","Category",["Documents","Safety","Financial","Scheduling","Staffing","Subcontracts"]),projectListSchemas_text("description","Description"),choice("status","Status",["Pending","Complete","N/A"]),projectListSchemas_text("assignedTo","Assigned To"),num("assignedToId","Assigned To ID"),bool("required","Required"),dateTime("completedDate","Completed Date"),note("notes","Notes")]},BUYOUT_LOG={listName:"Buyout_Log",description:"Subcontractor buyout tracking and commitment approvals",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("divisionCode","Division Code"),projectListSchemas_text("divisionDescription","Division Description"),bool("isStandard","Is Standard"),currency("originalBudget","Original Budget"),currency("estimatedTax","Estimated Tax"),currency("totalBudget","Total Budget"),projectListSchemas_text("subcontractorName","Subcontractor Name"),currency("contractValue","Contract Value"),currency("overUnder","Over/Under"),bool("enrolledInSDI","Enrolled In SDI"),bool("bondRequired","Bond Required"),num("qScore","Q Score"),choice("compassPreQualStatus","Compass Pre-Qual Status",[]),bool("scopeMatchesBudget","Scope Matches Budget"),bool("exhibitCInsuranceConfirmed","Exhibit C Insurance Confirmed"),bool("exhibitDScheduleConfirmed","Exhibit D Schedule Confirmed"),bool("exhibitESafetyConfirmed","Exhibit E Safety Confirmed"),choice("commitmentStatus","Commitment Status",["Draft","PendingPM","PendingPX","PendingCFO","Approved","Rejected","WaiverRequired"]),bool("waiverRequired","Waiver Required"),choice("waiverType","Waiver Type",["PriceDeviation","QScoreDeviation","SoleSource","Other"]),note("waiverReason","Waiver Reason"),url("compiledCommitmentPdfUrl","Compiled Commitment PDF URL"),projectListSchemas_text("compiledCommitmentFileId","Compiled Commitment File ID"),projectListSchemas_text("compiledCommitmentFileName","Compiled Commitment File Name"),projectListSchemas_text("eVerifyContractNumber","E-Verify Contract Number"),dateTime("eVerifySentDate","E-Verify Sent Date"),dateTime("eVerifyReminderDate","E-Verify Reminder Date"),dateTime("eVerifyReceivedDate","E-Verify Received Date"),choice("eVerifyStatus","E-Verify Status",["Not Sent","Sent","Reminder Sent","Received","Overdue"]),choice("currentApprovalStep","Current Approval Step",["PM","PX","CFO"]),dateTime("loiSentDate","LOI Sent Date"),dateTime("loiReturnedDate","LOI Returned Date"),dateTime("contractSentDate","Contract Sent Date"),dateTime("contractExecutedDate","Contract Executed Date"),dateTime("insuranceCOIReceivedDate","Insurance COI Received Date"),choice("status","Status",["Not Started","In Progress","Complete"]),note("notes","Notes"),dateTime("createdDate","Created Date"),dateTime("modifiedDate","Modified Date")]},COMMITMENT_APPROVALS={listName:"Commitment_Approvals",description:"Buyout commitment approval history",templateType:100,fields:[num("buyoutEntryId","Buyout Entry ID"),projectListSchemas_text("projectCode","Project Code",{indexed:!0}),choice("step","Step",["PM","PX","CFO"]),projectListSchemas_text("approverName","Approver Name"),projectListSchemas_text("approverEmail","Approver Email"),choice("status","Status",["Pending","Approved","Rejected"]),note("comment","Comment"),dateTime("actionDate","Action Date"),choice("waiverType","Waiver Type",["PriceDeviation","QScoreDeviation","SoleSource","Other"])]},STARTUP_CHECKLIST={listName:"Startup_Checklist",description:"Project startup checklist items",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("sectionNumber","Section Number"),projectListSchemas_text("sectionName","Section Name"),projectListSchemas_text("itemNumber","Item Number"),projectListSchemas_text("label","Label"),choice("responseType","Response Type",["YesNo","Text","Date","Upload"]),projectListSchemas_text("response","Response"),choice("status","Status",["Pending","Complete","N/A"]),projectListSchemas_text("respondedBy","Responded By"),dateTime("respondedDate","Responded Date"),projectListSchemas_text("assignedTo","Assigned To"),projectListSchemas_text("assignedToName","Assigned To Name"),note("comment","Comment"),bool("isHidden","Is Hidden"),bool("isCustom","Is Custom"),num("sortOrder","Sort Order")]},CHECKLIST_ACTIVITY_LOG={listName:"Checklist_Activity_Log",description:"Activity log for startup checklist changes",templateType:100,fields:[num("checklistItemId","Checklist Item ID"),projectListSchemas_text("projectCode","Project Code",{indexed:!0}),dateTime("timestamp","Timestamp"),projectListSchemas_text("user","User"),projectListSchemas_text("previousValue","Previous Value"),projectListSchemas_text("newValue","New Value"),note("comment","Comment")]},INTERNAL_MATRIX={listName:"Internal_Matrix",description:"Internal responsibility matrix tasks",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("sortOrder","Sort Order"),projectListSchemas_text("taskCategory","Task Category"),projectListSchemas_text("taskDescription","Task Description"),choice("PX","PX",["P","S","N/A"]),choice("SrPM","Sr PM",["P","S","N/A"]),choice("PM2","PM2",["P","S","N/A"]),choice("PM1","PM1",["P","S","N/A"]),choice("PA","PA",["P","S","N/A"]),choice("QAQC","QAQC",["P","S","N/A"]),choice("ProjAcct","Proj Acct",["P","S","N/A"]),bool("isHidden","Is Hidden"),bool("isCustom","Is Custom")]},TEAM_ROLE_ASSIGNMENTS={listName:"Team_Role_Assignments",description:"Role-to-person mappings for responsibility matrix",templateType:100,fields:[projectListSchemas_text("ProjectCode","Project Code",{indexed:!0}),projectListSchemas_text("RoleAbbreviation","Role Abbreviation"),projectListSchemas_text("AssignedPerson","Assigned Person"),projectListSchemas_text("AssignedPersonEmail","Assigned Person Email")]},OWNER_CONTRACT_MATRIX={listName:"Owner_Contract_Matrix",description:"Owner contract article responsibility matrix",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("sortOrder","Sort Order"),projectListSchemas_text("articleNumber","Article Number"),projectListSchemas_text("pageNumber","Page Number"),choice("responsibleParty","Responsible Party",[]),note("description","Description"),bool("isHidden","Is Hidden"),bool("isCustom","Is Custom")]},SUB_CONTRACT_MATRIX={listName:"Sub_Contract_Matrix",description:"Sub-contract clause responsibility matrix",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("sortOrder","Sort Order"),projectListSchemas_text("refNumber","Ref Number"),projectListSchemas_text("pageNumber","Page Number"),note("clauseDescription","Clause Description"),choice("ProjExec","Proj Exec",["P","S","N/A"]),choice("ProjMgr","Proj Mgr",["P","S","N/A"]),choice("AsstPM","Asst PM",["P","S","N/A"]),choice("Super","Super",["P","S","N/A"]),choice("ProjAdmin","Proj Admin",["P","S","N/A"]),bool("isHidden","Is Hidden"),bool("isCustom","Is Custom")]},RISK_COST_MANAGEMENT={listName:"Risk_Cost_Management",description:"Project risk and cost management header",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("contractType","Contract Type"),currency("contractAmount","Contract Amount"),projectListSchemas_text("createdBy","Created By"),dateTime("createdAt","Created At"),projectListSchemas_text("lastUpdatedBy","Last Updated By"),dateTime("lastUpdatedAt","Last Updated At")]},RISK_COST_ITEMS={listName:"Risk_Cost_Items",description:"Risk and cost line items (buyout opportunities, risks, savings)",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("riskCostId","Risk Cost ID"),choice("category","Category",["BuyoutOpportunity","PotentialRisk","PotentialSaving"]),projectListSchemas_text("letter","Letter"),note("description","Description"),currency("estimatedValue","Estimated Value"),choice("status","Status",["Open","Mitigated","Realized","Closed"]),note("notes","Notes"),dateTime("createdDate","Created Date"),dateTime("updatedDate","Updated Date")]},QUALITY_CONCERNS={listName:"Quality_Concerns",description:"Project quality concerns tracking",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("letter","Letter"),note("description","Description"),projectListSchemas_text("raisedBy","Raised By"),dateTime("raisedDate","Raised Date"),choice("status","Status",["Open","In Progress","Resolved"]),note("resolution","Resolution"),dateTime("resolvedDate","Resolved Date"),note("notes","Notes")]},SAFETY_CONCERNS={listName:"Safety_Concerns",description:"Project safety concerns tracking",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("safetyOfficerName","Safety Officer Name"),projectListSchemas_text("safetyOfficerEmail","Safety Officer Email"),projectListSchemas_text("letter","Letter"),note("description","Description"),choice("severity","Severity",["Low","Medium","High","Critical"]),projectListSchemas_text("raisedBy","Raised By"),dateTime("raisedDate","Raised Date"),choice("status","Status",["Open","In Progress","Resolved"]),note("resolution","Resolution"),dateTime("resolvedDate","Resolved Date"),note("notes","Notes")]},PROJECT_SCHEDULE={listName:"Project_Schedule",description:"Project schedule and critical path management",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),dateTime("startDate","Start Date"),dateTime("substantialCompletionDate","Substantial Completion Date"),dateTime("ntpDate","NTP Date"),dateTime("nocDate","NOC Date"),num("contractCalendarDays","Contract Calendar Days"),projectListSchemas_text("contractBasisType","Contract Basis Type"),num("teamGoalDaysAhead","Team Goal Days Ahead"),note("teamGoalDescription","Team Goal Description"),bool("hasLiquidatedDamages","Has Liquidated Damages"),currency("liquidatedDamagesAmount","Liquidated Damages Amount"),note("liquidatedDamagesTerms","Liquidated Damages Terms"),projectListSchemas_text("createdBy","Created By"),dateTime("createdAt","Created At"),projectListSchemas_text("lastUpdatedBy","Last Updated By"),dateTime("lastUpdatedAt","Last Updated At")]},CRITICAL_PATH_ITEMS={listName:"Critical_Path_Items",description:"Critical path concern items",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("scheduleId","Schedule ID"),projectListSchemas_text("letter","Letter"),note("description","Description"),note("impactDescription","Impact Description"),choice("status","Status",["Open","Mitigated","Resolved"]),note("mitigationPlan","Mitigation Plan"),dateTime("createdDate","Created Date"),dateTime("updatedDate","Updated Date")]},SUPERINTENDENT_PLAN={listName:"Superintendent_Plan",description:"Superintendent field plan header",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("superintendentName","Superintendent Name"),projectListSchemas_text("createdBy","Created By"),dateTime("createdAt","Created At"),projectListSchemas_text("lastUpdatedBy","Last Updated By"),dateTime("lastUpdatedAt","Last Updated At")]},projectListSchemas_SUPERINTENDENT_PLAN_SECTIONS={listName:"Superintendent_Plan_Sections",description:"Superintendent plan section content",templateType:100,fields:[num("superintendentPlanId","Superintendent Plan ID"),projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("sectionKey","Section Key"),projectListSchemas_text("sectionTitle","Section Title"),note("content","Content"),note("attachmentUrls","Attachment URLs"),bool("isComplete","Is Complete")]},LESSONS_LEARNED={listName:"Lessons_Learned",description:"Project lessons learned entries",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("title","Title"),choice("category","Category",["Safety","Quality","Schedule","Cost","Scope","Communication","Other"]),choice("impact","Impact",["Low","Medium","High"]),note("description","Description"),note("recommendation","Recommendation"),projectListSchemas_text("raisedBy","Raised By"),dateTime("raisedDate","Raised Date"),projectListSchemas_text("phase","Phase"),bool("isIncludedInFinalRecord","Included In Final Record"),note("tags","Tags")]},PMP={listName:"Project_Management_Plans",description:"Project management plan documents",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("projectName","Project Name"),projectListSchemas_text("jobNumber","Job Number"),choice("status","Status",["Draft","PendingApproval","Approved","Returned"]),num("currentCycleNumber","Current Cycle Number"),projectListSchemas_text("division","Division"),note("superintendentPlan","Superintendent Plan"),note("preconMeetingNotes","Precon Meeting Notes"),note("siteManagementNotes","Site Management Notes"),dateTime("projectAdminBuyoutDate","Project Admin Buyout Date"),note("attachmentUrls","Attachment URLs"),note("riskCostData","Risk Cost Data"),note("qualityConcerns","Quality Concerns"),note("safetyConcerns","Safety Concerns"),note("scheduleData","Schedule Data"),note("superintendentPlanData","Superintendent Plan Data"),note("lessonsLearned","Lessons Learned"),note("teamAssignments","Team Assignments"),note("boilerplate","Boilerplate"),projectListSchemas_text("createdBy","Created By"),dateTime("createdAt","Created At"),projectListSchemas_text("lastUpdatedBy","Last Updated By"),dateTime("lastUpdatedAt","Last Updated At")]},PMP_SIGNATURES={listName:"PMP_Signatures",description:"PMP signature tracking",templateType:100,fields:[num("pmpId","PMP ID"),projectListSchemas_text("projectCode","Project Code",{indexed:!0}),choice("signatureType","Signature Type",["Startup","Completion"]),projectListSchemas_text("role","Role"),projectListSchemas_text("personName","Person Name"),projectListSchemas_text("personEmail","Person Email"),bool("isRequired","Is Required"),bool("isLead","Is Lead"),choice("status","Status",["Pending","Signed","Declined"]),dateTime("signedDate","Signed Date"),note("affidavitText","Affidavit Text"),note("comment","Comment")]},PMP_APPROVAL_CYCLES={listName:"PMP_Approval_Cycles",description:"PMP approval cycle tracking",templateType:100,fields:[num("pmpId","PMP ID"),projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("cycleNumber","Cycle Number"),projectListSchemas_text("submittedBy","Submitted By"),dateTime("submittedDate","Submitted Date"),choice("status","Status",["Active","Completed","Cancelled"]),note("changesFromPrevious","Changes From Previous")]},PMP_APPROVAL_STEPS={listName:"PMP_Approval_Steps",description:"PMP approval step entries",templateType:100,fields:[num("approvalCycleId","Approval Cycle ID"),projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("stepOrder","Step Order"),projectListSchemas_text("approverRole","Approver Role"),projectListSchemas_text("approverName","Approver Name"),projectListSchemas_text("approverEmail","Approver Email"),choice("status","Status",["Pending","Approved","Returned"]),note("comment","Comment"),dateTime("actionDate","Action Date"),num("approvalCycleNumber","Approval Cycle Number")]},MONTHLY_REVIEWS={listName:"Monthly_Reviews",description:"Monthly project review entries",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("reviewMonth","Review Month"),choice("status","Status",["Draft","PMSubmitted","PXReview","PXValidated","LeadershipReview","Complete"]),dateTime("dueDate","Due Date"),dateTime("meetingDate","Meeting Date"),dateTime("pmSubmittedDate","PM Submitted Date"),dateTime("pxReviewDate","PX Review Date"),dateTime("pxValidationDate","PX Validation Date"),dateTime("leadershipSubmitDate","Leadership Submit Date"),dateTime("completedDate","Completed Date"),note("reportDocumentUrls","Report Document URLs"),projectListSchemas_text("createdBy","Created By"),dateTime("createdAt","Created At"),projectListSchemas_text("lastUpdatedBy","Last Updated By"),dateTime("lastUpdatedAt","Last Updated At")]},MONTHLY_CHECKLIST_ITEMS={listName:"Monthly_Checklist_Items",description:"Monthly review checklist items",templateType:100,fields:[num("reviewId","Review ID"),projectListSchemas_text("sectionKey","Section Key"),projectListSchemas_text("sectionTitle","Section Title"),projectListSchemas_text("itemKey","Item Key"),projectListSchemas_text("itemDescription","Item Description"),note("pmComment","PM Comment"),note("pxComment","PX Comment"),projectListSchemas_text("pxInitial","PX Initial")]},MONTHLY_FOLLOW_UPS={listName:"Monthly_Follow_Ups",description:"Monthly review follow-up items",templateType:100,fields:[num("reviewId","Review ID"),note("question","Question"),projectListSchemas_text("requestedBy","Requested By"),dateTime("requestedDate","Requested Date"),note("pmResponse","PM Response"),dateTime("responseDate","Response Date"),dateTime("pxForwardedDate","PX Forwarded Date"),choice("status","Status",["Open","Responded","Closed"])]},CLOSEOUT_ITEMS={listName:"Closeout_Items",description:"Project closeout checklist items",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("category","Category"),projectListSchemas_text("description","Description"),choice("status","Status",["Pending","Complete","N/A"]),projectListSchemas_text("assignedTo","Assigned To"),dateTime("completedDate","Completed Date"),note("notes","Notes")]},MARKETING_PROJECT_RECORD={listName:"Marketing_Project_Record",description:"Project-level marketing record (mirrors hub-level)",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),projectListSchemas_text("projectName","Project Name"),num("leadId","Lead ID"),note("contractType","Contract Type"),projectListSchemas_text("deliveryMethod","Delivery Method"),projectListSchemas_text("architect","Architect"),note("projectDescription","Project Description"),currency("contractBudget","Contract Budget"),currency("contractFinalCost","Contract Final Cost"),dateTime("scheduleStartActual","Schedule Start Actual"),dateTime("scheduleEndActual","Schedule End Actual"),num("overallCompletion","Overall Completion"),projectListSchemas_text("lastUpdatedBy","Last Updated By"),dateTime("lastUpdatedAt","Last Updated At")]},CONTRACT_INFO={listName:"Contract_Info",description:"Project contract information",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("leadId","Lead ID"),projectListSchemas_text("contractType","Contract Type"),currency("contractValue","Contract Value"),dateTime("contractDate","Contract Date"),projectListSchemas_text("ownerName","Owner Name"),note("notes","Notes")]},INTERVIEW_PREP={listName:"Interview_Prep",description:"Interview preparation documents",templateType:100,fields:[num("leadId","Lead ID",{indexed:!0}),projectListSchemas_text("projectCode","Project Code"),note("keyMessages","Key Messages"),note("teamBios","Team Bios"),note("presentationNotes","Presentation Notes"),projectListSchemas_text("createdBy","Created By"),dateTime("createdAt","Created At")]},TURNOVER_AGENDAS={listName:"Turnover_Agendas",description:"Turnover agenda master records",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("leadId","Lead ID"),choice("status","Status",["Draft","PrerequisitesInProgress","MeetingScheduled","MeetingComplete","PendingSignatures","Signed","Complete"]),dateTime("meetingDate","Meeting Date"),projectListSchemas_text("meetingLocation","Meeting Location"),note("projectHeader","Project Header"),projectListSchemas_text("createdBy","Created By"),dateTime("createdAt","Created At"),projectListSchemas_text("lastUpdatedBy","Last Updated By"),dateTime("lastUpdatedAt","Last Updated At")]},TURNOVER_PREREQUISITES={listName:"Turnover_Prerequisites",description:"Turnover prerequisite items",templateType:100,fields:[num("turnoverAgendaId","Turnover Agenda ID"),projectListSchemas_text("label","Label"),bool("isComplete","Is Complete"),projectListSchemas_text("completedBy","Completed By"),dateTime("completedDate","Completed Date"),note("notes","Notes"),num("sortOrder","Sort Order")]},TURNOVER_DISCUSSION_ITEMS={listName:"Turnover_Discussion_Items",description:"Turnover discussion agenda items",templateType:100,fields:[num("turnoverAgendaId","Turnover Agenda ID"),projectListSchemas_text("sectionKey","Section Key"),projectListSchemas_text("sectionTitle","Section Title"),projectListSchemas_text("itemLabel","Item Label"),note("notes","Notes"),projectListSchemas_text("responsibleParty","Responsible Party"),bool("isDiscussed","Is Discussed"),num("sortOrder","Sort Order")]},TURNOVER_SUBCONTRACTORS={listName:"Turnover_Subcontractors",description:"Turnover subcontractor entries",templateType:100,fields:[num("turnoverAgendaId","Turnover Agenda ID"),projectListSchemas_text("trade","Trade"),projectListSchemas_text("company","Company"),projectListSchemas_text("contactName","Contact Name"),projectListSchemas_text("contactPhone","Contact Phone"),projectListSchemas_text("contactEmail","Contact Email"),currency("contractAmount","Contract Amount"),note("scopeNotes","Scope Notes"),num("sortOrder","Sort Order")]},TURNOVER_EXHIBITS={listName:"Turnover_Exhibits",description:"Turnover exhibit documents",templateType:100,fields:[num("turnoverAgendaId","Turnover Agenda ID"),projectListSchemas_text("exhibitLabel","Exhibit Label"),projectListSchemas_text("exhibitTitle","Exhibit Title"),note("description","Description"),url("fileUrl","File URL"),projectListSchemas_text("fileName","File Name"),bool("isReviewed","Is Reviewed"),projectListSchemas_text("reviewedBy","Reviewed By"),dateTime("reviewedDate","Reviewed Date"),num("sortOrder","Sort Order")]},TURNOVER_SIGNATURES={listName:"Turnover_Signatures",description:"Turnover signature tracking",templateType:100,fields:[num("turnoverAgendaId","Turnover Agenda ID"),projectListSchemas_text("role","Role"),projectListSchemas_text("personName","Person Name"),projectListSchemas_text("personEmail","Person Email"),bool("isSigned","Is Signed"),dateTime("signedDate","Signed Date"),note("affidavitText","Affidavit Text"),note("comment","Comment"),num("sortOrder","Sort Order")]},TURNOVER_ATTACHMENTS={listName:"Turnover_Attachments",description:"Turnover discussion item attachments",templateType:100,fields:[num("discussionItemId","Discussion Item ID"),projectListSchemas_text("fileName","File Name"),url("fileUrl","File URL"),projectListSchemas_text("uploadedBy","Uploaded By"),dateTime("uploadedDate","Uploaded Date")]},TURNOVER_ESTIMATE_OVERVIEWS={listName:"Turnover_Estimate_Overviews",description:"Turnover estimate overview data",templateType:100,fields:[projectListSchemas_text("projectCode","Project Code",{indexed:!0}),num("turnoverAgendaId","Turnover Agenda ID"),currency("originalContractAmount","Original Contract Amount"),currency("approvedChangeOrders","Approved Change Orders"),currency("pendingChangeOrders","Pending Change Orders"),currency("currentContractValue","Current Contract Value"),currency("projectedFinalCost","Projected Final Cost"),num("projectedFeePercent","Projected Fee Percent"),note("notes","Notes"),projectListSchemas_text("lastUpdatedBy","Last Updated By"),dateTime("lastUpdatedAt","Last Updated At")]},SCHEDULE_ACTIVITIES={listName:"Schedule_Activities",description:"P6-style schedule activities imported from CSV",templateType:100,fields:[projectListSchemas_text("ProjectCode","Project Code",{indexed:!0}),num("ImportId","Import ID"),projectListSchemas_text("WbsCode","WBS Code"),projectListSchemas_text("ActivityName","Activity Name"),projectListSchemas_text("ActivityType","Activity Type"),choice("Status","Status",["Completed","In Progress","Not Started"]),num("OriginalDuration","Original Duration"),num("RemainingDuration","Remaining Duration"),num("ActualDuration","Actual Duration"),dateTime("BaselineStartDate","Baseline Start Date"),dateTime("BaselineFinishDate","Baseline Finish Date"),dateTime("PlannedStartDate","Planned Start Date"),dateTime("PlannedFinishDate","Planned Finish Date"),dateTime("ActualStartDate","Actual Start Date"),dateTime("ActualFinishDate","Actual Finish Date"),num("RemainingFloat","Remaining Float"),num("FreeFloat","Free Float"),note("Predecessors","Predecessors"),note("Successors","Successors"),note("SuccessorDetails","Successor Details"),projectListSchemas_text("Resources","Resources"),projectListSchemas_text("CalendarName","Calendar Name"),projectListSchemas_text("PrimaryConstraint","Primary Constraint"),projectListSchemas_text("SecondaryConstraint","Secondary Constraint"),bool("IsCritical","Is Critical"),num("PercentComplete","Percent Complete"),num("StartVarianceDays","Start Variance Days"),num("FinishVarianceDays","Finish Variance Days"),bool("DeleteFlag","Delete Flag")]},SCHEDULE_IMPORTS={listName:"Schedule_Imports",description:"Schedule import history and metadata",templateType:100,fields:[projectListSchemas_text("ProjectCode","Project Code",{indexed:!0}),choice("Format","Format",["P6-CSV","MSProject-CSV"]),dateTime("ImportDate","Import Date"),projectListSchemas_text("ImportedBy","Imported By"),num("ActivityCount","Activity Count"),note("Notes","Notes")]},CONSTRAINTS_LOG={listName:"Constraints_Log",description:"Construction constraints tracking (permits, AHJ, materials, etc.)",templateType:100,fields:[projectListSchemas_text("ProjectCode","Project Code",{indexed:!0}),num("ConstraintNumber","Constraint Number"),choice("Category","Category",["Permits","AHJ Coordination","Utility Coordination","Design Completion","Material Procurement","Subcontractor Mobilization","Owner Decisions","Site Access","Environmental","Other"]),note("Description","Description"),choice("Status","Status",["Open","Closed"]),projectListSchemas_text("AssignedTo","Assigned To"),dateTime("DateIdentified","Date Identified"),dateTime("DueDate","Due Date"),dateTime("DateClosed","Date Closed"),projectListSchemas_text("Reference","Reference"),projectListSchemas_text("ClosureDocument","Closure Document"),currency("BudgetImpactCost","Budget Impact Cost"),note("Comments","Comments")]},PERMITS_LOG={listName:"Permits_Log",description:"Construction permits tracking (primary, sub, temp permits with AHJ)",templateType:100,fields:[projectListSchemas_text("ProjectCode","Project Code",{indexed:!0}),projectListSchemas_text("RefNumber","Ref Number"),projectListSchemas_text("ParentRefNumber","Parent Ref Number"),choice("Location","Location",["Site","Building","Pool","Parking","Utility","Other"]),choice("PermitType","Permit Type",["PRIMARY","SUB","TEMP"]),projectListSchemas_text("PermitNumber","Permit Number"),note("Description","Description"),projectListSchemas_text("ResponsibleContractor","Responsible Contractor"),projectListSchemas_text("Address","Address"),dateTime("DateRequired","Date Required"),dateTime("DateSubmitted","Date Submitted"),dateTime("DateReceived","Date Received"),dateTime("DateExpires","Date Expires"),choice("Status","Status",["Active","Pending Application","Pending Revision","Inactive","VOID","Expired","Closed"]),projectListSchemas_text("AHJ","AHJ"),note("Comments","Comments")]},ALL_PROJECT_SCHEMAS=[PROJECT_INFO,TEAM_MEMBERS,DELIVERABLES,ACTION_ITEMS,TURNOVER_CHECKLIST,BUYOUT_LOG,COMMITMENT_APPROVALS,STARTUP_CHECKLIST,CHECKLIST_ACTIVITY_LOG,INTERNAL_MATRIX,TEAM_ROLE_ASSIGNMENTS,OWNER_CONTRACT_MATRIX,SUB_CONTRACT_MATRIX,RISK_COST_MANAGEMENT,RISK_COST_ITEMS,QUALITY_CONCERNS,SAFETY_CONCERNS,PROJECT_SCHEDULE,CRITICAL_PATH_ITEMS,SCHEDULE_ACTIVITIES,SCHEDULE_IMPORTS,SUPERINTENDENT_PLAN,projectListSchemas_SUPERINTENDENT_PLAN_SECTIONS,LESSONS_LEARNED,PMP,PMP_SIGNATURES,PMP_APPROVAL_CYCLES,PMP_APPROVAL_STEPS,MONTHLY_REVIEWS,MONTHLY_CHECKLIST_ITEMS,MONTHLY_FOLLOW_UPS,CLOSEOUT_ITEMS,MARKETING_PROJECT_RECORD,CONTRACT_INFO,INTERVIEW_PREP,TURNOVER_AGENDAS,TURNOVER_PREREQUISITES,TURNOVER_DISCUSSION_ITEMS,TURNOVER_SUBCONTRACTORS,TURNOVER_EXHIBITS,TURNOVER_SIGNATURES,TURNOVER_ATTACHMENTS,TURNOVER_ESTIMATE_OVERVIEWS,CONSTRAINTS_LOG,PERMITS_LOG];function buildCacheKeySuffix(params){if(!params)return"";const filtered=Object.entries(params).filter(([,v])=>null!=v).sort(([a],[b])=>a.localeCompare(b));if(0===filtered.length)return"";const obj={};for(const[k,v]of filtered)obj[k]=v;return"_"+JSON.stringify(obj)}async function computeSha256Hex(input){const digest=await globalThis.crypto.subtle.digest("SHA-256",input),bytes=new Uint8Array(digest);let hex="";for(const b of bytes)hex+=b.toString(16).padStart(2,"0");return hex}class SharePointDataService{constructor(){this._pageContextUser=null,this._projectSiteUrl=null}initialize(spInstance){this.sp=spInstance}initializeContext(pageContextUser){this._pageContextUser=pageContextUser}async getLeads(_options){performanceService.startMark("sp:getLeads");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.top((null==_options?void 0:_options.top)||100)();return performanceService.endMark("sp:getLeads"),{items,totalCount:items.length,hasMore:!1}}catch(err){throw performanceService.endMark("sp:getLeads"),this.handleError("getLeads",err,{entityType:"Lead"})}}async getLeadById(id){performanceService.startMark("sp:getLeadById");try{const item=await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.getById(id)();return performanceService.endMark("sp:getLeadById"),item}catch(_a){return performanceService.endMark("sp:getLeadById"),null}}async getLeadsByStage(stage){performanceService.startMark("sp:getLeadsByStage");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.filter(`Stage eq '${stage}'`).top(5e3)();return performanceService.endMark("sp:getLeadsByStage"),items}catch(err){throw performanceService.endMark("sp:getLeadsByStage"),this.handleError("getLeadsByStage",err,{entityType:"Lead"})}}async createLead(data){performanceService.startMark("sp:createLead");try{const result=await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.add(data);return performanceService.endMark("sp:createLead"),result}catch(err){throw performanceService.endMark("sp:createLead"),this.handleError("createLead",err,{entityType:"Lead"})}}async updateLead(id,data){performanceService.startMark("sp:updateLead");try{return await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.getById(id).update(data),performanceService.endMark("sp:updateLead"),this.getLeadById(id)}catch(err){throw performanceService.endMark("sp:updateLead"),this.handleError("updateLead",err,{entityType:"Lead",entityId:String(id)})}}async deleteLead(id){performanceService.startMark("sp:deleteLead");try{await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.getById(id).delete(),performanceService.endMark("sp:deleteLead")}catch(err){throw performanceService.endMark("sp:deleteLead"),this.handleError("deleteLead",err,{entityType:"Lead",entityId:String(id)})}}async searchLeads(query){performanceService.startMark("sp:searchLeads");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.filter(`substringof('${query}', Title) or substringof('${query}', ClientName) or substringof('${query}', ProjectCode)`).top(5e3)();return performanceService.endMark("sp:searchLeads"),items}catch(err){throw performanceService.endMark("sp:searchLeads"),this.handleError("searchLeads",err,{entityType:"Lead"})}}async getScorecardByLeadId(leadId){performanceService.startMark("sp:getScorecardByLeadId");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.filter(`LeadID eq ${leadId}`).top(1)();return performanceService.endMark("sp:getScorecardByLeadId"),items.length>0?items[0]:null}catch(err){throw performanceService.endMark("sp:getScorecardByLeadId"),this.handleError("getScorecardByLeadId",err,{entityType:"Scorecard"})}}async getScorecards(){performanceService.startMark("sp:getScorecards");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.top(5e3)();return performanceService.endMark("sp:getScorecards"),items}catch(err){throw performanceService.endMark("sp:getScorecards"),this.handleError("getScorecards",err,{entityType:"Scorecard"})}}async createScorecard(data){performanceService.startMark("sp:createScorecard");try{const result=await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.add(data);return performanceService.endMark("sp:createScorecard"),result}catch(err){throw performanceService.endMark("sp:createScorecard"),this.handleError("createScorecard",err,{entityType:"Scorecard"})}}async updateScorecard(id,data){performanceService.startMark("sp:updateScorecard");try{return await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(id).update(data),performanceService.endMark("sp:updateScorecard"),Object.assign({id},data)}catch(err){throw performanceService.endMark("sp:updateScorecard"),this.handleError("updateScorecard",err,{entityType:"Scorecard",entityId:String(id)})}}async submitGoNoGoDecision(scorecardId,decision,projectCode){performanceService.startMark("sp:submitGoNoGoDecision");try{await this.updateScorecard(scorecardId,{Decision:decision,DecisionDate:(new Date).toISOString(),ProjectCode:projectCode}),performanceService.endMark("sp:submitGoNoGoDecision")}catch(err){throw performanceService.endMark("sp:submitGoNoGoDecision"),this.handleError("submitGoNoGoDecision",err,{entityType:"Scorecard",entityId:String(scorecardId)})}}async getEstimatingRecords(_options){performanceService.startMark("sp:getEstimatingRecords");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_TRACKER).items.top(5e3)();return performanceService.endMark("sp:getEstimatingRecords"),{items,totalCount:items.length,hasMore:!1}}catch(err){throw performanceService.endMark("sp:getEstimatingRecords"),this.handleError("getEstimatingRecords",err,{entityType:"EstimatingTracker"})}}async getEstimatingRecordById(id){performanceService.startMark("sp:getEstimatingRecordById");try{const item=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_TRACKER).items.getById(id)();return performanceService.endMark("sp:getEstimatingRecordById"),item}catch(_a){return performanceService.endMark("sp:getEstimatingRecordById"),null}}async getEstimatingByLeadId(leadId){performanceService.startMark("sp:getEstimatingByLeadId");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_TRACKER).items.filter(`LeadID eq ${leadId}`).top(1)();return performanceService.endMark("sp:getEstimatingByLeadId"),items.length>0?items[0]:null}catch(err){throw performanceService.endMark("sp:getEstimatingByLeadId"),this.handleError("getEstimatingByLeadId",err,{entityType:"EstimatingTracker"})}}async createEstimatingRecord(data){performanceService.startMark("sp:createEstimatingRecord");try{const result=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_TRACKER).items.add(data);return performanceService.endMark("sp:createEstimatingRecord"),result}catch(err){throw performanceService.endMark("sp:createEstimatingRecord"),this.handleError("createEstimatingRecord",err,{entityType:"EstimatingTracker"})}}async updateEstimatingRecord(id,data){performanceService.startMark("sp:updateEstimatingRecord");try{return await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_TRACKER).items.getById(id).update(data),performanceService.endMark("sp:updateEstimatingRecord"),Object.assign({id},data)}catch(err){throw performanceService.endMark("sp:updateEstimatingRecord"),this.handleError("updateEstimatingRecord",err,{entityType:"EstimatingTracker",entityId:String(id)})}}async getCurrentPursuits(){performanceService.startMark("sp:getCurrentPursuits");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_TRACKER).items.filter("AwardStatus eq 'Pending'").top(5e3)();return performanceService.endMark("sp:getCurrentPursuits"),items}catch(err){throw performanceService.endMark("sp:getCurrentPursuits"),this.handleError("getCurrentPursuits",err,{entityType:"EstimatingTracker"})}}async getPreconEngagements(){performanceService.startMark("sp:getPreconEngagements");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_TRACKER).items.filter("AwardStatus eq 'Awarded w/ Precon'").top(5e3)();return performanceService.endMark("sp:getPreconEngagements"),items}catch(err){throw performanceService.endMark("sp:getPreconEngagements"),this.handleError("getPreconEngagements",err,{entityType:"EstimatingTracker"})}}async getEstimateLog(){performanceService.startMark("sp:getEstimateLog");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_TRACKER).items.filter("SubmittedDate ne null").top(5e3)();return performanceService.endMark("sp:getEstimateLog"),items}catch(err){throw performanceService.endMark("sp:getEstimateLog"),this.handleError("getEstimateLog",err,{entityType:"EstimatingTracker"})}}async getCurrentUser(){var _a;if(performanceService.startMark("sp:getCurrentUser"),!this._pageContextUser)throw new Error("SharePointDataService.initializeContext() must be called before getCurrentUser()");const{displayName,email,loginName,id}=this._pageContextUser,roles=[],allPermissions=[];try{const roleItems=await this.getRoles(),emailLower=email.toLowerCase();for(const role of roleItems){if(!role.IsActive)continue;if(null===(_a=role.UserOrGroup)||void 0===_a?void 0:_a.some(u=>u.toLowerCase()===emailLower)){roles.push(role.Title);const rolePerms=ROLE_PERMISSIONS[role.Title]||[];allPermissions.push(...rolePerms)}}}catch(_b){console.warn("[SP] Failed to fetch roles from App_Roles list, falling back to empty roles")}return{id,displayName,email,loginName,roles,permissions:new Set(allPermissions)}}async getRoles(){performanceService.startMark("sp:getRoles");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.APP_ROLES).items();return performanceService.endMark("sp:getRoles"),items}async updateRole(id,data){return performanceService.startMark("sp:updateRole"),await this.sp.web.lists.getByTitle(LIST_NAMES.APP_ROLES).items.getById(id).update(data),performanceService.endMark("sp:updateRole"),Object.assign({id},data)}async getFeatureFlags(){performanceService.startMark("sp:getFeatureFlags");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.FEATURE_FLAGS).items();return performanceService.endMark("sp:getFeatureFlags"),items}async updateFeatureFlag(id,data){return performanceService.startMark("sp:updateFeatureFlag"),await this.sp.web.lists.getByTitle(LIST_NAMES.FEATURE_FLAGS).items.getById(id).update(data),performanceService.endMark("sp:updateFeatureFlag"),Object.assign({id},data)}async getCalendarAvailability(_emails,_startDate,_endDate){throw performanceService.startMark("sp:getCalendarAvailability"),new Error("Use GraphService directly")}async createMeeting(_meeting){throw performanceService.startMark("sp:createMeeting"),new Error("Use GraphService directly")}async getMeetings(_projectCode){return performanceService.startMark("sp:getMeetings"),performanceService.endMark("sp:getMeetings"),[]}async sendNotification(_notification){throw performanceService.startMark("sp:sendNotification"),new Error("Use PowerAutomateService directly")}async getNotifications(_projectCode){return performanceService.startMark("sp:getNotifications"),performanceService.endMark("sp:getNotifications"),[]}async logAudit(entry){performanceService.startMark("sp:logAudit"),await this.sp.web.lists.getByTitle(LIST_NAMES.AUDIT_LOG).items.add(entry),performanceService.endMark("sp:logAudit")}handleError(method,err,options){var _a;const dsError=err instanceof DataServiceError?err:new DataServiceError(method,"Operation failed",{entityType:null==options?void 0:options.entityType,entityId:null==options?void 0:options.entityId,innerError:err});if(this.logAudit({Action:enums.AuditAction.ServiceError,EntityType:dsError.entityType||enums.EntityType.Project,EntityId:dsError.entityId||"",User:(null===(_a=this._pageContextUser)||void 0===_a?void 0:_a.displayName)||"System",Details:dsError.message}).catch(()=>{}),!1!==(null==options?void 0:options.rethrow))throw dsError;return dsError}async getAuditLog(entityType,entityId,startDate,endDate){performanceService.startMark("sp:getAuditLog");let query=this.sp.web.lists.getByTitle(LIST_NAMES.AUDIT_LOG).items;const filters=[];entityType&&filters.push(`EntityType eq '${entityType}'`),entityId&&filters.push(`EntityId eq '${entityId}'`),startDate&&filters.push(`Timestamp ge datetime'${startDate}'`),endDate&&filters.push(`Timestamp le datetime'${endDate}'`),filters.length>0&&(query=query.filter(filters.join(" and ")));const items=await query.orderBy("Timestamp",!1).top(100)();return performanceService.endMark("sp:getAuditLog"),items}async purgeOldAuditEntries(_olderThanDays){throw performanceService.startMark("sp:purgeOldAuditEntries"),new Error("Not implemented â€” use Power Automate scheduled flow for production archive")}async triggerProvisioning(leadId,projectCode,projectName,requestedBy,metadata){performanceService.startMark("sp:triggerProvisioning");const col=PROVISIONING_LOG_COLUMNS,addData={[col.projectCode]:projectCode,[col.projectName]:projectName,[col.leadId]:leadId,[col.status]:"Queued",[col.currentStep]:0,[col.completedSteps]:0,[col.retryCount]:0,[col.requestedBy]:requestedBy,[col.requestedAt]:(new Date).toISOString()};(null==metadata?void 0:metadata.division)&&(addData[col.division]=metadata.division),(null==metadata?void 0:metadata.region)&&(addData[col.region]=metadata.region),(null==metadata?void 0:metadata.clientName)&&(addData[col.clientName]=metadata.clientName);const newId=(await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.add(addData)).data.Id,item=await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.getById(newId)();return performanceService.endMark("sp:triggerProvisioning"),item}async getProvisioningStatus(projectCode){performanceService.startMark("sp:getProvisioningStatus");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.filter(`ProjectCode eq '${projectCode}'`).orderBy("RequestedAt",!1).top(1)();return 0===items.length?null:(performanceService.endMark("sp:getProvisioningStatus"),items[0])}async updateProvisioningLog(projectCode,data){performanceService.startMark("sp:updateProvisioningLog");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.filter(`ProjectCode eq '${projectCode}'`).orderBy("RequestedAt",!1).top(1)();if(0===items.length)throw new Error(`Provisioning log for ${projectCode} not found`);const itemId=items[0].Id,col=PROVISIONING_LOG_COLUMNS,updateData={};void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.currentStep&&(updateData[col.currentStep]=data.currentStep),void 0!==data.completedSteps&&(updateData[col.completedSteps]=data.completedSteps),void 0!==data.failedStep&&(updateData[col.failedStep]=data.failedStep),void 0!==data.errorMessage&&(updateData[col.errorMessage]=data.errorMessage),void 0!==data.retryCount&&(updateData[col.retryCount]=data.retryCount),void 0!==data.siteUrl&&(updateData[col.siteUrl]=data.siteUrl),void 0!==data.completedAt&&(updateData[col.completedAt]=data.completedAt),void 0!==data.hubNavLinkStatus&&(updateData[col.hubNavLinkStatus]=data.hubNavLinkStatus),await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.getById(itemId).update(updateData);const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.getById(itemId)();return performanceService.endMark("sp:updateProvisioningLog"),updated}async getProvisioningLogs(){performanceService.startMark("sp:getProvisioningLogs");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.orderBy("RequestedAt",!1).top(100)();return performanceService.endMark("sp:getProvisioningLogs"),items}async retryProvisioning(projectCode,fromStep){performanceService.startMark("sp:retryProvisioning");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.filter(`ProjectCode eq '${projectCode}'`).orderBy("RequestedAt",!1).top(1)();if(0===items.length)throw new Error(`Provisioning log for ${projectCode} not found`);const itemId=items[0].Id,currentRetryCount=items[0].retryCount||0,col=PROVISIONING_LOG_COLUMNS;await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.getById(itemId).update({[col.status]:"InProgress",[col.currentStep]:fromStep,[col.failedStep]:null,[col.errorMessage]:null,[col.retryCount]:currentRetryCount+1});const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.getById(itemId)();return performanceService.endMark("sp:retryProvisioning"),updated}async createProjectSite(projectCode,projectName,siteAlias){performanceService.startMark("sp:createProjectSite");const siteUrl=`https://hedrickbrotherscom.sharepoint.com/sites/${siteAlias}`,response=await this.sp.web.fetchRaw("https://hedrickbrotherscom.sharepoint.com/_api/SPSiteManager/create",{method:"POST",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},body:JSON.stringify({request:{Title:`${projectCode} â€” ${projectName}`,Url:siteUrl,Lcid:1033,ShareByEmailEnabled:!1,Description:`HBC Project Site: ${projectCode}`,WebTemplate:"STS#3",Owner:""}})});if(!response.ok)throw new Error(`Site creation failed (${response.status}): ${response.statusText}`);return this.logAudit({Action:enums.AuditAction.SiteCreated,EntityType:enums.EntityType.Project,EntityId:projectCode,ProjectCode:projectCode,Details:`Project site created: ${siteUrl}`,User:"system"}).catch(console.error),performanceService.endMark("sp:createProjectSite"),{siteUrl}}async provisionProjectLists(siteUrl,projectCode){performanceService.startMark("sp:provisionProjectLists");const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),web=Web([this.sp.web,siteUrl]),schemas=function getProjectListSchemas(){return ALL_PROJECT_SCHEMAS}();for(let i=0;i<schemas.length;i+=5){const batch=schemas.slice(i,i+5),[batchedWeb,execute]=web.batched();for(const schema of batch)batchedWeb.lists.add(schema.listName,schema.description,schema.templateType);await execute();for(const schema of batch){const list=web.lists.getByTitle(schema.listName);for(const field of schema.fields)try{const xml=this._buildFieldXml(field);await list.fields.createFieldAsXml(xml)}catch(_a){}}}this.logAudit({Action:enums.AuditAction.SiteListsProvisioned,EntityType:enums.EntityType.Project,EntityId:projectCode,ProjectCode:projectCode,Details:`Provisioned ${schemas.length} lists on ${siteUrl}`,User:"system"}).catch(console.error),performanceService.endMark("sp:provisionProjectLists")}async associateWithHubSite(siteUrl,hubSiteUrl){performanceService.startMark("sp:associateWithHubSite");const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),hubWeb=Web([this.sp.web,hubSiteUrl]),hubSiteId=(await hubWeb.site()).Id,projectWeb=Web([this.sp.web,siteUrl]);await projectWeb.site.joinHubSite(hubSiteId),this.logAudit({Action:enums.AuditAction.SiteHubAssociated,EntityType:enums.EntityType.Project,EntityId:siteUrl,Details:`Associated ${siteUrl} with hub ${hubSiteUrl}`,User:"system"}).catch(console.error),performanceService.endMark("sp:associateWithHubSite")}async createProjectSecurityGroups(siteUrl,projectCode,_division){performanceService.startMark("sp:createProjectSecurityGroups");const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),web=Web([this.sp.web,siteUrl]),suffixes=["Owners","Members","Visitors"];for(const suffix of suffixes)try{const group=(await web.siteGroups()).find(g=>{var _a;return null===(_a=g.Title)||void 0===_a?void 0:_a.endsWith(suffix)});group&&await web.siteGroups.getById(group.Id).update({Title:`${projectCode} ${suffix}`})}catch(_a){}const activeGroups=(await this.getSecurityGroupMappings()).filter(m=>m.isActive);for(const sg of activeGroups)try{await this.inviteToProjectSiteGroup(projectCode,sg.securityGroupName,"Members")}catch(_b){}this.logAudit({Action:enums.AuditAction.SiteSecurityGroupsCreated,EntityType:enums.EntityType.Project,EntityId:projectCode,ProjectCode:projectCode,Details:`Security groups created for ${projectCode} on ${siteUrl}`,User:"system"}).catch(console.error),performanceService.endMark("sp:createProjectSecurityGroups")}async copyTemplateFiles(siteUrl,projectCode,division){performanceService.startMark("sp:copyTemplateFiles");const col=TEMPLATE_REGISTRY_COLUMNS,templates=await this.sp.web.lists.getByTitle(LIST_NAMES.TEMPLATE_REGISTRY).items.filter(`${col.Active} eq 1 and (${col.Division} eq '${division}' or ${col.Division} eq 'All')`)(),{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),projectWeb=Web([this.sp.web,siteUrl]);for(const tmpl of templates){const sourceUrl=String(tmpl[col.SourceURL]||""),targetFolder=String(tmpl[col.TargetFolder]||"Shared Documents");if(sourceUrl)try{const fileName=sourceUrl.split("/").pop()||"",fileBuffer=await this.sp.web.getFileByServerRelativePath(sourceUrl).getBuffer();await projectWeb.getFolderByServerRelativePath(targetFolder).files.addUsingPath(fileName,fileBuffer,{Overwrite:!0})}catch(err){console.warn(`[SP] Template copy failed ${sourceUrl}:`,err)}}this.logAudit({Action:enums.AuditAction.SiteTemplatesCopied,EntityType:enums.EntityType.Project,EntityId:projectCode,ProjectCode:projectCode,Details:`Copied ${templates.length} templates to ${siteUrl}`,User:"system"}).catch(console.error),performanceService.endMark("sp:copyTemplateFiles")}async copyLeadDataToProjectSite(siteUrl,leadId,projectCode){performanceService.startMark("sp:copyLeadDataToProjectSite");const lead=await this.getLeadById(leadId);if(!lead)throw new Error(`Lead ${leadId} not found`);const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),projectWeb=Web([this.sp.web,siteUrl]);await projectWeb.lists.getByTitle("Project_Info").items.add({Title:lead.Title,ProjectCode:projectCode,LeadID:leadId,ProjectSiteURL:siteUrl}),await projectWeb.lists.getByTitle("Contract_Info").items.add({projectCode,leadId}),this.logAudit({Action:enums.AuditAction.SiteLeadDataCopied,EntityType:enums.EntityType.Project,EntityId:projectCode,ProjectCode:projectCode,Details:`Lead data (ID: ${leadId}) copied to ${siteUrl}`,User:"system"}).catch(console.error),performanceService.endMark("sp:copyLeadDataToProjectSite")}async updateSiteProperties(siteUrl,properties){performanceService.startMark("sp:updateSiteProperties");const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),web=Web([this.sp.web,siteUrl]);await web.update(properties),performanceService.endMark("sp:updateSiteProperties")}async createList(siteUrl,listName,templateType,fields){performanceService.startMark("sp:createList");const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),web=Web([this.sp.web,siteUrl]);await web.lists.add(listName,"",templateType);const list=web.lists.getByTitle(listName);for(const field of fields){const xml=this._buildFieldXml(field);await list.fields.createFieldAsXml(xml),performanceService.endMark("sp:createList")}}_buildFieldXml(field){const req=field.required?' Required="TRUE"':"",idx=field.indexed?' Indexed="TRUE"':"";return`<Field Type="${field.fieldType}" DisplayName="${field.displayName}" Name="${field.internalName}"${req}${idx}/>`}async getTemplateSiteConfig(){var _a,_b,_c,_d,_e;try{const cached=cacheService.get(CACHE_KEYS_TEMPLATE_SITE_CONFIG);if(cached)return cached;const items=await this.sp.web.lists.getByTitle(HUB_LISTS.TEMPLATE_SITE_CONFIG).items.filter("Active eq 1").orderBy("ID",!1).top(1)();if(0===items.length)return null;const item=items[0],config={id:item[TEMPLATE_SITE_CONFIG_COLUMNS_id],templateSiteUrl:item[TEMPLATE_SITE_CONFIG_COLUMNS_TemplateSiteUrl],lastSnapshotHash:null!==(_a=item[TEMPLATE_SITE_CONFIG_COLUMNS_LastSnapshotHash])&&void 0!==_a?_a:"",lastSnapshotDate:null!==(_b=item[TEMPLATE_SITE_CONFIG_COLUMNS_LastSnapshotDate])&&void 0!==_b?_b:"",githubRepoOwner:null!==(_c=item[TEMPLATE_SITE_CONFIG_COLUMNS_GitHubRepoOwner])&&void 0!==_c?_c:"",githubRepoName:null!==(_d=item[TEMPLATE_SITE_CONFIG_COLUMNS_GitHubRepoName])&&void 0!==_d?_d:"",githubBranch:null!==(_e=item[TEMPLATE_SITE_CONFIG_COLUMNS_GitHubBranch])&&void 0!==_e?_e:"main",active:item[TEMPLATE_SITE_CONFIG_COLUMNS_Active]};return cacheService.set(CACHE_KEYS_TEMPLATE_SITE_CONFIG,config),config}catch(e){throw this.handleError("getTemplateSiteConfig",e,{entityType:"TemplateSiteConfig"})}}async updateTemplateSiteConfig(data){var _a,_b,_c,_d,_e;const current=await this.getTemplateSiteConfig();if(!current)throw new Error("Template_Site_Config entry not found");return await this.sp.web.lists.getByTitle(HUB_LISTS.TEMPLATE_SITE_CONFIG).items.getById(current.id).update({[TEMPLATE_SITE_CONFIG_COLUMNS_LastSnapshotHash]:null!==(_a=data.lastSnapshotHash)&&void 0!==_a?_a:current.lastSnapshotHash,[TEMPLATE_SITE_CONFIG_COLUMNS_LastSnapshotDate]:null!==(_b=data.lastSnapshotDate)&&void 0!==_b?_b:current.lastSnapshotDate,[TEMPLATE_SITE_CONFIG_COLUMNS_Active]:null!==(_c=data.active)&&void 0!==_c?_c:current.active}),cacheService.remove(CACHE_KEYS_TEMPLATE_SITE_CONFIG),this.logAudit({Action:enums.AuditAction.TemplateSiteConfigUpdated,EntityType:enums.EntityType.TemplateSiteConfig,EntityId:String(current.id),User:null!==(_e=null===(_d=this._pageContextUser)||void 0===_d?void 0:_d.email)&&void 0!==_e?_e:"unknown",Details:"Template site config updated"}).catch(console.error),Object.assign(Object.assign({},current),data)}async getCommittedTemplateRegistry(){var _a,_b,_c;try{const cached=cacheService.get(CACHE_KEYS_TEMPLATE_REGISTRY);if(cached)return cached;const config=await this.getTemplateSiteConfig(),owner=null!==(_a=null==config?void 0:config.githubRepoOwner)&&void 0!==_a?_a:"RMF112018",repo=null!==(_b=null==config?void 0:config.githubRepoName)&&void 0!==_b?_b:"Project-Controls",url=`https://raw.githubusercontent.com/${owner}/${repo}/${null!==(_c=null==config?void 0:config.githubBranch)&&void 0!==_c?_c:"main"}/templates/template-registry.json`,resp=await fetch(url);if(!resp.ok)throw new Error(`Failed to fetch template registry: HTTP ${resp.status}`);const registry=await resp.json();return cacheService.set(CACHE_KEYS_TEMPLATE_REGISTRY,registry,3e5),registry}catch(e){throw this.handleError("getCommittedTemplateRegistry",e,{entityType:"TemplateRegistry"})}}async getTemplateSiteFiles(){var _a;try{const config=await this.getTemplateSiteConfig();if(!config)return[];const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),templateWeb=Web([this.sp.web,config.templateSiteUrl]),templateSiteRelUrl=new URL(config.templateSiteUrl).pathname,folders=await templateWeb.getFolderByServerRelativePath(templateSiteRelUrl+"/Shared Documents").folders(),results=[];for(const folder of folders){const files=await templateWeb.getFolderByServerRelativePath(folder.ServerRelativeUrl).files();for(const file of files){const buf=await templateWeb.getFileByServerRelativePath(file.ServerRelativeUrl).getBuffer(),fileHash=`sha256:${await computeSha256Hex(buf)}`;results.push({sourcePath:file.ServerRelativeUrl,fileName:file.Name,fileHash,fileSize:null!==(_a=file.Length)&&void 0!==_a?_a:0,lastModified:file.TimeLastModified,division:"Both"})}}return results}catch(e){throw this.handleError("getTemplateSiteFiles",e,{entityType:"TemplateRegistry"})}}async applyGitOpsTemplates(siteUrl,division,registry){var _a,_b;const applicable=registry.templates.filter(t=>t.active&&("Both"===t.division||t.division===division));let appliedCount=0;const config=await this.getTemplateSiteConfig();if(!config)throw new Error("Template_Site_Config not found â€” cannot apply GitOps templates");const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js");for(const entry of applicable)try{const buf=await Web([this.sp.web,config.templateSiteUrl]).getFileByServerRelativePath(entry.sourcePath).getBuffer();await Web([this.sp.web,siteUrl]).getFolderByServerRelativePath(entry.targetFolder).files.addUsingPath(entry.fileName,buf,{Overwrite:!0}),appliedCount++}catch(err){console.warn(`[GitOps] Failed to copy ${entry.fileName}:`,err)}return this.logAudit({Action:enums.AuditAction.TemplateAppliedFromGitOps,EntityType:enums.EntityType.TemplateRegistry,EntityId:siteUrl,User:null!==(_b=null===(_a=this._pageContextUser)||void 0===_a?void 0:_a.email)&&void 0!==_b?_b:"unknown",Details:`Applied ${appliedCount}/${applicable.length} templates to ${siteUrl} (division: ${division})`}).catch(console.error),{appliedCount}}async logTemplateSyncPR(entry){var _a,_b,_c,_d,_e,_f;const created=await this.sp.web.lists.getByTitle(HUB_LISTS.TEMPLATE_MANIFEST_LOG).items.add({[TEMPLATE_MANIFEST_LOG_COLUMNS_SyncDate]:entry.syncDate,[TEMPLATE_MANIFEST_LOG_COLUMNS_TriggeredBy]:entry.triggeredBy,[TEMPLATE_MANIFEST_LOG_COLUMNS_DiffSummary]:JSON.stringify(entry.diffSummary),[TEMPLATE_MANIFEST_LOG_COLUMNS_PRNumber]:entry.prNumber,[TEMPLATE_MANIFEST_LOG_COLUMNS_PRUrl]:entry.prUrl,[TEMPLATE_MANIFEST_LOG_COLUMNS_Status]:entry.status});return this.logAudit({Action:enums.AuditAction.TemplateSyncPRCreated,EntityType:enums.EntityType.TemplateRegistry,EntityId:String(null!==(_b=null===(_a=created.data)||void 0===_a?void 0:_a.ID)&&void 0!==_b?_b:0),User:null!==(_d=null===(_c=this._pageContextUser)||void 0===_c?void 0:_c.email)&&void 0!==_d?_d:"unknown",Details:`Template sync PR #${entry.prNumber} logged`}).catch(console.error),Object.assign({id:null!==(_f=null===(_e=created.data)||void 0===_e?void 0:_e.ID)&&void 0!==_f?_f:0},entry)}async getTeamMembers(_projectCode){performanceService.startMark("sp:getTeamMembers");const items=await this.sp.web.lists.getByTitle("Team_Members").items.filter(`ProjectCode eq '${_projectCode}'`)();return performanceService.endMark("sp:getTeamMembers"),items}async getDeliverables(_projectCode){performanceService.startMark("sp:getDeliverables");const items=await this.sp.web.lists.getByTitle("Deliverables").items.filter(`ProjectCode eq '${_projectCode}'`)();return performanceService.endMark("sp:getDeliverables"),items}async createDeliverable(data){performanceService.startMark("sp:createDeliverable");const result=await this.sp.web.lists.getByTitle("Deliverables").items.add(data);return performanceService.endMark("sp:createDeliverable"),result}async updateDeliverable(id,data){return performanceService.startMark("sp:updateDeliverable"),await this.sp.web.lists.getByTitle("Deliverables").items.getById(id).update(data),performanceService.endMark("sp:updateDeliverable"),Object.assign({id},data)}async getInterviewPrep(_leadId){performanceService.startMark("sp:getInterviewPrep");const items=await this.sp.web.lists.getByTitle("Interview_Prep").items.filter(`LeadID eq ${_leadId}`)();return performanceService.endMark("sp:getInterviewPrep"),items.length>0?items[0]:null}async saveInterviewPrep(data){performanceService.startMark("sp:saveInterviewPrep");const result=await this.sp.web.lists.getByTitle("Interview_Prep").items.add(data);return performanceService.endMark("sp:saveInterviewPrep"),result}async getContractInfo(_projectCode){performanceService.startMark("sp:getContractInfo");const items=await this.sp.web.lists.getByTitle("Contract_Info").items.filter(`ProjectCode eq '${_projectCode}'`)();return performanceService.endMark("sp:getContractInfo"),items.length>0?items[0]:null}async saveContractInfo(data){performanceService.startMark("sp:saveContractInfo");const result=await this.sp.web.lists.getByTitle("Contract_Info").items.add(data);return performanceService.endMark("sp:saveContractInfo"),result}async getTurnoverItems(_projectCode){performanceService.startMark("sp:getTurnoverItems");const items=await this.sp.web.lists.getByTitle("Turnover_Items").items.filter(`ProjectCode eq '${_projectCode}'`)();return performanceService.endMark("sp:getTurnoverItems"),items}async updateTurnoverItem(id,data){return performanceService.startMark("sp:updateTurnoverItem"),await this.sp.web.lists.getByTitle("Turnover_Items").items.getById(id).update(data),performanceService.endMark("sp:updateTurnoverItem"),Object.assign({id},data)}async getCloseoutItems(_projectCode){performanceService.startMark("sp:getCloseoutItems");const web=this._getProjectWeb(),col=CLOSEOUT_ITEMS_COLUMNS,result=(await web.lists.getByTitle("Closeout_Items").items.filter(`${col.projectCode} eq '${_projectCode}' and ${col.isHidden} ne 1`).orderBy(col.sortOrder,!0).top(500)()).map(item=>this.mapToCloseoutItem(item));return performanceService.endMark("sp:getCloseoutItems"),result}async updateCloseoutItem(id,data){performanceService.startMark("sp:updateCloseoutItem");const web=this._getProjectWeb(),col=CLOSEOUT_ITEMS_COLUMNS,updateData={};void 0!==data.response&&(updateData[col.response]=data.response),void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.respondedBy&&(updateData[col.respondedBy]=data.respondedBy),void 0!==data.respondedDate&&(updateData[col.respondedDate]=data.respondedDate),void 0!==data.comment&&(updateData[col.comment]=data.comment),void 0!==data.isHidden&&(updateData[col.isHidden]=data.isHidden),void 0!==data.label&&(updateData[col.label]=data.label),void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),void 0!==data.dateValue&&(updateData[col.dateValue]=data.dateValue),void 0!==data.details&&(updateData[col.details]=data.details),void 0!==data.assignedTo&&(updateData[col.assignedTo]=data.assignedTo),void 0!==data.notes&&(updateData[col.notes]=data.notes),await web.lists.getByTitle("Closeout_Items").items.getById(id).update(updateData);const updated=await web.lists.getByTitle("Closeout_Items").items.getById(id)();return performanceService.endMark("sp:updateCloseoutItem"),this.mapToCloseoutItem(updated)}async addCloseoutItem(projectCode,item){var _a,_b,_c,_d,_e;performanceService.startMark("sp:addCloseoutItem");const web=this._getProjectWeb(),col=CLOSEOUT_ITEMS_COLUMNS,addData={[col.projectCode]:projectCode,[col.sectionNumber]:item.sectionNumber||0,[col.sectionName]:item.sectionName||"",[col.itemNumber]:item.itemNumber||"",[col.label]:item.label||"",[col.category]:item.sectionName||item.category||"",[col.description]:item.label||item.description||"",[col.responseType]:item.responseType||"yesNoNA",[col.response]:null!==(_a=item.response)&&void 0!==_a?_a:null,[col.status]:item.status||"NoResponse",[col.assignedTo]:item.assignedTo||"",[col.comment]:item.comment||null,[col.isHidden]:item.isHidden||!1,[col.isCustom]:!0,[col.sortOrder]:item.sortOrder||0,[col.dateValue]:null!==(_b=item.dateValue)&&void 0!==_b?_b:null,[col.calculatedFrom]:null!==(_c=item.calculatedFrom)&&void 0!==_c?_c:null,[col.placeholder]:null!==(_d=item.placeholder)&&void 0!==_d?_d:null,[col.details]:null!==(_e=item.details)&&void 0!==_e?_e:null},spResult=await web.lists.getByTitle("Closeout_Items").items.add(addData);return performanceService.endMark("sp:addCloseoutItem"),this.mapToCloseoutItem(spResult)}async removeCloseoutItem(_projectCode,itemId){performanceService.startMark("sp:removeCloseoutItem");const web=this._getProjectWeb();await web.lists.getByTitle("Closeout_Items").items.getById(itemId).recycle(),performanceService.endMark("sp:removeCloseoutItem")}async getLossAutopsy(_leadId){performanceService.startMark("sp:getLossAutopsy");const items=await this.sp.web.lists.getByTitle("Loss_Autopsy").items.filter(`LeadID eq ${_leadId}`)();return performanceService.endMark("sp:getLossAutopsy"),items.length>0?items[0]:null}async saveLossAutopsy(data){performanceService.startMark("sp:saveLossAutopsy");const result=await this.sp.web.lists.getByTitle("Loss_Autopsy").items.add(data);return performanceService.endMark("sp:saveLossAutopsy"),result}async finalizeLossAutopsy(leadId,data){performanceService.startMark("sp:finalizeLossAutopsy");const items=await this.sp.web.lists.getByTitle("Loss_Autopsy").items.filter(`LeadID eq ${leadId}`)();if(0===items.length)throw new Error(`No autopsy found for lead ${leadId}`);return await this.sp.web.lists.getByTitle("Loss_Autopsy").items.getById(items[0].Id).update(Object.assign(Object.assign({},data),{isFinalized:!0,finalizedDate:(new Date).toISOString()})),performanceService.endMark("sp:finalizeLossAutopsy"),Object.assign(Object.assign(Object.assign({},items[0]),data),{isFinalized:!0})}async isAutopsyFinalized(leadId){performanceService.startMark("sp:isAutopsyFinalized");const items=await this.sp.web.lists.getByTitle("Loss_Autopsy").items.filter(`LeadID eq ${leadId} and isFinalized eq 1`)();return performanceService.endMark("sp:isAutopsyFinalized"),items.length>0}async getAllLossAutopsies(){return performanceService.startMark("sp:getAllLossAutopsies"),performanceService.endMark("sp:getAllLossAutopsies"),await this.sp.web.lists.getByTitle("Loss_Autopsy").items()}async getAppContextConfig(siteUrl){performanceService.startMark("sp:getAppContextConfig");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.filter(`SiteURL eq '${siteUrl}'`)();return performanceService.endMark("sp:getAppContextConfig"),0===items.length?null:{RenderMode:items[0].RenderMode,AppTitle:items[0].AppTitle,VisibleModules:JSON.parse(items[0].VisibleModules||"[]")}}async getTemplates(){performanceService.startMark("sp:getTemplates");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.TEMPLATE_REGISTRY).items();return performanceService.endMark("sp:getTemplates"),items.map(i=>({TemplateName:String(i.TemplateName||""),SourceURL:String(i.SourceURL||""),TargetFolder:String(i.TargetFolder||""),Division:String(i.Division||""),Active:Boolean(i.Active)}))}async getRegions(){performanceService.startMark("sp:getRegions");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.REGIONS).items.select("Title")();return performanceService.endMark("sp:getRegions"),items.map(i=>String(i.Title||""))}async getSectors(){performanceService.startMark("sp:getSectors");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.SECTORS).items.select("Title")();return performanceService.endMark("sp:getSectors"),items.map(i=>String(i.Title||""))}async getStartupChecklist(projectCode){performanceService.startMark("sp:getStartupChecklist");const web=this._getProjectWeb(),col=STARTUP_CHECKLIST_COLUMNS,actCol=CHECKLIST_ACTIVITY_LOG_COLUMNS,[items,activityItems]=await Promise.all([web.lists.getByTitle(LIST_NAMES.STARTUP_CHECKLIST).items.filter(`${col.projectCode} eq '${projectCode}'`).orderBy(col.sortOrder,!0).top(500)(),web.lists.getByTitle(LIST_NAMES.CHECKLIST_ACTIVITY_LOG).items.filter(`${actCol.projectCode} eq '${projectCode}'`).top(5e3)()]),activityMap=new Map;for(const a of activityItems){const entry=this.mapToChecklistActivityEntry(a),key=entry.checklistItemId||0;activityMap.has(key)||activityMap.set(key,[]),activityMap.get(key).push(entry)}const result=items.map(item=>this.mapToStartupChecklistItem(item,activityMap.get(item.Id)));return performanceService.endMark("sp:getStartupChecklist"),result}async updateChecklistItem(projectCode,itemId,data){performanceService.startMark("sp:updateChecklistItem");const web=this._getProjectWeb(),col=STARTUP_CHECKLIST_COLUMNS,updateData={};if(void 0!==data.response&&(updateData[col.response]=data.response),void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.respondedBy&&(updateData[col.respondedBy]=data.respondedBy),void 0!==data.respondedDate&&(updateData[col.respondedDate]=data.respondedDate),void 0!==data.assignedTo&&(updateData[col.assignedTo]=data.assignedTo),void 0!==data.assignedToName&&(updateData[col.assignedToName]=data.assignedToName),void 0!==data.comment&&(updateData[col.comment]=data.comment),void 0!==data.isHidden&&(updateData[col.isHidden]=data.isHidden),void 0!==data.label&&(updateData[col.label]=data.label),void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),void 0!==data.hbShare&&(updateData[col.hbShare]=data.hbShare),void 0!==data.amount&&(updateData[col.amount]=data.amount),void 0!==data.period&&(updateData[col.period]=data.period),void 0!==data.dateValue&&(updateData[col.dateValue]=data.dateValue),void 0!==data.details&&(updateData[col.details]=data.details),void 0!==data.placeholder&&(updateData[col.placeholder]=data.placeholder),await web.lists.getByTitle(LIST_NAMES.STARTUP_CHECKLIST).items.getById(itemId).update(updateData),data.activityLog&&data.activityLog.length>0){const actCol=CHECKLIST_ACTIVITY_LOG_COLUMNS,latestEntry=data.activityLog[data.activityLog.length-1];await web.lists.getByTitle(LIST_NAMES.CHECKLIST_ACTIVITY_LOG).items.add({[actCol.checklistItemId]:itemId,[actCol.projectCode]:projectCode,[actCol.timestamp]:latestEntry.timestamp,[actCol.user]:latestEntry.user,[actCol.previousValue]:latestEntry.previousValue,[actCol.newValue]:latestEntry.newValue,[actCol.comment]:latestEntry.comment||null})}const updated=await web.lists.getByTitle(LIST_NAMES.STARTUP_CHECKLIST).items.getById(itemId)(),actItems=await web.lists.getByTitle(LIST_NAMES.CHECKLIST_ACTIVITY_LOG).items.filter(`${CHECKLIST_ACTIVITY_LOG_COLUMNS.checklistItemId} eq ${itemId}`)(),mapped=this.mapToStartupChecklistItem(updated,actItems.map(a=>this.mapToChecklistActivityEntry(a)));return performanceService.endMark("sp:updateChecklistItem"),mapped}async addChecklistItem(projectCode,item){var _a,_b,_c,_d,_e,_f,_g,_h,_j;performanceService.startMark("sp:addChecklistItem");const web=this._getProjectWeb(),col=STARTUP_CHECKLIST_COLUMNS,addData={[col.projectCode]:projectCode,[col.sectionNumber]:item.sectionNumber||0,[col.sectionName]:item.sectionName||"",[col.itemNumber]:item.itemNumber||"",[col.label]:item.label||"",[col.responseType]:item.responseType||"yesNoNA",[col.response]:null!==(_a=item.response)&&void 0!==_a?_a:null,[col.status]:item.status||"NoResponse",[col.respondedBy]:item.respondedBy||null,[col.respondedDate]:item.respondedDate||null,[col.assignedTo]:item.assignedTo||null,[col.assignedToName]:item.assignedToName||null,[col.comment]:item.comment||null,[col.isHidden]:item.isHidden||!1,[col.isCustom]:null===(_b=item.isCustom)||void 0===_b||_b,[col.sortOrder]:item.sortOrder||0,[col.hbShare]:null!==(_c=item.hbShare)&&void 0!==_c?_c:null,[col.amount]:null!==(_d=item.amount)&&void 0!==_d?_d:null,[col.period]:null!==(_e=item.period)&&void 0!==_e?_e:null,[col.dateValue]:null!==(_f=item.dateValue)&&void 0!==_f?_f:null,[col.calculatedFrom]:null!==(_g=item.calculatedFrom)&&void 0!==_g?_g:null,[col.placeholder]:null!==(_h=item.placeholder)&&void 0!==_h?_h:null,[col.details]:null!==(_j=item.details)&&void 0!==_j?_j:null},spResult=await web.lists.getByTitle(LIST_NAMES.STARTUP_CHECKLIST).items.add(addData);return performanceService.endMark("sp:addChecklistItem"),this.mapToStartupChecklistItem(spResult,[])}async removeChecklistItem(_projectCode,itemId){performanceService.startMark("sp:removeChecklistItem");const web=this._getProjectWeb();await web.lists.getByTitle(LIST_NAMES.STARTUP_CHECKLIST).items.getById(itemId).recycle(),performanceService.endMark("sp:removeChecklistItem")}async getInternalMatrix(projectCode){performanceService.startMark("sp:getInternalMatrix");const web=this._getProjectWeb(),col=INTERNAL_MATRIX_COLUMNS,items=await web.lists.getByTitle(LIST_NAMES.INTERNAL_MATRIX).items.filter(`${col.projectCode} eq '${projectCode}'`).orderBy(col.sortOrder,!0).top(500)();return performanceService.endMark("sp:getInternalMatrix"),items.map(item=>this.mapToInternalMatrixTask(item))}async updateInternalMatrixTask(projectCode,taskId,data){performanceService.startMark("sp:updateInternalMatrixTask");const web=this._getProjectWeb(),col=INTERNAL_MATRIX_COLUMNS,updateData={};void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),void 0!==data.taskCategory&&(updateData[col.taskCategory]=data.taskCategory),void 0!==data.taskDescription&&(updateData[col.taskDescription]=data.taskDescription),void 0!==data.PX&&(updateData[col.PX]=data.PX),void 0!==data.SrPM&&(updateData[col.SrPM]=data.SrPM),void 0!==data.PM2&&(updateData[col.PM2]=data.PM2),void 0!==data.PM1&&(updateData[col.PM1]=data.PM1),void 0!==data.PA&&(updateData[col.PA]=data.PA),void 0!==data.QAQC&&(updateData[col.QAQC]=data.QAQC),void 0!==data.ProjAcct&&(updateData[col.ProjAcct]=data.ProjAcct),void 0!==data.isHidden&&(updateData[col.isHidden]=data.isHidden),void 0!==data.isCustom&&(updateData[col.isCustom]=data.isCustom),await web.lists.getByTitle(LIST_NAMES.INTERNAL_MATRIX).items.getById(taskId).update(updateData);const updated=await web.lists.getByTitle(LIST_NAMES.INTERNAL_MATRIX).items.getById(taskId)();return performanceService.endMark("sp:updateInternalMatrixTask"),this.mapToInternalMatrixTask(updated)}async addInternalMatrixTask(projectCode,task){var _a;performanceService.startMark("sp:addInternalMatrixTask");const web=this._getProjectWeb(),col=INTERNAL_MATRIX_COLUMNS,addData={[col.projectCode]:projectCode,[col.sortOrder]:task.sortOrder||0,[col.taskCategory]:task.taskCategory||"",[col.taskDescription]:task.taskDescription||"",[col.PX]:task.PX||"",[col.SrPM]:task.SrPM||"",[col.PM2]:task.PM2||"",[col.PM1]:task.PM1||"",[col.PA]:task.PA||"",[col.QAQC]:task.QAQC||"",[col.ProjAcct]:task.ProjAcct||"",[col.isHidden]:task.isHidden||!1,[col.isCustom]:null===(_a=task.isCustom)||void 0===_a||_a},result=await web.lists.getByTitle(LIST_NAMES.INTERNAL_MATRIX).items.add(addData);return performanceService.endMark("sp:addInternalMatrixTask"),this.mapToInternalMatrixTask(result)}async removeInternalMatrixTask(_projectCode,taskId){performanceService.startMark("sp:removeInternalMatrixTask");const web=this._getProjectWeb();await web.lists.getByTitle(LIST_NAMES.INTERNAL_MATRIX).items.getById(taskId).recycle(),performanceService.endMark("sp:removeInternalMatrixTask")}async getTeamRoleAssignments(projectCode){performanceService.startMark("sp:getTeamRoleAssignments");const web=this._getProjectWeb(),col=TEAM_ROLE_ASSIGNMENTS_COLUMNS,items=await web.lists.getByTitle(LIST_NAMES.TEAM_ROLE_ASSIGNMENTS).items.filter(`${col.projectCode} eq '${projectCode}'`).top(100)();return performanceService.endMark("sp:getTeamRoleAssignments"),items.map(item=>({projectCode:item[col.projectCode]||"",roleAbbreviation:item[col.roleAbbreviation]||"",assignedPerson:item[col.assignedPerson]||"",assignedPersonEmail:item[col.assignedPersonEmail]||""}))}async updateTeamRoleAssignment(projectCode,role,person,email){performanceService.startMark("sp:updateTeamRoleAssignment");const web=this._getProjectWeb(),col=TEAM_ROLE_ASSIGNMENTS_COLUMNS,listTitle=LIST_NAMES.TEAM_ROLE_ASSIGNMENTS,existing=await web.lists.getByTitle(listTitle).items.filter(`${col.projectCode} eq '${projectCode}' and ${col.roleAbbreviation} eq '${role}'`).top(1)();if(existing.length>0){const itemId=existing[0].Id;await web.lists.getByTitle(listTitle).items.getById(itemId).update({[col.assignedPerson]:person,[col.assignedPersonEmail]:email||""})}else await web.lists.getByTitle(listTitle).items.add({[col.projectCode]:projectCode,[col.roleAbbreviation]:role,[col.assignedPerson]:person,[col.assignedPersonEmail]:email||""});return performanceService.endMark("sp:updateTeamRoleAssignment"),{projectCode,roleAbbreviation:role,assignedPerson:person,assignedPersonEmail:email||""}}async getOwnerContractMatrix(projectCode){performanceService.startMark("sp:getOwnerContractMatrix");const web=this._getProjectWeb(),col=OWNER_CONTRACT_MATRIX_COLUMNS,items=await web.lists.getByTitle(LIST_NAMES.OWNER_CONTRACT_MATRIX).items.filter(`${col.projectCode} eq '${projectCode}'`).orderBy(col.sortOrder,!0).top(500)();return performanceService.endMark("sp:getOwnerContractMatrix"),items.map(item=>this.mapToOwnerContractArticle(item))}async updateOwnerContractArticle(projectCode,itemId,data){performanceService.startMark("sp:updateOwnerContractArticle");const web=this._getProjectWeb(),col=OWNER_CONTRACT_MATRIX_COLUMNS,updateData={};void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),void 0!==data.articleNumber&&(updateData[col.articleNumber]=data.articleNumber),void 0!==data.pageNumber&&(updateData[col.pageNumber]=data.pageNumber),void 0!==data.responsibleParty&&(updateData[col.responsibleParty]=data.responsibleParty),void 0!==data.description&&(updateData[col.description]=data.description),void 0!==data.isHidden&&(updateData[col.isHidden]=data.isHidden),void 0!==data.isCustom&&(updateData[col.isCustom]=data.isCustom),await web.lists.getByTitle(LIST_NAMES.OWNER_CONTRACT_MATRIX).items.getById(itemId).update(updateData);const updated=await web.lists.getByTitle(LIST_NAMES.OWNER_CONTRACT_MATRIX).items.getById(itemId)();return performanceService.endMark("sp:updateOwnerContractArticle"),this.mapToOwnerContractArticle(updated)}async addOwnerContractArticle(projectCode,item){var _a;performanceService.startMark("sp:addOwnerContractArticle");const web=this._getProjectWeb(),col=OWNER_CONTRACT_MATRIX_COLUMNS,addData={[col.projectCode]:projectCode,[col.sortOrder]:item.sortOrder||0,[col.articleNumber]:item.articleNumber||"",[col.pageNumber]:item.pageNumber||"",[col.responsibleParty]:item.responsibleParty||"",[col.description]:item.description||"",[col.isHidden]:item.isHidden||!1,[col.isCustom]:null===(_a=item.isCustom)||void 0===_a||_a},result=await web.lists.getByTitle(LIST_NAMES.OWNER_CONTRACT_MATRIX).items.add(addData);return performanceService.endMark("sp:addOwnerContractArticle"),this.mapToOwnerContractArticle(result)}async removeOwnerContractArticle(_projectCode,itemId){performanceService.startMark("sp:removeOwnerContractArticle");const web=this._getProjectWeb();await web.lists.getByTitle(LIST_NAMES.OWNER_CONTRACT_MATRIX).items.getById(itemId).recycle(),performanceService.endMark("sp:removeOwnerContractArticle")}async getSubContractMatrix(projectCode){performanceService.startMark("sp:getSubContractMatrix");const web=this._getProjectWeb(),col=SUB_CONTRACT_MATRIX_COLUMNS,items=await web.lists.getByTitle(LIST_NAMES.SUB_CONTRACT_MATRIX).items.filter(`${col.projectCode} eq '${projectCode}'`).orderBy(col.sortOrder,!0).top(500)();return performanceService.endMark("sp:getSubContractMatrix"),items.map(item=>this.mapToSubContractClause(item))}async updateSubContractClause(projectCode,itemId,data){performanceService.startMark("sp:updateSubContractClause");const web=this._getProjectWeb(),col=SUB_CONTRACT_MATRIX_COLUMNS,updateData={};void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),void 0!==data.refNumber&&(updateData[col.refNumber]=data.refNumber),void 0!==data.pageNumber&&(updateData[col.pageNumber]=data.pageNumber),void 0!==data.clauseDescription&&(updateData[col.clauseDescription]=data.clauseDescription),void 0!==data.ProjExec&&(updateData[col.ProjExec]=data.ProjExec),void 0!==data.ProjMgr&&(updateData[col.ProjMgr]=data.ProjMgr),void 0!==data.AsstPM&&(updateData[col.AsstPM]=data.AsstPM),void 0!==data.Super&&(updateData[col.Super]=data.Super),void 0!==data.ProjAdmin&&(updateData[col.ProjAdmin]=data.ProjAdmin),void 0!==data.isHidden&&(updateData[col.isHidden]=data.isHidden),void 0!==data.isCustom&&(updateData[col.isCustom]=data.isCustom),await web.lists.getByTitle(LIST_NAMES.SUB_CONTRACT_MATRIX).items.getById(itemId).update(updateData);const updated=await web.lists.getByTitle(LIST_NAMES.SUB_CONTRACT_MATRIX).items.getById(itemId)();return performanceService.endMark("sp:updateSubContractClause"),this.mapToSubContractClause(updated)}async addSubContractClause(projectCode,item){var _a;performanceService.startMark("sp:addSubContractClause");const web=this._getProjectWeb(),col=SUB_CONTRACT_MATRIX_COLUMNS,addData={[col.projectCode]:projectCode,[col.sortOrder]:item.sortOrder||0,[col.refNumber]:item.refNumber||"",[col.pageNumber]:item.pageNumber||"",[col.clauseDescription]:item.clauseDescription||"",[col.ProjExec]:item.ProjExec||"",[col.ProjMgr]:item.ProjMgr||"",[col.AsstPM]:item.AsstPM||"",[col.Super]:item.Super||"",[col.ProjAdmin]:item.ProjAdmin||"",[col.isHidden]:item.isHidden||!1,[col.isCustom]:null===(_a=item.isCustom)||void 0===_a||_a},result=await web.lists.getByTitle(LIST_NAMES.SUB_CONTRACT_MATRIX).items.add(addData);return performanceService.endMark("sp:addSubContractClause"),this.mapToSubContractClause(result)}async removeSubContractClause(_projectCode,itemId){performanceService.startMark("sp:removeSubContractClause");const web=this._getProjectWeb();await web.lists.getByTitle(LIST_NAMES.SUB_CONTRACT_MATRIX).items.getById(itemId).recycle(),performanceService.endMark("sp:removeSubContractClause")}async getMarketingProjectRecord(projectCode){performanceService.startMark("sp:getMarketingProjectRecord");const col=MARKETING_PROJECT_RECORDS_COLUMNS;try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.MARKETING_PROJECT_RECORDS).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();return 0===items.length?null:this.mapToMarketingProjectRecord(items[0])}catch(_a){return performanceService.endMark("sp:getMarketingProjectRecord"),null}}async createMarketingProjectRecord(data){performanceService.startMark("sp:createMarketingProjectRecord");const addData=this.buildMarketingUpdateData(data),result=await this.sp.web.lists.getByTitle(LIST_NAMES.MARKETING_PROJECT_RECORDS).items.add(addData);return performanceService.endMark("sp:createMarketingProjectRecord"),this.mapToMarketingProjectRecord(result)}async updateMarketingProjectRecord(projectCode,data){performanceService.startMark("sp:updateMarketingProjectRecord");const col=MARKETING_PROJECT_RECORDS_COLUMNS,items=await this.sp.web.lists.getByTitle(LIST_NAMES.MARKETING_PROJECT_RECORDS).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===items.length)throw new Error(`Marketing project record not found for projectCode: ${projectCode}`);const itemId=items[0].Id,updateData=this.buildMarketingUpdateData(data);await this.sp.web.lists.getByTitle(LIST_NAMES.MARKETING_PROJECT_RECORDS).items.getById(itemId).update(updateData);const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.MARKETING_PROJECT_RECORDS).items.getById(itemId)();return performanceService.endMark("sp:updateMarketingProjectRecord"),this.mapToMarketingProjectRecord(updated)}async getAllMarketingProjectRecords(){performanceService.startMark("sp:getAllMarketingProjectRecords");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.MARKETING_PROJECT_RECORDS).items.top(500)();return performanceService.endMark("sp:getAllMarketingProjectRecords"),items.map(item=>this.mapToMarketingProjectRecord(item))}async getRiskCostManagement(projectCode){performanceService.startMark("sp:getRiskCostManagement");const web=this._getProjectWeb(),col=RISK_COST_MANAGEMENT_COLUMNS,itemCol=RISK_COST_ITEMS_COLUMNS,[parents,items]=await Promise.all([web.lists.getByTitle(LIST_NAMES.RISK_COST_MANAGEMENT).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)(),web.lists.getByTitle(LIST_NAMES.RISK_COST_ITEMS).items.filter(`${itemCol.projectCode} eq '${projectCode}'`).top(500)()]);if(0===parents.length)return null;const parent=this.mapToRiskCostManagement(parents[0]),mappedItems=items.map(i=>this.mapToRiskCostItem(i));return performanceService.endMark("sp:getRiskCostManagement"),Object.assign(Object.assign({},parent),{buyoutOpportunities:mappedItems.filter(i=>"Buyout"===i.category),potentialRisks:mappedItems.filter(i=>"Risk"===i.category),potentialSavings:mappedItems.filter(i=>"Savings"===i.category)})}async updateRiskCostManagement(projectCode,data){performanceService.startMark("sp:updateRiskCostManagement");const web=this._getProjectWeb(),col=RISK_COST_MANAGEMENT_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.RISK_COST_MANAGEMENT).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===parents.length)throw new Error(`Risk/Cost record for ${projectCode} not found`);const updateData={};void 0!==data.contractType&&(updateData[col.contractType]=data.contractType),void 0!==data.contractAmount&&(updateData[col.contractAmount]=data.contractAmount),void 0!==data.lastUpdatedBy&&(updateData[col.lastUpdatedBy]=data.lastUpdatedBy),updateData[col.lastUpdatedAt]=(new Date).toISOString();const itemId=parents[0].Id;return await web.lists.getByTitle(LIST_NAMES.RISK_COST_MANAGEMENT).items.getById(itemId).update(updateData),performanceService.endMark("sp:updateRiskCostManagement"),await this.getRiskCostManagement(projectCode)}async addRiskCostItem(projectCode,item){var _a,_b,_c,_d,_e,_f;performanceService.startMark("sp:addRiskCostItem");const web=this._getProjectWeb(),col=RISK_COST_ITEMS_COLUMNS,parentCol=RISK_COST_MANAGEMENT_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.RISK_COST_MANAGEMENT).items.filter(`${parentCol.projectCode} eq '${projectCode}'`).top(1)(),riskCostId=parents.length>0?parents[0].Id:void 0,now=(new Date).toISOString(),addData={[col.projectCode]:projectCode,[col.riskCostId]:riskCostId,[col.category]:null!==(_a=item.category)&&void 0!==_a?_a:"Risk",[col.letter]:null!==(_b=item.letter)&&void 0!==_b?_b:"",[col.description]:null!==(_c=item.description)&&void 0!==_c?_c:"",[col.estimatedValue]:null!==(_d=item.estimatedValue)&&void 0!==_d?_d:0,[col.status]:null!==(_e=item.status)&&void 0!==_e?_e:"Open",[col.notes]:null!==(_f=item.notes)&&void 0!==_f?_f:"",[col.createdDate]:now,[col.updatedDate]:now},result=await web.lists.getByTitle(LIST_NAMES.RISK_COST_ITEMS).items.add(addData);return performanceService.endMark("sp:addRiskCostItem"),this.mapToRiskCostItem(result.data)}async updateRiskCostItem(projectCode,itemId,data){performanceService.startMark("sp:updateRiskCostItem");const web=this._getProjectWeb(),col=RISK_COST_ITEMS_COLUMNS,updateData={};void 0!==data.category&&(updateData[col.category]=data.category),void 0!==data.letter&&(updateData[col.letter]=data.letter),void 0!==data.description&&(updateData[col.description]=data.description),void 0!==data.estimatedValue&&(updateData[col.estimatedValue]=data.estimatedValue),void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.notes&&(updateData[col.notes]=data.notes),updateData[col.updatedDate]=(new Date).toISOString(),await web.lists.getByTitle(LIST_NAMES.RISK_COST_ITEMS).items.getById(itemId).update(updateData);const updated=await web.lists.getByTitle(LIST_NAMES.RISK_COST_ITEMS).items.getById(itemId)();return performanceService.endMark("sp:updateRiskCostItem"),this.mapToRiskCostItem(updated)}async getQualityConcerns(projectCode){performanceService.startMark("sp:getQualityConcerns");const web=this._getProjectWeb(),col=QUALITY_CONCERNS_COLUMNS,items=await web.lists.getByTitle(LIST_NAMES.QUALITY_CONCERNS).items.filter(`${col.projectCode} eq '${projectCode}'`).orderBy(col.letter,!0).top(500)();return performanceService.endMark("sp:getQualityConcerns"),items.map(item=>this.mapToQualityConcern(item))}async addQualityConcern(projectCode,concern){var _a,_b,_c,_d,_e,_f,_g,_h;performanceService.startMark("sp:addQualityConcern");const web=this._getProjectWeb(),col=QUALITY_CONCERNS_COLUMNS,addData={[col.projectCode]:projectCode,[col.letter]:null!==(_a=concern.letter)&&void 0!==_a?_a:"",[col.description]:null!==(_b=concern.description)&&void 0!==_b?_b:"",[col.raisedBy]:null!==(_c=concern.raisedBy)&&void 0!==_c?_c:"",[col.raisedDate]:null!==(_d=concern.raisedDate)&&void 0!==_d?_d:(new Date).toISOString(),[col.status]:null!==(_e=concern.status)&&void 0!==_e?_e:"Open",[col.resolution]:null!==(_f=concern.resolution)&&void 0!==_f?_f:"",[col.resolvedDate]:null!==(_g=concern.resolvedDate)&&void 0!==_g?_g:null,[col.notes]:null!==(_h=concern.notes)&&void 0!==_h?_h:""},result=await web.lists.getByTitle(LIST_NAMES.QUALITY_CONCERNS).items.add(addData);return performanceService.endMark("sp:addQualityConcern"),this.mapToQualityConcern(result.data)}async updateQualityConcern(projectCode,concernId,data){performanceService.startMark("sp:updateQualityConcern");const web=this._getProjectWeb(),col=QUALITY_CONCERNS_COLUMNS,updateData={};void 0!==data.letter&&(updateData[col.letter]=data.letter),void 0!==data.description&&(updateData[col.description]=data.description),void 0!==data.raisedBy&&(updateData[col.raisedBy]=data.raisedBy),void 0!==data.raisedDate&&(updateData[col.raisedDate]=data.raisedDate),void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.resolution&&(updateData[col.resolution]=data.resolution),void 0!==data.resolvedDate&&(updateData[col.resolvedDate]=data.resolvedDate),void 0!==data.notes&&(updateData[col.notes]=data.notes),await web.lists.getByTitle(LIST_NAMES.QUALITY_CONCERNS).items.getById(concernId).update(updateData);const updated=await web.lists.getByTitle(LIST_NAMES.QUALITY_CONCERNS).items.getById(concernId)();return performanceService.endMark("sp:updateQualityConcern"),this.mapToQualityConcern(updated)}async getSafetyConcerns(projectCode){performanceService.startMark("sp:getSafetyConcerns");const web=this._getProjectWeb(),col=SAFETY_CONCERNS_COLUMNS,items=await web.lists.getByTitle(LIST_NAMES.SAFETY_CONCERNS).items.filter(`${col.projectCode} eq '${projectCode}'`).orderBy(col.letter,!0).top(500)();return performanceService.endMark("sp:getSafetyConcerns"),items.map(item=>this.mapToSafetyConcern(item))}async addSafetyConcern(projectCode,concern){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;performanceService.startMark("sp:addSafetyConcern");const web=this._getProjectWeb(),col=SAFETY_CONCERNS_COLUMNS,addData={[col.projectCode]:projectCode,[col.safetyOfficerName]:null!==(_a=concern.safetyOfficerName)&&void 0!==_a?_a:"",[col.safetyOfficerEmail]:null!==(_b=concern.safetyOfficerEmail)&&void 0!==_b?_b:"",[col.letter]:null!==(_c=concern.letter)&&void 0!==_c?_c:"",[col.description]:null!==(_d=concern.description)&&void 0!==_d?_d:"",[col.severity]:null!==(_e=concern.severity)&&void 0!==_e?_e:"Medium",[col.raisedBy]:null!==(_f=concern.raisedBy)&&void 0!==_f?_f:"",[col.raisedDate]:null!==(_g=concern.raisedDate)&&void 0!==_g?_g:(new Date).toISOString(),[col.status]:null!==(_h=concern.status)&&void 0!==_h?_h:"Open",[col.resolution]:null!==(_j=concern.resolution)&&void 0!==_j?_j:"",[col.resolvedDate]:null!==(_k=concern.resolvedDate)&&void 0!==_k?_k:null,[col.notes]:null!==(_l=concern.notes)&&void 0!==_l?_l:""},result=await web.lists.getByTitle(LIST_NAMES.SAFETY_CONCERNS).items.add(addData);return performanceService.endMark("sp:addSafetyConcern"),this.mapToSafetyConcern(result.data)}async updateSafetyConcern(projectCode,concernId,data){performanceService.startMark("sp:updateSafetyConcern");const web=this._getProjectWeb(),col=SAFETY_CONCERNS_COLUMNS,updateData={};void 0!==data.safetyOfficerName&&(updateData[col.safetyOfficerName]=data.safetyOfficerName),void 0!==data.safetyOfficerEmail&&(updateData[col.safetyOfficerEmail]=data.safetyOfficerEmail),void 0!==data.letter&&(updateData[col.letter]=data.letter),void 0!==data.description&&(updateData[col.description]=data.description),void 0!==data.severity&&(updateData[col.severity]=data.severity),void 0!==data.raisedBy&&(updateData[col.raisedBy]=data.raisedBy),void 0!==data.raisedDate&&(updateData[col.raisedDate]=data.raisedDate),void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.resolution&&(updateData[col.resolution]=data.resolution),void 0!==data.resolvedDate&&(updateData[col.resolvedDate]=data.resolvedDate),void 0!==data.notes&&(updateData[col.notes]=data.notes),await web.lists.getByTitle(LIST_NAMES.SAFETY_CONCERNS).items.getById(concernId).update(updateData);const updated=await web.lists.getByTitle(LIST_NAMES.SAFETY_CONCERNS).items.getById(concernId)();return performanceService.endMark("sp:updateSafetyConcern"),this.mapToSafetyConcern(updated)}async getProjectSchedule(projectCode){performanceService.startMark("sp:getProjectSchedule");const web=this._getProjectWeb(),col=PROJECT_SCHEDULE_COLUMNS,itemCol=CRITICAL_PATH_ITEMS_COLUMNS,[parents,items]=await Promise.all([web.lists.getByTitle(LIST_NAMES.PROJECT_SCHEDULE).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)(),web.lists.getByTitle(LIST_NAMES.CRITICAL_PATH_ITEMS).items.filter(`${itemCol.projectCode} eq '${projectCode}'`).orderBy(itemCol.letter,!0).top(500)()]);if(0===parents.length)return null;const schedule=this.mapToProjectSchedule(parents[0]);return performanceService.endMark("sp:getProjectSchedule"),Object.assign(Object.assign({},schedule),{criticalPathConcerns:items.map(i=>this.mapToCriticalPathItem(i))})}async updateProjectSchedule(projectCode,data){performanceService.startMark("sp:updateProjectSchedule");const web=this._getProjectWeb(),col=PROJECT_SCHEDULE_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.PROJECT_SCHEDULE).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===parents.length)throw new Error(`Schedule record for ${projectCode} not found`);const updateData={};void 0!==data.startDate&&(updateData[col.startDate]=data.startDate),void 0!==data.substantialCompletionDate&&(updateData[col.substantialCompletionDate]=data.substantialCompletionDate),void 0!==data.ntpDate&&(updateData[col.ntpDate]=data.ntpDate),void 0!==data.nocDate&&(updateData[col.nocDate]=data.nocDate),void 0!==data.contractCalendarDays&&(updateData[col.contractCalendarDays]=data.contractCalendarDays),void 0!==data.contractBasisType&&(updateData[col.contractBasisType]=data.contractBasisType),void 0!==data.teamGoalDaysAhead&&(updateData[col.teamGoalDaysAhead]=data.teamGoalDaysAhead),void 0!==data.teamGoalDescription&&(updateData[col.teamGoalDescription]=data.teamGoalDescription),void 0!==data.hasLiquidatedDamages&&(updateData[col.hasLiquidatedDamages]=data.hasLiquidatedDamages),void 0!==data.liquidatedDamagesAmount&&(updateData[col.liquidatedDamagesAmount]=data.liquidatedDamagesAmount),void 0!==data.liquidatedDamagesTerms&&(updateData[col.liquidatedDamagesTerms]=data.liquidatedDamagesTerms),void 0!==data.lastUpdatedBy&&(updateData[col.lastUpdatedBy]=data.lastUpdatedBy),updateData[col.lastUpdatedAt]=(new Date).toISOString();const itemId=parents[0].Id;return await web.lists.getByTitle(LIST_NAMES.PROJECT_SCHEDULE).items.getById(itemId).update(updateData),performanceService.endMark("sp:updateProjectSchedule"),await this.getProjectSchedule(projectCode)}async addCriticalPathItem(projectCode,item){var _a,_b,_c,_d,_e;performanceService.startMark("sp:addCriticalPathItem");const web=this._getProjectWeb(),col=CRITICAL_PATH_ITEMS_COLUMNS,parentCol=PROJECT_SCHEDULE_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.PROJECT_SCHEDULE).items.filter(`${parentCol.projectCode} eq '${projectCode}'`).top(1)(),scheduleId=parents.length>0?parents[0].Id:void 0,now=(new Date).toISOString(),addData={[col.projectCode]:projectCode,[col.scheduleId]:scheduleId,[col.letter]:null!==(_a=item.letter)&&void 0!==_a?_a:"",[col.description]:null!==(_b=item.description)&&void 0!==_b?_b:"",[col.impactDescription]:null!==(_c=item.impactDescription)&&void 0!==_c?_c:"",[col.status]:null!==(_d=item.status)&&void 0!==_d?_d:"Active",[col.mitigationPlan]:null!==(_e=item.mitigationPlan)&&void 0!==_e?_e:"",[col.createdDate]:now,[col.updatedDate]:now},result=await web.lists.getByTitle(LIST_NAMES.CRITICAL_PATH_ITEMS).items.add(addData);return performanceService.endMark("sp:addCriticalPathItem"),this.mapToCriticalPathItem(result.data)}async getSuperintendentPlan(projectCode){performanceService.startMark("sp:getSuperintendentPlan");const web=this._getProjectWeb(),col=SUPERINTENDENT_PLAN_COLUMNS,secCol=SUPERINTENDENT_PLAN_SECTIONS_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.SUPERINTENDENT_PLAN).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===parents.length)return null;const plan=this.mapToSuperintendentPlan(parents[0]),sections=await web.lists.getByTitle(LIST_NAMES.SUPERINTENDENT_PLAN_SECTIONS).items.filter(`${secCol.superintendentPlanId} eq ${plan.id}`).top(500)();return performanceService.endMark("sp:getSuperintendentPlan"),Object.assign(Object.assign({},plan),{sections:sections.map(s=>this.mapToSuperintendentPlanSection(s))})}async updateSuperintendentPlanSection(projectCode,sectionId,data){performanceService.startMark("sp:updateSuperintendentPlanSection");const web=this._getProjectWeb(),secCol=SUPERINTENDENT_PLAN_SECTIONS_COLUMNS,col=SUPERINTENDENT_PLAN_COLUMNS,updateData={};void 0!==data.sectionTitle&&(updateData[secCol.sectionTitle]=data.sectionTitle),void 0!==data.content&&(updateData[secCol.content]=data.content),void 0!==data.isComplete&&(updateData[secCol.isComplete]=data.isComplete),void 0!==data.attachmentUrls&&(updateData[secCol.attachmentUrls]=JSON.stringify(data.attachmentUrls)),await web.lists.getByTitle(LIST_NAMES.SUPERINTENDENT_PLAN_SECTIONS).items.getById(sectionId).update(updateData);const parents=await web.lists.getByTitle(LIST_NAMES.SUPERINTENDENT_PLAN).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(parents.length>0){const parentId=parents[0].Id;await web.lists.getByTitle(LIST_NAMES.SUPERINTENDENT_PLAN).items.getById(parentId).update({[col.lastUpdatedAt]:(new Date).toISOString()})}const updated=await web.lists.getByTitle(LIST_NAMES.SUPERINTENDENT_PLAN_SECTIONS).items.getById(sectionId)();return performanceService.endMark("sp:updateSuperintendentPlanSection"),this.mapToSuperintendentPlanSection(updated)}async createSuperintendentPlan(projectCode,data){var _a,_b,_c,_d,_e,_f,_g,_h,_j;performanceService.startMark("sp:createSuperintendentPlan");const web=this._getProjectWeb(),col=SUPERINTENDENT_PLAN_COLUMNS,secCol=SUPERINTENDENT_PLAN_SECTIONS_COLUMNS,now=(new Date).toISOString(),addData={[col.projectCode]:projectCode,[col.superintendentName]:null!==(_a=data.superintendentName)&&void 0!==_a?_a:"",[col.createdBy]:null!==(_b=data.createdBy)&&void 0!==_b?_b:"",[col.createdAt]:now,[col.lastUpdatedBy]:null!==(_d=null!==(_c=data.lastUpdatedBy)&&void 0!==_c?_c:data.createdBy)&&void 0!==_d?_d:"",[col.lastUpdatedAt]:now},planId=(await web.lists.getByTitle(LIST_NAMES.SUPERINTENDENT_PLAN).items.add(addData)).data.Id;if(data.sections&&data.sections.length>0)for(const sec of data.sections){const secData={[secCol.superintendentPlanId]:planId,[secCol.projectCode]:projectCode,[secCol.sectionKey]:null!==(_e=sec.sectionKey)&&void 0!==_e?_e:"",[secCol.sectionTitle]:null!==(_f=sec.sectionTitle)&&void 0!==_f?_f:"",[secCol.content]:null!==(_g=sec.content)&&void 0!==_g?_g:"",[secCol.attachmentUrls]:JSON.stringify(null!==(_h=sec.attachmentUrls)&&void 0!==_h?_h:[]),[secCol.isComplete]:null!==(_j=sec.isComplete)&&void 0!==_j&&_j};await web.lists.getByTitle(LIST_NAMES.SUPERINTENDENT_PLAN_SECTIONS).items.add(secData)}return performanceService.endMark("sp:createSuperintendentPlan"),await this.getSuperintendentPlan(projectCode)}async getLessonsLearned(projectCode){performanceService.startMark("sp:getLessonsLearned");const web=this._getProjectWeb(),col=LESSONS_LEARNED_COLUMNS,items=await web.lists.getByTitle(LIST_NAMES.LESSONS_LEARNED).items.filter(`${col.projectCode} eq '${projectCode}'`).top(500)();return performanceService.endMark("sp:getLessonsLearned"),items.map(item=>this.mapToLessonLearned(item))}async addLessonLearned(projectCode,lesson){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k;performanceService.startMark("sp:addLessonLearned");const web=this._getProjectWeb(),col=LESSONS_LEARNED_COLUMNS,addData={[col.projectCode]:projectCode,[col.title]:null!==(_a=lesson.title)&&void 0!==_a?_a:"",[col.category]:null!==(_b=lesson.category)&&void 0!==_b?_b:"Other",[col.impact]:null!==(_c=lesson.impact)&&void 0!==_c?_c:"Neutral",[col.description]:null!==(_d=lesson.description)&&void 0!==_d?_d:"",[col.recommendation]:null!==(_e=lesson.recommendation)&&void 0!==_e?_e:"",[col.raisedBy]:null!==(_f=lesson.raisedBy)&&void 0!==_f?_f:"",[col.raisedDate]:null!==(_g=lesson.raisedDate)&&void 0!==_g?_g:(new Date).toISOString(),[col.phase]:null!==(_h=lesson.phase)&&void 0!==_h?_h:"",[col.isIncludedInFinalRecord]:null!==(_j=lesson.isIncludedInFinalRecord)&&void 0!==_j&&_j,[col.tags]:JSON.stringify(null!==(_k=lesson.tags)&&void 0!==_k?_k:[])},result=await web.lists.getByTitle(LIST_NAMES.LESSONS_LEARNED).items.add(addData);return performanceService.endMark("sp:addLessonLearned"),this.mapToLessonLearned(result.data)}async updateLessonLearned(projectCode,lessonId,data){performanceService.startMark("sp:updateLessonLearned");const web=this._getProjectWeb(),col=LESSONS_LEARNED_COLUMNS,updateData={};void 0!==data.title&&(updateData[col.title]=data.title),void 0!==data.category&&(updateData[col.category]=data.category),void 0!==data.impact&&(updateData[col.impact]=data.impact),void 0!==data.description&&(updateData[col.description]=data.description),void 0!==data.recommendation&&(updateData[col.recommendation]=data.recommendation),void 0!==data.raisedBy&&(updateData[col.raisedBy]=data.raisedBy),void 0!==data.raisedDate&&(updateData[col.raisedDate]=data.raisedDate),void 0!==data.phase&&(updateData[col.phase]=data.phase),void 0!==data.isIncludedInFinalRecord&&(updateData[col.isIncludedInFinalRecord]=data.isIncludedInFinalRecord),void 0!==data.tags&&(updateData[col.tags]=JSON.stringify(data.tags)),await web.lists.getByTitle(LIST_NAMES.LESSONS_LEARNED).items.getById(lessonId).update(updateData);const updated=await web.lists.getByTitle(LIST_NAMES.LESSONS_LEARNED).items.getById(lessonId)();return performanceService.endMark("sp:updateLessonLearned"),this.mapToLessonLearned(updated)}async getProjectManagementPlan(projectCode){performanceService.startMark("sp:getProjectManagementPlan");const web=this._getProjectWeb(),col=PMP_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.PMP).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===parents.length)return null;const pmp=this.mapToPMP(parents[0]),[sigItems,cycleItems,stepItems]=await Promise.all([web.lists.getByTitle(LIST_NAMES.PMP_SIGNATURES).items.filter(`${PMP_SIGNATURES_COLUMNS.pmpId} eq ${pmp.id}`).top(500)(),web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_CYCLES).items.filter(`${PMP_APPROVAL_CYCLES_COLUMNS.pmpId} eq ${pmp.id}`).top(500)(),web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_STEPS).items.filter(`${PMP_APPROVAL_STEPS_COLUMNS.projectCode} eq '${projectCode}'`).top(500)()]),signatures=sigItems.map(s=>this.mapToPMPSignature(s)),cycles=cycleItems.map(c=>this.mapToPMPApprovalCycle(c)),steps=stepItems.map(s=>this.mapToPMPApprovalStep(s));return performanceService.endMark("sp:getProjectManagementPlan"),this.assemblePMPFromParts(pmp,signatures,cycles,steps)}async updateProjectManagementPlan(projectCode,data){performanceService.startMark("sp:updateProjectManagementPlan");const web=this._getProjectWeb(),col=PMP_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.PMP).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===parents.length)throw new Error(`PMP for ${projectCode} not found`);const pmpId=parents[0].ID||parents[0].Id,now=(new Date).toISOString(),updateData={[col.lastUpdatedAt]:now};void 0!==data.projectName&&(updateData[col.projectName]=data.projectName),void 0!==data.jobNumber&&(updateData[col.jobNumber]=data.jobNumber),void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.division&&(updateData[col.division]=data.division),void 0!==data.currentCycleNumber&&(updateData[col.currentCycleNumber]=data.currentCycleNumber),void 0!==data.superintendentPlan&&(updateData[col.superintendentPlan]=data.superintendentPlan),void 0!==data.preconMeetingNotes&&(updateData[col.preconMeetingNotes]=data.preconMeetingNotes),void 0!==data.siteManagementNotes&&(updateData[col.siteManagementNotes]=data.siteManagementNotes),void 0!==data.projectAdminBuyoutDate&&(updateData[col.projectAdminBuyoutDate]=data.projectAdminBuyoutDate),void 0!==data.lastUpdatedBy&&(updateData[col.lastUpdatedBy]=data.lastUpdatedBy),void 0!==data.attachmentUrls&&(updateData[col.attachmentUrls]=JSON.stringify(data.attachmentUrls)),void 0!==data.riskCostData&&(updateData[col.riskCostData]=JSON.stringify(data.riskCostData)),void 0!==data.qualityConcerns&&(updateData[col.qualityConcerns]=JSON.stringify(data.qualityConcerns)),void 0!==data.safetyConcerns&&(updateData[col.safetyConcerns]=JSON.stringify(data.safetyConcerns)),void 0!==data.scheduleData&&(updateData[col.scheduleData]=JSON.stringify(data.scheduleData)),void 0!==data.superintendentPlanData&&(updateData[col.superintendentPlanData]=JSON.stringify(data.superintendentPlanData)),void 0!==data.lessonsLearned&&(updateData[col.lessonsLearned]=JSON.stringify(data.lessonsLearned)),void 0!==data.teamAssignments&&(updateData[col.teamAssignments]=JSON.stringify(data.teamAssignments)),void 0!==data.boilerplate&&(updateData[col.boilerplate]=JSON.stringify(data.boilerplate)),await web.lists.getByTitle(LIST_NAMES.PMP).items.getById(pmpId).update(updateData);const result=await this.getProjectManagementPlan(projectCode);if(!result)throw new Error(`PMP for ${projectCode} not found after update`);return performanceService.endMark("sp:updateProjectManagementPlan"),result}async submitPMPForApproval(projectCode,submittedBy){var _a;performanceService.startMark("sp:submitPMPForApproval");const web=this._getProjectWeb(),col=PMP_COLUMNS,cycCol=PMP_APPROVAL_CYCLES_COLUMNS,stepCol=PMP_APPROVAL_STEPS_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.PMP).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===parents.length)throw new Error(`PMP for ${projectCode} not found`);const pmpId=parents[0].ID||parents[0].Id,currentCycle=parents[0][col.currentCycleNumber]||0,division=parents[0][col.division]||"",newCycleNumber=currentCycle+1,now=(new Date).toISOString(),divApprover=(await this.getDivisionApprovers()).find(d=>d.division===division),cycleResult=await web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_CYCLES).items.add({[cycCol.pmpId]:pmpId,[cycCol.projectCode]:projectCode,[cycCol.cycleNumber]:newCycleNumber,[cycCol.submittedBy]:submittedBy,[cycCol.submittedDate]:now,[cycCol.status]:"InProgress",[cycCol.changesFromPrevious]:"[]"}),newCycleId=cycleResult.Id||(null===(_a=cycleResult.data)||void 0===_a?void 0:_a.Id);await web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_STEPS).items.add({[stepCol.approvalCycleId]:newCycleId,[stepCol.projectCode]:projectCode,[stepCol.stepOrder]:1,[stepCol.approverRole]:"Project Executive",[stepCol.approverName]:"Kim Foster",[stepCol.approverEmail]:"kfoster@hedrickbrothers.com",[stepCol.status]:"Pending",[stepCol.comment]:"",[stepCol.actionDate]:null,[stepCol.approvalCycleNumber]:newCycleNumber}),divApprover&&await web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_STEPS).items.add({[stepCol.approvalCycleId]:newCycleId,[stepCol.projectCode]:projectCode,[stepCol.stepOrder]:2,[stepCol.approverRole]:"Division Head",[stepCol.approverName]:divApprover.approverName,[stepCol.approverEmail]:divApprover.approverEmail,[stepCol.status]:"Pending",[stepCol.comment]:"",[stepCol.actionDate]:null,[stepCol.approvalCycleNumber]:newCycleNumber}),await web.lists.getByTitle(LIST_NAMES.PMP).items.getById(pmpId).update({[col.currentCycleNumber]:newCycleNumber,[col.status]:"PendingApproval",[col.lastUpdatedAt]:now});const result=await this.getProjectManagementPlan(projectCode);if(!result)throw new Error(`PMP for ${projectCode} not found after submission`);return performanceService.endMark("sp:submitPMPForApproval"),result}async respondToPMPApproval(projectCode,stepId,approved,comment){performanceService.startMark("sp:respondToPMPApproval");const web=this._getProjectWeb(),col=PMP_COLUMNS,stepCol=PMP_APPROVAL_STEPS_COLUMNS,cycCol=PMP_APPROVAL_CYCLES_COLUMNS,now=(new Date).toISOString(),parents=await web.lists.getByTitle(LIST_NAMES.PMP).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===parents.length)throw new Error(`PMP for ${projectCode} not found`);const pmpId=parents[0].ID||parents[0].Id,cycleId=(await web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_STEPS).items.getById(stepId)())[stepCol.approvalCycleId];await web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_STEPS).items.getById(stepId).update({[stepCol.status]:approved?"Approved":"Returned",[stepCol.comment]:comment,[stepCol.actionDate]:now});const cycleSteps=await web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_STEPS).items.filter(`${stepCol.approvalCycleId} eq ${cycleId}`).top(100)();if(approved){cycleSteps.every(s=>(s.ID||s.Id)===stepId||"Approved"===s[stepCol.status])?(await web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_CYCLES).items.getById(cycleId).update({[cycCol.status]:"Approved"}),await web.lists.getByTitle(LIST_NAMES.PMP).items.getById(pmpId).update({[col.status]:"Approved",[col.lastUpdatedAt]:now})):await web.lists.getByTitle(LIST_NAMES.PMP).items.getById(pmpId).update({[col.lastUpdatedAt]:now})}else await web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_CYCLES).items.getById(cycleId).update({[cycCol.status]:"Returned"}),await web.lists.getByTitle(LIST_NAMES.PMP).items.getById(pmpId).update({[col.status]:"Returned",[col.lastUpdatedAt]:now});const result=await this.getProjectManagementPlan(projectCode);if(!result)throw new Error(`PMP for ${projectCode} not found after approval response`);return performanceService.endMark("sp:respondToPMPApproval"),result}async signPMP(projectCode,signatureId,comment){performanceService.startMark("sp:signPMP");const web=this._getProjectWeb(),col=PMP_COLUMNS,sigCol=PMP_SIGNATURES_COLUMNS,now=(new Date).toISOString(),parents=await web.lists.getByTitle(LIST_NAMES.PMP).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===parents.length)throw new Error(`PMP for ${projectCode} not found`);const pmpId=parents[0].ID||parents[0].Id;if((await web.lists.getByTitle(LIST_NAMES.PMP_SIGNATURES).items.getById(signatureId)())[sigCol.pmpId]!==pmpId)throw new Error(`Signature ${signatureId} does not belong to PMP for ${projectCode}`);await web.lists.getByTitle(LIST_NAMES.PMP_SIGNATURES).items.getById(signatureId).update({[sigCol.status]:"Signed",[sigCol.signedDate]:now,[sigCol.comment]:comment}),await web.lists.getByTitle(LIST_NAMES.PMP).items.getById(pmpId).update({[col.lastUpdatedAt]:now});const result=await this.getProjectManagementPlan(projectCode);if(!result)throw new Error(`PMP for ${projectCode} not found after signing`);return performanceService.endMark("sp:signPMP"),result}async getDivisionApprovers(){performanceService.startMark("sp:getDivisionApprovers");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.DIVISION_APPROVERS).items.top(100)();return performanceService.endMark("sp:getDivisionApprovers"),items.map(item=>this.mapToDivisionApprover(item))}async getPMPBoilerplate(){performanceService.startMark("sp:getPMPBoilerplate");const col=PMP_BOILERPLATE_COLUMNS,items=await this.sp.web.lists.getByTitle(LIST_NAMES.PMP_BOILERPLATE).items.orderBy(col.sectionNumber,!0).top(100)();return performanceService.endMark("sp:getPMPBoilerplate"),items.map(item=>this.mapToPMPBoilerplateSection(item))}async getMonthlyReviews(projectCode){performanceService.startMark("sp:getMonthlyReviews");const web=this._getProjectWeb(),col=MONTHLY_REVIEWS_COLUMNS,ciCol=MONTHLY_CHECKLIST_ITEMS_COLUMNS,fuCol=MONTHLY_FOLLOW_UPS_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.MONTHLY_REVIEWS).items.filter(`${col.projectCode} eq '${projectCode}'`).top(500)();if(0===parents.length)return[];const reviews=parents.map(p=>this.mapToMonthlyReview(p)),reviewIds=reviews.map(r=>r.id),orFilter=reviewIds.map(id=>`${ciCol.reviewId} eq ${id}`).join(" or "),[checklistItems,followUpItems]=await Promise.all([web.lists.getByTitle(LIST_NAMES.MONTHLY_CHECKLIST_ITEMS).items.filter(orFilter).top(5e3)(),web.lists.getByTitle(LIST_NAMES.MONTHLY_FOLLOW_UPS).items.filter(reviewIds.map(id=>`${fuCol.reviewId} eq ${id}`).join(" or ")).top(5e3)()]),mappedChecklist=checklistItems.map(i=>this.mapToMonthlyChecklistItem(i)),mappedFollowUps=followUpItems.map(f=>this.mapToMonthlyFollowUp(f));return reviews.map(r=>this.assembleMonthlyReview(r,mappedChecklist,mappedFollowUps)).sort((a,b)=>b.reviewMonth.localeCompare(a.reviewMonth))}async getMonthlyReview(reviewId){performanceService.startMark("sp:getMonthlyReview");const web=this._getProjectWeb(),ciCol=MONTHLY_CHECKLIST_ITEMS_COLUMNS,fuCol=MONTHLY_FOLLOW_UPS_COLUMNS;let parentItem;try{parentItem=await web.lists.getByTitle(LIST_NAMES.MONTHLY_REVIEWS).items.getById(reviewId)()}catch(_a){return null}const review=this.mapToMonthlyReview(parentItem),[checklistItems,followUpItems]=await Promise.all([web.lists.getByTitle(LIST_NAMES.MONTHLY_CHECKLIST_ITEMS).items.filter(`${ciCol.reviewId} eq ${reviewId}`).top(5e3)(),web.lists.getByTitle(LIST_NAMES.MONTHLY_FOLLOW_UPS).items.filter(`${fuCol.reviewId} eq ${reviewId}`).top(5e3)()]),mappedChecklist=checklistItems.map(i=>this.mapToMonthlyChecklistItem(i)),mappedFollowUps=followUpItems.map(f=>this.mapToMonthlyFollowUp(f));return performanceService.endMark("sp:getMonthlyReview"),this.assembleMonthlyReview(review,mappedChecklist,mappedFollowUps)}async updateMonthlyReview(reviewId,data){performanceService.startMark("sp:updateMonthlyReview");const web=this._getProjectWeb(),col=MONTHLY_REVIEWS_COLUMNS,ciCol=MONTHLY_CHECKLIST_ITEMS_COLUMNS,fuCol=MONTHLY_FOLLOW_UPS_COLUMNS,now=(new Date).toISOString(),updateData={[col.lastUpdatedAt]:now};if(void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.reviewMonth&&(updateData[col.reviewMonth]=data.reviewMonth),void 0!==data.dueDate&&(updateData[col.dueDate]=data.dueDate),void 0!==data.meetingDate&&(updateData[col.meetingDate]=data.meetingDate),void 0!==data.pmSubmittedDate&&(updateData[col.pmSubmittedDate]=data.pmSubmittedDate),void 0!==data.pxReviewDate&&(updateData[col.pxReviewDate]=data.pxReviewDate),void 0!==data.pxValidationDate&&(updateData[col.pxValidationDate]=data.pxValidationDate),void 0!==data.leadershipSubmitDate&&(updateData[col.leadershipSubmitDate]=data.leadershipSubmitDate),void 0!==data.completedDate&&(updateData[col.completedDate]=data.completedDate),void 0!==data.reportDocumentUrls&&(updateData[col.reportDocumentUrls]=JSON.stringify(data.reportDocumentUrls)),void 0!==data.lastUpdatedBy&&(updateData[col.lastUpdatedBy]=data.lastUpdatedBy),await web.lists.getByTitle(LIST_NAMES.MONTHLY_REVIEWS).items.getById(reviewId).update(updateData),data.checklistItems){const existingCI=await web.lists.getByTitle(LIST_NAMES.MONTHLY_CHECKLIST_ITEMS).items.filter(`${ciCol.reviewId} eq ${reviewId}`).top(5e3)();for(const ci of existingCI){const ciId=ci.ID||ci.Id;await web.lists.getByTitle(LIST_NAMES.MONTHLY_CHECKLIST_ITEMS).items.getById(ciId).delete()}for(const item of data.checklistItems)await web.lists.getByTitle(LIST_NAMES.MONTHLY_CHECKLIST_ITEMS).items.add({[ciCol.reviewId]:reviewId,[ciCol.sectionKey]:item.sectionKey,[ciCol.sectionTitle]:item.sectionTitle,[ciCol.itemKey]:item.itemKey,[ciCol.itemDescription]:item.itemDescription,[ciCol.pmComment]:item.pmComment||"",[ciCol.pxComment]:item.pxComment||"",[ciCol.pxInitial]:item.pxInitial||""})}if(data.followUps){const existingFU=await web.lists.getByTitle(LIST_NAMES.MONTHLY_FOLLOW_UPS).items.filter(`${fuCol.reviewId} eq ${reviewId}`).top(5e3)();for(const fu of existingFU){const fuId=fu.ID||fu.Id;await web.lists.getByTitle(LIST_NAMES.MONTHLY_FOLLOW_UPS).items.getById(fuId).delete()}for(const fu of data.followUps)await web.lists.getByTitle(LIST_NAMES.MONTHLY_FOLLOW_UPS).items.add({[fuCol.reviewId]:reviewId,[fuCol.question]:fu.question||"",[fuCol.requestedBy]:fu.requestedBy||"",[fuCol.requestedDate]:fu.requestedDate||"",[fuCol.pmResponse]:fu.pmResponse||"",[fuCol.responseDate]:fu.responseDate||null,[fuCol.pxForwardedDate]:fu.pxForwardedDate||null,[fuCol.status]:fu.status||"Open"})}const result=await this.getMonthlyReview(reviewId);if(!result)throw new Error(`Monthly review ${reviewId} not found after update`);return performanceService.endMark("sp:updateMonthlyReview"),result}async createMonthlyReview(data){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;performanceService.startMark("sp:createMonthlyReview");const web=this._getProjectWeb(),col=MONTHLY_REVIEWS_COLUMNS,ciCol=MONTHLY_CHECKLIST_ITEMS_COLUMNS,fuCol=MONTHLY_FOLLOW_UPS_COLUMNS,now=(new Date).toISOString(),addResult=await web.lists.getByTitle(LIST_NAMES.MONTHLY_REVIEWS).items.add({[col.projectCode]:null!==(_a=data.projectCode)&&void 0!==_a?_a:"",[col.reviewMonth]:null!==(_b=data.reviewMonth)&&void 0!==_b?_b:"",[col.status]:null!==(_c=data.status)&&void 0!==_c?_c:"NotStarted",[col.dueDate]:null!==(_d=data.dueDate)&&void 0!==_d?_d:"",[col.meetingDate]:null!==(_e=data.meetingDate)&&void 0!==_e?_e:null,[col.pmSubmittedDate]:null,[col.pxReviewDate]:null,[col.pxValidationDate]:null,[col.leadershipSubmitDate]:null,[col.completedDate]:null,[col.reportDocumentUrls]:JSON.stringify(null!==(_f=data.reportDocumentUrls)&&void 0!==_f?_f:[]),[col.createdBy]:null!==(_g=data.createdBy)&&void 0!==_g?_g:"",[col.createdAt]:now,[col.lastUpdatedBy]:null!==(_j=null!==(_h=data.lastUpdatedBy)&&void 0!==_h?_h:data.createdBy)&&void 0!==_j?_j:"",[col.lastUpdatedAt]:now}),newId=(null===(_k=addResult.data)||void 0===_k?void 0:_k.ID)||(null===(_l=addResult.data)||void 0===_l?void 0:_l.Id);if(data.checklistItems)for(const item of data.checklistItems)await web.lists.getByTitle(LIST_NAMES.MONTHLY_CHECKLIST_ITEMS).items.add({[ciCol.reviewId]:newId,[ciCol.sectionKey]:item.sectionKey,[ciCol.sectionTitle]:item.sectionTitle,[ciCol.itemKey]:item.itemKey,[ciCol.itemDescription]:item.itemDescription,[ciCol.pmComment]:item.pmComment||"",[ciCol.pxComment]:item.pxComment||"",[ciCol.pxInitial]:item.pxInitial||""});if(data.followUps)for(const fu of data.followUps)await web.lists.getByTitle(LIST_NAMES.MONTHLY_FOLLOW_UPS).items.add({[fuCol.reviewId]:newId,[fuCol.question]:fu.question||"",[fuCol.requestedBy]:fu.requestedBy||"",[fuCol.requestedDate]:fu.requestedDate||"",[fuCol.pmResponse]:fu.pmResponse||"",[fuCol.responseDate]:fu.responseDate||null,[fuCol.pxForwardedDate]:fu.pxForwardedDate||null,[fuCol.status]:fu.status||"Open"});const result=await this.getMonthlyReview(newId);if(!result)throw new Error("Monthly review not found after create");return performanceService.endMark("sp:createMonthlyReview"),result}async getEstimatingKickoff(projectCode){performanceService.startMark("sp:getEstimatingKickoff");const col=ESTIMATING_KICKOFFS_COLUMNS,itemCol=ESTIMATING_KICKOFF_ITEMS_COLUMNS;try{const parents=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.filter(`${col.ProjectCode} eq '${projectCode}'`).top(1)();if(!parents||0===parents.length)return performanceService.endMark("sp:getEstimatingKickoff"),null;const parent=this.mapToEstimatingKickoff(parents[0]),childItems=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.filter(`${itemCol.kickoffId} eq ${parent.id}`).orderBy(itemCol.sortOrder,!0).top(500)();return parent.items=childItems.map(i=>this.mapToEstimatingKickoffItem(i)),performanceService.endMark("sp:getEstimatingKickoff"),parent}catch(err){throw performanceService.endMark("sp:getEstimatingKickoff"),this.handleError("getEstimatingKickoff",err,{entityType:"EstimatingKickoff",entityId:projectCode})}}async getEstimatingKickoffByLeadId(leadId){performanceService.startMark("sp:getEstimatingKickoffByLeadId");const col=ESTIMATING_KICKOFFS_COLUMNS,itemCol=ESTIMATING_KICKOFF_ITEMS_COLUMNS;try{const parents=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.filter(`${col.LeadID} eq ${leadId}`).top(1)();if(!parents||0===parents.length)return performanceService.endMark("sp:getEstimatingKickoffByLeadId"),null;const parent=this.mapToEstimatingKickoff(parents[0]),childItems=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.filter(`${itemCol.kickoffId} eq ${parent.id}`).orderBy(itemCol.sortOrder,!0).top(500)();return parent.items=childItems.map(i=>this.mapToEstimatingKickoffItem(i)),performanceService.endMark("sp:getEstimatingKickoffByLeadId"),parent}catch(err){throw performanceService.endMark("sp:getEstimatingKickoffByLeadId"),this.handleError("getEstimatingKickoffByLeadId",err,{entityType:"EstimatingKickoff"})}}async createEstimatingKickoff(data){var _a,_b,_c,_d,_e,_f;performanceService.startMark("sp:createEstimatingKickoff");const col=ESTIMATING_KICKOFFS_COLUMNS,itemCol=ESTIMATING_KICKOFF_ITEMS_COLUMNS,now=(new Date).toISOString(),parentData={[col.LeadID]:null!==(_a=data.LeadID)&&void 0!==_a?_a:0,[col.ProjectCode]:null!==(_b=data.ProjectCode)&&void 0!==_b?_b:"",[col.CreatedDate]:now,[col.CreatedBy]:null!==(_c=data.CreatedBy)&&void 0!==_c?_c:"system",[col.ModifiedDate]:now};data.Architect&&(parentData[col.Architect]=data.Architect),data.ProposalDueDateTime&&(parentData[col.ProposalDueDateTime]=data.ProposalDueDateTime),data.ProposalType&&(parentData[col.ProposalType]=data.ProposalType),data.RFIFormat&&(parentData[col.RFIFormat]=data.RFIFormat),data.PrimaryOwnerContact&&(parentData[col.PrimaryOwnerContact]=data.PrimaryOwnerContact),data.ProposalDeliveryMethod&&(parentData[col.ProposalDeliveryMethod]=data.ProposalDeliveryMethod),void 0!==data.CopiesIfHandDelivered&&(parentData[col.CopiesIfHandDelivered]=data.CopiesIfHandDelivered),data.HBProposalDue&&(parentData[col.HBProposalDue]=data.HBProposalDue),data.SubcontractorProposalsDue&&(parentData[col.SubcontractorProposalsDue]=data.SubcontractorProposalsDue),data.PreSubmissionReview&&(parentData[col.PreSubmissionReview]=data.PreSubmissionReview),data.SubcontractorSiteWalkThru&&(parentData[col.SubcontractorSiteWalkThru]=data.SubcontractorSiteWalkThru),data.OwnerEstimateReview&&(parentData[col.OwnerEstimateReview]=data.OwnerEstimateReview),data.keyPersonnel&&(parentData[col.KeyPersonnel]=JSON.stringify(data.keyPersonnel)),data.KickoffMeetingId&&(parentData[col.KickoffMeetingId]=data.KickoffMeetingId),data.KickoffMeetingDate&&(parentData[col.KickoffMeetingDate]=data.KickoffMeetingDate);const result=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.add(parentData),newId=result.Id||result.id;if(data.items&&data.items.length>0)for(const item of data.items){const childData={[itemCol.kickoffId]:newId,[itemCol.projectCode]:null!==(_d=data.ProjectCode)&&void 0!==_d?_d:"",[itemCol.section]:item.section||"managing",[itemCol.task]:item.task||"",[itemCol.status]:item.status||null,[itemCol.sortOrder]:null!==(_e=item.sortOrder)&&void 0!==_e?_e:0};item.responsibleParty&&(childData[itemCol.responsibleParty]=item.responsibleParty),item.assignees&&(childData[itemCol.Assignees]=JSON.stringify(item.assignees)),item.deadline&&(childData[itemCol.deadline]=item.deadline),item.frequency&&(childData[itemCol.frequency]=item.frequency),item.notes&&(childData[itemCol.notes]=item.notes),void 0!==item.tabRequired&&(childData[itemCol.tabRequired]=item.tabRequired),void 0!==item.isCustom&&(childData[itemCol.isCustom]=item.isCustom),await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.add(childData)}const assembled=await this.getEstimatingKickoff(null!==(_f=data.ProjectCode)&&void 0!==_f?_f:"");return performanceService.endMark("sp:createEstimatingKickoff"),assembled}async updateEstimatingKickoff(id,data){var _a;performanceService.startMark("sp:updateEstimatingKickoff");const col=ESTIMATING_KICKOFFS_COLUMNS,itemCol=ESTIMATING_KICKOFF_ITEMS_COLUMNS,now=(new Date).toISOString(),updateData={[col.ModifiedDate]:now};if(void 0!==data.Architect&&(updateData[col.Architect]=data.Architect),void 0!==data.ProposalDueDateTime&&(updateData[col.ProposalDueDateTime]=data.ProposalDueDateTime),void 0!==data.ProposalType&&(updateData[col.ProposalType]=data.ProposalType),void 0!==data.RFIFormat&&(updateData[col.RFIFormat]=data.RFIFormat),void 0!==data.PrimaryOwnerContact&&(updateData[col.PrimaryOwnerContact]=data.PrimaryOwnerContact),void 0!==data.ProposalDeliveryMethod&&(updateData[col.ProposalDeliveryMethod]=data.ProposalDeliveryMethod),void 0!==data.CopiesIfHandDelivered&&(updateData[col.CopiesIfHandDelivered]=data.CopiesIfHandDelivered),void 0!==data.HBProposalDue&&(updateData[col.HBProposalDue]=data.HBProposalDue),void 0!==data.SubcontractorProposalsDue&&(updateData[col.SubcontractorProposalsDue]=data.SubcontractorProposalsDue),void 0!==data.PreSubmissionReview&&(updateData[col.PreSubmissionReview]=data.PreSubmissionReview),void 0!==data.SubcontractorSiteWalkThru&&(updateData[col.SubcontractorSiteWalkThru]=data.SubcontractorSiteWalkThru),void 0!==data.OwnerEstimateReview&&(updateData[col.OwnerEstimateReview]=data.OwnerEstimateReview),void 0!==data.keyPersonnel&&(updateData[col.KeyPersonnel]=JSON.stringify(data.keyPersonnel)),void 0!==data.KickoffMeetingId&&(updateData[col.KickoffMeetingId]=data.KickoffMeetingId),void 0!==data.KickoffMeetingDate&&(updateData[col.KickoffMeetingDate]=data.KickoffMeetingDate),void 0!==data.ModifiedBy&&(updateData[col.ModifiedBy]=data.ModifiedBy),await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.getById(id).update(updateData),data.items){const projectCode=(await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.getById(id)())[col.ProjectCode]||"",existingItems=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.filter(`${itemCol.kickoffId} eq ${id}`).top(500)();for(const existing of existingItems)await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.getById(existing.Id||existing.ID).recycle();for(const item of data.items){const childData={[itemCol.kickoffId]:id,[itemCol.projectCode]:projectCode,[itemCol.section]:item.section||"managing",[itemCol.task]:item.task||"",[itemCol.status]:item.status||null,[itemCol.sortOrder]:null!==(_a=item.sortOrder)&&void 0!==_a?_a:0};void 0!==item.responsibleParty&&(childData[itemCol.responsibleParty]=item.responsibleParty),item.assignees&&(childData[itemCol.Assignees]=JSON.stringify(item.assignees)),void 0!==item.deadline&&(childData[itemCol.deadline]=item.deadline),void 0!==item.frequency&&(childData[itemCol.frequency]=item.frequency),void 0!==item.notes&&(childData[itemCol.notes]=item.notes),void 0!==item.tabRequired&&(childData[itemCol.tabRequired]=item.tabRequired),void 0!==item.isCustom&&(childData[itemCol.isCustom]=item.isCustom),await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.add(childData)}}const projectCode=(await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.getById(id)())[col.ProjectCode]||"",result=await this.getEstimatingKickoff(projectCode);return performanceService.endMark("sp:updateEstimatingKickoff"),result}async updateKickoffItem(kickoffId,itemId,data){performanceService.startMark("sp:updateKickoffItem");const col=ESTIMATING_KICKOFF_ITEMS_COLUMNS,parentCol=ESTIMATING_KICKOFFS_COLUMNS,updateData={};void 0!==data.section&&(updateData[col.section]=data.section),void 0!==data.task&&(updateData[col.task]=data.task),void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.responsibleParty&&(updateData[col.responsibleParty]=data.responsibleParty),void 0!==data.assignees&&(updateData[col.Assignees]=JSON.stringify(data.assignees)),void 0!==data.deadline&&(updateData[col.deadline]=data.deadline),void 0!==data.frequency&&(updateData[col.frequency]=data.frequency),void 0!==data.notes&&(updateData[col.notes]=data.notes),void 0!==data.tabRequired&&(updateData[col.tabRequired]=data.tabRequired),void 0!==data.isCustom&&(updateData[col.isCustom]=data.isCustom),void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.getById(itemId).update(updateData),await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.getById(kickoffId).update({[parentCol.ModifiedDate]:(new Date).toISOString()});const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.getById(itemId)();return performanceService.endMark("sp:updateKickoffItem"),this.mapToEstimatingKickoffItem(updated)}async addKickoffItem(kickoffId,item){var _a,_b;performanceService.startMark("sp:addKickoffItem");const col=ESTIMATING_KICKOFF_ITEMS_COLUMNS,parentCol=ESTIMATING_KICKOFFS_COLUMNS,projectCode=(await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.getById(kickoffId)())[parentCol.ProjectCode]||"",childData={[col.kickoffId]:kickoffId,[col.projectCode]:projectCode,[col.section]:item.section||"managing",[col.task]:item.task||"New Task",[col.status]:item.status||null,[col.sortOrder]:null!==(_a=item.sortOrder)&&void 0!==_a?_a:0,[col.isCustom]:null===(_b=item.isCustom)||void 0===_b||_b};item.responsibleParty&&(childData[col.responsibleParty]=item.responsibleParty),item.assignees&&(childData[col.Assignees]=JSON.stringify(item.assignees)),item.deadline&&(childData[col.deadline]=item.deadline),item.frequency&&(childData[col.frequency]=item.frequency),item.notes&&(childData[col.notes]=item.notes),void 0!==item.tabRequired&&(childData[col.tabRequired]=item.tabRequired);const result=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.add(childData),newId=result.Id||result.id;await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.getById(kickoffId).update({[parentCol.ModifiedDate]:(new Date).toISOString()});const created=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.getById(newId)();return performanceService.endMark("sp:addKickoffItem"),this.mapToEstimatingKickoffItem(created)}async removeKickoffItem(kickoffId,itemId){performanceService.startMark("sp:removeKickoffItem");const parentCol=ESTIMATING_KICKOFFS_COLUMNS;await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFF_ITEMS).items.getById(itemId).recycle(),await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.getById(kickoffId).update({[parentCol.ModifiedDate]:(new Date).toISOString()}),performanceService.endMark("sp:removeKickoffItem")}async updateKickoffKeyPersonnel(kickoffId,personnel){performanceService.startMark("sp:updateKickoffKeyPersonnel");const col=ESTIMATING_KICKOFFS_COLUMNS,now=(new Date).toISOString();await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.getById(kickoffId).update({[col.KeyPersonnel]:JSON.stringify(personnel),[col.ModifiedDate]:now});const projectCode=(await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_KICKOFFS).items.getById(kickoffId)())[col.ProjectCode]||"",result=await this.getEstimatingKickoff(projectCode);return performanceService.endMark("sp:updateKickoffKeyPersonnel"),result}async getJobNumberRequests(status){performanceService.startMark("sp:getJobNumberRequests");try{const col=JOB_NUMBER_REQUESTS_COLUMNS;let query=this.sp.web.lists.getByTitle(LIST_NAMES.JOB_NUMBER_REQUESTS).items;status&&(query=query.filter(`${col.RequestStatus} eq '${status}'`));const items=await query.orderBy(col.RequestDate,!1).top(500)();return performanceService.endMark("sp:getJobNumberRequests"),items.map(item=>this.mapToJobNumberRequest(item))}catch(err){throw performanceService.endMark("sp:getJobNumberRequests"),this.handleError("getJobNumberRequests",err,{entityType:"JobNumberRequest"})}}async getJobNumberRequestByLeadId(leadId){performanceService.startMark("sp:getJobNumberRequestByLeadId");try{const col=JOB_NUMBER_REQUESTS_COLUMNS,items=await this.sp.web.lists.getByTitle(LIST_NAMES.JOB_NUMBER_REQUESTS).items.filter(`${col.LeadID} eq ${leadId}`).orderBy(col.RequestDate,!1).top(1)();return performanceService.endMark("sp:getJobNumberRequestByLeadId"),items&&0!==items.length?this.mapToJobNumberRequest(items[0]):null}catch(err){throw performanceService.endMark("sp:getJobNumberRequestByLeadId"),this.handleError("getJobNumberRequestByLeadId",err,{entityType:"JobNumberRequest"})}}async createJobNumberRequest(data){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;performanceService.startMark("sp:createJobNumberRequest");const col=JOB_NUMBER_REQUESTS_COLUMNS,addData={[col.LeadID]:null!==(_a=data.LeadID)&&void 0!==_a?_a:0,[col.RequestDate]:null!==(_b=data.RequestDate)&&void 0!==_b?_b:(new Date).toISOString().split("T")[0],[col.Originator]:null!==(_c=data.Originator)&&void 0!==_c?_c:"",[col.RequiredByDate]:null!==(_d=data.RequiredByDate)&&void 0!==_d?_d:"",[col.ProjectAddress]:null!==(_e=data.ProjectAddress)&&void 0!==_e?_e:"",[col.ProjectExecutive]:null!==(_f=data.ProjectExecutive)&&void 0!==_f?_f:"",[col.ProjectType]:null!==(_g=data.ProjectType)&&void 0!==_g?_g:"",[col.ProjectTypeLabel]:null!==(_h=data.ProjectTypeLabel)&&void 0!==_h?_h:"",[col.IsEstimatingOnly]:null!==(_j=data.IsEstimatingOnly)&&void 0!==_j&&_j,[col.RequestedCostCodes]:JSON.stringify(null!==(_k=data.RequestedCostCodes)&&void 0!==_k?_k:[]),[col.RequestStatus]:JobNumberRequestStatus.Pending,[col.SiteProvisioningHeld]:null===(_l=data.SiteProvisioningHeld)||void 0===_l||_l};data.ProjectManager&&(addData[col.ProjectManager]=data.ProjectManager),data.TempProjectCode&&(addData[col.TempProjectCode]=data.TempProjectCode),data.Notes&&(addData[col.Notes]=data.Notes);const result=await this.sp.web.lists.getByTitle(LIST_NAMES.JOB_NUMBER_REQUESTS).items.add(addData),newId=result.Id||result.id;if(data.LeadID)try{await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.getById(data.LeadID).update({JobNumberRequestId:newId})}catch(_m){}const created=await this.sp.web.lists.getByTitle(LIST_NAMES.JOB_NUMBER_REQUESTS).items.getById(newId)();return performanceService.endMark("sp:createJobNumberRequest"),this.mapToJobNumberRequest(created)}async finalizeJobNumber(requestId,jobNumber,assignedBy){performanceService.startMark("sp:finalizeJobNumber");const col=JOB_NUMBER_REQUESTS_COLUMNS,now=(new Date).toISOString().split("T")[0],leadId=(await this.sp.web.lists.getByTitle(LIST_NAMES.JOB_NUMBER_REQUESTS).items.getById(requestId)())[col.LeadID];if(await this.sp.web.lists.getByTitle(LIST_NAMES.JOB_NUMBER_REQUESTS).items.getById(requestId).update({[col.RequestStatus]:JobNumberRequestStatus.Completed,[col.AssignedJobNumber]:jobNumber,[col.AssignedBy]:assignedBy,[col.AssignedDate]:now}),leadId)try{await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.getById(leadId).update({ProjectCode:jobNumber,OfficialJobNumber:jobNumber})}catch(_a){}const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.JOB_NUMBER_REQUESTS).items.getById(requestId)();return performanceService.endMark("sp:finalizeJobNumber"),this.mapToJobNumberRequest(updated)}async getProjectTypes(){performanceService.startMark("sp:getProjectTypes");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TYPES).items.top(500)();return performanceService.endMark("sp:getProjectTypes"),items.map(item=>this.mapToProjectType(item))}async getStandardCostCodes(){performanceService.startMark("sp:getStandardCostCodes");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.STANDARD_COST_CODES).items.top(500)();return performanceService.endMark("sp:getStandardCostCodes"),items.map(item=>this.mapToStandardCostCode(item))}async getBuyoutEntries(projectCode){performanceService.startMark("sp:getBuyoutEntries");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.filter(`ProjectCode eq '${projectCode}'`).orderBy("Title",!0)();return performanceService.endMark("sp:getBuyoutEntries"),items.map(item=>this.mapToBuyoutEntry(item))}async initializeBuyoutLog(projectCode){performanceService.startMark("sp:initializeBuyoutLog");const existing=await this.getBuyoutEntries(projectCode);if(existing.length>0)return existing;const batch=this.sp.web.createBatch(),list=this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG);for(const division of STANDARD_BUYOUT_DIVISIONS)list.items.inBatch(batch).add({Title:division.divisionCode,ProjectCode:projectCode,DivisionDescription:division.divisionDescription,IsStandard:!0,OriginalBudget:0,EstimatedTax:0,TotalBudget:0,EnrolledInSDI:!1,BondRequired:!1,Status:"Not Started"});return await batch.execute(),performanceService.endMark("sp:initializeBuyoutLog"),this.getBuyoutEntries(projectCode)}async addBuyoutEntry(projectCode,entry){var _a,_b,_c;performanceService.startMark("sp:addBuyoutEntry");const totalBudget=(entry.originalBudget||0)+(entry.estimatedTax||0),overUnder=null!=entry.contractValue?totalBudget-entry.contractValue:void 0,result=await this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.add({Title:entry.divisionCode,ProjectCode:projectCode,DivisionDescription:entry.divisionDescription,IsStandard:null!==(_a=entry.isStandard)&&void 0!==_a&&_a,OriginalBudget:entry.originalBudget||0,EstimatedTax:entry.estimatedTax||0,TotalBudget:totalBudget,SubcontractorName:entry.subcontractorName,ContractValue:entry.contractValue,OverUnder:overUnder,EnrolledInSDI:null!==(_b=entry.enrolledInSDI)&&void 0!==_b&&_b,BondRequired:null!==(_c=entry.bondRequired)&&void 0!==_c&&_c,LOISentDate:entry.loiSentDate,LOIReturnedDate:entry.loiReturnedDate,ContractSentDate:entry.contractSentDate,ContractExecutedDate:entry.contractExecutedDate,InsuranceCOIReceivedDate:entry.insuranceCOIReceivedDate,Status:entry.status||"Not Started",Notes:entry.notes});return performanceService.endMark("sp:addBuyoutEntry"),this.mapToBuyoutEntry(result.data)}async updateBuyoutEntry(projectCode,entryId,data){var _a,_b,_c,_d,_e;performanceService.startMark("sp:updateBuyoutEntry");const current=await this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.getById(entryId)(),totalBudget=(null!==(_b=null!==(_a=data.originalBudget)&&void 0!==_a?_a:current.OriginalBudget)&&void 0!==_b?_b:0)+(null!==(_d=null!==(_c=data.estimatedTax)&&void 0!==_c?_c:current.EstimatedTax)&&void 0!==_d?_d:0),contractValue=null!==(_e=data.contractValue)&&void 0!==_e?_e:current.ContractValue,overUnder=null!=contractValue?totalBudget-contractValue:void 0,updateData={};void 0!==data.divisionCode&&(updateData.Title=data.divisionCode),void 0!==data.divisionDescription&&(updateData.DivisionDescription=data.divisionDescription),void 0!==data.originalBudget&&(updateData.OriginalBudget=data.originalBudget),void 0!==data.estimatedTax&&(updateData.EstimatedTax=data.estimatedTax),void 0!==data.subcontractorName&&(updateData.SubcontractorName=data.subcontractorName),void 0!==data.contractValue&&(updateData.ContractValue=data.contractValue),void 0!==data.enrolledInSDI&&(updateData.EnrolledInSDI=data.enrolledInSDI),void 0!==data.bondRequired&&(updateData.BondRequired=data.bondRequired),void 0!==data.loiSentDate&&(updateData.LOISentDate=data.loiSentDate),void 0!==data.loiReturnedDate&&(updateData.LOIReturnedDate=data.loiReturnedDate),void 0!==data.contractSentDate&&(updateData.ContractSentDate=data.contractSentDate),void 0!==data.contractExecutedDate&&(updateData.ContractExecutedDate=data.contractExecutedDate),void 0!==data.insuranceCOIReceivedDate&&(updateData.InsuranceCOIReceivedDate=data.insuranceCOIReceivedDate),void 0!==data.status&&(updateData.Status=data.status),void 0!==data.notes&&(updateData.Notes=data.notes),void 0!==data.compiledCommitmentPdfUrl&&(updateData.CompiledCommitmentPdfUrl=data.compiledCommitmentPdfUrl),void 0!==data.compiledCommitmentFileId&&(updateData.CompiledCommitmentFileId=data.compiledCommitmentFileId),void 0!==data.compiledCommitmentFileName&&(updateData.CompiledCommitmentFileName=data.compiledCommitmentFileName),void 0!==data.eVerifyContractNumber&&(updateData.EVerifyContractNumber=data.eVerifyContractNumber),void 0!==data.eVerifySentDate&&(updateData.EVerifySentDate=data.eVerifySentDate),void 0!==data.eVerifyReminderDate&&(updateData.EVerifyReminderDate=data.eVerifyReminderDate),void 0!==data.eVerifyReceivedDate&&(updateData.EVerifyReceivedDate=data.eVerifyReceivedDate),void 0!==data.eVerifyStatus&&(updateData.EVerifyStatus=data.eVerifyStatus),updateData.TotalBudget=totalBudget,void 0!==overUnder&&(updateData.OverUnder=overUnder),await this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.getById(entryId).update(updateData);const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.getById(entryId)();return performanceService.endMark("sp:updateBuyoutEntry"),this.mapToBuyoutEntry(updated)}async removeBuyoutEntry(_projectCode,entryId){performanceService.startMark("sp:removeBuyoutEntry"),await this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.getById(entryId).delete(),performanceService.endMark("sp:removeBuyoutEntry")}mapToBuyoutEntry(item){return{id:item.Id,projectCode:item.ProjectCode,divisionCode:item.Title,divisionDescription:item.DivisionDescription,isStandard:item.IsStandard,originalBudget:item.OriginalBudget||0,estimatedTax:item.EstimatedTax||0,totalBudget:item.TotalBudget||0,subcontractorName:item.SubcontractorName,contractValue:item.ContractValue,overUnder:item.OverUnder,enrolledInSDI:item.EnrolledInSDI||!1,bondRequired:item.BondRequired||!1,qScore:item.QScore,compassPreQualStatus:item.CompassPreQualStatus,scopeMatchesBudget:item.ScopeMatchesBudget,exhibitCInsuranceConfirmed:item.ExhibitCInsuranceConfirmed,exhibitDScheduleConfirmed:item.ExhibitDScheduleConfirmed,exhibitESafetyConfirmed:item.ExhibitESafetyConfirmed,commitmentStatus:item.CommitmentStatus||"Budgeted",waiverRequired:item.WaiverRequired||!1,waiverType:item.WaiverType,waiverReason:item.WaiverReason,compiledCommitmentPdfUrl:item.CompiledCommitmentPdfUrl,compiledCommitmentFileId:item.CompiledCommitmentFileId,compiledCommitmentFileName:item.CompiledCommitmentFileName,eVerifyContractNumber:item.EVerifyContractNumber,eVerifySentDate:item.EVerifySentDate,eVerifyReminderDate:item.EVerifyReminderDate,eVerifyReceivedDate:item.EVerifyReceivedDate,eVerifyStatus:item.EVerifyStatus||void 0,currentApprovalStep:item.CurrentApprovalStep,approvalHistory:[],contractTrackingStatus:item.ContractTrackingStatus||void 0,currentContractTrackingStep:item.CurrentContractTrackingStep,contractTrackingHistory:[],loiSentDate:item.LOISentDate,loiReturnedDate:item.LOIReturnedDate,contractSentDate:item.ContractSentDate,contractExecutedDate:item.ContractExecutedDate,insuranceCOIReceivedDate:item.InsuranceCOIReceivedDate,status:item.Status,notes:item.Notes,createdDate:item.Created,modifiedDate:item.Modified}}mapToPermissionTemplate(item){let toolAccess=[];try{const raw=item[PERMISSION_TEMPLATES_COLUMNS_toolAccess];"string"==typeof raw&&raw&&(toolAccess=JSON.parse(raw))}catch(_a){}return{id:item[PERMISSION_TEMPLATES_COLUMNS_id]||item.Id,name:item[PERMISSION_TEMPLATES_COLUMNS_name]||"",description:item[PERMISSION_TEMPLATES_COLUMNS_description]||"",isGlobal:!!item[PERMISSION_TEMPLATES_COLUMNS_isGlobal],globalAccess:!!item[PERMISSION_TEMPLATES_COLUMNS_globalAccess],identityType:item[PERMISSION_TEMPLATES_COLUMNS_identityType]||"Internal",toolAccess,isDefault:!!item[PERMISSION_TEMPLATES_COLUMNS_isDefault],isActive:!!item[PERMISSION_TEMPLATES_COLUMNS_isActive],version:item.Version||1,promotedFromTier:item.PromotedFromTier,createdBy:item[PERMISSION_TEMPLATES_COLUMNS_createdBy]||"",createdDate:item[PERMISSION_TEMPLATES_COLUMNS_createdDate]||"",lastModifiedBy:item[PERMISSION_TEMPLATES_COLUMNS_lastModifiedBy]||"",lastModifiedDate:item[PERMISSION_TEMPLATES_COLUMNS_lastModifiedDate]||""}}mapToSecurityGroupMapping(item){return{id:item[SECURITY_GROUP_MAPPINGS_COLUMNS_id]||item.Id,securityGroupId:item[SECURITY_GROUP_MAPPINGS_COLUMNS_securityGroupId]||"",securityGroupName:item[SECURITY_GROUP_MAPPINGS_COLUMNS_securityGroupName]||"",defaultTemplateId:item[SECURITY_GROUP_MAPPINGS_COLUMNS_defaultTemplateId]||0,isActive:!!item[SECURITY_GROUP_MAPPINGS_COLUMNS_isActive]}}mapToProjectTeamAssignment(item){let granularFlagOverrides;try{const raw=item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.granularFlagOverrides];"string"==typeof raw&&raw&&(granularFlagOverrides=JSON.parse(raw))}catch(_a){}return{id:item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.id]||item.Id,projectCode:item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.projectCode]||"",userId:item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.userId]||"",userDisplayName:item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.userDisplayName]||"",userEmail:item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.userEmail]||"",assignedRole:item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.assignedRole]||"",templateOverrideId:item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.templateOverrideId],granularFlagOverrides,assignedBy:item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.assignedBy]||"",assignedDate:item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.assignedDate]||"",isActive:!!item[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.isActive]}}async submitCommitmentForApproval(projectCode,entryId,_submittedBy){performanceService.startMark("sp:submitCommitmentForApproval");const entry=(await this.getBuyoutEntries(projectCode)).find(e=>e.id===entryId);if(!entry)throw new Error(`Buyout entry ${entryId} not found`);const{evaluateCommitmentRisk,determineWaiverType}=await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,"./packages/hbc-sp-services/src/utils/riskEngine.ts")),risk=evaluateCommitmentRisk(entry),waiverType=risk.requiresWaiver?determineWaiverType(entry):void 0;return await this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.getById(entryId).update({CommitmentStatus:risk.requiresWaiver?"WaiverPending":"PendingReview",WaiverRequired:risk.requiresWaiver,WaiverType:waiverType,CurrentApprovalStep:"PX"}),await this.sp.web.lists.getByTitle(LIST_NAMES.COMMITMENT_APPROVALS).items.add({BuyoutEntryId:entryId,ProjectCode:projectCode,Step:"PX",ApproverName:"Project Executive",ApproverEmail:"",Status:"Pending",WaiverType:waiverType}),performanceService.endMark("sp:submitCommitmentForApproval"),(await this.getBuyoutEntries(projectCode)).find(e=>e.id===entryId)}async respondToCommitmentApproval(projectCode,entryId,approved,comment,escalate){var _a;performanceService.startMark("sp:respondToCommitmentApproval");const pending=(await this.getCommitmentApprovalHistory(projectCode,entryId)).find(a=>"Pending"===a.status);if(!pending)throw new Error("No pending approval step found");const entry=(await this.getBuyoutEntries(projectCode)).find(e=>e.id===entryId);if(!entry)throw new Error(`Buyout entry ${entryId} not found`);let newStatus,nextStep;await this.sp.web.lists.getByTitle(LIST_NAMES.COMMITMENT_APPROVALS).items.getById(pending.id).update({Status:approved?escalate?"Escalated":"Approved":"Rejected",Comment:comment,ActionDate:(new Date).toISOString()}),approved?escalate&&"ComplianceManager"===pending.step?(newStatus="CFOReview",nextStep="CFO",await this.sp.web.lists.getByTitle(LIST_NAMES.COMMITMENT_APPROVALS).items.add({BuyoutEntryId:entryId,ProjectCode:projectCode,Step:"CFO",ApproverName:"CFO",ApproverEmail:"",Status:"Pending",WaiverType:entry.waiverType})):"PX"===pending.step&&entry.waiverRequired&&(null!==(_a=entry.contractValue)&&void 0!==_a?_a:0)>=25e4?(newStatus="ComplianceReview",nextStep="ComplianceManager",await this.sp.web.lists.getByTitle(LIST_NAMES.COMMITMENT_APPROVALS).items.add({BuyoutEntryId:entryId,ProjectCode:projectCode,Step:"ComplianceManager",ApproverName:"Compliance Manager",ApproverEmail:"",Status:"Pending",WaiverType:entry.waiverType})):(newStatus="Committed",nextStep=void 0):(newStatus="Rejected",nextStep=void 0);const updateData={CommitmentStatus:newStatus,CurrentApprovalStep:null!=nextStep?nextStep:null};return"Committed"===newStatus&&(updateData.Status="Executed"),await this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.getById(entryId).update(updateData),performanceService.endMark("sp:respondToCommitmentApproval"),(await this.getBuyoutEntries(projectCode)).find(e=>e.id===entryId)}async getCommitmentApprovalHistory(projectCode,entryId){performanceService.startMark("sp:getCommitmentApprovalHistory");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.COMMITMENT_APPROVALS).items.filter(`ProjectCode eq '${projectCode}' and BuyoutEntryId eq ${entryId}`).orderBy("Id",!0)();return performanceService.endMark("sp:getCommitmentApprovalHistory"),items.map(item=>({id:item.Id,buyoutEntryId:item.BuyoutEntryId,projectCode:item.ProjectCode,step:item.Step,approverName:item.ApproverName,approverEmail:item.ApproverEmail,status:item.Status,comment:item.Comment,actionDate:item.ActionDate,waiverType:item.WaiverType}))}getNextTrackingStep(current){const steps=SharePointDataService.TRACKING_STEP_ORDER,idx=steps.indexOf(current);return idx<steps.length-1?steps[idx+1]:null}resolveTrackingStepApprover(chain,step){var _a;const stepOrder=SharePointDataService.TRACKING_STEP_TO_ORDER[step],resolved=chain.find(s=>s.stepOrder===stepOrder);return(null===(_a=null==resolved?void 0:resolved.assignee)||void 0===_a?void 0:_a.email)?{name:resolved.assignee.displayName,email:resolved.assignee.email}:{name:"Approver",email:""}}async submitContractTracking(projectCode,entryId,_submittedBy){var _a,_b,_c,_d;performanceService.startMark("sp:submitContractTracking");const entry=(await this.getBuyoutEntries(projectCode)).find(e=>e.id===entryId);if(!entry)throw new Error(`Buyout entry ${entryId} not found`);let firstStep="APM_PA",chain=null;try{chain=await this.resolveWorkflowChain(enums.WorkflowKey.CONTRACT_TRACKING,projectCode);const apmStep=chain.find(s=>1===s.stepOrder);(null==apmStep?void 0:apmStep.skipped)&&(firstStep="ProjectManager",await this._getProjectWeb().lists.getByTitle(LIST_NAMES.CONTRACT_TRACKING_APPROVALS).items.add({BuyoutEntryId:entryId,ProjectCode:projectCode,Step:"APM_PA",ApproverName:null!==(_b=null===(_a=apmStep.assignee)||void 0===_a?void 0:_a.displayName)&&void 0!==_b?_b:"APM/PA",ApproverEmail:null!==(_d=null===(_c=apmStep.assignee)||void 0===_c?void 0:_c.email)&&void 0!==_d?_d:"",Status:"Skipped",ActionDate:(new Date).toISOString(),SkippedReason:"No APM/PA assigned for this project"}))}catch(_e){}const approver=chain?this.resolveTrackingStepApprover(chain,firstStep):{name:"Approver",email:""};return await this._getProjectWeb().lists.getByTitle(LIST_NAMES.CONTRACT_TRACKING_APPROVALS).items.add({BuyoutEntryId:entryId,ProjectCode:projectCode,Step:firstStep,ApproverName:approver.name,ApproverEmail:approver.email,Status:"Pending"}),await this._getProjectWeb().lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.getById(entryId).update({ContractTrackingStatus:SharePointDataService.TRACKING_STEP_STATUS[firstStep],CurrentContractTrackingStep:firstStep}),this.logAudit({Action:enums.AuditAction.ContractTrackingSubmitted,EntityType:enums.EntityType.ContractTracking,EntityId:String(entryId),Details:`Contract tracking submitted for ${entry.divisionDescription}`}),performanceService.endMark("sp:submitContractTracking"),(await this.getBuyoutEntries(projectCode)).find(e=>e.id===entryId)}async respondToContractTracking(projectCode,entryId,approved,comment){performanceService.startMark("sp:respondToContractTracking");const pending=(await this.getContractTrackingHistory(projectCode,entryId)).find(a=>"Pending"===a.status);if(!pending)throw new Error("No pending contract tracking step found");let newStatus,nextStep;if(await this._getProjectWeb().lists.getByTitle(LIST_NAMES.CONTRACT_TRACKING_APPROVALS).items.getById(pending.id).update({Status:approved?"Approved":"Rejected",Comment:comment,ActionDate:(new Date).toISOString()}),approved){const next=this.getNextTrackingStep(pending.step);if(next){newStatus=SharePointDataService.TRACKING_STEP_STATUS[next],nextStep=next;let approver={name:"Approver",email:""};try{const chain=await this.resolveWorkflowChain(enums.WorkflowKey.CONTRACT_TRACKING,projectCode);approver=this.resolveTrackingStepApprover(chain,next)}catch(_a){}await this._getProjectWeb().lists.getByTitle(LIST_NAMES.CONTRACT_TRACKING_APPROVALS).items.add({BuyoutEntryId:entryId,ProjectCode:projectCode,Step:next,ApproverName:approver.name,ApproverEmail:approver.email,Status:"Pending"}),this.logAudit({Action:enums.AuditAction.ContractTrackingApproved,EntityType:enums.EntityType.ContractTracking,EntityId:String(entryId),Details:`Contract tracking approved at ${pending.step}, advancing to ${next}`})}else newStatus="Tracked",nextStep=void 0,this.logAudit({Action:enums.AuditAction.ContractTrackingApproved,EntityType:enums.EntityType.ContractTracking,EntityId:String(entryId),Details:"Contract tracking fully approved â€” status: Tracked"})}else newStatus="Rejected",nextStep=void 0,this.logAudit({Action:enums.AuditAction.ContractTrackingRejected,EntityType:enums.EntityType.ContractTracking,EntityId:String(entryId),Details:`Contract tracking rejected at ${pending.step}`});return await this._getProjectWeb().lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.getById(entryId).update({ContractTrackingStatus:newStatus,CurrentContractTrackingStep:null!=nextStep?nextStep:null}),performanceService.endMark("sp:respondToContractTracking"),(await this.getBuyoutEntries(projectCode)).find(e=>e.id===entryId)}async getContractTrackingHistory(projectCode,entryId){performanceService.startMark("sp:getContractTrackingHistory");const items=await this._getProjectWeb().lists.getByTitle(LIST_NAMES.CONTRACT_TRACKING_APPROVALS).items.filter(`ProjectCode eq '${projectCode}' and BuyoutEntryId eq ${entryId}`).orderBy("Id",!0)();return performanceService.endMark("sp:getContractTrackingHistory"),items.map(item=>({id:item.Id,buyoutEntryId:item.BuyoutEntryId,projectCode:item.ProjectCode,step:item.Step,approverName:item.ApproverName,approverEmail:item.ApproverEmail,status:item.Status,comment:item.Comment,actionDate:item.ActionDate,skippedReason:item.SkippedReason}))}async uploadCommitmentDocument(projectCode,entryId,file){performanceService.startMark("sp:uploadCommitmentDocument");const folderPath="Shared Documents/Commitments";try{await this.sp.web.getFolderByServerRelativePath(folderPath).select("Exists")()}catch(_a){await this.sp.web.folders.addUsingPath(folderPath)}const fileName=`${projectCode}_${entryId}_${file.name}`,result=await this.sp.web.getFolderByServerRelativePath(folderPath).files.addUsingPath(fileName,file,{Overwrite:!0}),fileUrl=result.data.ServerRelativeUrl,fileId=result.data.UniqueId||`file-${Date.now()}`;return await this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.getById(entryId).update({CompiledCommitmentPdfUrl:fileUrl,CompiledCommitmentFileId:fileId,CompiledCommitmentFileName:fileName}),performanceService.endMark("sp:uploadCommitmentDocument"),{fileId,fileName,fileUrl}}async getComplianceLog(filters){performanceService.startMark("sp:getComplianceLog");let filterStr="SubcontractorName ne null";(null==filters?void 0:filters.projectCode)&&(filterStr+=` and ProjectCode eq '${filters.projectCode}'`),(null==filters?void 0:filters.commitmentStatus)&&(filterStr+=` and CommitmentStatus eq '${filters.commitmentStatus}'`),(null==filters?void 0:filters.eVerifyStatus)&&(filterStr+=` and EVerifyStatus eq '${filters.eVerifyStatus}'`);let entries=(await this.sp.web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.filter(filterStr).orderBy("ProjectCode",!0).top(500)()).map(item=>{const buyout=this.mapToBuyoutEntry(item);return this.mapToComplianceEntry(buyout)});if(null==filters?void 0:filters.searchQuery){const q=filters.searchQuery.toLowerCase();entries=entries.filter(e=>e.subcontractorName.toLowerCase().includes(q)||e.projectCode.toLowerCase().includes(q)||e.divisionDescription.toLowerCase().includes(q))}return performanceService.endMark("sp:getComplianceLog"),entries}async getComplianceSummary(){performanceService.startMark("sp:getComplianceSummary");const entries=await this.getComplianceLog();return performanceService.endMark("sp:getComplianceSummary"),{totalCommitments:entries.length,fullyCompliant:entries.filter(e=>e.overallCompliant).length,eVerifyPending:entries.filter(e=>"Sent"===e.eVerifyStatus||"Reminder Sent"===e.eVerifyStatus||"Not Sent"===e.eVerifyStatus).length,eVerifyOverdue:entries.filter(e=>"Overdue"===e.eVerifyStatus).length,waiversPending:entries.filter(e=>"WaiverPending"===e.commitmentStatus).length,documentsMissing:entries.filter(e=>!e.documentsCompliant).length}}mapToComplianceEntry(entry){const riskCompliant=null!=entry.qScore&&entry.qScore>=70&&"Approved"===entry.compassPreQualStatus,documentsCompliant=!0===entry.scopeMatchesBudget&&!0===entry.exhibitCInsuranceConfirmed&&!0===entry.exhibitDScheduleConfirmed&&!0===entry.exhibitESafetyConfirmed,hasDoc=!(!entry.compiledCommitmentPdfUrl&&!entry.compiledCommitmentFileId),insuranceCompliant=entry.enrolledInSDI&&!!entry.insuranceCOIReceivedDate,eVerifyCompliant="Received"===entry.eVerifyStatus,overallCompliant=riskCompliant&&documentsCompliant&&hasDoc&&insuranceCompliant&&eVerifyCompliant;return{id:entry.id,projectCode:entry.projectCode,projectName:entry.projectCode,divisionCode:entry.divisionCode,divisionDescription:entry.divisionDescription,subcontractorName:entry.subcontractorName||"",contractValue:entry.contractValue||0,riskCompliant,qScore:entry.qScore,compassStatus:entry.compassPreQualStatus,documentsCompliant,scopeMatch:!0===entry.scopeMatchesBudget,exhibitC:!0===entry.exhibitCInsuranceConfirmed,exhibitD:!0===entry.exhibitDScheduleConfirmed,exhibitE:!0===entry.exhibitESafetyConfirmed,hasCommitmentDocument:hasDoc,insuranceCompliant,sdiEnrolled:entry.enrolledInSDI,bondRequired:entry.bondRequired,coiReceived:!!entry.insuranceCOIReceivedDate,eVerifyCompliant,eVerifyStatus:entry.eVerifyStatus||"Not Sent",eVerifyContractNumber:entry.eVerifyContractNumber,eVerifySentDate:entry.eVerifySentDate,eVerifyReminderDate:entry.eVerifyReminderDate,eVerifyReceivedDate:entry.eVerifyReceivedDate,commitmentStatus:entry.commitmentStatus,overallCompliant}}async rekeyProjectCode(oldCode,newCode,leadId){performanceService.startMark("sp:rekeyProjectCode"),await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.getById(leadId).update({ProjectCode:newCode,OfficialJobNumber:newCode});const batchRekey=async(listName,columnName)=>{const items=await this.sp.web.lists.getByTitle(listName).items.filter(`${columnName} eq '${oldCode}'`).select("Id")();if(0===items.length)return;const batch=this.sp.web.createBatch();for(const item of items)this.sp.web.lists.getByTitle(listName).items.getById(item.Id).inBatch(batch).update({[columnName]:newCode});await batch.execute()};await batchRekey(LIST_NAMES.ESTIMATING_TRACKER,"ProjectCode"),await batchRekey(LIST_NAMES.MARKETING_PROJECT_RECORDS,"projectCode"),await batchRekey(LIST_NAMES.PROVISIONING_LOG,"ProjectCode"),await batchRekey(LIST_NAMES.BUYOUT_LOG,"ProjectCode"),await batchRekey(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS,PROJECT_TEAM_ASSIGNMENTS_COLUMNS.projectCode),performanceService.endMark("sp:rekeyProjectCode")}async getActiveProjects(options){const cacheKey=CACHE_KEYS_ACTIVE_PROJECTS+buildCacheKeySuffix(options),cached=cacheService.get(cacheKey);if(cached)return cached;performanceService.startMark("sp:getActiveProjects");const filterParts=[];(null==options?void 0:options.status)&&filterParts.push(`Status eq '${options.status}'`),(null==options?void 0:options.sector)&&filterParts.push(`Sector eq '${options.sector}'`),(null==options?void 0:options.projectExecutive)&&filterParts.push(`ProjectExecutive eq '${options.projectExecutive}'`),(null==options?void 0:options.projectManager)&&filterParts.push(`LeadPM eq '${options.projectManager}'`),(null==options?void 0:options.region)&&filterParts.push(`Region eq '${options.region}'`);try{let query=this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.top((null==options?void 0:options.top)||500);filterParts.length>0&&(query=query.filter(filterParts.join(" and "))),(null==options?void 0:options.orderBy)&&(query=query.orderBy(options.orderBy,!1!==options.orderAscending));const result=(await query()).map(item=>this.mapToActiveProject(item));return cacheService.set(cacheKey,result,9e5),performanceService.endMark("sp:getActiveProjects"),result}catch(err){throw performanceService.endMark("sp:getActiveProjects"),this.handleError("getActiveProjects",err,{entityType:"Project"})}}async getActiveProjectById(id){const cacheKey=CACHE_KEYS_ACTIVE_PROJECTS+"_id_"+id,cached=cacheService.get(cacheKey);if(cached)return cached;performanceService.startMark("sp:getActiveProjectById");try{const item=await this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.getById(id)(),result=this.mapToActiveProject(item);return cacheService.set(cacheKey,result,9e5),performanceService.endMark("sp:getActiveProjectById"),result}catch(err){return performanceService.endMark("sp:getActiveProjectById"),this.handleError("getActiveProjectById",err,{entityType:"Project",entityId:String(id),rethrow:!1}),null}}async syncActiveProject(projectCode){performanceService.startMark("sp:syncActiveProject");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.filter(`ProjectCode eq '${projectCode}'`)();if(0===items.length)throw performanceService.endMark("sp:syncActiveProject"),new DataServiceError("syncActiveProject",`Project ${projectCode} not found in portfolio`,{entityType:"Project",entityId:projectCode});const projectId=items[0].Id;await this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.getById(projectId).update({LastSyncDate:(new Date).toISOString()});const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.getById(projectId)();return cacheService.removeByPrefix(CACHE_KEYS_ACTIVE_PROJECTS),cacheService.removeByPrefix(CACHE_KEYS_PORTFOLIO_SUMMARY),cacheService.removeByPrefix(CACHE_KEYS_PERSONNEL_WORKLOAD),performanceService.endMark("sp:syncActiveProject"),this.mapToActiveProject(updated)}catch(err){throw performanceService.endMark("sp:syncActiveProject"),this.handleError("syncActiveProject",err,{entityType:"Project",entityId:projectCode})}}async updateActiveProject(id,data){performanceService.startMark("sp:updateActiveProject");try{const updateData={};void 0!==data.projectName&&(updateData.Title=data.projectName),void 0!==data.status&&(updateData.Status=data.status),void 0!==data.sector&&(updateData.Sector=data.sector),void 0!==data.region&&(updateData.Region=data.region),void 0!==data.statusComments&&(updateData.StatusComments=data.statusComments),data.personnel&&(void 0!==data.personnel.projectExecutive&&(updateData.ProjectExecutive=data.personnel.projectExecutive),void 0!==data.personnel.leadPM&&(updateData.LeadPM=data.personnel.leadPM),void 0!==data.personnel.additionalPM&&(updateData.AdditionalPM=data.personnel.additionalPM),void 0!==data.personnel.assistantPM&&(updateData.AssistantPM=data.personnel.assistantPM),void 0!==data.personnel.projectAccountant&&(updateData.ProjectAccountant=data.personnel.projectAccountant),void 0!==data.personnel.leadSuper&&(updateData.LeadSuper=data.personnel.leadSuper)),data.financials&&(void 0!==data.financials.originalContract&&(updateData.OriginalContract=data.financials.originalContract),void 0!==data.financials.changeOrders&&(updateData.ChangeOrders=data.financials.changeOrders),void 0!==data.financials.currentContractValue&&(updateData.CurrentContractValue=data.financials.currentContractValue),void 0!==data.financials.billingsToDate&&(updateData.BillingsToDate=data.financials.billingsToDate),void 0!==data.financials.unbilled&&(updateData.Unbilled=data.financials.unbilled),void 0!==data.financials.projectedFee&&(updateData.ProjectedFee=data.financials.projectedFee),void 0!==data.financials.projectedFeePct&&(updateData.ProjectedFeePct=data.financials.projectedFeePct)),data.schedule&&(void 0!==data.schedule.startDate&&(updateData.StartDate=data.schedule.startDate),void 0!==data.schedule.substantialCompletionDate&&(updateData.SubstantialCompletionDate=data.schedule.substantialCompletionDate),void 0!==data.schedule.currentPhase&&(updateData.CurrentPhase=data.schedule.currentPhase),void 0!==data.schedule.percentComplete&&(updateData.PercentComplete=data.schedule.percentComplete)),updateData.LastModified=(new Date).toISOString(),await this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.getById(id).update(updateData);const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.getById(id)();return cacheService.removeByPrefix(CACHE_KEYS_ACTIVE_PROJECTS),cacheService.removeByPrefix(CACHE_KEYS_PORTFOLIO_SUMMARY),cacheService.removeByPrefix(CACHE_KEYS_PERSONNEL_WORKLOAD),performanceService.endMark("sp:updateActiveProject"),this.mapToActiveProject(updated)}catch(err){throw performanceService.endMark("sp:updateActiveProject"),this.handleError("updateActiveProject",err,{entityType:"Project",entityId:String(id)})}}async getPortfolioSummary(filters){const cacheKey=CACHE_KEYS_PORTFOLIO_SUMMARY+buildCacheKeySuffix(filters),cached=cacheService.get(cacheKey);if(cached)return cached;performanceService.startMark("sp:getPortfolioSummary");try{const projects=await this.getActiveProjects(filters),totalBacklog=projects.reduce((sum,p)=>sum+(p.financials.remainingValue||0),0),totalOriginalContract=projects.reduce((sum,p)=>sum+(p.financials.originalContract||0),0),totalBillingsToDate=projects.reduce((sum,p)=>sum+(p.financials.billingsToDate||0),0),totalUnbilled=projects.reduce((sum,p)=>sum+(p.financials.unbilled||0),0),projectsWithFee=projects.filter(p=>null!=p.financials.projectedFeePct),averageFeePct=projectsWithFee.length>0?projectsWithFee.reduce((sum,p)=>sum+(p.financials.projectedFeePct||0),0)/projectsWithFee.length:0,monthlyBurnRate=totalBillingsToDate/12,projectsByStatus={Precon:projects.filter(p=>"Precon"===p.status).length,Construction:projects.filter(p=>"Construction"===p.status).length,"Final Payment":projects.filter(p=>"Final Payment"===p.status).length},projectsBySector={Commercial:projects.filter(p=>"Commercial"===p.sector).length,Residential:projects.filter(p=>"Residential"===p.sector).length},projectsWithAlerts=projects.filter(p=>p.hasUnbilledAlert||p.hasScheduleAlert||p.hasFeeErosionAlert).length,result={totalBacklog,totalOriginalContract,totalBillingsToDate,totalUnbilled,averageFeePct,monthlyBurnRate,projectCount:projects.length,projectsByStatus,projectsBySector,projectsWithAlerts};return cacheService.set(cacheKey,result,9e5),performanceService.endMark("sp:getPortfolioSummary"),result}catch(err){throw performanceService.endMark("sp:getPortfolioSummary"),this.handleError("getPortfolioSummary",err,{entityType:"Project"})}}async getPersonnelWorkload(role){const cacheKey=CACHE_KEYS_PERSONNEL_WORKLOAD+(role?"_"+role:""),cached=cacheService.get(cacheKey);if(cached)return cached;performanceService.startMark("sp:getPersonnelWorkload");try{const projects=await this.getActiveProjects(),workloadMap=new Map;for(const project of projects){if((!role||"PX"===role)&&project.personnel.projectExecutive){const name=project.personnel.projectExecutive,existing=workloadMap.get(`PX-${name}`)||{name,email:project.personnel.projectExecutiveEmail,role:"PX",projectCount:0,totalContractValue:0,projects:[]};existing.projectCount++,existing.totalContractValue+=project.financials.currentContractValue||project.financials.originalContract||0,existing.projects.push(project),workloadMap.set(`PX-${name}`,existing)}if((!role||"PM"===role)&&project.personnel.leadPM){const name=project.personnel.leadPM,existing=workloadMap.get(`PM-${name}`)||{name,email:project.personnel.leadPMEmail,role:"PM",projectCount:0,totalContractValue:0,projects:[]};existing.projectCount++,existing.totalContractValue+=project.financials.currentContractValue||project.financials.originalContract||0,existing.projects.push(project),workloadMap.set(`PM-${name}`,existing)}if((!role||"Super"===role)&&project.personnel.leadSuper){const name=project.personnel.leadSuper,existing=workloadMap.get(`Super-${name}`)||{name,role:"Super",projectCount:0,totalContractValue:0,projects:[]};existing.projectCount++,existing.totalContractValue+=project.financials.currentContractValue||project.financials.originalContract||0,existing.projects.push(project),workloadMap.set(`Super-${name}`,existing)}}const result=Array.from(workloadMap.values()).sort((a,b)=>b.projectCount-a.projectCount);return cacheService.set(cacheKey,result,9e5),performanceService.endMark("sp:getPersonnelWorkload"),result}catch(err){throw performanceService.endMark("sp:getPersonnelWorkload"),this.handleError("getPersonnelWorkload",err,{entityType:"Project"})}}async triggerPortfolioSync(){performanceService.startMark("sp:triggerPortfolioSync");try{const now=(new Date).toISOString(),items=await this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.select("Id").top(5e3)(),batch=this.sp.web.createBatch();for(const item of items)this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.getById(item.Id).inBatch(batch).update({LastSyncDate:now});await batch.execute(),cacheService.removeByPrefix(CACHE_KEYS_ACTIVE_PROJECTS),cacheService.removeByPrefix(CACHE_KEYS_PORTFOLIO_SUMMARY),cacheService.removeByPrefix(CACHE_KEYS_PERSONNEL_WORKLOAD),performanceService.endMark("sp:triggerPortfolioSync")}catch(err){throw performanceService.endMark("sp:triggerPortfolioSync"),this.handleError("triggerPortfolioSync",err,{entityType:"Project"})}}mapToActiveProject(item){const currentContractValue=item.CurrentContractValue||item.OriginalContract||0,unbilled=item.Unbilled||0,unbilledPct=currentContractValue>0?unbilled/currentContractValue*100:0;return{id:item.Id,jobNumber:item.JobNumber,projectCode:item.ProjectCode,projectName:item.Title,status:item.Status,sector:item.Sector,region:item.Region,personnel:{projectExecutive:item.ProjectExecutive,projectExecutiveEmail:item.ProjectExecutiveEmail,leadPM:item.LeadPM,leadPMEmail:item.LeadPMEmail,additionalPM:item.AdditionalPM,assistantPM:item.AssistantPM,projectAccountant:item.ProjectAccountant,projectAssistant:item.ProjectAssistant,leadSuper:item.LeadSuper,superintendent:item.Superintendent,assistantSuper:item.AssistantSuper},financials:{originalContract:item.OriginalContract,changeOrders:item.ChangeOrders,currentContractValue,billingsToDate:item.BillingsToDate,unbilled,projectedFee:item.ProjectedFee,projectedFeePct:item.ProjectedFeePct,projectedCost:item.ProjectedCost,remainingValue:item.RemainingValue},schedule:{startDate:item.StartDate,substantialCompletionDate:item.SubstantialCompletionDate,nocExpiration:item.NOCExpiration,currentPhase:item.CurrentPhase,percentComplete:item.PercentComplete},riskMetrics:{averageQScore:item.AverageQScore,openWaiverCount:item.OpenWaiverCount,pendingCommitments:item.PendingCommitments,complianceStatus:item.ComplianceStatus},statusComments:item.StatusComments,projectSiteUrl:item.ProjectSiteUrl,lastSyncDate:item.LastSyncDate,lastModified:item.Modified,hasUnbilledAlert:unbilledPct>=DEFAULT_ALERT_THRESHOLDS_unbilledWarningPct,hasScheduleAlert:item.HasScheduleAlert,hasFeeErosionAlert:item.HasFeeErosionAlert}}async syncDenormalizedFields(leadId){performanceService.startMark("sp:syncDenormalizedFields");const lead=await this.getLeadById(leadId);if(!lead)return;const estItems=await this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_TRACKER).items.filter(`LeadID eq ${leadId}`).select("Id")();if(estItems.length>0){const batch=this.sp.web.createBatch();for(const item of estItems)this.sp.web.lists.getByTitle(LIST_NAMES.ESTIMATING_TRACKER).items.getById(item.Id).inBatch(batch).update({Title:lead.Title});await batch.execute()}if(!lead.ProjectCode)return;const pmpItems=await this.sp.web.lists.getByTitle(LIST_NAMES.PMP).items.filter(`projectCode eq '${lead.ProjectCode}'`).select("Id")();if(pmpItems.length>0){const b2=this.sp.web.createBatch();for(const i of pmpItems)this.sp.web.lists.getByTitle(LIST_NAMES.PMP).items.getById(i.Id).inBatch(b2).update({projectName:lead.Title});await b2.execute()}const mktItems=await this.sp.web.lists.getByTitle(LIST_NAMES.MARKETING_PROJECT_RECORDS).items.filter(`projectCode eq '${lead.ProjectCode}'`).select("Id")();if(mktItems.length>0){const b3=this.sp.web.createBatch();for(const i of mktItems)this.sp.web.lists.getByTitle(LIST_NAMES.MARKETING_PROJECT_RECORDS).items.getById(i.Id).inBatch(b3).update({projectName:lead.Title});await b3.execute()}const provItems=await this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.filter(`ProjectCode eq '${lead.ProjectCode}'`).select("Id")();if(provItems.length>0){const b4=this.sp.web.createBatch();for(const i of provItems)this.sp.web.lists.getByTitle(LIST_NAMES.PROVISIONING_LOG).items.getById(i.Id).inBatch(b4).update({projectName:lead.Title});await b4.execute()}const jnrItems=await this.sp.web.lists.getByTitle(LIST_NAMES.JOB_NUMBER_REQUESTS).items.filter(`LeadID eq ${leadId}`).select("Id")();if(jnrItems.length>0){const upd={};if(lead.ProjectExecutive&&(upd.ProjectExecutive=lead.ProjectExecutive),lead.ProjectManager&&(upd.ProjectManager=lead.ProjectManager),Object.keys(upd).length>0){const b5=this.sp.web.createBatch();for(const i of jnrItems)this.sp.web.lists.getByTitle(LIST_NAMES.JOB_NUMBER_REQUESTS).items.getById(i.Id).inBatch(b5).update(upd);await b5.execute(),performanceService.endMark("sp:syncDenormalizedFields")}}}async promoteToHub(projectCode){performanceService.startMark("sp:promoteToHub");let projectLessons=[];if(this._projectSiteUrl){const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),projectWeb=Web([this.sp.web,this._projectSiteUrl]);projectLessons=await projectWeb.lists.getByTitle("Lessons_Learned").items.filter(`projectCode eq '${projectCode}' and isIncludedInFinalRecord eq 1`)()}else console.warn("[SP] promoteToHub: _projectSiteUrl not set, skipping lessons copy");for(const lesson of projectLessons){const title=String(lesson.title||"").replace(/'/g,"''");0===(await this.sp.web.lists.getByTitle(LIST_NAMES.LESSONS_LEARNED_HUB).items.filter(`projectCode eq '${projectCode}' and title eq '${title}'`).top(1)()).length&&await this.sp.web.lists.getByTitle(LIST_NAMES.LESSONS_LEARNED_HUB).items.add({projectCode:lesson.projectCode,title:lesson.title,category:lesson.category,impact:lesson.impact,description:lesson.description,recommendation:lesson.recommendation,isIncludedInFinalRecord:!0})}const pmpItems=await this.sp.web.lists.getByTitle(LIST_NAMES.PMP).items.filter(`projectCode eq '${projectCode}'`).select("Id","status")();for(const pmp of pmpItems)"Closed"!==pmp.status&&(await this.sp.web.lists.getByTitle(LIST_NAMES.PMP).items.getById(pmp.Id).update({status:"Closed",lastUpdatedAt:(new Date).toISOString()}),performanceService.endMark("sp:promoteToHub"))}mapToScorecardApprovalCycle(item){const col=SCORECARD_APPROVAL_CYCLES_COLUMNS;return{id:item[col.id]||item.Id,scorecardId:item[col.scorecardId],cycleNumber:item[col.cycleNumber],version:item[col.version]||1,steps:[],startedDate:item[col.startedDate]||"",completedDate:item[col.completedDate]||void 0,status:item[col.status]||"Active"}}mapToScorecardApprovalStep(item){const col=SCORECARD_APPROVAL_STEPS_COLUMNS;return{id:item[col.id]||item.Id,cycleId:item[col.cycleId],stepOrder:item[col.stepOrder],name:item[col.name]||"",assigneeEmail:item[col.assigneeEmail]||"",assigneeName:item[col.assigneeName]||"",assignmentSource:item[col.assignmentSource]||"Default",status:item[col.status]||"Pending",actionDate:item[col.actionDate]||void 0,comment:item[col.comment]||void 0}}mapToScorecardVersion(item){const col=SCORECARD_VERSIONS_COLUMNS;let originalScores={},committeeScores={};try{originalScores=JSON.parse(item[col.originalScores]||"{}")}catch(_a){}try{committeeScores=JSON.parse(item[col.committeeScores]||"{}")}catch(_b){}return{id:item[col.id]||item.Id,scorecardId:item[col.scorecardId],versionNumber:item[col.versionNumber],createdDate:item[col.createdDate]||"",createdBy:item[col.createdBy]||"",reason:item[col.reason]||void 0,originalScores,committeeScores,totalOriginal:item[col.totalOriginal]||void 0,totalCommittee:item[col.totalCommittee]||void 0,decision:item[col.decision]||void 0,conditions:item[col.conditions]||void 0}}async assembleScorecard(scorecardId){performanceService.startMark("sp:assembleScorecard");const col=GONOGO_SCORECARD_COLUMNS,raw=await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId)();let scores={};try{scores=JSON.parse(raw[col.scores]||"{}")}catch(_a){}let scoredByCmte=[];try{scoredByCmte=JSON.parse(raw[col.ScoredBy_Cmte]||"[]")}catch(_b){}const cycles=(await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.filter(`${SCORECARD_APPROVAL_CYCLES_COLUMNS.scorecardId} eq ${scorecardId}`).orderBy(SCORECARD_APPROVAL_CYCLES_COLUMNS.cycleNumber,!0)()).map(c=>this.mapToScorecardApprovalCycle(c));if(cycles.length>0){const cycleIds=cycles.map(c=>c.id),steps=(await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_STEPS).items.filter(cycleIds.map(cid=>`${SCORECARD_APPROVAL_STEPS_COLUMNS.cycleId} eq ${cid}`).join(" or ")).orderBy(SCORECARD_APPROVAL_STEPS_COLUMNS.stepOrder,!0)()).map(s=>this.mapToScorecardApprovalStep(s));for(const cycle of cycles)cycle.steps=steps.filter(s=>s.cycleId===cycle.id)}const versions=(await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_VERSIONS).items.filter(`${SCORECARD_VERSIONS_COLUMNS.scorecardId} eq ${scorecardId}`).orderBy(SCORECARD_VERSIONS_COLUMNS.versionNumber,!0)()).map(v=>this.mapToScorecardVersion(v));return{id:raw.ID||raw.Id,LeadID:raw[col.LeadID],ProjectCode:raw[col.ProjectCode]||void 0,scores,TotalScore_Orig:raw[col.TotalScore_Orig]||void 0,TotalScore_Cmte:raw[col.TotalScore_Cmte]||void 0,OriginatorComments:raw[col.OriginatorComments]||void 0,CommitteeComments:raw[col.CommitteeComments]||void 0,ProposalMarketingComments:raw[col.ProposalMarketingComments]||void 0,ProposalMarketingResources:raw[col.ProposalMarketingResources]||void 0,ProposalMarketingHours:raw[col.ProposalMarketingHours]||void 0,EstimatingComments:raw[col.EstimatingComments]||void 0,EstimatingResources:raw[col.EstimatingResources]||void 0,EstimatingHours:raw[col.EstimatingHours]||void 0,DecisionMakingProcess:raw[col.DecisionMakingProcess]||void 0,HBDifferentiators:raw[col.HBDifferentiators]||void 0,WinStrategy:raw[col.WinStrategy]||void 0,StrategicPursuit:raw[col.StrategicPursuit]||void 0,DecisionMakerAdvocate:raw[col.DecisionMakerAdvocate]||void 0,Decision:raw[col.Decision]||void 0,DecisionDate:raw[col.DecisionDate]||void 0,ScoredBy_Orig:raw[col.ScoredBy_Orig]||void 0,ScoredBy_Cmte:scoredByCmte,scorecardStatus:raw[col.scorecardStatus]||enums.ScorecardStatus.BDDraft,currentApprovalStep:raw[col.currentApprovalStep]||void 0,approvalCycles:cycles,committeeScoresEnteredBy:raw[col.committeeScoresEnteredBy]||void 0,committeeScoresEnteredDate:raw[col.committeeScoresEnteredDate]||void 0,committeeMeetingDate:raw[col.committeeMeetingDate]||void 0,recommendedDecision:raw[col.recommendedDecision]||void 0,finalDecision:raw[col.finalDecision]||void 0,finalDecisionBy:raw[col.finalDecisionBy]||void 0,finalDecisionDate:raw[col.finalDecisionDate]||void 0,conditionalGoConditions:raw[col.conditionalGoConditions]||void 0,currentVersion:raw[col.currentVersion]||1,versions,isLocked:!!raw[col.isLocked],unlockedBy:raw[col.unlockedBy]||void 0,unlockedDate:raw[col.unlockedDate]||void 0,unlockReason:raw[col.unlockReason]||void 0}}async createVersionSnapshot(scorecardId,reason,createdBy){var _a,_b;performanceService.startMark("sp:createVersionSnapshot");const col=GONOGO_SCORECARD_COLUMNS,vCol=SCORECARD_VERSIONS_COLUMNS,raw=await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId)();let scores={};try{scores=JSON.parse(raw[col.scores]||"{}")}catch(_c){}const origScores={},cmteScores={};for(const key of Object.keys(scores))void 0!==(null===(_a=scores[Number(key)])||void 0===_a?void 0:_a.originator)&&(origScores[key]=scores[Number(key)].originator),void 0!==(null===(_b=scores[Number(key)])||void 0===_b?void 0:_b.committee)&&(cmteScores[key]=scores[Number(key)].committee);const currentVersion=raw[col.currentVersion]||1,now=(new Date).toISOString(),result=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_VERSIONS).items.add({[vCol.scorecardId]:scorecardId,[vCol.versionNumber]:currentVersion,[vCol.createdDate]:now,[vCol.createdBy]:createdBy,[vCol.reason]:reason,[vCol.originalScores]:JSON.stringify(origScores),[vCol.committeeScores]:JSON.stringify(cmteScores),[vCol.totalOriginal]:raw[col.TotalScore_Orig]||0,[vCol.totalCommittee]:raw[col.TotalScore_Cmte]||0,[vCol.decision]:raw[col.finalDecision]||raw[col.Decision]||"",[vCol.conditions]:raw[col.conditionalGoConditions]||""});return this.logAudit({Action:enums.AuditAction.ScorecardVersionCreated,EntityType:enums.EntityType.Scorecard,EntityId:String(scorecardId),User:createdBy,Details:`Version ${currentVersion} snapshot: ${reason}`}).catch(()=>{}),performanceService.endMark("sp:createVersionSnapshot"),this.mapToScorecardVersion(result)}async submitScorecard(scorecardId,submittedBy,_approverOverride){var _a;performanceService.startMark("sp:submitScorecard");const col=GONOGO_SCORECARD_COLUMNS,cycCol=SCORECARD_APPROVAL_CYCLES_COLUMNS,stepCol=SCORECARD_APPROVAL_STEPS_COLUMNS,now=(new Date).toISOString(),raw=await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId)(),newCycleNumber=(await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.filter(`${cycCol.scorecardId} eq ${scorecardId}`)()).length+1,currentVersion=raw[col.currentVersion]||1;1===newCycleNumber&&await this.createVersionSnapshot(scorecardId,"Initial submission",submittedBy);const cycleResult=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.add({[cycCol.scorecardId]:scorecardId,[cycCol.cycleNumber]:newCycleNumber,[cycCol.version]:currentVersion,[cycCol.startedDate]:now,[cycCol.status]:"Active"}),newCycleId=cycleResult.Id||(null===(_a=cycleResult.data)||void 0===_a?void 0:_a.Id);await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_STEPS).items.add({[stepCol.cycleId]:newCycleId,[stepCol.stepOrder]:1,[stepCol.name]:"BD Representative",[stepCol.assigneeEmail]:submittedBy,[stepCol.assigneeName]:submittedBy,[stepCol.assignmentSource]:"Default",[stepCol.status]:"Approved",[stepCol.actionDate]:now,[stepCol.comment]:"Submitted for review"}),await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_STEPS).items.add({[stepCol.cycleId]:newCycleId,[stepCol.stepOrder]:2,[stepCol.name]:"Department Director",[stepCol.assigneeEmail]:"",[stepCol.assigneeName]:"",[stepCol.assignmentSource]:"Default",[stepCol.status]:"Pending"}),await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId).update({[col.scorecardStatus]:enums.ScorecardStatus.AwaitingDirectorReview,[col.currentApprovalStep]:2}),this.logAudit({Action:enums.AuditAction.ScorecardSubmitted,EntityType:enums.EntityType.Scorecard,EntityId:String(scorecardId),User:submittedBy,Details:`Scorecard submitted for director review (cycle ${newCycleNumber})`}).catch(()=>{});const result=await this.assembleScorecard(scorecardId);return performanceService.endMark("sp:submitScorecard"),result}async respondToScorecardSubmission(scorecardId,approved,comment){performanceService.startMark("sp:respondToScorecardSubmission");const col=GONOGO_SCORECARD_COLUMNS,cycCol=SCORECARD_APPROVAL_CYCLES_COLUMNS,stepCol=SCORECARD_APPROVAL_STEPS_COLUMNS,now=(new Date).toISOString(),activeCycles=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.filter(`${cycCol.scorecardId} eq ${scorecardId} and ${cycCol.status} eq 'Active'`).top(1)();if(0===activeCycles.length)throw new Error("No active approval cycle found");const cycleId=activeCycles[0].ID||activeCycles[0].Id,pendingSteps=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_STEPS).items.filter(`${stepCol.cycleId} eq ${cycleId} and ${stepCol.status} eq 'Pending'`).top(1)();if(0===pendingSteps.length)throw new Error("No pending approval step found");const stepId=pendingSteps[0].ID||pendingSteps[0].Id;await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_STEPS).items.getById(stepId).update({[stepCol.status]:approved?"Approved":"Returned",[stepCol.actionDate]:now,[stepCol.comment]:comment});const newStatus=approved?enums.ScorecardStatus.AwaitingCommitteeScoring:enums.ScorecardStatus.DirectorReturnedForRevision;await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId).update({[col.scorecardStatus]:newStatus}),approved||await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.getById(cycleId).update({[cycCol.completedDate]:now,[cycCol.status]:"Completed"}),this.logAudit({Action:approved?enums.AuditAction.ScorecardCommitteeScored:enums.AuditAction.ScorecardReturned,EntityType:enums.EntityType.Scorecard,EntityId:String(scorecardId),User:"Director",Details:approved?"Director approved â€” advancing to committee scoring":`Director returned for revision: ${comment}`}).catch(()=>{});const result=await this.assembleScorecard(scorecardId);return performanceService.endMark("sp:respondToScorecardSubmission"),result}async enterCommitteeScores(scorecardId,scores,enteredBy){performanceService.startMark("sp:enterCommitteeScores");const col=GONOGO_SCORECARD_COLUMNS,now=(new Date).toISOString(),raw=await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId)();let existingScores={};try{existingScores=JSON.parse(raw[col.scores]||"{}")}catch(_a){}for(const[criterionId,value]of Object.entries(scores))existingScores[Number(criterionId)]||(existingScores[Number(criterionId)]={}),existingScores[Number(criterionId)].committee=value;const totalCmte=calculateTotalScore(existingScores,"committee"),recommended=getRecommendedDecision(totalCmte);await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId).update({[col.scores]:JSON.stringify(existingScores),[col.TotalScore_Cmte]:totalCmte,[col.recommendedDecision]:recommended.decision,[col.committeeScoresEnteredBy]:enteredBy,[col.committeeScoresEnteredDate]:now}),this.logAudit({Action:enums.AuditAction.ScorecardCommitteeScored,EntityType:enums.EntityType.Scorecard,EntityId:String(scorecardId),User:enteredBy,Details:`Committee scores entered. Total: ${totalCmte}. Recommended: ${recommended.decision}`}).catch(()=>{});const result=await this.assembleScorecard(scorecardId);return performanceService.endMark("sp:enterCommitteeScores"),result}async recordFinalDecision(scorecardId,decision,conditions,decidedBy){performanceService.startMark("sp:recordFinalDecision");const col=GONOGO_SCORECARD_COLUMNS,cycCol=SCORECARD_APPROVAL_CYCLES_COLUMNS,now=(new Date).toISOString(),raw=await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId)(),leadId=raw[col.LeadID];let newStatus;newStatus=decision===enums.GoNoGoDecision.Go||decision===enums.GoNoGoDecision.ConditionalGo?enums.ScorecardStatus.Go:enums.ScorecardStatus.NoGo,await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId).update({[col.scorecardStatus]:newStatus,[col.finalDecision]:decision,[col.finalDecisionBy]:decidedBy||"",[col.finalDecisionDate]:now,[col.conditionalGoConditions]:conditions||"",[col.isLocked]:!0});const activeCycles=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.filter(`${cycCol.scorecardId} eq ${scorecardId} and ${cycCol.status} eq 'Active'`)();for(const cycle of activeCycles){const cId=cycle.ID||cycle.Id;await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.getById(cId).update({[cycCol.completedDate]:now,[cycCol.status]:"Completed"})}if(await this.createVersionSnapshot(scorecardId,`Final decision: ${decision}`,decidedBy||"Committee"),leadId){const leadStage=decision===enums.GoNoGoDecision.Go||decision===enums.GoNoGoDecision.ConditionalGo?enums.Stage.Opportunity:enums.Stage.ArchivedNoGo;await this.updateLead(leadId,{GoNoGoDecision:decision,GoNoGoDecisionDate:now,GoNoGoScore_Originator:raw[col.TotalScore_Orig],GoNoGoScore_Committee:raw[col.TotalScore_Cmte],Stage:leadStage})}this.logAudit({Action:enums.AuditAction.ScorecardDecisionMade,EntityType:enums.EntityType.Scorecard,EntityId:String(scorecardId),User:decidedBy||"Committee",Details:`Final decision: ${decision}${conditions?". Conditions: "+conditions:""}`}).catch(()=>{});const result=await this.assembleScorecard(scorecardId);return performanceService.endMark("sp:recordFinalDecision"),result}async unlockScorecard(scorecardId,reason){performanceService.startMark("sp:unlockScorecard");const col=GONOGO_SCORECARD_COLUMNS,now=(new Date).toISOString(),raw=await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId)();if(!raw[col.isLocked])throw new Error("Scorecard is not currently locked");const currentVersion=raw[col.currentVersion]||1;await this.createVersionSnapshot(scorecardId,`Pre-unlock snapshot: ${reason}`,raw[col.unlockedBy]||"System"),await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId).update({[col.isLocked]:!1,[col.scorecardStatus]:enums.ScorecardStatus.Unlocked,[col.currentVersion]:currentVersion+1,[col.unlockedBy]:"",[col.unlockedDate]:now,[col.unlockReason]:reason}),this.logAudit({Action:enums.AuditAction.ScorecardUnlocked,EntityType:enums.EntityType.Scorecard,EntityId:String(scorecardId),User:"Admin",Details:`Scorecard unlocked. Reason: ${reason}. Version incremented to ${currentVersion+1}`}).catch(()=>{});const result=await this.assembleScorecard(scorecardId);return performanceService.endMark("sp:unlockScorecard"),result}async relockScorecard(scorecardId,startNewCycle){var _a;performanceService.startMark("sp:relockScorecard");const col=GONOGO_SCORECARD_COLUMNS,cycCol=SCORECARD_APPROVAL_CYCLES_COLUMNS,stepCol=SCORECARD_APPROVAL_STEPS_COLUMNS,now=(new Date).toISOString();if(startNewCycle){const newCycleNumber=(await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.filter(`${cycCol.scorecardId} eq ${scorecardId}`)()).length+1,currentVersion=(await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId)())[col.currentVersion]||1,cycleResult=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.add({[cycCol.scorecardId]:scorecardId,[cycCol.cycleNumber]:newCycleNumber,[cycCol.version]:currentVersion,[cycCol.startedDate]:now,[cycCol.status]:"Active"}),newCycleId=cycleResult.Id||(null===(_a=cycleResult.data)||void 0===_a?void 0:_a.Id);await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_STEPS).items.add({[stepCol.cycleId]:newCycleId,[stepCol.stepOrder]:1,[stepCol.name]:"BD Representative",[stepCol.assigneeEmail]:"",[stepCol.assigneeName]:"",[stepCol.assignmentSource]:"Default",[stepCol.status]:"Approved",[stepCol.actionDate]:now}),await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_STEPS).items.add({[stepCol.cycleId]:newCycleId,[stepCol.stepOrder]:2,[stepCol.name]:"Department Director",[stepCol.assigneeEmail]:"",[stepCol.assigneeName]:"",[stepCol.assignmentSource]:"Default",[stepCol.status]:"Pending"}),await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId).update({[col.isLocked]:!1,[col.scorecardStatus]:enums.ScorecardStatus.AwaitingDirectorReview,[col.currentApprovalStep]:2})}else await this.createVersionSnapshot(scorecardId,"Relocked","Admin"),await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId).update({[col.isLocked]:!0,[col.scorecardStatus]:enums.ScorecardStatus.Locked});this.logAudit({Action:enums.AuditAction.ScorecardRelocked,EntityType:enums.EntityType.Scorecard,EntityId:String(scorecardId),User:"Admin",Details:startNewCycle?"Relocked with new approval cycle":"Relocked without new cycle"}).catch(()=>{});const result=await this.assembleScorecard(scorecardId);return performanceService.endMark("sp:relockScorecard"),result}async getScorecardVersions(scorecardId){performanceService.startMark("sp:getScorecardVersions");try{const col=SCORECARD_VERSIONS_COLUMNS,items=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_VERSIONS).items.filter(`${col.scorecardId} eq ${scorecardId}`).orderBy(col.versionNumber,!0).top(500)();return performanceService.endMark("sp:getScorecardVersions"),items.map(i=>this.mapToScorecardVersion(i))}catch(err){throw performanceService.endMark("sp:getScorecardVersions"),this.handleError("getScorecardVersions",err,{entityType:"ScorecardVersion"})}}mapToWorkflowDefinition(item,steps){return{id:item[WORKFLOW_DEFINITIONS_COLUMNS_id]||item.Id,workflowKey:item[WORKFLOW_DEFINITIONS_COLUMNS_workflowKey],name:item[WORKFLOW_DEFINITIONS_COLUMNS_name]||"",description:item[WORKFLOW_DEFINITIONS_COLUMNS_description]||"",steps,isActive:!!item[WORKFLOW_DEFINITIONS_COLUMNS_isActive],lastModifiedBy:item[WORKFLOW_DEFINITIONS_COLUMNS_lastModifiedBy]||"",lastModifiedDate:item[WORKFLOW_DEFINITIONS_COLUMNS_lastModifiedDate]||""}}mapToWorkflowStep(item,conditionalAssignees){let defaultAssignee;try{const raw=item[WORKFLOW_STEPS_COLUMNS_defaultAssignee];"string"==typeof raw&&raw&&(defaultAssignee=JSON.parse(raw))}catch(_a){}return{id:item[WORKFLOW_STEPS_COLUMNS_id]||item.Id,workflowId:item[WORKFLOW_STEPS_COLUMNS_workflowId]||0,stepOrder:item[WORKFLOW_STEPS_COLUMNS_stepOrder]||0,name:item[WORKFLOW_STEPS_COLUMNS_name]||"",description:item[WORKFLOW_STEPS_COLUMNS_description]||void 0,assignmentType:item[WORKFLOW_STEPS_COLUMNS_assignmentType]||enums.StepAssignmentType.NamedPerson,projectRole:item[WORKFLOW_STEPS_COLUMNS_projectRole]||void 0,defaultAssignee,conditionalAssignees,isConditional:!!item[WORKFLOW_STEPS_COLUMNS_isConditional],conditionDescription:item[WORKFLOW_STEPS_COLUMNS_conditionDescription]||void 0,actionLabel:item[WORKFLOW_STEPS_COLUMNS_actionLabel]||"",canChairMeeting:!!item[WORKFLOW_STEPS_COLUMNS_canChairMeeting],featureFlagName:item[WORKFLOW_STEPS_COLUMNS_featureFlagName]||void 0,isSkippable:!!item[WORKFLOW_STEPS_COLUMNS_isSkippable]}}mapToConditionalAssignment(item){let conditions=[],assignee={userId:"",displayName:"",email:""};try{const rawConds=item[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_conditions];"string"==typeof rawConds&&rawConds&&(conditions=JSON.parse(rawConds))}catch(_a){}try{const rawAssignee=item[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_assignee];"string"==typeof rawAssignee&&rawAssignee&&(assignee=JSON.parse(rawAssignee))}catch(_b){}return{id:item[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_id]||item.Id,stepId:item[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_stepId]||0,conditions,assignee,priority:item[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_priority]||0}}mapToWorkflowStepOverride(item){let overrideAssignee={userId:"",displayName:"",email:""};try{const raw=item[WORKFLOW_STEP_OVERRIDES_COLUMNS_overrideAssignee];"string"==typeof raw&&raw&&(overrideAssignee=JSON.parse(raw))}catch(_a){}return{id:item[WORKFLOW_STEP_OVERRIDES_COLUMNS_id]||item.Id,projectCode:item[WORKFLOW_STEP_OVERRIDES_COLUMNS_projectCode]||"",workflowKey:item[WORKFLOW_STEP_OVERRIDES_COLUMNS_workflowKey],stepId:item[WORKFLOW_STEP_OVERRIDES_COLUMNS_stepId]||0,overrideAssignee,overrideReason:item[WORKFLOW_STEP_OVERRIDES_COLUMNS_overrideReason]||void 0,overriddenBy:item[WORKFLOW_STEP_OVERRIDES_COLUMNS_overriddenBy]||"",overriddenDate:item[WORKFLOW_STEP_OVERRIDES_COLUMNS_overriddenDate]||""}}getLeadFieldValue(lead,field){switch(field){case enums.ConditionField.Division:return lead.Division||"";case enums.ConditionField.Region:return lead.Region||"";case enums.ConditionField.Sector:return lead.Sector||"";default:return""}}async assembleAllWorkflowDefinitions(){performanceService.startMark("sp:assembleAllWorkflowDefinitions");const[defItems,stepItems,caItems]=await Promise.all([this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_DEFINITIONS).items(),this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEPS).items(),this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_CONDITIONAL_ASSIGNMENTS).items()]),caByStepId=new Map;for(const caItem of caItems){const ca=this.mapToConditionalAssignment(caItem),existing=caByStepId.get(ca.stepId)||[];existing.push(ca),caByStepId.set(ca.stepId,existing)}const stepsByWorkflowId=new Map;for(const stepItem of stepItems){const stepId=stepItem[WORKFLOW_STEPS_COLUMNS_id]||stepItem.Id,workflowId=stepItem[WORKFLOW_STEPS_COLUMNS_workflowId]||0,step=this.mapToWorkflowStep(stepItem,caByStepId.get(stepId)||[]),existing=stepsByWorkflowId.get(workflowId)||[];existing.push(step),stepsByWorkflowId.set(workflowId,existing)}for(const[,steps]of stepsByWorkflowId)steps.sort((a,b)=>a.stepOrder-b.stepOrder);return defItems.map(defItem=>{const defId=defItem[WORKFLOW_DEFINITIONS_COLUMNS_id]||defItem.Id;return this.mapToWorkflowDefinition(defItem,stepsByWorkflowId.get(defId)||[])})}async getWorkflowDefinitions(){return performanceService.startMark("sp:getWorkflowDefinitions"),performanceService.endMark("sp:getWorkflowDefinitions"),this.assembleAllWorkflowDefinitions()}async getWorkflowDefinition(workflowKey){performanceService.startMark("sp:getWorkflowDefinition");const defItems=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_DEFINITIONS).items.filter(`${WORKFLOW_DEFINITIONS_COLUMNS_workflowKey} eq '${workflowKey}'`)();if(0===defItems.length)return null;const defItem=defItems[0],defId=defItem[WORKFLOW_DEFINITIONS_COLUMNS_id]||defItem.Id,stepItems=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEPS).items.filter(`${WORKFLOW_STEPS_COLUMNS_workflowId} eq ${defId}`)(),stepIds=stepItems.map(s=>s[WORKFLOW_STEPS_COLUMNS_id]||s.Id);let caItems=[];if(stepIds.length>0){const caFilter=stepIds.map(id=>`${WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_stepId} eq ${id}`).join(" or ");caItems=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_CONDITIONAL_ASSIGNMENTS).items.filter(caFilter)()}const caByStepId=new Map;for(const caItem of caItems){const ca=this.mapToConditionalAssignment(caItem),existing=caByStepId.get(ca.stepId)||[];existing.push(ca),caByStepId.set(ca.stepId,existing)}const steps=stepItems.map(stepItem=>{const stepId=stepItem[WORKFLOW_STEPS_COLUMNS_id]||stepItem.Id;return this.mapToWorkflowStep(stepItem,caByStepId.get(stepId)||[])}).sort((a,b)=>a.stepOrder-b.stepOrder);return performanceService.endMark("sp:getWorkflowDefinition"),this.mapToWorkflowDefinition(defItem,steps)}async updateWorkflowStep(workflowId,stepId,data){performanceService.startMark("sp:updateWorkflowStep");const updateData={};void 0!==data.name&&(updateData[WORKFLOW_STEPS_COLUMNS_name]=data.name),void 0!==data.description&&(updateData[WORKFLOW_STEPS_COLUMNS_description]=data.description),void 0!==data.stepOrder&&(updateData[WORKFLOW_STEPS_COLUMNS_stepOrder]=data.stepOrder),void 0!==data.assignmentType&&(updateData[WORKFLOW_STEPS_COLUMNS_assignmentType]=data.assignmentType),void 0!==data.projectRole&&(updateData[WORKFLOW_STEPS_COLUMNS_projectRole]=data.projectRole),void 0!==data.defaultAssignee&&(updateData[WORKFLOW_STEPS_COLUMNS_defaultAssignee]=JSON.stringify(data.defaultAssignee)),void 0!==data.isConditional&&(updateData[WORKFLOW_STEPS_COLUMNS_isConditional]=data.isConditional),void 0!==data.conditionDescription&&(updateData[WORKFLOW_STEPS_COLUMNS_conditionDescription]=data.conditionDescription),void 0!==data.actionLabel&&(updateData[WORKFLOW_STEPS_COLUMNS_actionLabel]=data.actionLabel),void 0!==data.canChairMeeting&&(updateData[WORKFLOW_STEPS_COLUMNS_canChairMeeting]=data.canChairMeeting),void 0!==data.featureFlagName&&(updateData[WORKFLOW_STEPS_COLUMNS_featureFlagName]=data.featureFlagName),void 0!==data.isSkippable&&(updateData[WORKFLOW_STEPS_COLUMNS_isSkippable]=data.isSkippable),await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEPS).items.getById(stepId).update(updateData),await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_DEFINITIONS).items.getById(workflowId).update({[WORKFLOW_DEFINITIONS_COLUMNS_lastModifiedDate]:(new Date).toISOString()});const updatedItem=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEPS).items.getById(stepId)(),cas=(await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_CONDITIONAL_ASSIGNMENTS).items.filter(`${WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_stepId} eq ${stepId}`)()).map(ca=>this.mapToConditionalAssignment(ca));return performanceService.endMark("sp:updateWorkflowStep"),this.mapToWorkflowStep(updatedItem,cas)}async addConditionalAssignment(stepId,assignment){var _a;performanceService.startMark("sp:addConditionalAssignment");const addData={[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_stepId]:stepId,[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_conditions]:JSON.stringify(assignment.conditions||[]),[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_assignee]:JSON.stringify(assignment.assignee||{userId:"",displayName:"",email:""}),[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_priority]:assignment.priority||1},result=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_CONDITIONAL_ASSIGNMENTS).items.add(addData),newId=result.Id||(null===(_a=result.data)||void 0===_a?void 0:_a.Id),workflowId=(await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEPS).items.getById(stepId)())[WORKFLOW_STEPS_COLUMNS_workflowId];workflowId&&await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_DEFINITIONS).items.getById(workflowId).update({[WORKFLOW_DEFINITIONS_COLUMNS_lastModifiedDate]:(new Date).toISOString()});const createdItem=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_CONDITIONAL_ASSIGNMENTS).items.getById(newId)();return performanceService.endMark("sp:addConditionalAssignment"),this.mapToConditionalAssignment(createdItem)}async updateConditionalAssignment(assignmentId,data){performanceService.startMark("sp:updateConditionalAssignment");const updateData={};void 0!==data.conditions&&(updateData[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_conditions]=JSON.stringify(data.conditions)),void 0!==data.assignee&&(updateData[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_assignee]=JSON.stringify(data.assignee)),void 0!==data.priority&&(updateData[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_priority]=data.priority),await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_CONDITIONAL_ASSIGNMENTS).items.getById(assignmentId).update(updateData);const updatedItem=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_CONDITIONAL_ASSIGNMENTS).items.getById(assignmentId)(),stepId=updatedItem[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_stepId];if(stepId){const workflowId=(await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEPS).items.getById(stepId)())[WORKFLOW_STEPS_COLUMNS_workflowId];workflowId&&await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_DEFINITIONS).items.getById(workflowId).update({[WORKFLOW_DEFINITIONS_COLUMNS_lastModifiedDate]:(new Date).toISOString()})}return performanceService.endMark("sp:updateConditionalAssignment"),this.mapToConditionalAssignment(updatedItem)}async removeConditionalAssignment(assignmentId){performanceService.startMark("sp:removeConditionalAssignment");const stepId=(await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_CONDITIONAL_ASSIGNMENTS).items.getById(assignmentId)())[WORKFLOW_CONDITIONAL_ASSIGNMENTS_COLUMNS_stepId];if(await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_CONDITIONAL_ASSIGNMENTS).items.getById(assignmentId).recycle(),stepId){const workflowId=(await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEPS).items.getById(stepId)())[WORKFLOW_STEPS_COLUMNS_workflowId];workflowId&&(await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_DEFINITIONS).items.getById(workflowId).update({[WORKFLOW_DEFINITIONS_COLUMNS_lastModifiedDate]:(new Date).toISOString()}),performanceService.endMark("sp:removeConditionalAssignment"))}}async getWorkflowOverrides(projectCode){performanceService.startMark("sp:getWorkflowOverrides");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEP_OVERRIDES).items.filter(`${WORKFLOW_STEP_OVERRIDES_COLUMNS_projectCode} eq '${projectCode}'`)();return performanceService.endMark("sp:getWorkflowOverrides"),items.map(item=>this.mapToWorkflowStepOverride(item))}async setWorkflowStepOverride(override){var _a;if(performanceService.startMark("sp:setWorkflowStepOverride"),override.projectCode&&override.stepId){const existing=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEP_OVERRIDES).items.filter(`${WORKFLOW_STEP_OVERRIDES_COLUMNS_projectCode} eq '${override.projectCode}' and ${WORKFLOW_STEP_OVERRIDES_COLUMNS_stepId} eq ${override.stepId}`)();for(const ex of existing){const exId=ex[WORKFLOW_STEP_OVERRIDES_COLUMNS_id]||ex.Id;await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEP_OVERRIDES).items.getById(exId).recycle()}}const addData={[WORKFLOW_STEP_OVERRIDES_COLUMNS_projectCode]:override.projectCode||"",[WORKFLOW_STEP_OVERRIDES_COLUMNS_workflowKey]:override.workflowKey||enums.WorkflowKey.GO_NO_GO,[WORKFLOW_STEP_OVERRIDES_COLUMNS_stepId]:override.stepId||0,[WORKFLOW_STEP_OVERRIDES_COLUMNS_overrideAssignee]:JSON.stringify(override.overrideAssignee||{userId:"",displayName:"",email:""}),[WORKFLOW_STEP_OVERRIDES_COLUMNS_overrideReason]:override.overrideReason||"",[WORKFLOW_STEP_OVERRIDES_COLUMNS_overriddenBy]:override.overriddenBy||"",[WORKFLOW_STEP_OVERRIDES_COLUMNS_overriddenDate]:(new Date).toISOString()},result=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEP_OVERRIDES).items.add(addData),newId=result.Id||(null===(_a=result.data)||void 0===_a?void 0:_a.Id),createdItem=await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEP_OVERRIDES).items.getById(newId)();return performanceService.endMark("sp:setWorkflowStepOverride"),this.mapToWorkflowStepOverride(createdItem)}async removeWorkflowStepOverride(overrideId){performanceService.startMark("sp:removeWorkflowStepOverride"),await this.sp.web.lists.getByTitle(LIST_NAMES.WORKFLOW_STEP_OVERRIDES).items.getById(overrideId).recycle(),performanceService.endMark("sp:removeWorkflowStepOverride")}async resolveWorkflowChain(workflowKey,projectCode){performanceService.startMark("sp:resolveWorkflowChain");const workflow=await this.getWorkflowDefinition(workflowKey);if(!workflow)return[];const overrides=(await this.getWorkflowOverrides(projectCode)).filter(o=>o.workflowKey===workflowKey),teamMembers=await this.getTeamMembers(projectCode),leadItems=await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.filter(`ProjectCode eq '${projectCode}'`).top(1)(),lead=leadItems.length>0?leadItems[0]:null,featureFlags=await this.getFeatureFlags(),resolved=[];for(const step of workflow.steps){if(step.featureFlagName){const flag=featureFlags.find(f=>f.FeatureName===step.featureFlagName);if(!(!flag||flag.Enabled)){step.isSkippable&&resolved.push({stepId:step.id,stepOrder:step.stepOrder,name:step.name,assignee:{userId:"",displayName:"(Skipped)",email:""},assignmentSource:"Default",isConditional:!1,conditionMet:!1,actionLabel:step.actionLabel,canChairMeeting:!1,skipped:!0,skipReason:`Feature flag '${step.featureFlagName}' is disabled`});continue}}const override=overrides.find(o=>o.stepId===step.id);if(override)resolved.push({stepId:step.id,stepOrder:step.stepOrder,name:step.name,assignee:override.overrideAssignee,assignmentSource:"Override",isConditional:step.isConditional,conditionMet:!0,actionLabel:step.actionLabel,canChairMeeting:step.canChairMeeting||!1});else{if(step.assignmentType===enums.StepAssignmentType.ProjectRole&&step.projectRole){const member=teamMembers.find(tm=>tm.role===step.projectRole);member?resolved.push({stepId:step.id,stepOrder:step.stepOrder,name:step.name,assignee:{userId:String(member.id),displayName:member.name,email:member.email},assignmentSource:"ProjectRole",isConditional:step.isConditional,conditionMet:!0,actionLabel:step.actionLabel,canChairMeeting:step.canChairMeeting||!1}):resolved.push({stepId:step.id,stepOrder:step.stepOrder,name:step.name,assignee:{userId:"",displayName:`(No ${step.projectRole} assigned)`,email:""},assignmentSource:"ProjectRole",isConditional:step.isConditional,conditionMet:!1,actionLabel:step.actionLabel,canChairMeeting:step.canChairMeeting||!1});continue}if(step.assignmentType===enums.StepAssignmentType.NamedPerson){let assignee=step.defaultAssignee,source="Default",conditionMet=!step.isConditional;if(step.conditionalAssignees.length>0&&lead){const sorted=[...step.conditionalAssignees].sort((a,b)=>a.priority-b.priority);for(const ca of sorted){if(ca.conditions.every(cond=>this.getLeadFieldValue(lead,cond.field)===cond.value)){assignee=ca.assignee,source="Condition",conditionMet=!0;break}}}resolved.push({stepId:step.id,stepOrder:step.stepOrder,name:step.name,assignee:assignee||{userId:"",displayName:"(Unassigned)",email:""},assignmentSource:source,isConditional:step.isConditional,conditionMet,actionLabel:step.actionLabel,canChairMeeting:step.canChairMeeting||!1});continue}}}return performanceService.endMark("sp:resolveWorkflowChain"),resolved}async getTurnoverAgenda(projectCode){performanceService.startMark("sp:getTurnoverAgenda");const web=this._getProjectWeb(),col=TURNOVER_AGENDAS_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.TURNOVER_AGENDAS).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===parents.length)return null;const agenda=this.mapToTurnoverAgenda(parents[0]),[prereqItems,discussionItemsRaw,attachmentItems,subItems,exhibitItems,sigItems,overviewItems]=await Promise.all([web.lists.getByTitle(LIST_NAMES.TURNOVER_PREREQUISITES).items.filter(`${TURNOVER_PREREQUISITES_COLUMNS.turnoverAgendaId} eq ${agenda.id}`).top(500)(),web.lists.getByTitle(LIST_NAMES.TURNOVER_DISCUSSION_ITEMS).items.filter(`${TURNOVER_DISCUSSION_ITEMS_COLUMNS.turnoverAgendaId} eq ${agenda.id}`).top(500)(),web.lists.getByTitle(LIST_NAMES.TURNOVER_ATTACHMENTS).items.top(5e3)(),web.lists.getByTitle(LIST_NAMES.TURNOVER_SUBCONTRACTORS).items.filter(`${TURNOVER_SUBCONTRACTORS_COLUMNS.turnoverAgendaId} eq ${agenda.id}`).top(500)(),web.lists.getByTitle(LIST_NAMES.TURNOVER_EXHIBITS).items.filter(`${TURNOVER_EXHIBITS_COLUMNS.turnoverAgendaId} eq ${agenda.id}`).top(500)(),web.lists.getByTitle(LIST_NAMES.TURNOVER_SIGNATURES).items.filter(`${TURNOVER_SIGNATURES_COLUMNS.turnoverAgendaId} eq ${agenda.id}`).top(500)(),web.lists.getByTitle(LIST_NAMES.TURNOVER_ESTIMATE_OVERVIEWS).items.filter(`${TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS.turnoverAgendaId} eq ${agenda.id}`).top(1)()]),lead=agenda.leadId?await this.getLeadById(agenda.leadId):null,prereqs=prereqItems.map(i=>this.mapToTurnoverPrerequisite(i)),discussionItems=discussionItemsRaw.map(i=>this.mapToTurnoverDiscussionItem(i)),attachments=attachmentItems.map(i=>this.mapToTurnoverAttachment(i)),subs=subItems.map(i=>this.mapToTurnoverSubcontractor(i)),exhibits=exhibitItems.map(i=>this.mapToTurnoverExhibit(i)),sigs=sigItems.map(i=>this.mapToTurnoverSignature(i)),estimateOverview=overviewItems.length>0?this.mapToTurnoverEstimateOverview(overviewItems[0]):null;let headerOverrides={};try{const raw=parents[0][col.headerOverrides];"string"==typeof raw&&raw?headerOverrides=JSON.parse(raw):"object"==typeof raw&&null!==raw&&(headerOverrides=raw)}catch(_a){}return performanceService.endMark("sp:getTurnoverAgenda"),this.assembleTurnoverAgenda(agenda,lead,headerOverrides,estimateOverview,prereqs,discussionItems,attachments,subs,exhibits,sigs)}async createTurnoverAgenda(projectCode,leadId){var _a,_b,_c;performanceService.startMark("sp:createTurnoverAgenda");const web=this._getProjectWeb(),col=TURNOVER_AGENDAS_COLUMNS,now=(new Date).toISOString(),createdBy=(null===(_a=this._pageContextUser)||void 0===_a?void 0:_a.displayName)||"System",lead=await this.getLeadById(leadId),agendaData={[col.projectCode]:projectCode,[col.leadId]:leadId,[col.status]:enums.TurnoverStatus.Draft,[col.projectName]:(null==lead?void 0:lead.Title)||"",[col.createdBy]:createdBy,[col.createdDate]:now},agendaResult=await web.lists.getByTitle(LIST_NAMES.TURNOVER_AGENDAS).items.add(agendaData),agendaId=agendaResult.Id||(null===(_b=agendaResult.data)||void 0===_b?void 0:_b.Id)||(null===(_c=agendaResult.data)||void 0===_c?void 0:_c.ID),prereqPromises=DEFAULT_PREREQUISITES.map(prereq=>web.lists.getByTitle(LIST_NAMES.TURNOVER_PREREQUISITES).items.add({[TURNOVER_PREREQUISITES_COLUMNS.turnoverAgendaId]:agendaId,[TURNOVER_PREREQUISITES_COLUMNS.sortOrder]:prereq.sortOrder,[TURNOVER_PREREQUISITES_COLUMNS.label]:prereq.label,[TURNOVER_PREREQUISITES_COLUMNS.description]:prereq.description,[TURNOVER_PREREQUISITES_COLUMNS.completed]:!1})),discussionPromises=DEFAULT_DISCUSSION_ITEMS.map(item=>web.lists.getByTitle(LIST_NAMES.TURNOVER_DISCUSSION_ITEMS).items.add({[TURNOVER_DISCUSSION_ITEMS_COLUMNS.turnoverAgendaId]:agendaId,[TURNOVER_DISCUSSION_ITEMS_COLUMNS.sortOrder]:item.sortOrder,[TURNOVER_DISCUSSION_ITEMS_COLUMNS.label]:item.label,[TURNOVER_DISCUSSION_ITEMS_COLUMNS.description]:item.description,[TURNOVER_DISCUSSION_ITEMS_COLUMNS.discussed]:!1,[TURNOVER_DISCUSSION_ITEMS_COLUMNS.notes]:""})),exhibitPromises=DEFAULT_EXHIBITS.map(exhibit=>web.lists.getByTitle(LIST_NAMES.TURNOVER_EXHIBITS).items.add({[TURNOVER_EXHIBITS_COLUMNS.turnoverAgendaId]:agendaId,[TURNOVER_EXHIBITS_COLUMNS.sortOrder]:exhibit.sortOrder,[TURNOVER_EXHIBITS_COLUMNS.label]:exhibit.label,[TURNOVER_EXHIBITS_COLUMNS.isDefault]:exhibit.isDefault,[TURNOVER_EXHIBITS_COLUMNS.reviewed]:!1})),signaturePromises=DEFAULT_SIGNATURES.map(sig=>web.lists.getByTitle(LIST_NAMES.TURNOVER_SIGNATURES).items.add({[TURNOVER_SIGNATURES_COLUMNS.turnoverAgendaId]:agendaId,[TURNOVER_SIGNATURES_COLUMNS.sortOrder]:sig.sortOrder,[TURNOVER_SIGNATURES_COLUMNS.role]:sig.role,[TURNOVER_SIGNATURES_COLUMNS.signerName]:"",[TURNOVER_SIGNATURES_COLUMNS.signerEmail]:"",[TURNOVER_SIGNATURES_COLUMNS.affidavitText]:TURNOVER_SIGNATURE_AFFIDAVIT,[TURNOVER_SIGNATURES_COLUMNS.signed]:!1})),projectValue=(null==lead?void 0:lead.ProjectValue)||0,feePct=(null==lead?void 0:lead.AnticipatedFeePct)||5,overviewPromise=web.lists.getByTitle(LIST_NAMES.TURNOVER_ESTIMATE_OVERVIEWS).items.add({[TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS.turnoverAgendaId]:agendaId,[TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS.contractAmount]:projectValue,[TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS.originalEstimate]:projectValue,[TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS.buyoutTarget]:Math.round(.9*projectValue),[TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS.estimatedFee]:Math.round(projectValue*(feePct/100)),[TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS.estimatedGrossMargin]:(null==lead?void 0:lead.AnticipatedGrossMargin)||0,[TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS.contingency]:Math.round(.015*projectValue),[TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS.notes]:"",[TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS.overrides]:JSON.stringify({})});await Promise.all([...prereqPromises,...discussionPromises,...exhibitPromises,...signaturePromises,overviewPromise]);const result=await this.getTurnoverAgenda(projectCode);if(!result)throw new Error(`Turnover agenda for ${projectCode} not found after creation`);return performanceService.endMark("sp:createTurnoverAgenda"),result}async updateTurnoverAgenda(projectCode,data){var _a;performanceService.startMark("sp:updateTurnoverAgenda");const web=this._getProjectWeb(),col=TURNOVER_AGENDAS_COLUMNS,parents=await web.lists.getByTitle(LIST_NAMES.TURNOVER_AGENDAS).items.filter(`${col.projectCode} eq '${projectCode}'`).top(1)();if(0===parents.length)throw new Error(`Turnover agenda for ${projectCode} not found`);const agendaId=parents[0].ID||parents[0].Id,now=(new Date).toISOString(),updateData={[col.lastModifiedDate]:now,[col.lastModifiedBy]:(null===(_a=this._pageContextUser)||void 0===_a?void 0:_a.displayName)||""};void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.meetingDate&&(updateData[col.meetingDate]=data.meetingDate),void 0!==data.recordingUrl&&(updateData[col.recordingUrl]=data.recordingUrl),void 0!==data.turnoverFolderUrl&&(updateData[col.turnoverFolderUrl]=data.turnoverFolderUrl),void 0!==data.bcPublished&&(updateData[col.bcPublished]=data.bcPublished),void 0!==data.pmName&&(updateData[col.pmName]=data.pmName),void 0!==data.apmName&&(updateData[col.apmName]=data.apmName),void 0!==data.projectName&&(updateData[col.projectName]=data.projectName),await web.lists.getByTitle(LIST_NAMES.TURNOVER_AGENDAS).items.getById(agendaId).update(updateData);const result=await this.getTurnoverAgenda(projectCode);if(!result)throw new Error(`Turnover agenda for ${projectCode} not found after update`);return performanceService.endMark("sp:updateTurnoverAgenda"),result}async updateTurnoverPrerequisite(prerequisiteId,data){performanceService.startMark("sp:updateTurnoverPrerequisite");const web=this._getProjectWeb(),col=TURNOVER_PREREQUISITES_COLUMNS,updateData={};void 0!==data.completed&&(updateData[col.completed]=data.completed),void 0!==data.completedBy&&(updateData[col.completedBy]=data.completedBy),void 0!==data.completedDate&&(updateData[col.completedDate]=data.completedDate),void 0!==data.label&&(updateData[col.label]=data.label),void 0!==data.description&&(updateData[col.description]=data.description),void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),await web.lists.getByTitle(LIST_NAMES.TURNOVER_PREREQUISITES).items.getById(prerequisiteId).update(updateData);const item=await web.lists.getByTitle(LIST_NAMES.TURNOVER_PREREQUISITES).items.getById(prerequisiteId)();return performanceService.endMark("sp:updateTurnoverPrerequisite"),this.mapToTurnoverPrerequisite(item)}async updateTurnoverDiscussionItem(itemId,data){performanceService.startMark("sp:updateTurnoverDiscussionItem");const web=this._getProjectWeb(),col=TURNOVER_DISCUSSION_ITEMS_COLUMNS,updateData={};void 0!==data.discussed&&(updateData[col.discussed]=data.discussed),void 0!==data.notes&&(updateData[col.notes]=data.notes),void 0!==data.label&&(updateData[col.label]=data.label),void 0!==data.description&&(updateData[col.description]=data.description),void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),await web.lists.getByTitle(LIST_NAMES.TURNOVER_DISCUSSION_ITEMS).items.getById(itemId).update(updateData);const item=await web.lists.getByTitle(LIST_NAMES.TURNOVER_DISCUSSION_ITEMS).items.getById(itemId)(),mapped=this.mapToTurnoverDiscussionItem(item),attachmentItems=await web.lists.getByTitle(LIST_NAMES.TURNOVER_ATTACHMENTS).items.filter(`${TURNOVER_ATTACHMENTS_COLUMNS.discussionItemId} eq ${itemId}`).top(500)();return mapped.attachments=attachmentItems.map(a=>this.mapToTurnoverAttachment(a)),performanceService.endMark("sp:updateTurnoverDiscussionItem"),mapped}async addTurnoverDiscussionAttachment(itemId,file){var _a,_b,_c;performanceService.startMark("sp:addTurnoverDiscussionAttachment");const web=this._getProjectWeb(),col=TURNOVER_ATTACHMENTS_COLUMNS,folderPath="Shared Documents/Turnover";try{await web.getFolderByServerRelativePath(folderPath).select("Exists")()}catch(_d){await web.folders.addUsingPath(folderPath)}const fileName=`${Date.now()}_${file.name}`,fileUrl=(await web.getFolderByServerRelativePath(folderPath).files.addUsingPath(fileName,file,{Overwrite:!0})).data.ServerRelativeUrl||`${folderPath}/${fileName}`,now=(new Date).toISOString(),attachmentData={[col.discussionItemId]:itemId,[col.fileName]:file.name,[col.fileUrl]:fileUrl,[col.uploadedBy]:(null===(_a=this._pageContextUser)||void 0===_a?void 0:_a.displayName)||"",[col.uploadedDate]:now},result=await web.lists.getByTitle(LIST_NAMES.TURNOVER_ATTACHMENTS).items.add(attachmentData),newId=result.Id||(null===(_b=result.data)||void 0===_b?void 0:_b.Id)||(null===(_c=result.data)||void 0===_c?void 0:_c.ID),item=await web.lists.getByTitle(LIST_NAMES.TURNOVER_ATTACHMENTS).items.getById(newId)();return performanceService.endMark("sp:addTurnoverDiscussionAttachment"),this.mapToTurnoverAttachment(item)}async removeTurnoverDiscussionAttachment(attachmentId){performanceService.startMark("sp:removeTurnoverDiscussionAttachment");const web=this._getProjectWeb();await web.lists.getByTitle(LIST_NAMES.TURNOVER_ATTACHMENTS).items.getById(attachmentId).delete(),performanceService.endMark("sp:removeTurnoverDiscussionAttachment")}async addTurnoverSubcontractor(turnoverAgendaId,data){var _a,_b,_c,_d,_e;performanceService.startMark("sp:addTurnoverSubcontractor");const web=this._getProjectWeb(),col=TURNOVER_SUBCONTRACTORS_COLUMNS,addData={[col.turnoverAgendaId]:turnoverAgendaId,[col.trade]:data.trade||"",[col.subcontractorName]:data.subcontractorName||"",[col.contactName]:data.contactName||"",[col.contactPhone]:data.contactPhone||"",[col.contactEmail]:data.contactEmail||"",[col.qScore]:null!==(_a=data.qScore)&&void 0!==_a?_a:null,[col.isPreferred]:null!==(_b=data.isPreferred)&&void 0!==_b&&_b,[col.isRequired]:null!==(_c=data.isRequired)&&void 0!==_c&&_c,[col.notes]:data.notes||""},result=await web.lists.getByTitle(LIST_NAMES.TURNOVER_SUBCONTRACTORS).items.add(addData),newId=result.Id||(null===(_d=result.data)||void 0===_d?void 0:_d.Id)||(null===(_e=result.data)||void 0===_e?void 0:_e.ID),item=await web.lists.getByTitle(LIST_NAMES.TURNOVER_SUBCONTRACTORS).items.getById(newId)();return performanceService.endMark("sp:addTurnoverSubcontractor"),this.mapToTurnoverSubcontractor(item)}async updateTurnoverSubcontractor(subId,data){performanceService.startMark("sp:updateTurnoverSubcontractor");const web=this._getProjectWeb(),col=TURNOVER_SUBCONTRACTORS_COLUMNS,updateData={};void 0!==data.trade&&(updateData[col.trade]=data.trade),void 0!==data.subcontractorName&&(updateData[col.subcontractorName]=data.subcontractorName),void 0!==data.contactName&&(updateData[col.contactName]=data.contactName),void 0!==data.contactPhone&&(updateData[col.contactPhone]=data.contactPhone),void 0!==data.contactEmail&&(updateData[col.contactEmail]=data.contactEmail),void 0!==data.qScore&&(updateData[col.qScore]=data.qScore),void 0!==data.isPreferred&&(updateData[col.isPreferred]=data.isPreferred),void 0!==data.isRequired&&(updateData[col.isRequired]=data.isRequired),void 0!==data.notes&&(updateData[col.notes]=data.notes),await web.lists.getByTitle(LIST_NAMES.TURNOVER_SUBCONTRACTORS).items.getById(subId).update(updateData);const item=await web.lists.getByTitle(LIST_NAMES.TURNOVER_SUBCONTRACTORS).items.getById(subId)();return performanceService.endMark("sp:updateTurnoverSubcontractor"),this.mapToTurnoverSubcontractor(item)}async removeTurnoverSubcontractor(subId){performanceService.startMark("sp:removeTurnoverSubcontractor");const web=this._getProjectWeb();await web.lists.getByTitle(LIST_NAMES.TURNOVER_SUBCONTRACTORS).items.getById(subId).delete(),performanceService.endMark("sp:removeTurnoverSubcontractor")}async updateTurnoverExhibit(exhibitId,data){performanceService.startMark("sp:updateTurnoverExhibit");const web=this._getProjectWeb(),col=TURNOVER_EXHIBITS_COLUMNS,updateData={};void 0!==data.label&&(updateData[col.label]=data.label),void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),void 0!==data.reviewed&&(updateData[col.reviewed]=data.reviewed),void 0!==data.reviewedBy&&(updateData[col.reviewedBy]=data.reviewedBy),void 0!==data.reviewedDate&&(updateData[col.reviewedDate]=data.reviewedDate),void 0!==data.linkedDocumentUrl&&(updateData[col.linkedDocumentUrl]=data.linkedDocumentUrl),void 0!==data.uploadedFileName&&(updateData[col.uploadedFileName]=data.uploadedFileName),void 0!==data.uploadedFileUrl&&(updateData[col.uploadedFileUrl]=data.uploadedFileUrl),await web.lists.getByTitle(LIST_NAMES.TURNOVER_EXHIBITS).items.getById(exhibitId).update(updateData);const item=await web.lists.getByTitle(LIST_NAMES.TURNOVER_EXHIBITS).items.getById(exhibitId)();return performanceService.endMark("sp:updateTurnoverExhibit"),this.mapToTurnoverExhibit(item)}async addTurnoverExhibit(turnoverAgendaId,data){var _a,_b;performanceService.startMark("sp:addTurnoverExhibit");const web=this._getProjectWeb(),col=TURNOVER_EXHIBITS_COLUMNS,existingItems=await web.lists.getByTitle(LIST_NAMES.TURNOVER_EXHIBITS).items.filter(`${col.turnoverAgendaId} eq ${turnoverAgendaId}`).select(col.sortOrder).top(500)(),maxOrder=existingItems.length>0?Math.max(...existingItems.map(e=>e[col.sortOrder]||0)):0,addData={[col.turnoverAgendaId]:turnoverAgendaId,[col.sortOrder]:data.sortOrder||maxOrder+1,[col.label]:data.label||"Custom Exhibit",[col.isDefault]:!1,[col.reviewed]:!1},result=await web.lists.getByTitle(LIST_NAMES.TURNOVER_EXHIBITS).items.add(addData),newId=result.Id||(null===(_a=result.data)||void 0===_a?void 0:_a.Id)||(null===(_b=result.data)||void 0===_b?void 0:_b.ID),item=await web.lists.getByTitle(LIST_NAMES.TURNOVER_EXHIBITS).items.getById(newId)();return performanceService.endMark("sp:addTurnoverExhibit"),this.mapToTurnoverExhibit(item)}async removeTurnoverExhibit(exhibitId){performanceService.startMark("sp:removeTurnoverExhibit");const web=this._getProjectWeb();await web.lists.getByTitle(LIST_NAMES.TURNOVER_EXHIBITS).items.getById(exhibitId).delete(),performanceService.endMark("sp:removeTurnoverExhibit")}async uploadTurnoverExhibitFile(exhibitId,file){performanceService.startMark("sp:uploadTurnoverExhibitFile");const web=this._getProjectWeb(),col=TURNOVER_EXHIBITS_COLUMNS,folderPath="Shared Documents/Turnover";try{await web.getFolderByServerRelativePath(folderPath).select("Exists")()}catch(_a){await web.folders.addUsingPath(folderPath)}const fileName=`exhibit_${exhibitId}_${file.name}`,fileUrl=(await web.getFolderByServerRelativePath(folderPath).files.addUsingPath(fileName,file,{Overwrite:!0})).data.ServerRelativeUrl||`${folderPath}/${fileName}`;return await web.lists.getByTitle(LIST_NAMES.TURNOVER_EXHIBITS).items.getById(exhibitId).update({[col.uploadedFileName]:file.name,[col.uploadedFileUrl]:fileUrl}),performanceService.endMark("sp:uploadTurnoverExhibitFile"),{fileUrl,fileName:file.name}}async signTurnoverAgenda(signatureId,comment){var _a,_b;performanceService.startMark("sp:signTurnoverAgenda");const web=this._getProjectWeb(),col=TURNOVER_SIGNATURES_COLUMNS,now=(new Date).toISOString(),updateData={[col.signed]:!0,[col.signedDate]:now,[col.signerName]:(null===(_a=this._pageContextUser)||void 0===_a?void 0:_a.displayName)||"",[col.signerEmail]:(null===(_b=this._pageContextUser)||void 0===_b?void 0:_b.email)||""};void 0!==comment&&(updateData[col.comment]=comment),await web.lists.getByTitle(LIST_NAMES.TURNOVER_SIGNATURES).items.getById(signatureId).update(updateData);const item=await web.lists.getByTitle(LIST_NAMES.TURNOVER_SIGNATURES).items.getById(signatureId)();return performanceService.endMark("sp:signTurnoverAgenda"),this.mapToTurnoverSignature(item)}async updateTurnoverEstimateOverview(projectCode,data){performanceService.startMark("sp:updateTurnoverEstimateOverview");const web=this._getProjectWeb(),agendaCol=TURNOVER_AGENDAS_COLUMNS,col=TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS,agendas=await web.lists.getByTitle(LIST_NAMES.TURNOVER_AGENDAS).items.filter(`${agendaCol.projectCode} eq '${projectCode}'`).select("ID","Id").top(1)();if(0===agendas.length)throw new Error(`Turnover agenda for ${projectCode} not found`);const agendaId=agendas[0].ID||agendas[0].Id,overviews=await web.lists.getByTitle(LIST_NAMES.TURNOVER_ESTIMATE_OVERVIEWS).items.filter(`${col.turnoverAgendaId} eq ${agendaId}`).top(1)();if(0===overviews.length)throw new Error(`Estimate overview for agenda ${agendaId} not found`);const overviewId=overviews[0].ID||overviews[0].Id,updateData={};void 0!==data.contractAmount&&(updateData[col.contractAmount]=data.contractAmount),void 0!==data.originalEstimate&&(updateData[col.originalEstimate]=data.originalEstimate),void 0!==data.buyoutTarget&&(updateData[col.buyoutTarget]=data.buyoutTarget),void 0!==data.estimatedFee&&(updateData[col.estimatedFee]=data.estimatedFee),void 0!==data.estimatedGrossMargin&&(updateData[col.estimatedGrossMargin]=data.estimatedGrossMargin),void 0!==data.contingency&&(updateData[col.contingency]=data.contingency),void 0!==data.notes&&(updateData[col.notes]=data.notes),void 0!==data.overrides&&(updateData[col.overrides]=JSON.stringify(data.overrides)),await web.lists.getByTitle(LIST_NAMES.TURNOVER_ESTIMATE_OVERVIEWS).items.getById(overviewId).update(updateData);const item=await web.lists.getByTitle(LIST_NAMES.TURNOVER_ESTIMATE_OVERVIEWS).items.getById(overviewId)();return performanceService.endMark("sp:updateTurnoverEstimateOverview"),this.mapToTurnoverEstimateOverview(item)}async getHubSiteUrl(){if(performanceService.startMark("sp:getHubSiteUrl"),!this.sp)return"https://hedrickbrotherscom.sharepoint.com/sites/HBCentral";try{const items=await this.sp.web.lists.getByTitle("App_Context_Config").items.filter("SiteURL eq 'HUB_SITE_URL'").select("AppTitle").top(1)();return items.length>0?items[0].AppTitle:"https://hedrickbrotherscom.sharepoint.com/sites/HBCentral"}catch(_a){return performanceService.endMark("sp:getHubSiteUrl"),"https://hedrickbrotherscom.sharepoint.com/sites/HBCentral"}}async setHubSiteUrl(url){performanceService.startMark("sp:setHubSiteUrl");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.filter("SiteURL eq 'HUB_SITE_URL'").top(1)();items.length>0?await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.getById(items[0].Id).update({AppTitle:url}):await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.add({SiteURL:"HUB_SITE_URL",AppTitle:url})}catch(err){throw console.error("[SP] setHubSiteUrl failed:",err),err}}async getActionItems(userEmail){performanceService.startMark("sp:getActionItems");const items=[],now=Date.now(),calcWaitingDays=dateStr=>Math.floor((now-new Date(dateStr).getTime())/864e5),calcPriority=days=>days>7?enums.ActionPriority.Urgent:days>=1?enums.ActionPriority.Normal:enums.ActionPriority.New;try{const scorecardSteps=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_STEPS).items.filter(`${SCORECARD_APPROVAL_STEPS_COLUMNS.assigneeEmail} eq '${userEmail}' and ${SCORECARD_APPROVAL_STEPS_COLUMNS.status} eq 'Pending'`).top(50)();for(const step of scorecardSteps){const cycleId=step[SCORECARD_APPROVAL_STEPS_COLUMNS.cycleId];try{const cycle=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.getById(cycleId)(),scorecardId=cycle[SCORECARD_APPROVAL_CYCLES_COLUMNS.scorecardId],startedDate=cycle[SCORECARD_APPROVAL_CYCLES_COLUMNS.startedDate]||(new Date).toISOString(),scorecard=await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId)(),leadId=scorecard[GONOGO_SCORECARD_COLUMNS.LeadID],waitingDays=calcWaitingDays(startedDate);items.push({id:`scorecard-step-${step.Id||step.ID}`,workflowType:enums.WorkflowActionType.GoNoGoReview,actionLabel:"Review Go/No-Go Scorecard",projectCode:scorecard[GONOGO_SCORECARD_COLUMNS.ProjectCode]||"",projectName:"",entityId:scorecardId,requestedBy:"",requestedByEmail:"",requestedDate:startedDate,waitingDays,routePath:`/lead/${leadId}/gonogo`,priority:calcPriority(waitingDays)})}catch(_a){}}}catch(_b){}try{const pmpSteps=await this.sp.web.lists.getByTitle(LIST_NAMES.PMP_APPROVAL_STEPS).items.filter(`${PMP_APPROVAL_STEPS_COLUMNS.approverEmail} eq '${userEmail}' and ${PMP_APPROVAL_STEPS_COLUMNS.status} eq 'Pending'`).top(50)();for(const step of pmpSteps){const projectCode=step[PMP_APPROVAL_STEPS_COLUMNS.projectCode]||"",requestedDate=step[PMP_APPROVAL_STEPS_COLUMNS.actionDate]||(new Date).toISOString(),waitingDays=calcWaitingDays(requestedDate);items.push({id:`pmp-step-${step.Id||step.ID}`,workflowType:enums.WorkflowActionType.PMPApproval,actionLabel:"Approve Project Management Plan",projectCode,projectName:"",entityId:step.Id||step.ID,requestedBy:"",requestedByEmail:"",requestedDate,waitingDays,routePath:"/operations/management-plan",priority:calcPriority(waitingDays)})}}catch(_c){}try{const pmpSigs=await this.sp.web.lists.getByTitle(LIST_NAMES.PMP_SIGNATURES).items.filter(`${PMP_SIGNATURES_COLUMNS.personEmail} eq '${userEmail}' and ${PMP_SIGNATURES_COLUMNS.status} eq 'Pending'`).top(50)();for(const sig of pmpSigs){const projectCode=sig[PMP_SIGNATURES_COLUMNS.projectCode]||"",requestedDate=(new Date).toISOString(),waitingDays=0;items.push({id:`pmp-sig-${sig.Id||sig.ID}`,workflowType:enums.WorkflowActionType.PMPSignature,actionLabel:"Sign Project Management Plan",projectCode,projectName:"",entityId:sig.Id||sig.ID,requestedBy:"",requestedByEmail:"",requestedDate,waitingDays,routePath:"/operations/management-plan",priority:calcPriority(waitingDays)})}}catch(_d){}try{const reviews=await this.sp.web.lists.getByTitle(LIST_NAMES.MONTHLY_REVIEWS).items.filter(`${MONTHLY_REVIEWS_COLUMNS.status} eq 'PendingPXReview' or ${MONTHLY_REVIEWS_COLUMNS.status} eq 'PendingPXValidation'`).top(50)();for(const review of reviews){const projectCode=review[MONTHLY_REVIEWS_COLUMNS.projectCode]||"",submittedDate=review[MONTHLY_REVIEWS_COLUMNS.pmSubmittedDate]||review[MONTHLY_REVIEWS_COLUMNS.lastUpdatedAt]||(new Date).toISOString(),waitingDays=calcWaitingDays(submittedDate);items.push({id:`review-${review.Id||review.ID}`,workflowType:enums.WorkflowActionType.MonthlyReviewValidation,actionLabel:"Review Monthly Project Review",projectCode,projectName:"",entityId:review.Id||review.ID,requestedBy:"",requestedByEmail:"",requestedDate:submittedDate,waitingDays,routePath:"/operations/monthly-review",priority:calcPriority(waitingDays)})}}catch(_e){}const priorityOrder={Urgent:3,Normal:2,New:1};return items.sort((a,b)=>{const pDiff=(priorityOrder[b.priority]||0)-(priorityOrder[a.priority]||0);return 0!==pDiff?pDiff:b.waitingDays-a.waitingDays}),performanceService.endMark("sp:getActionItems"),items}async getPermissionTemplates(){performanceService.startMark("sp:getPermissionTemplates");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.PERMISSION_TEMPLATES).items();return performanceService.endMark("sp:getPermissionTemplates"),items.map(i=>this.mapToPermissionTemplate(i))}async getPermissionTemplate(id){performanceService.startMark("sp:getPermissionTemplate");try{const item=await this.sp.web.lists.getByTitle(LIST_NAMES.PERMISSION_TEMPLATES).items.getById(id)();return this.mapToPermissionTemplate(item)}catch(_a){return performanceService.endMark("sp:getPermissionTemplate"),null}}async createPermissionTemplate(data){var _a,_b,_c,_d;performanceService.startMark("sp:createPermissionTemplate");const now=(new Date).toISOString(),spItem={[PERMISSION_TEMPLATES_COLUMNS_name]:data.name||"",[PERMISSION_TEMPLATES_COLUMNS_description]:data.description||"",[PERMISSION_TEMPLATES_COLUMNS_isGlobal]:null!==(_a=data.isGlobal)&&void 0!==_a&&_a,[PERMISSION_TEMPLATES_COLUMNS_globalAccess]:null!==(_b=data.globalAccess)&&void 0!==_b&&_b,[PERMISSION_TEMPLATES_COLUMNS_identityType]:data.identityType||"Internal",[PERMISSION_TEMPLATES_COLUMNS_toolAccess]:JSON.stringify(data.toolAccess||[]),[PERMISSION_TEMPLATES_COLUMNS_isDefault]:null!==(_c=data.isDefault)&&void 0!==_c&&_c,[PERMISSION_TEMPLATES_COLUMNS_isActive]:null===(_d=data.isActive)||void 0===_d||_d,[PERMISSION_TEMPLATES_COLUMNS_createdBy]:data.createdBy||"",[PERMISSION_TEMPLATES_COLUMNS_createdDate]:data.createdDate||now,[PERMISSION_TEMPLATES_COLUMNS_lastModifiedBy]:data.lastModifiedBy||data.createdBy||"",[PERMISSION_TEMPLATES_COLUMNS_lastModifiedDate]:data.lastModifiedDate||now},result=await this.sp.web.lists.getByTitle(LIST_NAMES.PERMISSION_TEMPLATES).items.add(spItem);return performanceService.endMark("sp:createPermissionTemplate"),this.mapToPermissionTemplate(result)}async updatePermissionTemplate(id,data){performanceService.startMark("sp:updatePermissionTemplate");const updateData={};void 0!==data.name&&(updateData[PERMISSION_TEMPLATES_COLUMNS_name]=data.name),void 0!==data.description&&(updateData[PERMISSION_TEMPLATES_COLUMNS_description]=data.description),void 0!==data.isGlobal&&(updateData[PERMISSION_TEMPLATES_COLUMNS_isGlobal]=data.isGlobal),void 0!==data.globalAccess&&(updateData[PERMISSION_TEMPLATES_COLUMNS_globalAccess]=data.globalAccess),void 0!==data.identityType&&(updateData[PERMISSION_TEMPLATES_COLUMNS_identityType]=data.identityType),void 0!==data.toolAccess&&(updateData[PERMISSION_TEMPLATES_COLUMNS_toolAccess]=JSON.stringify(data.toolAccess)),void 0!==data.isDefault&&(updateData[PERMISSION_TEMPLATES_COLUMNS_isDefault]=data.isDefault),void 0!==data.isActive&&(updateData[PERMISSION_TEMPLATES_COLUMNS_isActive]=data.isActive),void 0!==data.lastModifiedBy&&(updateData[PERMISSION_TEMPLATES_COLUMNS_lastModifiedBy]=data.lastModifiedBy),updateData[PERMISSION_TEMPLATES_COLUMNS_lastModifiedDate]=(new Date).toISOString(),await this.sp.web.lists.getByTitle(LIST_NAMES.PERMISSION_TEMPLATES).items.getById(id).update(updateData);const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.PERMISSION_TEMPLATES).items.getById(id)();return performanceService.endMark("sp:updatePermissionTemplate"),this.mapToPermissionTemplate(updated)}async deletePermissionTemplate(id){performanceService.startMark("sp:deletePermissionTemplate"),await this.sp.web.lists.getByTitle(LIST_NAMES.PERMISSION_TEMPLATES).items.getById(id).delete(),performanceService.endMark("sp:deletePermissionTemplate")}async getSecurityGroupMappings(){performanceService.startMark("sp:getSecurityGroupMappings");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.SECURITY_GROUP_MAPPINGS).items();return performanceService.endMark("sp:getSecurityGroupMappings"),items.map(i=>this.mapToSecurityGroupMapping(i))}async createSecurityGroupMapping(data){var _a;performanceService.startMark("sp:createSecurityGroupMapping");const spItem={[SECURITY_GROUP_MAPPINGS_COLUMNS_securityGroupId]:data.securityGroupId||"",[SECURITY_GROUP_MAPPINGS_COLUMNS_securityGroupName]:data.securityGroupName||"",[SECURITY_GROUP_MAPPINGS_COLUMNS_defaultTemplateId]:data.defaultTemplateId||0,[SECURITY_GROUP_MAPPINGS_COLUMNS_isActive]:null===(_a=data.isActive)||void 0===_a||_a},result=await this.sp.web.lists.getByTitle(LIST_NAMES.SECURITY_GROUP_MAPPINGS).items.add(spItem);return performanceService.endMark("sp:createSecurityGroupMapping"),this.mapToSecurityGroupMapping(result)}async updateSecurityGroupMapping(id,data){performanceService.startMark("sp:updateSecurityGroupMapping");const updateData={};void 0!==data.securityGroupId&&(updateData[SECURITY_GROUP_MAPPINGS_COLUMNS_securityGroupId]=data.securityGroupId),void 0!==data.securityGroupName&&(updateData[SECURITY_GROUP_MAPPINGS_COLUMNS_securityGroupName]=data.securityGroupName),void 0!==data.defaultTemplateId&&(updateData[SECURITY_GROUP_MAPPINGS_COLUMNS_defaultTemplateId]=data.defaultTemplateId),void 0!==data.isActive&&(updateData[SECURITY_GROUP_MAPPINGS_COLUMNS_isActive]=data.isActive),await this.sp.web.lists.getByTitle(LIST_NAMES.SECURITY_GROUP_MAPPINGS).items.getById(id).update(updateData);const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.SECURITY_GROUP_MAPPINGS).items.getById(id)();return performanceService.endMark("sp:updateSecurityGroupMapping"),this.mapToSecurityGroupMapping(updated)}async getProjectTeamAssignments(projectCode){performanceService.startMark("sp:getProjectTeamAssignments");const col=PROJECT_TEAM_ASSIGNMENTS_COLUMNS,items=await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS).items.filter(`${col.projectCode} eq '${projectCode}' and ${col.isActive} eq 1`)();return performanceService.endMark("sp:getProjectTeamAssignments"),items.map(i=>this.mapToProjectTeamAssignment(i))}async getMyProjectAssignments(userEmail){const emailLower=userEmail.toLowerCase(),cacheKey=CACHE_KEYS_ASSIGNMENTS+"_user_"+emailLower,cached=cacheService.get(cacheKey);if(cached)return cached;performanceService.startMark("sp:getMyProjectAssignments");try{const col=PROJECT_TEAM_ASSIGNMENTS_COLUMNS,result=(await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS).items.filter(`tolower(${col.userEmail}) eq '${emailLower}' and ${col.isActive} eq 1`)()).map(i=>this.mapToProjectTeamAssignment(i));return cacheService.set(cacheKey,result,3e5),performanceService.endMark("sp:getMyProjectAssignments"),result}catch(err){throw performanceService.endMark("sp:getMyProjectAssignments"),this.handleError("getMyProjectAssignments",err,{entityType:"ProjectTeamAssignment",entityId:emailLower})}}async createProjectTeamAssignment(data){var _a;performanceService.startMark("sp:createProjectTeamAssignment");const col=PROJECT_TEAM_ASSIGNMENTS_COLUMNS,now=(new Date).toISOString(),spItem={[col.projectCode]:data.projectCode||"",[col.userId]:data.userId||"",[col.userDisplayName]:data.userDisplayName||"",[col.userEmail]:data.userEmail||"",[col.assignedRole]:data.assignedRole||"",[col.templateOverrideId]:data.templateOverrideId||null,[col.granularFlagOverrides]:data.granularFlagOverrides?JSON.stringify(data.granularFlagOverrides):null,[col.assignedBy]:data.assignedBy||"",[col.assignedDate]:data.assignedDate||now,[col.isActive]:null===(_a=data.isActive)||void 0===_a||_a},result=await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS).items.add(spItem);return cacheService.removeByPrefix(CACHE_KEYS_ASSIGNMENTS),cacheService.removeByPrefix(CACHE_KEYS_ACCESSIBLE_PROJECTS),performanceService.endMark("sp:createProjectTeamAssignment"),this.mapToProjectTeamAssignment(result)}async updateProjectTeamAssignment(id,data){performanceService.startMark("sp:updateProjectTeamAssignment");const col=PROJECT_TEAM_ASSIGNMENTS_COLUMNS,updateData={};void 0!==data.projectCode&&(updateData[col.projectCode]=data.projectCode),void 0!==data.userId&&(updateData[col.userId]=data.userId),void 0!==data.userDisplayName&&(updateData[col.userDisplayName]=data.userDisplayName),void 0!==data.userEmail&&(updateData[col.userEmail]=data.userEmail),void 0!==data.assignedRole&&(updateData[col.assignedRole]=data.assignedRole),void 0!==data.templateOverrideId&&(updateData[col.templateOverrideId]=data.templateOverrideId),void 0!==data.granularFlagOverrides&&(updateData[col.granularFlagOverrides]=JSON.stringify(data.granularFlagOverrides)),void 0!==data.isActive&&(updateData[col.isActive]=data.isActive),await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS).items.getById(id).update(updateData);const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS).items.getById(id)();return cacheService.removeByPrefix(CACHE_KEYS_ASSIGNMENTS),cacheService.removeByPrefix(CACHE_KEYS_ACCESSIBLE_PROJECTS),performanceService.endMark("sp:updateProjectTeamAssignment"),this.mapToProjectTeamAssignment(updated)}async removeProjectTeamAssignment(id){performanceService.startMark("sp:removeProjectTeamAssignment"),await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS).items.getById(id).update({[PROJECT_TEAM_ASSIGNMENTS_COLUMNS.isActive]:!1}),cacheService.removeByPrefix(CACHE_KEYS_ASSIGNMENTS),cacheService.removeByPrefix(CACHE_KEYS_ACCESSIBLE_PROJECTS),performanceService.endMark("sp:removeProjectTeamAssignment")}async getAllProjectTeamAssignments(){performanceService.startMark("sp:getAllProjectTeamAssignments");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS).items.filter(`${PROJECT_TEAM_ASSIGNMENTS_COLUMNS.isActive} eq 1`)();return performanceService.endMark("sp:getAllProjectTeamAssignments"),items.map(i=>this.mapToProjectTeamAssignment(i))}async inviteToProjectSiteGroup(projectCode,userEmail,role){performanceService.startMark("sp:inviteToProjectSiteGroup");try{const visitorRoles=["Legal","Risk Management","Marketing","Quality Control","Safety"];let groupSuffix="Members";["Executive Leadership","Department Director"].includes(role)?groupSuffix="Owners":visitorRoles.includes(role)&&(groupSuffix="Visitors");const groupName=`${projectCode} ${groupSuffix}`,siteGroup=this.sp.web.siteGroups.getByName(groupName);await siteGroup.users.add(userEmail)}catch(err){console.warn(`[SP] inviteToProjectSiteGroup failed for ${userEmail} on ${projectCode}:`,err),performanceService.endMark("sp:inviteToProjectSiteGroup")}}async resolveUserPermissions(userEmail,projectCode){performanceService.startMark("sp:resolveUserPermissions");const email=userEmail.toLowerCase(),roleToGroupMap={"Executive Leadership":"HBC - Executive Leadership","Department Director":"HBC - Project Executives","Operations Team":"HBC - Project Managers","Preconstruction Team":"HBC - Estimating","BD Representative":"HBC - Business Development","Estimating Coordinator":"HBC - Estimating","Accounting Manager":"HBC - Accounting",Legal:"HBC - Read Only","Risk Management":"HBC - Read Only",Marketing:"HBC - Read Only","Quality Control":"HBC - Read Only",Safety:"HBC - Read Only",IDS:"HBC - Read Only","SharePoint Admin":"HBC - SharePoint Admins"},userRoles=(await this.getCurrentUser()).roles,securityGroupMappings=await this.getSecurityGroupMappings();let defaultTemplateId=0;for(const role of userRoles){const groupName=roleToGroupMap[role];if(!groupName)continue;const mapping=securityGroupMappings.find(m=>m.securityGroupName===groupName&&m.isActive);if(mapping){defaultTemplateId=mapping.defaultTemplateId;break}}if(!defaultTemplateId){const readOnlyMapping=securityGroupMappings.find(m=>"HBC - Read Only"===m.securityGroupName&&m.isActive);defaultTemplateId=(null==readOnlyMapping?void 0:readOnlyMapping.defaultTemplateId)||0}let templateId=defaultTemplateId,source="SecurityGroupDefault";if(projectCode){const col=PROJECT_TEAM_ASSIGNMENTS_COLUMNS,assignments=await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS).items.filter(`tolower(${col.userEmail}) eq '${email}' and ${col.projectCode} eq '${projectCode}' and ${col.isActive} eq 1`)(),assignment=assignments.length>0?this.mapToProjectTeamAssignment(assignments[0]):null;(null==assignment?void 0:assignment.templateOverrideId)&&(templateId=assignment.templateOverrideId,source="ProjectOverride")}const template=templateId?await this.getPermissionTemplate(templateId):null;if(!template)return{userId:email,projectCode,templateId:0,templateName:"Unknown",source,toolLevels:{},granularFlags:{},permissions:new Set,globalAccess:!1};const toolAccess=[...template.toolAccess];if(projectCode){const col=PROJECT_TEAM_ASSIGNMENTS_COLUMNS,assignments=await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS).items.filter(`tolower(${col.userEmail}) eq '${email}' and ${col.projectCode} eq '${projectCode}' and ${col.isActive} eq 1`)();if(assignments.length>0){const assignment=this.mapToProjectTeamAssignment(assignments[0]);if(assignment.granularFlagOverrides)for(const override of assignment.granularFlagOverrides){const existingTool=toolAccess.find(ta=>ta.toolKey===override.toolKey);existingTool&&(existingTool.granularFlags=[...existingTool.granularFlags||[],...override.flags])}}}const permissionStrings=resolveToolPermissions(toolAccess,TOOL_DEFINITIONS),permissions=new Set(permissionStrings),toolLevels={},granularFlags={};for(const ta of toolAccess)toolLevels[ta.toolKey]=ta.level,ta.granularFlags&&ta.granularFlags.length>0&&(granularFlags[ta.toolKey]=ta.granularFlags);return{userId:email,projectCode,templateId:template.id,templateName:template.name,source,toolLevels,granularFlags,permissions,globalAccess:template.globalAccess}}async getAccessibleProjects(userEmail){const email=userEmail.toLowerCase(),cacheKey=CACHE_KEYS_ACCESSIBLE_PROJECTS+"_"+email,cached=cacheService.get(cacheKey);if(cached)return cached;performanceService.startMark("sp:getAccessibleProjects");try{if((await this.resolveUserPermissions(email,null)).globalAccess){const codes=(await this.sp.web.lists.getByTitle(LIST_NAMES.LEADS_MASTER).items.filter("ProjectCode ne null").select("ProjectCode").top(5e3)()).map(i=>i.ProjectCode).filter(Boolean),result=[...new Set(codes)];return cacheService.set(cacheKey,result,3e5),performanceService.endMark("sp:getAccessibleProjects"),result}const col=PROJECT_TEAM_ASSIGNMENTS_COLUMNS,codes=(await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_TEAM_ASSIGNMENTS).items.filter(`tolower(${col.userEmail}) eq '${email}' and ${col.isActive} eq 1`).select(col.projectCode)()).map(i=>i[col.projectCode]).filter(Boolean),result=[...new Set(codes)];return cacheService.set(cacheKey,result,3e5),performanceService.endMark("sp:getAccessibleProjects"),result}catch(err){throw performanceService.endMark("sp:getAccessibleProjects"),this.handleError("getAccessibleProjects",err,{entityType:"ProjectTeamAssignment",entityId:email})}}async getEnvironmentConfig(){performanceService.startMark("sp:getEnvironmentConfig");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.filter("SiteURL eq 'ENVIRONMENT_CONFIG'").select("AppTitle").top(1)();if(items.length>0&&items[0].AppTitle)return JSON.parse(items[0].AppTitle)}catch(_a){}return{currentTier:"prod",label:"Production",color:"#10B981",isReadOnly:!1,promotionHistory:[]}}async promoteTemplates(fromTier,toTier,promotedBy){performanceService.startMark("sp:promoteTemplates");const activeTemplates=(await this.getPermissionTemplates()).filter(t=>t.isActive),now=(new Date).toISOString();for(const template of activeTemplates)await this.sp.web.lists.getByTitle(LIST_NAMES.PERMISSION_TEMPLATES).items.getById(template.id).update({Version:(template.version||0)+1,PromotedFromTier:fromTier,[PERMISSION_TEMPLATES_COLUMNS_lastModifiedBy]:promotedBy,[PERMISSION_TEMPLATES_COLUMNS_lastModifiedDate]:now});const envConfig=await this.getEnvironmentConfig(),promotionRecord={fromTier,toTier,promotedBy,promotedDate:now,templateCount:activeTemplates.length};envConfig.promotionHistory=[...envConfig.promotionHistory||[],promotionRecord],envConfig.currentTier=toTier;try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.filter("SiteURL eq 'ENVIRONMENT_CONFIG'").top(1)();items.length>0?await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.getById(items[0].Id).update({AppTitle:JSON.stringify(envConfig)}):await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.add({SiteURL:"ENVIRONMENT_CONFIG",AppTitle:JSON.stringify(envConfig)})}catch(err){console.error("[SP] Failed to update environment config after promotion:",err),performanceService.endMark("sp:promoteTemplates")}}async getSectorDefinitions(){performanceService.startMark("sp:getSectorDefinitions");const col=SECTOR_DEFINITIONS_COLUMNS,items=await this.sp.web.lists.getByTitle(LIST_NAMES.SECTOR_DEFINITIONS).items.orderBy(col.sortOrder,!0).top(500)();return performanceService.endMark("sp:getSectorDefinitions"),items.map(item=>this.mapToSectorDefinition(item))}async createSectorDefinition(data){var _a,_b;performanceService.startMark("sp:createSectorDefinition");const col=SECTOR_DEFINITIONS_COLUMNS,code=data.code||(null===(_a=data.label)||void 0===_a?void 0:_a.toUpperCase().replace(/[^A-Z0-9]/g,"_"))||"NEW";let sortOrder=data.sortOrder;if(void 0===sortOrder){const existing=await this.sp.web.lists.getByTitle(LIST_NAMES.SECTOR_DEFINITIONS).items.orderBy(col.sortOrder,!1).top(1)();sortOrder=(existing.length>0&&existing[0][col.sortOrder]||0)+1}const result=await this.sp.web.lists.getByTitle(LIST_NAMES.SECTOR_DEFINITIONS).items.add({[col.code]:code,[col.label]:data.label||"New Sector",[col.isActive]:null===(_b=data.isActive)||void 0===_b||_b,[col.parentDivision]:data.parentDivision||null,[col.sortOrder]:sortOrder}),newId=result.Id||result.id,created=await this.sp.web.lists.getByTitle(LIST_NAMES.SECTOR_DEFINITIONS).items.getById(newId)();return performanceService.endMark("sp:createSectorDefinition"),this.mapToSectorDefinition(created)}async updateSectorDefinition(id,data){performanceService.startMark("sp:updateSectorDefinition");const col=SECTOR_DEFINITIONS_COLUMNS,updateData={};void 0!==data.code&&(updateData[col.code]=data.code),void 0!==data.label&&(updateData[col.label]=data.label),void 0!==data.isActive&&(updateData[col.isActive]=data.isActive),void 0!==data.parentDivision&&(updateData[col.parentDivision]=data.parentDivision),void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),await this.sp.web.lists.getByTitle(LIST_NAMES.SECTOR_DEFINITIONS).items.getById(id).update(updateData);const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.SECTOR_DEFINITIONS).items.getById(id)();return performanceService.endMark("sp:updateSectorDefinition"),this.mapToSectorDefinition(updated)}async createBdLeadFolder(leadTitle,originatorName){performanceService.startMark("sp:createBdLeadFolder");const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),libraryRoot=Web([this.sp.web,BD_LEADS_SITE_URL]).lists.getByTitle("BD Leads").rootFolder,year=(new Date).getFullYear().toString(),leadFolderName=`${leadTitle} - ${originatorName}`;try{await libraryRoot.folders.addUsingPath(year)}catch(_a){}const yearFolder=libraryRoot.folders.getByUrl(year);await yearFolder.folders.addUsingPath(leadFolderName);const leadFolder=yearFolder.folders.getByUrl(leadFolderName);for(const sub of BD_LEADS_SUBFOLDERS)try{await leadFolder.folders.addUsingPath(sub)}catch(err){console.warn(`[SP] Failed to create subfolder "${sub}":`,err),performanceService.endMark("sp:createBdLeadFolder")}}async checkFolderExists(path){performanceService.startMark("sp:checkFolderExists");try{if(path.startsWith("BD Leads")){const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),bdWeb=Web([this.sp.web,BD_LEADS_SITE_URL]),relativePath=path.substring(9);return await bdWeb.lists.getByTitle("BD Leads").rootFolder.folders.getByUrl(relativePath).select("Exists")(),!0}return await this.sp.web.getFolderByServerRelativePath(path).select("Exists")(),!0}catch(_a){return!1}}async createFolder(path){if(performanceService.startMark("sp:createFolder"),path.startsWith("BD Leads")){const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),bdWeb=Web([this.sp.web,BD_LEADS_SITE_URL]),segments=path.substring(9).split("/");let currentFolder=bdWeb.lists.getByTitle("BD Leads").rootFolder;for(const segment of segments){try{await currentFolder.folders.addUsingPath(segment)}catch(_a){}currentFolder=currentFolder.folders.getByUrl(segment)}}else await this.sp.web.folders.addUsingPath(path),performanceService.endMark("sp:createFolder")}async renameFolder(oldPath,newPath){if(performanceService.startMark("sp:renameFolder"),oldPath.startsWith("BD Leads")){const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js"),bdWeb=Web([this.sp.web,BD_LEADS_SITE_URL]),siteInfo=await bdWeb.select("ServerRelativeUrl")(),oldServerPath=`${siteInfo.ServerRelativeUrl}/${oldPath}`,newServerPath=`${siteInfo.ServerRelativeUrl}/${newPath}`;await bdWeb.getFolderByServerRelativePath(oldServerPath).moveByPath(newServerPath,!1)}else await this.sp.web.getFolderByServerRelativePath(oldPath).moveByPath(newPath,!1),performanceService.endMark("sp:renameFolder")}async getAssignmentMappings(){performanceService.startMark("sp:getAssignmentMappings");const items=await this.sp.web.lists.getByTitle(LIST_NAMES.ASSIGNMENT_MAPPINGS).items.top(500)();return performanceService.endMark("sp:getAssignmentMappings"),items.map(item=>this.mapToAssignmentMapping(item))}async createAssignmentMapping(data){var _a,_b,_c;performanceService.startMark("sp:createAssignmentMapping");const col=ASSIGNMENT_MAPPINGS_COLUMNS,result=await this.sp.web.lists.getByTitle(LIST_NAMES.ASSIGNMENT_MAPPINGS).items.add({[col.region]:data.region||"All Regions",[col.sector]:data.sector||"All Sectors",[col.assignmentType]:data.assignmentType||"Director",[col.assigneeUserId]:(null===(_a=data.assignee)||void 0===_a?void 0:_a.userId)||"",[col.assigneeDisplayName]:(null===(_b=data.assignee)||void 0===_b?void 0:_b.displayName)||"",[col.assigneeEmail]:(null===(_c=data.assignee)||void 0===_c?void 0:_c.email)||""}),newId=result.Id||result.id,created=await this.sp.web.lists.getByTitle(LIST_NAMES.ASSIGNMENT_MAPPINGS).items.getById(newId)();return performanceService.endMark("sp:createAssignmentMapping"),this.mapToAssignmentMapping(created)}async updateAssignmentMapping(id,data){performanceService.startMark("sp:updateAssignmentMapping");const col=ASSIGNMENT_MAPPINGS_COLUMNS,updateData={};void 0!==data.region&&(updateData[col.region]=data.region),void 0!==data.sector&&(updateData[col.sector]=data.sector),void 0!==data.assignmentType&&(updateData[col.assignmentType]=data.assignmentType),data.assignee&&(updateData[col.assigneeUserId]=data.assignee.userId,updateData[col.assigneeDisplayName]=data.assignee.displayName,updateData[col.assigneeEmail]=data.assignee.email),await this.sp.web.lists.getByTitle(LIST_NAMES.ASSIGNMENT_MAPPINGS).items.getById(id).update(updateData);const updated=await this.sp.web.lists.getByTitle(LIST_NAMES.ASSIGNMENT_MAPPINGS).items.getById(id)();return performanceService.endMark("sp:updateAssignmentMapping"),this.mapToAssignmentMapping(updated)}async deleteAssignmentMapping(id){performanceService.startMark("sp:deleteAssignmentMapping"),await this.sp.web.lists.getByTitle(LIST_NAMES.ASSIGNMENT_MAPPINGS).items.getById(id).recycle(),performanceService.endMark("sp:deleteAssignmentMapping")}async rejectScorecard(scorecardId,reason){performanceService.startMark("sp:rejectScorecard");const col=GONOGO_SCORECARD_COLUMNS,cycCol=SCORECARD_APPROVAL_CYCLES_COLUMNS,stepCol=SCORECARD_APPROVAL_STEPS_COLUMNS,now=(new Date).toISOString();await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId).update({[col.scorecardStatus]:enums.ScorecardStatus.Rejected,[col.isLocked]:!0,[col.finalDecision]:enums.GoNoGoDecision.NoGo,[col.finalDecisionDate]:now});const activeCycles=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.filter(`${cycCol.scorecardId} eq ${scorecardId} and ${cycCol.status} eq 'Active'`)();for(const cycle of activeCycles){const cId=cycle.ID||cycle.Id,pendingSteps=await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_STEPS).items.filter(`${stepCol.cycleId} eq ${cId} and ${stepCol.status} eq 'Pending'`)();for(const step of pendingSteps){const sId=step.ID||step.Id;await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_STEPS).items.getById(sId).update({[stepCol.status]:"Returned",[stepCol.actionDate]:now,[stepCol.comment]:reason})}await this.sp.web.lists.getByTitle(LIST_NAMES.SCORECARD_APPROVAL_CYCLES).items.getById(cId).update({[cycCol.completedDate]:now,[cycCol.status]:"Completed"})}await this.createVersionSnapshot(scorecardId,`Rejected: ${reason}`,"Director"),this.logAudit({Action:enums.AuditAction.ScorecardReturned,EntityType:enums.EntityType.Scorecard,EntityId:String(scorecardId),User:"Director",Details:`Scorecard rejected. Reason: ${reason}`}).catch(()=>{});const result=await this.assembleScorecard(scorecardId);return performanceService.endMark("sp:rejectScorecard"),result}async archiveScorecard(scorecardId,archivedBy){performanceService.startMark("sp:archiveScorecard");const now=(new Date).toISOString();await this.sp.web.lists.getByTitle(LIST_NAMES.GONOGO_SCORECARD).items.getById(scorecardId).update({isArchived:!0,archivedDate:now,archivedBy}),this.logAudit({Action:enums.AuditAction.ScorecardArchived,EntityType:enums.EntityType.Scorecard,EntityId:String(scorecardId),User:archivedBy,Details:"Scorecard archived"}).catch(()=>{});const result=await this.assembleScorecard(scorecardId);return performanceService.endMark("sp:archiveScorecard"),result}setProjectSiteUrl(siteUrl){this._projectSiteUrl=siteUrl}_getProjectWeb(){if(this._projectSiteUrl){const{Web}=__webpack_require__("./node_modules/@pnp/sp/webs/index.js");return Web([this.sp.web,this._projectSiteUrl])}return this.sp.web}mapToStartupChecklistItem(item,activityLog){var _a;const col=STARTUP_CHECKLIST_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",sectionNumber:item[col.sectionNumber]||0,sectionName:item[col.sectionName]||"",itemNumber:item[col.itemNumber]||"",label:item[col.label]||"",responseType:item[col.responseType]||"yesNoNA",response:null!==(_a=item[col.response])&&void 0!==_a?_a:null,status:item[col.status]||"NoResponse",respondedBy:item[col.respondedBy]||null,respondedDate:item[col.respondedDate]||null,assignedTo:item[col.assignedTo]||null,assignedToName:item[col.assignedToName]||null,comment:item[col.comment]||null,isHidden:!!item[col.isHidden],isCustom:!!item[col.isCustom],sortOrder:item[col.sortOrder]||0,activityLog:activityLog||[],hbShare:item[col.hbShare],amount:item[col.amount],period:item[col.period],dateValue:item[col.dateValue],calculatedFrom:item[col.calculatedFrom],placeholder:item[col.placeholder],details:item[col.details]}}mapToCloseoutItem(item){var _a;const col=CLOSEOUT_ITEMS_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",category:item[col.category]||"",description:item[col.description]||"",status:item[col.status]||"NoResponse",assignedTo:item[col.assignedTo]||"",assignedToId:item[col.assignedToId],completedDate:item[col.completedDate],notes:item[col.notes],sectionNumber:item[col.sectionNumber]||0,sectionName:item[col.sectionName]||"",itemNumber:item[col.itemNumber]||"",label:item[col.label]||"",responseType:item[col.responseType]||"yesNoNA",response:null!==(_a=item[col.response])&&void 0!==_a?_a:null,respondedBy:item[col.respondedBy],respondedDate:item[col.respondedDate],comment:item[col.comment],isHidden:!!item[col.isHidden],isCustom:!!item[col.isCustom],sortOrder:item[col.sortOrder]||0,dateValue:item[col.dateValue],calculatedFrom:item[col.calculatedFrom],placeholder:item[col.placeholder],details:item[col.details]}}mapToChecklistActivityEntry(item){const col=CHECKLIST_ACTIVITY_LOG_COLUMNS;return{id:item[col.id]||item.Id,checklistItemId:item[col.checklistItemId]||void 0,projectCode:item[col.projectCode]||void 0,timestamp:item[col.timestamp]||"",user:item[col.user]||"",previousValue:item[col.previousValue]||null,newValue:item[col.newValue]||null,comment:item[col.comment]||void 0}}mapToInternalMatrixTask(item){const col=INTERNAL_MATRIX_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",sortOrder:item[col.sortOrder]||0,taskCategory:item[col.taskCategory]||"",taskDescription:item[col.taskDescription]||"",PX:item[col.PX]||"",SrPM:item[col.SrPM]||"",PM2:item[col.PM2]||"",PM1:item[col.PM1]||"",PA:item[col.PA]||"",QAQC:item[col.QAQC]||"",ProjAcct:item[col.ProjAcct]||"",isHidden:!!item[col.isHidden],isCustom:!!item[col.isCustom]}}mapToOwnerContractArticle(item){const col=OWNER_CONTRACT_MATRIX_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",sortOrder:item[col.sortOrder]||0,articleNumber:item[col.articleNumber]||"",pageNumber:item[col.pageNumber]||"",responsibleParty:item[col.responsibleParty]||"",description:item[col.description]||"",isHidden:!!item[col.isHidden],isCustom:!!item[col.isCustom]}}mapToSubContractClause(item){const col=SUB_CONTRACT_MATRIX_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",sortOrder:item[col.sortOrder]||0,refNumber:item[col.refNumber]||"",pageNumber:item[col.pageNumber]||"",clauseDescription:item[col.clauseDescription]||"",ProjExec:item[col.ProjExec]||"",ProjMgr:item[col.ProjMgr]||"",AsstPM:item[col.AsstPM]||"",Super:item[col.Super]||"",ProjAdmin:item[col.ProjAdmin]||"",isHidden:!!item[col.isHidden],isCustom:!!item[col.isCustom]}}mapToMarketingProjectRecord(item){const col=MARKETING_PROJECT_RECORDS_COLUMNS;let contractType=[];try{const raw=item[col.contractType];"string"==typeof raw&&raw?contractType=JSON.parse(raw):Array.isArray(raw)&&(contractType=raw)}catch(_a){}let renderingUrls=[];try{const raw=item[col.renderingUrls];"string"==typeof raw&&raw?renderingUrls=JSON.parse(raw):Array.isArray(raw)&&(renderingUrls=raw)}catch(_b){}let finalPhotoUrls=[];try{const raw=item[col.finalPhotoUrls];"string"==typeof raw&&raw?finalPhotoUrls=JSON.parse(raw):Array.isArray(raw)&&(finalPhotoUrls=raw)}catch(_c){}let sectionCompletion={};try{const raw=item[col.sectionCompletion];"string"==typeof raw&&raw?sectionCompletion=JSON.parse(raw):raw&&"object"==typeof raw&&(sectionCompletion=raw)}catch(_d){}return{projectName:item[col.projectName]||"",projectCode:item[col.projectCode]||"",leadId:item[col.leadId]||null,contractType,deliveryMethod:item[col.deliveryMethod]||"",architect:item[col.architect]||"",landscapeArchitect:item[col.landscapeArchitect]||"",interiorDesigner:item[col.interiorDesigner]||"",engineer:item[col.engineer]||"",buildingSystemType:item[col.buildingSystemType]||"",projectDescription:item[col.projectDescription]||"",uniqueCharacteristics:item[col.uniqueCharacteristics]||"",renderingUrls,finalPhotoUrls,contractBudget:item[col.contractBudget]||null,contractFinalCost:item[col.contractFinalCost]||null,totalCostPerGSF:item[col.totalCostPerGSF]||null,totalBudgetVariance:item[col.totalBudgetVariance]||null,budgetExplanation:item[col.budgetExplanation]||"",CO_OwnerDirected_Count:item[col.CO_OwnerDirected_Count]||null,CO_OwnerDirected_Value:item[col.CO_OwnerDirected_Value]||null,CO_MunicipalityDirected_Count:item[col.CO_MunicipalityDirected_Count]||null,CO_MunicipalityDirected_Value:item[col.CO_MunicipalityDirected_Value]||null,CO_EO_Count:item[col.CO_EO_Count]||null,CO_EO_Value:item[col.CO_EO_Value]||null,CO_ContractorDirected_Count:item[col.CO_ContractorDirected_Count]||null,savingsReturned:item[col.savingsReturned]||null,savingsReturnedPct:item[col.savingsReturnedPct]||null,scheduleStartAnticipated:item[col.scheduleStartAnticipated]||null,scheduleStartActual:item[col.scheduleStartActual]||null,scheduleEndAnticipated:item[col.scheduleEndAnticipated]||null,scheduleEndActual:item[col.scheduleEndActual]||null,onSchedule:item[col.onSchedule]||"",scheduleExplanation:item[col.scheduleExplanation]||"",substantialCompletionDate:item[col.substantialCompletionDate]||null,finalCompletionDate:item[col.finalCompletionDate]||null,punchListItems:item[col.punchListItems]||null,punchListDaysToComplete:item[col.punchListDaysToComplete]||null,innovativeSafetyPrograms:item[col.innovativeSafetyPrograms]||"",mwbeRequirement:item[col.mwbeRequirement]||"",mwbeAchievement:item[col.mwbeAchievement]||"",sbeRequirement:item[col.sbeRequirement]||"",sbeAchievement:item[col.sbeAchievement]||"",localRequirement:item[col.localRequirement]||"",localAchievement:item[col.localAchievement]||"",leedDesignation:item[col.leedDesignation]||"",sustainabilityFeatures:item[col.sustainabilityFeatures]||"",leedAdditionalCost:item[col.leedAdditionalCost]||null,CS_Conflicts:item[col.CS_Conflicts]||"",CS_CostControl:item[col.CS_CostControl]||"",CS_ValueEngineering:item[col.CS_ValueEngineering]||"",CS_QualityControl:item[col.CS_QualityControl]||"",CS_Schedule:item[col.CS_Schedule]||"",CS_Team:item[col.CS_Team]||"",CS_Safety:item[col.CS_Safety]||"",CS_LEED:item[col.CS_LEED]||"",CS_SupplierDiversity:item[col.CS_SupplierDiversity]||"",CS_Challenges:item[col.CS_Challenges]||"",CS_InnovativeSolutions:item[col.CS_InnovativeSolutions]||"",CS_ProductsSystems:item[col.CS_ProductsSystems]||"",CS_ClientService:item[col.CS_ClientService]||"",CS_LessonsLearned:item[col.CS_LessonsLearned]||"",sectionCompletion,overallCompletion:item[col.overallCompletion]||0,lastUpdatedBy:item[col.lastUpdatedBy]||"",lastUpdatedAt:item[col.lastUpdatedAt]||"",createdBy:item[col.createdBy]||"",createdAt:item[col.createdAt]||""}}buildMarketingUpdateData(data){const col=MARKETING_PROJECT_RECORDS_COLUMNS,result={},stringFields=["projectName","projectCode","deliveryMethod","architect","landscapeArchitect","interiorDesigner","engineer","buildingSystemType","projectDescription","uniqueCharacteristics","budgetExplanation","onSchedule","scheduleExplanation","innovativeSafetyPrograms","mwbeRequirement","mwbeAchievement","sbeRequirement","sbeAchievement","localRequirement","localAchievement","leedDesignation","sustainabilityFeatures","CS_Conflicts","CS_CostControl","CS_ValueEngineering","CS_QualityControl","CS_Schedule","CS_Team","CS_Safety","CS_LEED","CS_SupplierDiversity","CS_Challenges","CS_InnovativeSolutions","CS_ProductsSystems","CS_ClientService","CS_LessonsLearned","lastUpdatedBy","lastUpdatedAt","createdBy","createdAt"];for(const field of stringFields)void 0!==data[field]&&(result[col[field]]=data[field]);const numberFields=["leadId","contractBudget","contractFinalCost","totalCostPerGSF","totalBudgetVariance","CO_OwnerDirected_Count","CO_OwnerDirected_Value","CO_MunicipalityDirected_Count","CO_MunicipalityDirected_Value","CO_EO_Count","CO_EO_Value","CO_ContractorDirected_Count","savingsReturned","savingsReturnedPct","punchListItems","punchListDaysToComplete","leedAdditionalCost","overallCompletion"];for(const field of numberFields)void 0!==data[field]&&(result[col[field]]=data[field]);const dateFields=["scheduleStartAnticipated","scheduleStartActual","scheduleEndAnticipated","scheduleEndActual","substantialCompletionDate","finalCompletionDate"];for(const field of dateFields)void 0!==data[field]&&(result[col[field]]=data[field]);return void 0!==data.contractType&&(result[col.contractType]=JSON.stringify(data.contractType)),void 0!==data.renderingUrls&&(result[col.renderingUrls]=JSON.stringify(data.renderingUrls)),void 0!==data.finalPhotoUrls&&(result[col.finalPhotoUrls]=JSON.stringify(data.finalPhotoUrls)),void 0!==data.sectionCompletion&&(result[col.sectionCompletion]=JSON.stringify(data.sectionCompletion)),result}mapToRiskCostManagement(item){const col=RISK_COST_MANAGEMENT_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",contractType:item[col.contractType]||"",contractAmount:item[col.contractAmount]||0,buyoutOpportunities:[],potentialRisks:[],potentialSavings:[],createdBy:item[col.createdBy]||"",createdAt:item[col.createdAt]||"",lastUpdatedBy:item[col.lastUpdatedBy]||"",lastUpdatedAt:item[col.lastUpdatedAt]||""}}mapToRiskCostItem(item){const col=RISK_COST_ITEMS_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",riskCostId:item[col.riskCostId]||void 0,category:item[col.category]||"Risk",letter:item[col.letter]||"",description:item[col.description]||"",estimatedValue:item[col.estimatedValue]||0,status:item[col.status]||"Open",notes:item[col.notes]||"",createdDate:item[col.createdDate]||"",updatedDate:item[col.updatedDate]||""}}mapToQualityConcern(item){const col=QUALITY_CONCERNS_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",letter:item[col.letter]||"",description:item[col.description]||"",raisedBy:item[col.raisedBy]||"",raisedDate:item[col.raisedDate]||"",status:item[col.status]||"Open",resolution:item[col.resolution]||"",resolvedDate:item[col.resolvedDate]||null,notes:item[col.notes]||""}}mapToSafetyConcern(item){const col=SAFETY_CONCERNS_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",safetyOfficerName:item[col.safetyOfficerName]||"",safetyOfficerEmail:item[col.safetyOfficerEmail]||"",letter:item[col.letter]||"",description:item[col.description]||"",severity:item[col.severity]||"Medium",raisedBy:item[col.raisedBy]||"",raisedDate:item[col.raisedDate]||"",status:item[col.status]||"Open",resolution:item[col.resolution]||"",resolvedDate:item[col.resolvedDate]||null,notes:item[col.notes]||""}}mapToProjectSchedule(item){var _a,_b,_c;const col=PROJECT_SCHEDULE_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",startDate:item[col.startDate]||null,substantialCompletionDate:item[col.substantialCompletionDate]||null,ntpDate:item[col.ntpDate]||null,nocDate:item[col.nocDate]||null,contractCalendarDays:null!==(_a=item[col.contractCalendarDays])&&void 0!==_a?_a:null,contractBasisType:item[col.contractBasisType]||"",teamGoalDaysAhead:null!==(_b=item[col.teamGoalDaysAhead])&&void 0!==_b?_b:null,teamGoalDescription:item[col.teamGoalDescription]||"",hasLiquidatedDamages:!!item[col.hasLiquidatedDamages],liquidatedDamagesAmount:null!==(_c=item[col.liquidatedDamagesAmount])&&void 0!==_c?_c:null,liquidatedDamagesTerms:item[col.liquidatedDamagesTerms]||"",criticalPathConcerns:[],createdBy:item[col.createdBy]||"",createdAt:item[col.createdAt]||"",lastUpdatedBy:item[col.lastUpdatedBy]||"",lastUpdatedAt:item[col.lastUpdatedAt]||""}}mapToCriticalPathItem(item){const col=CRITICAL_PATH_ITEMS_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",scheduleId:item[col.scheduleId]||void 0,letter:item[col.letter]||"",description:item[col.description]||"",impactDescription:item[col.impactDescription]||"",status:item[col.status]||"Active",mitigationPlan:item[col.mitigationPlan]||"",createdDate:item[col.createdDate]||"",updatedDate:item[col.updatedDate]||""}}mapToSuperintendentPlan(item){const col=SUPERINTENDENT_PLAN_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",superintendentName:item[col.superintendentName]||"",sections:[],createdBy:item[col.createdBy]||"",createdAt:item[col.createdAt]||"",lastUpdatedBy:item[col.lastUpdatedBy]||"",lastUpdatedAt:item[col.lastUpdatedAt]||""}}mapToSuperintendentPlanSection(item){const col=SUPERINTENDENT_PLAN_SECTIONS_COLUMNS;let attachmentUrls=[];try{const raw=item[col.attachmentUrls];"string"==typeof raw&&raw?attachmentUrls=JSON.parse(raw):Array.isArray(raw)&&(attachmentUrls=raw)}catch(_a){}return{id:item[col.id]||item.Id,superintendentPlanId:item[col.superintendentPlanId]||void 0,projectCode:item[col.projectCode]||"",sectionKey:item[col.sectionKey]||"",sectionTitle:item[col.sectionTitle]||"",content:item[col.content]||"",attachmentUrls,isComplete:!!item[col.isComplete]}}mapToLessonLearned(item){const col=LESSONS_LEARNED_COLUMNS;let tags=[];try{const raw=item[col.tags];"string"==typeof raw&&raw?tags=JSON.parse(raw):Array.isArray(raw)&&(tags=raw)}catch(_a){}return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",title:item[col.title]||"",category:item[col.category]||"Other",impact:item[col.impact]||"Neutral",description:item[col.description]||"",recommendation:item[col.recommendation]||"",raisedBy:item[col.raisedBy]||"",raisedDate:item[col.raisedDate]||"",phase:item[col.phase]||"",isIncludedInFinalRecord:!!item[col.isIncludedInFinalRecord],tags}}mapToEstimatingKickoff(item){var _a;const col=ESTIMATING_KICKOFFS_COLUMNS;let keyPersonnel=[];try{const raw=item[col.KeyPersonnel];"string"==typeof raw&&raw?keyPersonnel=JSON.parse(raw):Array.isArray(raw)&&(keyPersonnel=raw)}catch(_b){}return{id:item[col.id]||item.Id,LeadID:item[col.LeadID]||0,ProjectCode:item[col.ProjectCode]||"",Architect:item[col.Architect]||void 0,ProposalDueDateTime:item[col.ProposalDueDateTime]||void 0,ProposalType:item[col.ProposalType]||void 0,RFIFormat:item[col.RFIFormat]||void 0,PrimaryOwnerContact:item[col.PrimaryOwnerContact]||void 0,ProposalDeliveryMethod:item[col.ProposalDeliveryMethod]||void 0,CopiesIfHandDelivered:null!==(_a=item[col.CopiesIfHandDelivered])&&void 0!==_a?_a:void 0,HBProposalDue:item[col.HBProposalDue]||void 0,SubcontractorProposalsDue:item[col.SubcontractorProposalsDue]||void 0,PreSubmissionReview:item[col.PreSubmissionReview]||void 0,SubcontractorSiteWalkThru:item[col.SubcontractorSiteWalkThru]||void 0,OwnerEstimateReview:item[col.OwnerEstimateReview]||void 0,keyPersonnel:keyPersonnel.length>0?keyPersonnel:void 0,items:[],KickoffMeetingId:item[col.KickoffMeetingId]||void 0,KickoffMeetingDate:item[col.KickoffMeetingDate]||void 0,CreatedBy:item[col.CreatedBy]||"",CreatedDate:item[col.CreatedDate]||"",ModifiedBy:item[col.ModifiedBy]||void 0,ModifiedDate:item[col.ModifiedDate]||void 0}}mapToEstimatingKickoffItem(item){var _a;const col=ESTIMATING_KICKOFF_ITEMS_COLUMNS;let assignees;try{const raw=item[col.Assignees];"string"==typeof raw&&raw?assignees=JSON.parse(raw):Array.isArray(raw)&&(assignees=raw)}catch(_b){}return{id:item[col.id]||item.Id,kickoffId:item[col.kickoffId]||void 0,projectCode:item[col.projectCode]||void 0,section:item[col.section]||"managing",task:item[col.task]||"",status:item[col.status]||null,responsibleParty:item[col.responsibleParty]||void 0,assignees,deadline:item[col.deadline]||void 0,frequency:item[col.frequency]||void 0,notes:item[col.notes]||void 0,tabRequired:void 0!==item[col.tabRequired]?!!item[col.tabRequired]:void 0,isCustom:void 0!==item[col.isCustom]?!!item[col.isCustom]:void 0,sortOrder:null!==(_a=item[col.sortOrder])&&void 0!==_a?_a:0}}mapToJobNumberRequest(item){const col=JOB_NUMBER_REQUESTS_COLUMNS;let requestedCostCodes=[];try{const raw=item[col.RequestedCostCodes];"string"==typeof raw&&raw?requestedCostCodes=JSON.parse(raw):Array.isArray(raw)&&(requestedCostCodes=raw)}catch(_a){}return{id:item[col.id]||item.Id,LeadID:item[col.LeadID]||0,RequestDate:item[col.RequestDate]||"",Originator:item[col.Originator]||"",RequiredByDate:item[col.RequiredByDate]||"",ProjectAddress:item[col.ProjectAddress]||"",ProjectExecutive:item[col.ProjectExecutive]||"",ProjectManager:item[col.ProjectManager]||void 0,ProjectType:item[col.ProjectType]||"",ProjectTypeLabel:item[col.ProjectTypeLabel]||"",IsEstimatingOnly:!!item[col.IsEstimatingOnly],RequestedCostCodes:requestedCostCodes,RequestStatus:item[col.RequestStatus]||JobNumberRequestStatus.Pending,AssignedJobNumber:item[col.AssignedJobNumber]||void 0,AssignedBy:item[col.AssignedBy]||void 0,AssignedDate:item[col.AssignedDate]||void 0,SiteProvisioningHeld:!!item[col.SiteProvisioningHeld],TempProjectCode:item[col.TempProjectCode]||void 0,Notes:item[col.Notes]||void 0}}mapToProjectType(item){const col=PROJECT_TYPES_COLUMNS;return{code:item[col.code]||"",label:item[col.label]||"",office:item[col.office]||""}}mapToStandardCostCode(item){const col=STANDARD_COST_CODES_COLUMNS;return{id:item[col.id]||"",description:item[col.description]||"",phase:item[col.phase]||"",division:item[col.division]||"",isDefault:!!item[col.isDefault]}}mapToSectorDefinition(item){var _a;const col=SECTOR_DEFINITIONS_COLUMNS;return{id:item[col.id]||item.Id,code:item[col.code]||"",label:item[col.label]||"",isActive:!!item[col.isActive],parentDivision:item[col.parentDivision]||void 0,sortOrder:null!==(_a=item[col.sortOrder])&&void 0!==_a?_a:0}}mapToAssignmentMapping(item){const col=ASSIGNMENT_MAPPINGS_COLUMNS;return{id:item[col.id]||item.Id,region:item[col.region]||"All Regions",sector:item[col.sector]||"All Sectors",assignmentType:item[col.assignmentType]||"Director",assignee:{userId:item[col.assigneeUserId]||"",displayName:item[col.assigneeDisplayName]||"",email:item[col.assigneeEmail]||""}}}mapToPMP(item){const col=PMP_COLUMNS,parseJson=(raw,fallback=null)=>{try{if("string"==typeof raw&&raw)return JSON.parse(raw);if(Array.isArray(raw)||"object"==typeof raw&&null!==raw)return raw}catch(_a){}return fallback};return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",projectName:item[col.projectName]||"",jobNumber:item[col.jobNumber]||"",status:item[col.status]||"Draft",currentCycleNumber:item[col.currentCycleNumber]||0,division:item[col.division]||"",superintendentPlan:item[col.superintendentPlan]||"",preconMeetingNotes:item[col.preconMeetingNotes]||"",siteManagementNotes:item[col.siteManagementNotes]||"",projectAdminBuyoutDate:item[col.projectAdminBuyoutDate]||null,attachmentUrls:parseJson(item[col.attachmentUrls],[]),riskCostData:parseJson(item[col.riskCostData]),qualityConcerns:parseJson(item[col.qualityConcerns],[]),safetyConcerns:parseJson(item[col.safetyConcerns],[]),scheduleData:parseJson(item[col.scheduleData]),superintendentPlanData:parseJson(item[col.superintendentPlanData]),lessonsLearned:parseJson(item[col.lessonsLearned],[]),teamAssignments:parseJson(item[col.teamAssignments],[]),boilerplate:parseJson(item[col.boilerplate],[]),startupSignatures:[],completionSignatures:[],approvalCycles:[],createdBy:item[col.createdBy]||"",createdAt:item[col.createdAt]||"",lastUpdatedBy:item[col.lastUpdatedBy]||"",lastUpdatedAt:item[col.lastUpdatedAt]||""}}mapToPMPSignature(item){const col=PMP_SIGNATURES_COLUMNS;return{id:item[col.id]||item.Id,pmpId:item[col.pmpId]||void 0,projectCode:item[col.projectCode]||"",signatureType:item[col.signatureType]||"Startup",role:item[col.role]||"",personName:item[col.personName]||"",personEmail:item[col.personEmail]||"",isRequired:!!item[col.isRequired],isLead:!!item[col.isLead],status:item[col.status]||"Pending",signedDate:item[col.signedDate]||null,affidavitText:item[col.affidavitText]||"",comment:item[col.comment]||""}}mapToPMPApprovalCycle(item){const col=PMP_APPROVAL_CYCLES_COLUMNS;let changesFromPrevious=[];try{const raw=item[col.changesFromPrevious];"string"==typeof raw&&raw?changesFromPrevious=JSON.parse(raw):Array.isArray(raw)&&(changesFromPrevious=raw)}catch(_a){}return{id:item[col.id]||item.Id,pmpId:item[col.pmpId]||void 0,projectCode:item[col.projectCode]||void 0,cycleNumber:item[col.cycleNumber]||0,submittedBy:item[col.submittedBy]||"",submittedDate:item[col.submittedDate]||"",status:item[col.status]||"InProgress",steps:[],changesFromPrevious}}mapToPMPApprovalStep(item){const col=PMP_APPROVAL_STEPS_COLUMNS;return{id:item[col.id]||item.Id,approvalCycleId:item[col.approvalCycleId]||void 0,projectCode:item[col.projectCode]||"",stepOrder:item[col.stepOrder]||0,approverRole:item[col.approverRole]||"",approverName:item[col.approverName]||"",approverEmail:item[col.approverEmail]||"",status:item[col.status]||"Pending",comment:item[col.comment]||"",actionDate:item[col.actionDate]||null,approvalCycleNumber:item[col.approvalCycleNumber]||0}}mapToDivisionApprover(item){const col=DIVISION_APPROVERS_COLUMNS;return{id:item[col.id]||item.Id,division:item[col.division]||"Commercial",approverName:item[col.approverName]||"",approverEmail:item[col.approverEmail]||"",approverTitle:item[col.approverTitle]||""}}mapToPMPBoilerplateSection(item){const col=PMP_BOILERPLATE_COLUMNS;return{sectionNumber:item[col.sectionNumber]||"",sectionTitle:item[col.sectionTitle]||"",content:item[col.content]||"",sourceDocumentUrl:item[col.sourceDocumentUrl]||"",lastSourceUpdate:item[col.lastSourceUpdate]||""}}assemblePMPFromParts(pmp,signatures,cycles,steps){return Object.assign(Object.assign({},pmp),{startupSignatures:signatures.filter(s=>"Startup"===s.signatureType),completionSignatures:signatures.filter(s=>"Completion"===s.signatureType),approvalCycles:cycles.map(c=>Object.assign(Object.assign({},c),{steps:steps.filter(s=>s.approvalCycleId===c.id)}))})}mapToMonthlyReview(item){const col=MONTHLY_REVIEWS_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",reviewMonth:item[col.reviewMonth]||"",status:item[col.status]||"NotStarted",dueDate:item[col.dueDate]||"",meetingDate:item[col.meetingDate]||null,pmSubmittedDate:item[col.pmSubmittedDate]||null,pxReviewDate:item[col.pxReviewDate]||null,pxValidationDate:item[col.pxValidationDate]||null,leadershipSubmitDate:item[col.leadershipSubmitDate]||null,completedDate:item[col.completedDate]||null,checklistItems:[],followUps:[],reportDocumentUrls:((raw,fallback=null)=>{try{if("string"==typeof raw&&raw)return JSON.parse(raw);if(Array.isArray(raw)||"object"==typeof raw&&null!==raw)return raw}catch(_a){}return fallback})(item[col.reportDocumentUrls],[]),createdBy:item[col.createdBy]||"",createdAt:item[col.createdAt]||"",lastUpdatedBy:item[col.lastUpdatedBy]||"",lastUpdatedAt:item[col.lastUpdatedAt]||""}}mapToMonthlyChecklistItem(item){const col=MONTHLY_CHECKLIST_ITEMS_COLUMNS;return{id:item[col.id]||item.Id,reviewId:item[col.reviewId]||void 0,sectionKey:item[col.sectionKey]||"",sectionTitle:item[col.sectionTitle]||"",itemKey:item[col.itemKey]||"",itemDescription:item[col.itemDescription]||"",pmComment:item[col.pmComment]||"",pxComment:item[col.pxComment]||"",pxInitial:item[col.pxInitial]||""}}mapToMonthlyFollowUp(item){const col=MONTHLY_FOLLOW_UPS_COLUMNS;return{id:item[col.id]||item.Id,reviewId:item[col.reviewId]||void 0,question:item[col.question]||"",requestedBy:item[col.requestedBy]||"",requestedDate:item[col.requestedDate]||"",pmResponse:item[col.pmResponse]||"",responseDate:item[col.responseDate]||null,pxForwardedDate:item[col.pxForwardedDate]||null,status:item[col.status]||"Open"}}assembleMonthlyReview(review,checklistItems,followUps){return Object.assign(Object.assign({},review),{checklistItems:checklistItems.filter(i=>i.reviewId===review.id),followUps:followUps.filter(f=>f.reviewId===review.id)})}mapToTurnoverAgenda(item){const col=TURNOVER_AGENDAS_COLUMNS;return{id:item[col.id]||item.Id,projectCode:item[col.projectCode]||"",leadId:item[col.leadId]||0,status:item[col.status]||enums.TurnoverStatus.Draft,projectName:item[col.projectName]||"",header:{},estimateOverview:{},prerequisites:[],discussionItems:[],subcontractors:[],exhibits:[],signatures:[],meetingDate:item[col.meetingDate]||void 0,recordingUrl:item[col.recordingUrl]||void 0,turnoverFolderUrl:item[col.turnoverFolderUrl]||void 0,bcPublished:!!item[col.bcPublished],pmName:item[col.pmName]||void 0,apmName:item[col.apmName]||void 0,createdBy:item[col.createdBy]||"",createdDate:item[col.createdDate]||"",lastModifiedBy:item[col.lastModifiedBy]||void 0,lastModifiedDate:item[col.lastModifiedDate]||void 0}}mapToTurnoverPrerequisite(item){const col=TURNOVER_PREREQUISITES_COLUMNS;return{id:item[col.id]||item.Id,turnoverAgendaId:item[col.turnoverAgendaId]||0,sortOrder:item[col.sortOrder]||0,label:item[col.label]||"",description:item[col.description]||"",completed:!!item[col.completed],completedBy:item[col.completedBy]||void 0,completedDate:item[col.completedDate]||void 0}}mapToTurnoverDiscussionItem(item){const col=TURNOVER_DISCUSSION_ITEMS_COLUMNS;return{id:item[col.id]||item.Id,turnoverAgendaId:item[col.turnoverAgendaId]||0,sortOrder:item[col.sortOrder]||0,label:item[col.label]||"",description:item[col.description]||"",discussed:!!item[col.discussed],notes:item[col.notes]||"",attachments:[]}}mapToTurnoverSubcontractor(item){var _a;const col=TURNOVER_SUBCONTRACTORS_COLUMNS;return{id:item[col.id]||item.Id,turnoverAgendaId:item[col.turnoverAgendaId]||0,trade:item[col.trade]||"",subcontractorName:item[col.subcontractorName]||"",contactName:item[col.contactName]||"",contactPhone:item[col.contactPhone]||"",contactEmail:item[col.contactEmail]||"",qScore:null!==(_a=item[col.qScore])&&void 0!==_a?_a:null,isPreferred:!!item[col.isPreferred],isRequired:!!item[col.isRequired],notes:item[col.notes]||""}}mapToTurnoverExhibit(item){const col=TURNOVER_EXHIBITS_COLUMNS;return{id:item[col.id]||item.Id,turnoverAgendaId:item[col.turnoverAgendaId]||0,sortOrder:item[col.sortOrder]||0,label:item[col.label]||"",isDefault:!!item[col.isDefault],reviewed:!!item[col.reviewed],reviewedBy:item[col.reviewedBy]||void 0,reviewedDate:item[col.reviewedDate]||void 0,linkedDocumentUrl:item[col.linkedDocumentUrl]||void 0,uploadedFileName:item[col.uploadedFileName]||void 0,uploadedFileUrl:item[col.uploadedFileUrl]||void 0}}mapToTurnoverSignature(item){const col=TURNOVER_SIGNATURES_COLUMNS;return{id:item[col.id]||item.Id,turnoverAgendaId:item[col.turnoverAgendaId]||0,sortOrder:item[col.sortOrder]||0,role:item[col.role]||"",signerName:item[col.signerName]||"",signerEmail:item[col.signerEmail]||"",affidavitText:item[col.affidavitText]||"",signed:!!item[col.signed],signedDate:item[col.signedDate]||void 0,comment:item[col.comment]||void 0}}mapToTurnoverAttachment(item){const col=TURNOVER_ATTACHMENTS_COLUMNS;return{id:item[col.id]||item.Id,discussionItemId:item[col.discussionItemId]||0,fileName:item[col.fileName]||"",fileUrl:item[col.fileUrl]||"",uploadedBy:item[col.uploadedBy]||"",uploadedDate:item[col.uploadedDate]||""}}mapToTurnoverEstimateOverview(item){const col=TURNOVER_ESTIMATE_OVERVIEWS_COLUMNS;let overrides={};try{const raw=item[col.overrides];"string"==typeof raw&&raw?overrides=JSON.parse(raw):"object"==typeof raw&&null!==raw&&(overrides=raw)}catch(_a){}return{id:item[col.id]||item.Id,turnoverAgendaId:item[col.turnoverAgendaId]||0,contractAmount:item[col.contractAmount]||0,originalEstimate:item[col.originalEstimate]||0,buyoutTarget:item[col.buyoutTarget]||0,estimatedFee:item[col.estimatedFee]||0,estimatedGrossMargin:item[col.estimatedGrossMargin]||0,contingency:item[col.contingency]||0,notes:item[col.notes]||"",overrides}}assembleTurnoverAgenda(agenda,lead,headerOverrides,estimateOverview,prereqs,discussionItems,attachments,subs,exhibits,sigs){const header={id:agenda.id,turnoverAgendaId:agenda.id,projectName:(null==lead?void 0:lead.Title)||agenda.projectName||"",projectCode:agenda.projectCode,clientName:(null==lead?void 0:lead.ClientName)||"",projectValue:(null==lead?void 0:lead.ProjectValue)||0,deliveryMethod:(null==lead?void 0:lead.DeliveryMethod)||"",projectExecutive:(null==lead?void 0:lead.ProjectExecutive)||"",projectManager:(null==lead?void 0:lead.ProjectManager)||"",leadEstimator:"",overrides:headerOverrides},itemsWithAttachments=discussionItems.map(item=>Object.assign(Object.assign({},item),{attachments:attachments.filter(a=>a.discussionItemId===item.id)}));return Object.assign(Object.assign({},agenda),{header,estimateOverview:estimateOverview||{},prerequisites:prereqs.sort((a,b)=>a.sortOrder-b.sortOrder),discussionItems:itemsWithAttachments.sort((a,b)=>a.sortOrder-b.sortOrder),subcontractors:subs,exhibits:exhibits.sort((a,b)=>a.sortOrder-b.sortOrder),signatures:sigs.sort((a,b)=>a.sortOrder-b.sortOrder)})}mapToPerformanceLog(item){const col=PERFORMANCE_LOGS_COLUMNS;let marks=[];try{marks=JSON.parse(item[col.Marks]||"[]")}catch(_a){}return{id:item[col.id]||item.Id,SessionId:item[col.SessionId]||"",Timestamp:item[col.Timestamp]||"",UserEmail:item[col.UserEmail]||"",SiteUrl:item[col.SiteUrl]||"",ProjectCode:item[col.ProjectCode]||void 0,IsProjectSite:!!item[col.IsProjectSite],WebPartLoadMs:item[col.WebPartLoadMs]||0,AppInitMs:item[col.AppInitMs]||0,DataFetchMs:item[col.DataFetchMs]||void 0,TotalLoadMs:item[col.TotalLoadMs]||0,Marks:marks,UserAgent:item[col.UserAgent]||"",SpfxVersion:item[col.SpfxVersion]||"",Notes:item[col.Notes]||void 0}}async logPerformanceEntry(entry){var _a;performanceService.startMark("sp:logPerformanceEntry");const col=PERFORMANCE_LOGS_COLUMNS,addData={[col.SessionId]:entry.SessionId||"",[col.Timestamp]:entry.Timestamp||(new Date).toISOString(),[col.UserEmail]:entry.UserEmail||"",[col.SiteUrl]:entry.SiteUrl||"",[col.ProjectCode]:entry.ProjectCode||"",[col.IsProjectSite]:entry.IsProjectSite||!1,[col.WebPartLoadMs]:entry.WebPartLoadMs||0,[col.AppInitMs]:entry.AppInitMs||0,[col.DataFetchMs]:entry.DataFetchMs||0,[col.TotalLoadMs]:entry.TotalLoadMs||0,[col.Marks]:JSON.stringify(entry.Marks||[]),[col.UserAgent]:entry.UserAgent||"",[col.SpfxVersion]:entry.SpfxVersion||"",[col.Notes]:entry.Notes||""},result=await this.sp.web.lists.getByTitle(LIST_NAMES.PERFORMANCE_LOGS).items.add(addData),newId=result.Id||(null===(_a=result.data)||void 0===_a?void 0:_a.Id)||0,reRead=await this.sp.web.lists.getByTitle(LIST_NAMES.PERFORMANCE_LOGS).items.getById(newId)();return performanceService.endMark("sp:logPerformanceEntry"),this.mapToPerformanceLog(reRead)}async getPerformanceLogs(options){performanceService.startMark("sp:getPerformanceLogs");const col=PERFORMANCE_LOGS_COLUMNS,filters=[];(null==options?void 0:options.startDate)&&filters.push(`${col.Timestamp} ge datetime'${options.startDate}'`),(null==options?void 0:options.endDate)&&filters.push(`${col.Timestamp} le datetime'${options.endDate}'`),(null==options?void 0:options.siteUrl)&&filters.push(`${col.SiteUrl} eq '${options.siteUrl}'`),(null==options?void 0:options.projectCode)&&filters.push(`${col.ProjectCode} eq '${options.projectCode}'`);let query=this.sp.web.lists.getByTitle(LIST_NAMES.PERFORMANCE_LOGS).items;filters.length>0&&(query=query.filter(filters.join(" and "))),query=query.orderBy(col.Timestamp,!1).top((null==options?void 0:options.limit)||500);const items=await query();return performanceService.endMark("sp:getPerformanceLogs"),items.map(i=>this.mapToPerformanceLog(i))}async getPerformanceSummary(options){performanceService.startMark("sp:getPerformanceSummary");const logs=await this.getPerformanceLogs(options);if(0===logs.length)return{avgTotalLoadMs:0,avgWebPartLoadMs:0,avgAppInitMs:0,p95TotalLoadMs:0,totalSessions:0,slowSessionCount:0,byDay:[]};const totalSessions=logs.length,sumTotal=logs.reduce((s,l)=>s+l.TotalLoadMs,0),sumWP=logs.reduce((s,l)=>s+l.WebPartLoadMs,0),sumInit=logs.reduce((s,l)=>s+l.AppInitMs,0),sorted=[...logs].sort((a,b)=>a.TotalLoadMs-b.TotalLoadMs),p95TotalLoadMs=sorted[Math.min(Math.floor(.95*sorted.length),sorted.length-1)].TotalLoadMs,slowSessionCount=logs.filter(l=>l.TotalLoadMs>5e3).length,dayMap=new Map;for(const log of logs){const day=log.Timestamp.substring(0,10),existing=dayMap.get(day)||{sum:0,count:0};existing.sum+=log.TotalLoadMs,existing.count+=1,dayMap.set(day,existing)}const byDay=Array.from(dayMap.entries()).map(([date,{sum,count}])=>({date,avgMs:Math.round(sum/count),count})).sort((a,b)=>a.date.localeCompare(b.date));return{avgTotalLoadMs:Math.round(sumTotal/totalSessions),avgWebPartLoadMs:Math.round(sumWP/totalSessions),avgAppInitMs:Math.round(sumInit/totalSessions),p95TotalLoadMs,totalSessions,slowSessionCount,byDay}}mapToHelpGuide(item){const col=HELP_GUIDES_COLUMNS;return{id:item[col.id]||item.Id,moduleKey:item[col.moduleKey]||"",title:item[col.title]||"",content:item[col.content]||"",guideType:item[col.guideType]||"article",sortOrder:item[col.sortOrder]||0,targetSelector:item[col.targetSelector]||void 0,videoUrl:item[col.videoUrl]||void 0,isActive:!!item[col.isActive],lastModifiedBy:item[col.lastModifiedBy]||void 0,lastModifiedDate:item[col.lastModifiedDate]||void 0}}async getHelpGuides(moduleKey){performanceService.startMark("sp:getHelpGuides");const col=HELP_GUIDES_COLUMNS,filters=[`${col.isActive} eq 1`];moduleKey&&filters.push(`${col.moduleKey} eq '${moduleKey}'`);const items=await this.sp.web.lists.getByTitle(LIST_NAMES.HELP_GUIDES).items.filter(filters.join(" and ")).orderBy(col.sortOrder,!0)();return performanceService.endMark("sp:getHelpGuides"),items.map(i=>this.mapToHelpGuide(i))}async getHelpGuideById(id){performanceService.startMark("sp:getHelpGuideById");try{const item=await this.sp.web.lists.getByTitle(LIST_NAMES.HELP_GUIDES).items.getById(id)();return this.mapToHelpGuide(item)}catch(_a){return performanceService.endMark("sp:getHelpGuideById"),null}}async getSupportConfig(){performanceService.startMark("sp:getSupportConfig");const defaultConfig={supportEmail:"support@hedrickbrothers.com"};try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.filter("SiteURL eq 'SUPPORT_CONFIG'").top(1)();if(items.length>0&&items[0].AppTitle){const parsed=JSON.parse(items[0].AppTitle);return Object.assign(Object.assign({},defaultConfig),parsed)}return defaultConfig}catch(_a){return performanceService.endMark("sp:getSupportConfig"),defaultConfig}}async updateHelpGuide(id,data){performanceService.startMark("sp:updateHelpGuide");const col=HELP_GUIDES_COLUMNS,now=(new Date).toISOString(),updateData={};void 0!==data.moduleKey&&(updateData[col.moduleKey]=data.moduleKey),void 0!==data.title&&(updateData[col.title]=data.title),void 0!==data.content&&(updateData[col.content]=data.content),void 0!==data.guideType&&(updateData[col.guideType]=data.guideType),void 0!==data.sortOrder&&(updateData[col.sortOrder]=data.sortOrder),void 0!==data.targetSelector&&(updateData[col.targetSelector]=data.targetSelector),void 0!==data.videoUrl&&(updateData[col.videoUrl]=data.videoUrl),void 0!==data.isActive&&(updateData[col.isActive]=data.isActive),updateData[col.lastModifiedDate]=now,data.lastModifiedBy&&(updateData[col.lastModifiedBy]=data.lastModifiedBy),await this.sp.web.lists.getByTitle(LIST_NAMES.HELP_GUIDES).items.getById(id).update(updateData);const reRead=await this.sp.web.lists.getByTitle(LIST_NAMES.HELP_GUIDES).items.getById(id)();return performanceService.endMark("sp:updateHelpGuide"),this.mapToHelpGuide(reRead)}async syncToDataMart(projectCode){var _a,_b,_c;const now=(new Date).toISOString();performanceService.startMark("sp:syncToDataMart");try{const portfolioItems=await this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.filter(`ProjectCode eq '${projectCode}'`).top(1)();if(0===portfolioItems.length)return performanceService.endMark("sp:syncToDataMart"),{projectCode,success:!1,syncedAt:now,error:`Project ${projectCode} not found in portfolio`};const portfolio=portfolioItems[0],web=this._getProjectWeb(),[buyoutItems,qualityItems,safetyItems,scheduleItems,criticalPathItems,reviewItems,turnoverItems,pmpItems,teamRoles]=await Promise.all([web.lists.getByTitle(LIST_NAMES.BUYOUT_LOG).items.select("Id","Status","ContractValue","QScore","WaiverRequired","CommitmentStatus").top(5e3)().catch(()=>[]),web.lists.getByTitle(LIST_NAMES.QUALITY_CONCERNS).items.select("Id","Status").top(5e3)().catch(()=>[]),web.lists.getByTitle(LIST_NAMES.SAFETY_CONCERNS).items.select("Id","Status").top(5e3)().catch(()=>[]),web.lists.getByTitle(LIST_NAMES.PROJECT_SCHEDULE).items.select("Id","StartDate","SubstantialCompletionDate","PercentComplete").top(1)().catch(()=>[]),web.lists.getByTitle(LIST_NAMES.CRITICAL_PATH_ITEMS).items.select("Id").filter("Status eq 'Active'").top(5e3)().catch(()=>[]),web.lists.getByTitle(LIST_NAMES.MONTHLY_REVIEWS).items.select("Id","Status","MeetingDate").orderBy("MeetingDate",!1).top(1)().catch(()=>[]),web.lists.getByTitle(LIST_NAMES.TURNOVER_AGENDAS).items.select("Id","Status").top(1)().catch(()=>[]),web.lists.getByTitle(LIST_NAMES.PMP).items.select("Id","Status").top(1)().catch(()=>[]),web.lists.getByTitle(LIST_NAMES.TEAM_ROLE_ASSIGNMENTS).items.select("Id","Role","PersonName","PersonEmail").top(5e3)().catch(()=>[])]),executedBuyouts=buyoutItems.filter(b=>"Executed"===b.Status),buyoutCommittedTotal=executedBuyouts.reduce((sum,b)=>sum+(b.ContractValue||0),0),buyoutExecutedCount=executedBuyouts.length,buyoutOpenCount=buyoutItems.length-executedBuyouts.length,qScores=buyoutItems.filter(b=>null!=b.QScore).map(b=>b.QScore),averageQScore=qScores.length>0?qScores.reduce((s,v)=>s+v,0)/qScores.length:0,openWaiverCount=buyoutItems.filter(b=>b.WaiverRequired&&"Committed"!==b.CommitmentStatus).length,pendingCommitments=buyoutItems.filter(b=>"Committed"!==b.CommitmentStatus).length,openQualityConcerns=qualityItems.filter(c=>"Open"===c.Status||"Monitoring"===c.Status).length,openSafetyConcerns=safetyItems.filter(c=>"Open"===c.Status||"Monitoring"===c.Status).length,schedule=scheduleItems[0],startDate=(null==schedule?void 0:schedule.StartDate)||portfolio.StartDate||null,substantialCompletionDate=(null==schedule?void 0:schedule.SubstantialCompletionDate)||portfolio.SubstantialCompletionDate||null,percentComplete=(null==schedule?void 0:schedule.PercentComplete)||portfolio.PercentComplete||0,criticalPathItemCount=criticalPathItems.length,scheduleDaysVariance=substantialCompletionDate?Math.round((new Date(substantialCompletionDate).getTime()-Date.now())/864e5):0,latestReview=reviewItems[0],monthlyReviewStatus=(null==latestReview?void 0:latestReview.Status)||"",lastMonthlyReviewDate=(null==latestReview?void 0:latestReview.MeetingDate)||null,turnover=turnoverItems[0],turnoverStatus=(null==turnover?void 0:turnover.Status)||"",pmp=pmpItems[0],pmpStatus=(null==pmp?void 0:pmp.Status)||"",findTeamMember=role=>{const member=teamRoles.find(t=>t.Role===role);return{name:(null==member?void 0:member.PersonName)||portfolio[`Personnel${role}`]||"",email:(null==member?void 0:member.PersonEmail)||portfolio[`Personnel${role}Email`]||""}},px=findTeamMember("PX"),pm=findTeamMember("PM"),superRole=findTeamMember("Super"),originalContract=portfolio.OriginalContract||0,changeOrders=portfolio.ChangeOrders||0,currentContractValue=portfolio.CurrentContractValue||originalContract+changeOrders,billingsToDate=portfolio.BillingsToDate||0,unbilledAmount=currentContractValue-billingsToDate,projectedFee=portfolio.ProjectedFee||0,projectedFeePct=portfolio.ProjectedFeePct||0,hasUnbilledAlert=(currentContractValue>0?unbilledAmount/currentContractValue*100:0)>=DEFAULT_ALERT_THRESHOLDS_unbilledWarningPct,hasScheduleAlert=scheduleDaysVariance<-DEFAULT_ALERT_THRESHOLDS_scheduleDelayDays,hasFeeErosionAlert=projectedFeePct<DEFAULT_ALERT_THRESHOLDS_feeErosionPct,complianceStatus=openWaiverCount>3||averageQScore<60?"Red":openWaiverCount>1||averageQScore<75?"Yellow":"Green",dimensions=[complianceStatus];hasUnbilledAlert&&dimensions.push("Red"),hasScheduleAlert&&dimensions.push("Red"),hasFeeErosionAlert&&dimensions.push("Yellow"),openQualityConcerns>5||openSafetyConcerns>3?dimensions.push("Red"):(openQualityConcerns>2||openSafetyConcerns>1)&&dimensions.push("Yellow");const overallHealth=dimensions.includes("Red")?"Red":dimensions.includes("Yellow")?"Yellow":"Green",col=PROJECT_DATA_MART_COLUMNS,spData={[col.projectCode]:projectCode,[col.jobNumber]:portfolio.JobNumber||"",[col.projectName]:portfolio.Title||"",[col.status]:portfolio.Status||"",[col.sector]:portfolio.Sector||"",[col.region]:portfolio.Region||"",[col.projectExecutive]:px.name,[col.projectExecutiveEmail]:px.email,[col.leadPM]:pm.name,[col.leadPMEmail]:pm.email,[col.leadSuperintendent]:superRole.name,[col.leadSuperintendentEmail]:superRole.email,[col.originalContract]:originalContract,[col.changeOrders]:changeOrders,[col.currentContractValue]:currentContractValue,[col.billingsToDate]:billingsToDate,[col.unbilledAmount]:unbilledAmount,[col.projectedFee]:projectedFee,[col.projectedFeePct]:projectedFeePct,[col.buyoutCommittedTotal]:buyoutCommittedTotal,[col.buyoutExecutedCount]:buyoutExecutedCount,[col.buyoutOpenCount]:buyoutOpenCount,[col.startDate]:startDate,[col.substantialCompletionDate]:substantialCompletionDate,[col.percentComplete]:percentComplete,[col.criticalPathItemCount]:criticalPathItemCount,[col.scheduleDaysVariance]:scheduleDaysVariance,[col.openQualityConcerns]:openQualityConcerns,[col.openSafetyConcerns]:openSafetyConcerns,[col.averageQScore]:Math.round(10*averageQScore)/10,[col.openWaiverCount]:openWaiverCount,[col.pendingCommitments]:pendingCommitments,[col.complianceStatus]:complianceStatus,[col.overallHealth]:overallHealth,[col.hasUnbilledAlert]:hasUnbilledAlert,[col.hasScheduleAlert]:hasScheduleAlert,[col.hasFeeErosionAlert]:hasFeeErosionAlert,[col.monthlyReviewStatus]:monthlyReviewStatus,[col.lastMonthlyReviewDate]:lastMonthlyReviewDate,[col.turnoverStatus]:turnoverStatus,[col.pmpStatus]:pmpStatus,[col.lastSyncDate]:now,[col.lastSyncBy]:(null===(_a=this._pageContextUser)||void 0===_a?void 0:_a.displayName)||"System"},existing=await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_DATA_MART).items.filter(`ProjectCode eq '${projectCode}'`).top(1)();return existing.length>0?await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_DATA_MART).items.getById(existing[0].Id).update(spData):await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_DATA_MART).items.add(spData),this.logAudit({Action:enums.AuditAction.DataMartSynced,EntityType:enums.EntityType.DataMart,EntityId:projectCode,User:(null===(_b=this._pageContextUser)||void 0===_b?void 0:_b.displayName)||"System",Details:`Data Mart synced for ${projectCode}`}).catch(()=>{}),cacheService.removeByPrefix(CACHE_KEYS_DATA_MART),performanceService.endMark("sp:syncToDataMart"),{projectCode,success:!0,syncedAt:now}}catch(err){performanceService.endMark("sp:syncToDataMart");const dsError=new DataServiceError("syncToDataMart","Sync failed",{entityType:"DataMart",entityId:projectCode,innerError:err});return this.logAudit({Action:enums.AuditAction.DataMartSyncFailed,EntityType:enums.EntityType.DataMart,EntityId:projectCode,User:(null===(_c=this._pageContextUser)||void 0===_c?void 0:_c.displayName)||"System",Details:dsError.message}).catch(()=>{}),{projectCode,success:!1,syncedAt:now,error:dsError.message}}}async getDataMartRecords(filters){const cacheKey=CACHE_KEYS_DATA_MART+buildCacheKeySuffix(filters),cached=cacheService.get(cacheKey);if(cached)return cached;performanceService.startMark("sp:getDataMartRecords");try{const filterParts=[];(null==filters?void 0:filters.status)&&filterParts.push(`Status eq '${filters.status}'`),(null==filters?void 0:filters.sector)&&filterParts.push(`Sector eq '${filters.sector}'`),(null==filters?void 0:filters.region)&&filterParts.push(`Region eq '${filters.region}'`),(null==filters?void 0:filters.projectExecutive)&&filterParts.push(`ProjectExecutive eq '${filters.projectExecutive}'`),(null==filters?void 0:filters.overallHealth)&&filterParts.push(`OverallHealth eq '${filters.overallHealth}'`),(null==filters?void 0:filters.hasAlerts)&&filterParts.push("(HasUnbilledAlert eq true or HasScheduleAlert eq true or HasFeeErosionAlert eq true)");let query=this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_DATA_MART).items.top(5e3);filterParts.length>0&&(query=query.filter(filterParts.join(" and ")));const result=(await query()).map(item=>this.mapToDataMartRecord(item));return cacheService.set(cacheKey,result,9e5),performanceService.endMark("sp:getDataMartRecords"),result}catch(err){throw performanceService.endMark("sp:getDataMartRecords"),this.handleError("getDataMartRecords",err,{entityType:"DataMart"})}}async getDataMartRecord(projectCode){const cacheKey=CACHE_KEYS_DATA_MART+"_"+projectCode,cached=cacheService.get(cacheKey);if(cached)return cached;performanceService.startMark("sp:getDataMartRecord");try{const items=await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_DATA_MART).items.filter(`ProjectCode eq '${projectCode}'`).top(1)();if(0===items.length)return performanceService.endMark("sp:getDataMartRecord"),null;const result=this.mapToDataMartRecord(items[0]);return cacheService.set(cacheKey,result,9e5),performanceService.endMark("sp:getDataMartRecord"),result}catch(err){return performanceService.endMark("sp:getDataMartRecord"),this.handleError("getDataMartRecord",err,{entityType:"DataMart",entityId:projectCode,rethrow:!1}),null}}async triggerDataMartSync(){performanceService.startMark("sp:triggerDataMartSync");try{const projectCodes=(await this.sp.web.lists.getByTitle(LIST_NAMES.ACTIVE_PROJECTS_PORTFOLIO).items.select("ProjectCode").top(5e3)()).map(item=>item.ProjectCode).filter(Boolean),results=[];for(let i=0;i<projectCodes.length;i+=5){const batch=projectCodes.slice(i,i+5),batchResults=await Promise.all(batch.map(code=>this.syncToDataMart(code)));results.push(...batchResults)}return cacheService.removeByPrefix(CACHE_KEYS_DATA_MART),performanceService.endMark("sp:triggerDataMartSync"),results}catch(err){throw performanceService.endMark("sp:triggerDataMartSync"),this.handleError("triggerDataMartSync",err,{entityType:"DataMart"})}}mapToDataMartRecord(item){const col=PROJECT_DATA_MART_COLUMNS;return{id:item.Id||item[col.id]||0,projectCode:item[col.projectCode]||"",jobNumber:item[col.jobNumber]||"",projectName:item[col.projectName]||"",status:item[col.status]||"Construction",sector:item[col.sector]||"Commercial",region:item[col.region]||"",projectExecutive:item[col.projectExecutive]||"",projectExecutiveEmail:item[col.projectExecutiveEmail]||"",leadPM:item[col.leadPM]||"",leadPMEmail:item[col.leadPMEmail]||"",leadSuperintendent:item[col.leadSuperintendent]||"",leadSuperintendentEmail:item[col.leadSuperintendentEmail]||"",originalContract:item[col.originalContract]||0,changeOrders:item[col.changeOrders]||0,currentContractValue:item[col.currentContractValue]||0,billingsToDate:item[col.billingsToDate]||0,unbilledAmount:item[col.unbilledAmount]||0,projectedFee:item[col.projectedFee]||0,projectedFeePct:item[col.projectedFeePct]||0,buyoutCommittedTotal:item[col.buyoutCommittedTotal]||0,buyoutExecutedCount:item[col.buyoutExecutedCount]||0,buyoutOpenCount:item[col.buyoutOpenCount]||0,startDate:item[col.startDate]||null,substantialCompletionDate:item[col.substantialCompletionDate]||null,percentComplete:item[col.percentComplete]||0,criticalPathItemCount:item[col.criticalPathItemCount]||0,scheduleDaysVariance:item[col.scheduleDaysVariance]||0,openQualityConcerns:item[col.openQualityConcerns]||0,openSafetyConcerns:item[col.openSafetyConcerns]||0,averageQScore:item[col.averageQScore]||0,openWaiverCount:item[col.openWaiverCount]||0,pendingCommitments:item[col.pendingCommitments]||0,complianceStatus:item[col.complianceStatus]||"Green",overallHealth:item[col.overallHealth]||"Green",hasUnbilledAlert:!!item[col.hasUnbilledAlert],hasScheduleAlert:!!item[col.hasScheduleAlert],hasFeeErosionAlert:!!item[col.hasFeeErosionAlert],monthlyReviewStatus:item[col.monthlyReviewStatus]||"",lastMonthlyReviewDate:item[col.lastMonthlyReviewDate]||null,turnoverStatus:item[col.turnoverStatus]||"",pmpStatus:item[col.pmpStatus]||"",lastSyncDate:item[col.lastSyncDate]||"",lastSyncBy:item[col.lastSyncBy]||""}}async sendSupportEmail(_to,_subject,_htmlBody,_fromUserEmail){performanceService.startMark("sp:sendSupportEmail"),console.warn("[SP] sendSupportEmail requires Microsoft Graph API â€” not available via SP REST. No-op."),performanceService.endMark("sp:sendSupportEmail")}async updateSupportConfig(config){performanceService.startMark("sp:updateSupportConfig");const existing=await this.getSupportConfig(),merged=Object.assign(Object.assign({},existing),config),jsonStr=JSON.stringify(merged),items=await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.filter("SiteURL eq 'SUPPORT_CONFIG'").top(1)();return items.length>0?await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.getById(items[0].Id).update({AppTitle:jsonStr}):await this.sp.web.lists.getByTitle(LIST_NAMES.APP_CONTEXT_CONFIG).items.add({SiteURL:"SUPPORT_CONFIG",AppTitle:jsonStr}),this.logAudit({Action:enums.AuditAction.SupportConfigUpdated,EntityType:enums.EntityType.SupportRequest,EntityId:"SUPPORT_CONFIG",User:"Admin",Details:"Support configuration updated"}).catch(()=>{}),performanceService.endMark("sp:updateSupportConfig"),merged}async getScheduleActivities(projectCode){performanceService.startMark("sp:getScheduleActivities");try{const web=this._getProjectWeb(),items=await web.lists.getByTitle(LIST_NAMES.SCHEDULE_ACTIVITIES).items.filter(`ProjectCode eq '${projectCode}'`).top(5e3)();return performanceService.endMark("sp:getScheduleActivities"),items.map(item=>this.mapToScheduleActivity(item))}catch(err){throw performanceService.endMark("sp:getScheduleActivities"),this.handleError("getScheduleActivities",err,{entityType:"ScheduleActivity"})}}async importScheduleActivities(projectCode,activities,importMeta){var _a;performanceService.startMark("sp:importScheduleActivities");try{const web=this._getProjectWeb(),now=(new Date).toISOString(),col=SCHEDULE_ACTIVITIES_COLUMNS,icol=SCHEDULE_IMPORTS_COLUMNS,importResult=await web.lists.getByTitle(LIST_NAMES.SCHEDULE_IMPORTS).items.add({[icol.projectCode]:projectCode,Title:importMeta.fileName||"import.csv",[icol.format]:importMeta.format||"P6-CSV",[icol.importDate]:now,[icol.importedBy]:importMeta.importedBy||"Unknown",[icol.activityCount]:activities.length,[icol.notes]:importMeta.notes||""}),importId=importResult.Id||importResult.id||(null===(_a=importResult.data)||void 0===_a?void 0:_a.Id)||0,batchSize=100;for(let i=0;i<activities.length;i+=batchSize){const batch=web.createBatch(),list=web.lists.getByTitle(LIST_NAMES.SCHEDULE_ACTIVITIES),chunk=activities.slice(i,i+batchSize);for(const a of chunk)list.items.inBatch(batch).add({Title:a.taskCode,[col.projectCode]:projectCode,[col.importId]:importId,[col.wbsCode]:a.wbsCode,[col.activityName]:a.activityName,[col.activityType]:a.activityType,[col.status]:a.status,[col.originalDuration]:a.originalDuration,[col.remainingDuration]:a.remainingDuration,[col.actualDuration]:a.actualDuration,[col.baselineStartDate]:a.baselineStartDate,[col.baselineFinishDate]:a.baselineFinishDate,[col.plannedStartDate]:a.plannedStartDate,[col.plannedFinishDate]:a.plannedFinishDate,[col.actualStartDate]:a.actualStartDate,[col.actualFinishDate]:a.actualFinishDate,[col.remainingFloat]:a.remainingFloat,[col.freeFloat]:a.freeFloat,[col.predecessors]:JSON.stringify(a.predecessors),[col.successors]:JSON.stringify(a.successors),[col.successorDetails]:JSON.stringify(a.successorDetails),[col.resources]:a.resources,[col.calendarName]:a.calendarName,[col.primaryConstraint]:a.primaryConstraint,[col.secondaryConstraint]:a.secondaryConstraint,[col.isCritical]:a.isCritical,[col.percentComplete]:a.percentComplete,[col.startVarianceDays]:a.startVarianceDays,[col.finishVarianceDays]:a.finishVarianceDays,[col.deleteFlag]:a.deleteFlag});await batch.execute()}return this.logAudit({Action:enums.AuditAction.ScheduleActivitiesImported,EntityType:enums.EntityType.ScheduleActivity,EntityId:String(importId),Details:`Imported ${activities.length} activities for ${projectCode}`}).catch(()=>{}),performanceService.endMark("sp:importScheduleActivities"),this.getScheduleActivities(projectCode)}catch(err){throw performanceService.endMark("sp:importScheduleActivities"),this.handleError("importScheduleActivities",err,{entityType:"ScheduleActivity"})}}async updateScheduleActivity(projectCode,activityId,data){performanceService.startMark("sp:updateScheduleActivity");try{const web=this._getProjectWeb(),col=SCHEDULE_ACTIVITIES_COLUMNS,updateData={};void 0!==data.activityName&&(updateData[col.activityName]=data.activityName),void 0!==data.status&&(updateData[col.status]=data.status),void 0!==data.remainingDuration&&(updateData[col.remainingDuration]=data.remainingDuration),void 0!==data.actualDuration&&(updateData[col.actualDuration]=data.actualDuration),void 0!==data.actualStartDate&&(updateData[col.actualStartDate]=data.actualStartDate),void 0!==data.actualFinishDate&&(updateData[col.actualFinishDate]=data.actualFinishDate),void 0!==data.remainingFloat&&(updateData[col.remainingFloat]=data.remainingFloat),void 0!==data.freeFloat&&(updateData[col.freeFloat]=data.freeFloat),void 0!==data.isCritical&&(updateData[col.isCritical]=data.isCritical),void 0!==data.percentComplete&&(updateData[col.percentComplete]=data.percentComplete),await web.lists.getByTitle(LIST_NAMES.SCHEDULE_ACTIVITIES).items.getById(activityId).update(updateData);const updated=await web.lists.getByTitle(LIST_NAMES.SCHEDULE_ACTIVITIES).items.getById(activityId)();return this.logAudit({Action:enums.AuditAction.ScheduleActivityUpdated,EntityType:enums.EntityType.ScheduleActivity,EntityId:String(activityId),Details:`Updated schedule activity ${data.activityName||activityId}`}).catch(()=>{}),performanceService.endMark("sp:updateScheduleActivity"),this.mapToScheduleActivity(updated)}catch(err){throw performanceService.endMark("sp:updateScheduleActivity"),this.handleError("updateScheduleActivity",err,{entityType:"ScheduleActivity"})}}async deleteScheduleActivity(_projectCode,activityId){performanceService.startMark("sp:deleteScheduleActivity");try{const web=this._getProjectWeb();await web.lists.getByTitle(LIST_NAMES.SCHEDULE_ACTIVITIES).items.getById(activityId).delete(),this.logAudit({Action:enums.AuditAction.ScheduleActivityDeleted,EntityType:enums.EntityType.ScheduleActivity,EntityId:String(activityId),Details:`Deleted schedule activity ${activityId}`}).catch(()=>{}),performanceService.endMark("sp:deleteScheduleActivity")}catch(err){throw performanceService.endMark("sp:deleteScheduleActivity"),this.handleError("deleteScheduleActivity",err,{entityType:"ScheduleActivity"})}}async getScheduleImports(projectCode){performanceService.startMark("sp:getScheduleImports");try{const web=this._getProjectWeb(),items=await web.lists.getByTitle(LIST_NAMES.SCHEDULE_IMPORTS).items.filter(`ProjectCode eq '${projectCode}'`).orderBy("ImportDate",!1)();return performanceService.endMark("sp:getScheduleImports"),items.map(item=>this.mapToScheduleImport(item))}catch(err){throw performanceService.endMark("sp:getScheduleImports"),this.handleError("getScheduleImports",err,{entityType:"ScheduleActivity"})}}async getScheduleMetrics(projectCode){performanceService.startMark("sp:getScheduleMetrics");try{const metrics=computeScheduleMetrics(await this.getScheduleActivities(projectCode));return performanceService.endMark("sp:getScheduleMetrics"),metrics}catch(err){throw performanceService.endMark("sp:getScheduleMetrics"),this.handleError("getScheduleMetrics",err,{entityType:"ScheduleActivity"})}}mapToScheduleActivity(item){const col=SCHEDULE_ACTIVITIES_COLUMNS;let predecessors=[],successors=[],successorDetails=[];try{const predRaw=item[col.predecessors];"string"==typeof predRaw&&predRaw&&(predecessors=JSON.parse(predRaw))}catch(_a){}try{const succRaw=item[col.successors];"string"==typeof succRaw&&succRaw&&(successors=JSON.parse(succRaw))}catch(_b){}try{const detailsRaw=item[col.successorDetails];"string"==typeof detailsRaw&&detailsRaw&&(successorDetails=JSON.parse(detailsRaw))}catch(_c){}return{id:item.Id,projectCode:item[col.projectCode]||"",importId:item[col.importId],taskCode:item[col.taskCode]||"",wbsCode:item[col.wbsCode]||"",activityName:item[col.activityName]||"",activityType:item[col.activityType]||"Task Dependent",status:item[col.status]||"Not Started",originalDuration:item[col.originalDuration]||0,remainingDuration:item[col.remainingDuration]||0,actualDuration:item[col.actualDuration]||0,baselineStartDate:item[col.baselineStartDate],baselineFinishDate:item[col.baselineFinishDate],plannedStartDate:item[col.plannedStartDate],plannedFinishDate:item[col.plannedFinishDate],actualStartDate:item[col.actualStartDate],actualFinishDate:item[col.actualFinishDate],remainingFloat:item[col.remainingFloat],freeFloat:item[col.freeFloat],predecessors,successors,successorDetails,resources:item[col.resources]||"",calendarName:item[col.calendarName]||"",primaryConstraint:item[col.primaryConstraint]||"",secondaryConstraint:item[col.secondaryConstraint]||"",isCritical:!!item[col.isCritical],percentComplete:item[col.percentComplete]||0,startVarianceDays:item[col.startVarianceDays],finishVarianceDays:item[col.finishVarianceDays],deleteFlag:!!item[col.deleteFlag],createdDate:item.Created||"",modifiedDate:item.Modified||""}}mapToScheduleImport(item){const col=SCHEDULE_IMPORTS_COLUMNS;return{id:item.Id,projectCode:item[col.projectCode]||"",fileName:item[col.fileName]||"",format:item[col.format]||"P6-CSV",importDate:item[col.importDate]||"",importedBy:item[col.importedBy]||"",activityCount:item[col.activityCount]||0,notes:item[col.notes]||""}}async getAllConstraints(){const cacheKey=CACHE_KEYS_CONSTRAINTS+"_all",cached=cacheService.get(cacheKey);if(cached)return cached;performanceService.startMark("sp:getAllConstraints");try{const projectCodes=(await this.sp.web.lists.getByTitle(LIST_NAMES.PROJECT_DATA_MART).items.select("ProjectCode").top(500)()).map(i=>i.ProjectCode).filter(Boolean),allConstraints=[];for(let i=0;i<projectCodes.length;i+=5){const batch=projectCodes.slice(i,i+5);(await Promise.all(batch.map(code=>this.getConstraints(code).catch(()=>[])))).forEach(r=>allConstraints.push(...r))}return cacheService.set(cacheKey,allConstraints,9e5),performanceService.endMark("sp:getAllConstraints"),allConstraints}catch(err){throw performanceService.endMark("sp:getAllConstraints"),this.handleError("getAllConstraints",err,{entityType:"Constraint"})}}async getConstraints(projectCode){performanceService.startMark("sp:getConstraints");try{const web=this._getProjectWeb(),items=await web.lists.getByTitle(LIST_NAMES.CONSTRAINTS_LOG).items.filter(`ProjectCode eq '${projectCode}'`).top(5e3)();return performanceService.endMark("sp:getConstraints"),items.map(item=>this.mapToConstraintLog(item))}catch(err){throw performanceService.endMark("sp:getConstraints"),this.handleError("getConstraints",err,{entityType:"Constraint"})}}async addConstraint(projectCode,constraint){performanceService.startMark("sp:addConstraint");try{const web=this._getProjectWeb(),col=CONSTRAINTS_LOG_COLUMNS,existing=await web.lists.getByTitle(LIST_NAMES.CONSTRAINTS_LOG).items.filter(`ProjectCode eq '${projectCode}'`).orderBy("ConstraintNumber",!1).top(1)(),nextNumber=existing.length>0?(existing[0].ConstraintNumber||0)+1:1,result=await web.lists.getByTitle(LIST_NAMES.CONSTRAINTS_LOG).items.add({[col.projectCode]:projectCode,[col.constraintNumber]:nextNumber,[col.category]:constraint.category||"Other",[col.description]:constraint.description||"",[col.status]:constraint.status||"Open",[col.assignedTo]:constraint.assignedTo||"",[col.dateIdentified]:constraint.dateIdentified||(new Date).toISOString(),[col.dueDate]:constraint.dueDate||null,[col.dateClosed]:constraint.dateClosed||null,[col.reference]:constraint.reference||"",[col.closureDocument]:constraint.closureDocument||"",[col.budgetImpactCost]:constraint.budgetImpactCost||0,[col.comments]:constraint.comments||""});return this.logAudit({Action:enums.AuditAction.ConstraintUpdated,EntityType:enums.EntityType.Constraint,EntityId:String(result.Id||result.id||0),Details:`Added constraint #${nextNumber} for ${projectCode}`}),performanceService.endMark("sp:addConstraint"),this.mapToConstraintLog(result)}catch(err){throw performanceService.endMark("sp:addConstraint"),this.handleError("addConstraint",err,{entityType:"Constraint"})}}async updateConstraint(projectCode,constraintId,data){performanceService.startMark("sp:updateConstraint");try{const web=this._getProjectWeb(),col=CONSTRAINTS_LOG_COLUMNS,updates={};void 0!==data.category&&(updates[col.category]=data.category),void 0!==data.description&&(updates[col.description]=data.description),void 0!==data.status&&(updates[col.status]=data.status),void 0!==data.assignedTo&&(updates[col.assignedTo]=data.assignedTo),void 0!==data.dateIdentified&&(updates[col.dateIdentified]=data.dateIdentified),void 0!==data.dueDate&&(updates[col.dueDate]=data.dueDate),void 0!==data.dateClosed&&(updates[col.dateClosed]=data.dateClosed),void 0!==data.reference&&(updates[col.reference]=data.reference),void 0!==data.closureDocument&&(updates[col.closureDocument]=data.closureDocument),void 0!==data.budgetImpactCost&&(updates[col.budgetImpactCost]=data.budgetImpactCost),void 0!==data.comments&&(updates[col.comments]=data.comments),await web.lists.getByTitle(LIST_NAMES.CONSTRAINTS_LOG).items.getById(constraintId).update(updates),this.logAudit({Action:enums.AuditAction.ConstraintUpdated,EntityType:enums.EntityType.Constraint,EntityId:String(constraintId),Details:`Updated constraint ${constraintId} for ${projectCode}`});const item=await web.lists.getByTitle(LIST_NAMES.CONSTRAINTS_LOG).items.getById(constraintId)();return performanceService.endMark("sp:updateConstraint"),this.mapToConstraintLog(item)}catch(err){throw performanceService.endMark("sp:updateConstraint"),this.handleError("updateConstraint",err,{entityType:"Constraint"})}}async removeConstraint(projectCode,constraintId){performanceService.startMark("sp:removeConstraint");try{const web=this._getProjectWeb();await web.lists.getByTitle(LIST_NAMES.CONSTRAINTS_LOG).items.getById(constraintId).delete(),this.logAudit({Action:enums.AuditAction.ConstraintUpdated,EntityType:enums.EntityType.Constraint,EntityId:String(constraintId),Details:`Removed constraint ${constraintId} from ${projectCode}`}),performanceService.endMark("sp:removeConstraint")}catch(err){throw performanceService.endMark("sp:removeConstraint"),this.handleError("removeConstraint",err,{entityType:"Constraint"})}}mapToConstraintLog(item){const col=CONSTRAINTS_LOG_COLUMNS;return{id:item.Id||item.id||0,projectCode:item[col.projectCode]||"",constraintNumber:item[col.constraintNumber]||0,category:item[col.category]||"Other",description:item[col.description]||"",status:item[col.status]||"Open",assignedTo:item[col.assignedTo]||"",dateIdentified:item[col.dateIdentified]||"",dueDate:item[col.dueDate]||"",dateClosed:item[col.dateClosed]||void 0,reference:item[col.reference]||void 0,closureDocument:item[col.closureDocument]||void 0,budgetImpactCost:item[col.budgetImpactCost]||void 0,comments:item[col.comments]||void 0}}async getPermits(projectCode){performanceService.startMark("sp:getPermits");try{const web=this._getProjectWeb(),items=await web.lists.getByTitle(LIST_NAMES.PERMITS_LOG).items.filter(`ProjectCode eq '${projectCode}'`).top(5e3)();return performanceService.endMark("sp:getPermits"),items.map(item=>this.mapToPermit(item))}catch(err){throw performanceService.endMark("sp:getPermits"),this.handleError("getPermits",err,{entityType:"Permit"})}}async addPermit(projectCode,permit){performanceService.startMark("sp:addPermit");try{const web=this._getProjectWeb(),col=PERMITS_LOG_COLUMNS,result=await web.lists.getByTitle(LIST_NAMES.PERMITS_LOG).items.add({[col.projectCode]:projectCode,[col.refNumber]:permit.refNumber||"",[col.parentRefNumber]:permit.parentRefNumber||"",[col.location]:permit.location||"",[col.type]:permit.type||"PRIMARY",[col.permitNumber]:permit.permitNumber||"Not Issued",[col.description]:permit.description||"",[col.responsibleContractor]:permit.responsibleContractor||"",[col.address]:permit.address||"",[col.dateRequired]:permit.dateRequired||null,[col.dateSubmitted]:permit.dateSubmitted||null,[col.dateReceived]:permit.dateReceived||null,[col.dateExpires]:permit.dateExpires||null,[col.status]:permit.status||"Pending Application",[col.ahj]:permit.ahj||"",[col.comments]:permit.comments||""});return this.logAudit({Action:enums.AuditAction.PermitUpdated,EntityType:enums.EntityType.Permit,EntityId:String(result.Id||result.id||0),Details:`Added permit ${permit.refNumber||"new"} for ${projectCode}`}),performanceService.endMark("sp:addPermit"),this.mapToPermit(result)}catch(err){throw performanceService.endMark("sp:addPermit"),this.handleError("addPermit",err,{entityType:"Permit"})}}async updatePermit(projectCode,permitId,data){performanceService.startMark("sp:updatePermit");try{const web=this._getProjectWeb(),col=PERMITS_LOG_COLUMNS,updates={};void 0!==data.refNumber&&(updates[col.refNumber]=data.refNumber),void 0!==data.parentRefNumber&&(updates[col.parentRefNumber]=data.parentRefNumber),void 0!==data.location&&(updates[col.location]=data.location),void 0!==data.type&&(updates[col.type]=data.type),void 0!==data.permitNumber&&(updates[col.permitNumber]=data.permitNumber),void 0!==data.description&&(updates[col.description]=data.description),void 0!==data.responsibleContractor&&(updates[col.responsibleContractor]=data.responsibleContractor),void 0!==data.address&&(updates[col.address]=data.address),void 0!==data.dateRequired&&(updates[col.dateRequired]=data.dateRequired),void 0!==data.dateSubmitted&&(updates[col.dateSubmitted]=data.dateSubmitted),void 0!==data.dateReceived&&(updates[col.dateReceived]=data.dateReceived),void 0!==data.dateExpires&&(updates[col.dateExpires]=data.dateExpires),void 0!==data.status&&(updates[col.status]=data.status),void 0!==data.ahj&&(updates[col.ahj]=data.ahj),void 0!==data.comments&&(updates[col.comments]=data.comments),await web.lists.getByTitle(LIST_NAMES.PERMITS_LOG).items.getById(permitId).update(updates),this.logAudit({Action:enums.AuditAction.PermitUpdated,EntityType:enums.EntityType.Permit,EntityId:String(permitId),Details:`Updated permit ${permitId} for ${projectCode}`});const item=await web.lists.getByTitle(LIST_NAMES.PERMITS_LOG).items.getById(permitId)();return performanceService.endMark("sp:updatePermit"),this.mapToPermit(item)}catch(err){throw performanceService.endMark("sp:updatePermit"),this.handleError("updatePermit",err,{entityType:"Permit"})}}async removePermit(projectCode,permitId){performanceService.startMark("sp:removePermit");try{const web=this._getProjectWeb();await web.lists.getByTitle(LIST_NAMES.PERMITS_LOG).items.getById(permitId).delete(),this.logAudit({Action:enums.AuditAction.PermitUpdated,EntityType:enums.EntityType.Permit,EntityId:String(permitId),Details:`Removed permit ${permitId} from ${projectCode}`}),performanceService.endMark("sp:removePermit")}catch(err){throw performanceService.endMark("sp:removePermit"),this.handleError("removePermit",err,{entityType:"Permit"})}}mapToPermit(item){const col=PERMITS_LOG_COLUMNS;return{id:item.Id||item.id||0,projectCode:item[col.projectCode]||"",refNumber:item[col.refNumber]||"",parentRefNumber:item[col.parentRefNumber]||void 0,location:item[col.location]||"",type:item[col.type]||"PRIMARY",permitNumber:item[col.permitNumber]||"",description:item[col.description]||"",responsibleContractor:item[col.responsibleContractor]||"",address:item[col.address]||"",dateRequired:item[col.dateRequired]||void 0,dateSubmitted:item[col.dateSubmitted]||void 0,dateReceived:item[col.dateReceived]||void 0,dateExpires:item[col.dateExpires]||void 0,status:item[col.status]||"Pending Application",ahj:item[col.ahj]||"",comments:item[col.comments]||void 0}}}SharePointDataService.TRACKING_STEP_ORDER=["APM_PA","ProjectManager","RiskManager","ProjectExecutive"],SharePointDataService.TRACKING_STEP_STATUS={APM_PA:"PendingAPM",ProjectManager:"PendingPM",RiskManager:"PendingRiskMgr",ProjectExecutive:"PendingPX"},SharePointDataService.TRACKING_STEP_TO_ORDER={APM_PA:1,ProjectManager:2,RiskManager:3,ProjectExecutive:4};new class AuditService{constructor(){this.queue=[],this.flushTimer=null,this.logFn=null}initialize(logFunction){this.logFn=logFunction}log(action,entityType,entityId,details,options){const entry={Timestamp:(new Date).toISOString(),Action:action,EntityType:entityType,EntityId:entityId,Details:details,ProjectCode:null==options?void 0:options.projectCode,FieldChanged:null==options?void 0:options.fieldChanged,PreviousValue:null==options?void 0:options.previousValue,NewValue:null==options?void 0:options.newValue};this.queue.push(entry),this.flushTimer&&clearTimeout(this.flushTimer),this.flushTimer=setTimeout(()=>this.flush(),2e3)}async flush(){if(!this.logFn||0===this.queue.length)return;const entries=[...this.queue];this.queue=[];for(const entry of entries)try{await this.logFn(entry)}catch(error){console.warn("[AuditService] Failed to log audit entry:",error)}}async flushNow(){this.flushTimer&&(clearTimeout(this.flushTimer),this.flushTimer=null),await this.flush()}};let html2CanvasPromise=null,jsPdfPromise=null,xlsxPromise=null;let pdfDepsPromise=null;function loadXlsx(){return function loadXlsxModule(){return xlsxPromise||(xlsxPromise=__webpack_require__.e(405).then(__webpack_require__.bind(__webpack_require__,"./node_modules/xlsx/xlsx.mjs"))),xlsxPromise}()}class ExportService{async exportToPDF(elementId,options){try{const{html2canvas,jsPDF}=await function loadPdfDeps(){return pdfDepsPromise||(pdfDepsPromise=Promise.all([(html2CanvasPromise||(html2CanvasPromise=__webpack_require__.e(72).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/html2canvas/dist/html2canvas.js",23)).then(mod=>mod.default)),html2CanvasPromise),(jsPdfPromise||(jsPdfPromise=__webpack_require__.e(910).then(__webpack_require__.bind(__webpack_require__,"./node_modules/jspdf/dist/jspdf.es.min.js")).then(mod=>mod.jsPDF)),jsPdfPromise)]).then(([html2canvas,jsPDF])=>({html2canvas,jsPDF}))),pdfDepsPromise}(),element=document.getElementById(elementId);if(!element)throw new Error(`Element with id "${elementId}" not found`);const canvas=await html2canvas(element,{scale:2,useCORS:!0,logging:!1}),imgData=canvas.toDataURL("image/png"),headerHeight=(new jsPDF({orientation:canvas.width>canvas.height?"landscape":"portrait",unit:"px",format:[canvas.width,canvas.height]}),40),footerHeight=30,totalHeight=canvas.height+headerHeight+footerHeight,pdfDoc=new jsPDF({orientation:canvas.width>canvas.height?"landscape":"portrait",unit:"px",format:[canvas.width,totalHeight]});pdfDoc.setFillColor(27,42,74),pdfDoc.rect(0,0,canvas.width,headerHeight,"F"),pdfDoc.setTextColor(232,119,34),pdfDoc.setFontSize(14),pdfDoc.text("HBC Project Controls",16,26),options.title&&(pdfDoc.setTextColor(255,255,255),pdfDoc.setFontSize(10),pdfDoc.text(options.title,canvas.width-16,26,{align:"right"})),pdfDoc.addImage(imgData,"PNG",0,headerHeight,canvas.width,canvas.height),pdfDoc.setFillColor(249,250,251),pdfDoc.rect(0,headerHeight+canvas.height,canvas.width,footerHeight,"F"),pdfDoc.setTextColor(107,114,128),pdfDoc.setFontSize(8),pdfDoc.text(`Generated ${(new Date).toLocaleString("en-US")}`,16,headerHeight+canvas.height+18),pdfDoc.save(`${options.filename}.pdf`)}catch(error){throw console.error("[ExportService] PDF export failed:",error),error}}async exportToExcel(data,options){try{const XLSX=await loadXlsx(),worksheet=XLSX.utils.json_to_sheet(data),workbook=XLSX.utils.book_new();XLSX.utils.book_append_sheet(workbook,worksheet,options.sheetName||"Sheet1"),XLSX.writeFile(workbook,`${options.filename}.xlsx`)}catch(error){throw console.error("[ExportService] Excel export failed:",error),error}}async exportToExcelMultiSheet(sheets,options){try{const XLSX=await loadXlsx(),workbook=XLSX.utils.book_new();for(const sheet of sheets){const worksheet=XLSX.utils.json_to_sheet(sheet.data);XLSX.utils.book_append_sheet(workbook,worksheet,sheet.name)}XLSX.writeFile(workbook,`${options.filename}.xlsx`)}catch(error){throw console.error("[ExportService] Multi-sheet Excel export failed:",error),error}}exportToCSV(data,options){if(0===data.length)return;const headers=Object.keys(data[0]),csvRows=[headers.join(","),...data.map(row=>headers.map(h=>{const val=row[h],str=null==val?"":String(val);return str.includes(",")||str.includes('"')||str.includes("\n")?`"${str.replace(/"/g,'""')}"`:str}).join(","))],blob=new Blob([csvRows.join("\n")],{type:"text/csv;charset=utf-8;"}),link=document.createElement("a");link.href=URL.createObjectURL(blob),link.download=`${options.filename}.csv`,link.click(),URL.revokeObjectURL(link.href)}}new ExportService;new class GraphService{constructor(){this.auditLogger=null}initialize(graphClient){this.graphClient=graphClient}setAuditLogger(logger){this.auditLogger=logger}logGraphCall(action,endpoint,details,user){this.auditLogger&&this.auditLogger({Action:action,EntityType:enums.EntityType.GraphApi,EntityId:endpoint,User:user||"system",Details:details}).catch(()=>{})}async getCurrentUserProfile(){if(!this.graphClient)throw new Error("Graph client not initialized");try{const me=await this.graphClient.api("/me").select("displayName,mail,id").get();return{displayName:me.displayName,email:me.mail,id:me.id}}catch(err){throw this.logGraphCall(enums.AuditAction.GraphApiCallFailed,"GET /me",`getCurrentUserProfile failed: ${err instanceof Error?err.message:String(err)}`),err}}async getUserPhoto(email){try{if(!this.graphClient)return null;const photo=await this.graphClient.api(`/users/${email}/photo/$value`).get();return URL.createObjectURL(photo)}catch(_a){return null}}async getGroupMembers(groupId){if(!this.graphClient)throw new Error("Graph client not initialized");try{return(await this.graphClient.api(`/groups/${groupId}/members`).select("displayName,mail").get()).value.map(m=>({displayName:m.displayName,email:m.mail}))}catch(err){throw this.logGraphCall(enums.AuditAction.GraphApiCallFailed,`GET /groups/${groupId}/members`,`getGroupMembers failed for group ${groupId}: ${err instanceof Error?err.message:String(err)}`),err}}async addGroupMember(groupId,userId){if(this.graphClient)try{await this.graphClient.api(`/groups/${groupId}/members/$ref`).post({"@odata.id":`https://graph.microsoft.com/v1.0/directoryObjects/${userId}`}),this.logGraphCall(enums.AuditAction.GraphGroupMemberAdded,`POST /groups/${groupId}/members/$ref`,`Added user ${userId} to group ${groupId}`)}catch(err){throw this.logGraphCall(enums.AuditAction.GraphGroupMemberAddFailed,`POST /groups/${groupId}/members/$ref`,`Failed to add user ${userId} to group ${groupId}: ${err instanceof Error?err.message:String(err)}`),err}else console.warn("Graph client not initialized")}async getCalendarAvailability(emails,start,end){if(!this.graphClient)throw new Error("Graph client not initialized");try{return(await this.graphClient.api("/me/calendar/getSchedule").post({schedules:emails,startTime:{dateTime:start,timeZone:"Eastern Standard Time"},endTime:{dateTime:end,timeZone:"Eastern Standard Time"},availabilityViewInterval:60})).value.map(schedule=>({email:schedule.scheduleId,displayName:schedule.scheduleId,slots:this.parseAvailabilityView(schedule.availabilityView,start)}))}catch(err){throw this.logGraphCall(enums.AuditAction.GraphApiCallFailed,"POST /me/calendar/getSchedule",`getCalendarAvailability failed for ${emails.length} emails: ${err instanceof Error?err.message:String(err)}`),err}}parseAvailabilityView(view,startDate){const slots=[],start=new Date(startDate);for(let i=0;i<view.length;i++){const slotStart=new Date(start.getTime()+60*i*60*1e3),slotEnd=new Date(slotStart.getTime()+36e5);slots.push({start:slotStart.toISOString(),end:slotEnd.toISOString(),available:"0"===view[i]})}return slots}async createCalendarEvent(meeting){var _a,_b,_c;if(!this.graphClient)throw new Error("Graph client not initialized");try{const event=await this.graphClient.api("/me/events").post({subject:meeting.subject,start:{dateTime:meeting.startTime,timeZone:"Eastern Standard Time"},end:{dateTime:meeting.endTime,timeZone:"Eastern Standard Time"},attendees:null===(_a=meeting.attendees)||void 0===_a?void 0:_a.map(email=>({emailAddress:{address:email},type:"required"})),isOnlineMeeting:!0,onlineMeetingProvider:"teamsForBusiness"});return this.logGraphCall(enums.AuditAction.GraphApiCallSucceeded,"POST /me/events",`Calendar event created: "${meeting.subject}" with ${(null===(_b=meeting.attendees)||void 0===_b?void 0:_b.length)||0} attendees`),{id:event.id,subject:event.subject,type:meeting.type,startTime:event.start.dateTime,endTime:event.end.dateTime,attendees:meeting.attendees||[],teamsLink:null===(_c=event.onlineMeeting)||void 0===_c?void 0:_c.joinUrl,projectCode:meeting.projectCode,leadId:meeting.leadId,createdBy:"",createdAt:(new Date).toISOString()}}catch(err){throw this.logGraphCall(enums.AuditAction.GraphApiCallFailed,"POST /me/events",`createCalendarEvent failed for "${meeting.subject}": ${err instanceof Error?err.message:String(err)}`),err}}async sendEmail(to,subject,body){if(!this.graphClient)throw new Error("Graph client not initialized");try{await this.graphClient.api("/me/sendMail").post({message:{subject,body:{contentType:"HTML",content:body},toRecipients:to.map(email=>({emailAddress:{address:email}}))}}),this.logGraphCall(enums.AuditAction.GraphApiCallSucceeded,"POST /me/sendMail",`Email sent: "${subject}" to ${to.length} recipients`)}catch(err){throw this.logGraphCall(enums.AuditAction.GraphApiCallFailed,"POST /me/sendMail",`sendEmail failed for "${subject}" to ${to.join(", ")}: ${err instanceof Error?err.message:String(err)}`),err}}async createTeamsChat(members,message){if(!this.graphClient)throw new Error("Graph client not initialized");try{const chat=await this.graphClient.api("/chats").post({chatType:"group",members:members.map(email=>({"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users/${email}`}))});return await this.graphClient.api(`/chats/${chat.id}/messages`).post({body:{content:message}}),this.logGraphCall(enums.AuditAction.GraphApiCallSucceeded,"POST /chats",`Teams chat created with ${members.length} members`),chat.id}catch(err){throw this.logGraphCall(enums.AuditAction.GraphApiCallFailed,"POST /chats",`createTeamsChat failed with ${members.length} members: ${err instanceof Error?err.message:String(err)}`),err}}};new class OfflineQueueService{constructor(){this.queue=[],this.STORAGE_KEY="hbc_offline_queue",this.MAX_QUEUE_SIZE=100,this.RETRY_INTERVAL=3e4,this.retryTimer=null,this._status="online",this.statusListeners=[],this.syncFn=null,this.loadQueue(),this.startMonitoring()}get status(){return this._status}setStatus(status){this._status!==status&&(this._status=status,this.statusListeners.forEach(fn=>fn(status)))}onStatusChange(callback){return this.statusListeners.push(callback),()=>{this.statusListeners=this.statusListeners.filter(fn=>fn!==callback)}}initialize(syncFunction){this.syncFn=syncFunction}enqueue(operation,entityType,data,entityId){this.queue.length>=this.MAX_QUEUE_SIZE&&(console.warn("[OfflineQueue] Queue full, dropping oldest entry"),this.queue.shift());const item={id:`${Date.now()}_${Math.random().toString(36).slice(2,9)}`,timestamp:Date.now(),operation,entityType,entityId,data,retryCount:0};this.queue.push(item),this.saveQueue(),this.setStatus("offline")}getQueueLength(){return this.queue.length}async processQueue(){if(!this.syncFn||0===this.queue.length)return;this.setStatus("syncing");const processed=[];for(const item of this.queue)try{await this.syncFn(item),processed.push(item.id)}catch(_a){item.retryCount++,item.retryCount>=5&&(console.error("[OfflineQueue] Max retries reached, dropping:",item),processed.push(item.id))}this.queue=this.queue.filter(item=>!processed.includes(item.id)),this.saveQueue(),this.setStatus(this.queue.length>0?"offline":"online")}loadQueue(){try{const stored=sessionStorage.getItem(this.STORAGE_KEY);stored&&(this.queue=JSON.parse(stored))}catch(_a){this.queue=[]}}saveQueue(){try{sessionStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.queue))}catch(_a){}}startMonitoring(){this.retryTimer=setInterval(()=>{navigator.onLine&&this.queue.length>0&&this.processQueue()},this.RETRY_INTERVAL),"undefined"!=typeof window&&(window.addEventListener("online",()=>{this.queue.length>0?this.processQueue():this.setStatus("online")}),window.addEventListener("offline",()=>this.setStatus("offline")))}dispose(){this.retryTimer&&clearInterval(this.retryTimer)}};new class PowerAutomateService{constructor(){this.flowEndpoints={}}configure(endpoints){this.flowEndpoints=endpoints}async triggerProvisioning(payload){const endpoint=this.flowEndpoints.provisioning;if(!endpoint)throw new Error("Provisioning flow endpoint not configured");const response=await fetch(endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(payload)});if(!response.ok)throw new Error(`Provisioning trigger failed: ${response.statusText}`);return response.json()}async triggerNotification(payload){const endpoint=this.flowEndpoints.notification;if(!endpoint)return void console.warn("[PowerAutomate] Notification endpoint not configured");const response=await fetch(endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(payload)});response.ok||console.error("[PowerAutomate] Notification trigger failed:",response.statusText)}async triggerArchive(payload){const endpoint=this.flowEndpoints.archive;if(!endpoint)throw new Error("Archive flow endpoint not configured");const response=await fetch(endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(payload)});if(!response.ok)throw new Error(`Archive trigger failed: ${response.statusText}`)}};class SignalRService{constructor(){this.connection=null,this._status="disconnected",this.statusListeners=[],this.subscriptions=[],this.baseUrl="",this.getAccessToken=null,this.reconnectAttempt=0,this.reconnectTimer=null,this.disposed=!1,this.joinedGroups=new Set}get status(){return this._status}initialize(baseUrl,getAccessToken){this.baseUrl=baseUrl,this.getAccessToken=getAccessToken}onStatusChange(callback){return this.statusListeners.push(callback),()=>{this.statusListeners=this.statusListeners.filter(fn=>fn!==callback)}}subscribe(channelKey,callback){const sub={channelKey,callback};return this.subscriptions.push(sub),()=>{this.subscriptions=this.subscriptions.filter(s=>s!==sub)}}async connect(){if(!this.disposed)if(this.baseUrl&&this.getAccessToken){if("connected"!==this._status&&"connecting"!==this._status){this.setStatus("connecting");try{const signalRModule=await __webpack_require__.e(11).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@microsoft/signalr/dist/esm/index.js")),tokenProvider=this.getAccessToken;this.connection=(new signalRModule.HubConnectionBuilder).withUrl(`${this.baseUrl}/negotiate`,{accessTokenFactory:()=>tokenProvider()}).withAutomaticReconnect({nextRetryDelayInMilliseconds:retryContext=>Math.min(SignalRService.BASE_RECONNECT_DELAY*Math.pow(2,retryContext.previousRetryCount),SignalRService.MAX_RECONNECT_DELAY)}).configureLogging(signalRModule.LogLevel.Warning).build(),this.connection.onreconnecting(()=>{this.setStatus("reconnecting")}),this.connection.onreconnected(()=>{this.reconnectAttempt=0,this.setStatus("connected"),this.rejoinGroups()}),this.connection.onclose(()=>{this.disposed||(this.setStatus("disconnected"),this.scheduleReconnect())});const messageTypes=["EntityChanged","UserPresence","WorkflowAdvanced"];for(const msgType of messageTypes)this.connection.on(msgType,message=>{this.dispatchMessage(message)});await this.connection.start(),this.reconnectAttempt=0,this.setStatus("connected")}catch(error){console.warn("[SignalR] Connection failed:",error),this.setStatus("disconnected"),this.scheduleReconnect()}}}else console.warn("[SignalR] Not initialized â€” call initialize() first")}async disconnect(){if(this.clearReconnectTimer(),this.joinedGroups.clear(),this.connection){try{await this.connection.stop()}catch(_a){}this.connection=null}this.setStatus("disconnected")}dispose(){this.disposed=!0,this.disconnect(),this.statusListeners=[],this.subscriptions=[]}async joinGroup(groupName){if(this.joinedGroups.add(groupName),"connected"===this._status&&this.getAccessToken)try{const token=await this.getAccessToken();await fetch(`${this.baseUrl}/groups`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${token}`},body:JSON.stringify({groupName,action:"join"})})}catch(error){console.warn("[SignalR] Failed to join group:",groupName,error)}}async leaveGroup(groupName){if(this.joinedGroups.delete(groupName),"connected"===this._status&&this.getAccessToken)try{const token=await this.getAccessToken();await fetch(`${this.baseUrl}/groups`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${token}`},body:JSON.stringify({groupName,action:"leave"})})}catch(error){console.warn("[SignalR] Failed to leave group:",groupName,error)}}async broadcastChange(message){if("connected"===this._status&&this.getAccessToken)try{const token=await this.getAccessToken();await fetch(`${this.baseUrl}/broadcast`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${token}`},body:JSON.stringify({message})})}catch(error){console.warn("[SignalR] Broadcast failed:",error)}}setStatus(status){this._status!==status&&(this._status=status,this.statusListeners.forEach(fn=>fn(status)))}dispatchMessage(message){for(const sub of this.subscriptions)if("*"===sub.channelKey||sub.channelKey===message.type)try{sub.callback(message)}catch(error){console.warn("[SignalR] Subscriber error:",error)}}scheduleReconnect(){if(this.disposed)return;this.clearReconnectTimer();const delay=Math.min(SignalRService.BASE_RECONNECT_DELAY*Math.pow(2,this.reconnectAttempt),SignalRService.MAX_RECONNECT_DELAY);this.reconnectAttempt++,this.reconnectTimer=setTimeout(()=>{this.connect()},delay)}clearReconnectTimer(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)}async rejoinGroups(){for(const group of this.joinedGroups)await this.joinGroup(group)}}SignalRService.MAX_RECONNECT_DELAY=3e4,SignalRService.BASE_RECONNECT_DELAY=1e3;new SignalRService;const PII_FIELDS=["email","loginname","displayname","userid"];function scrubPii(props={}){const clean={};for(const[k,v]of Object.entries(props))PII_FIELDS.includes(k.toLowerCase())?clean[k]=btoa(v).slice(-6):clean[k]=v;return clean}new class TelemetryService{constructor(){this._appInsights=null,this._initialized=!1}initialize(connectionString,userHash,roleName){this._initialized||(__webpack_require__.e(539).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@microsoft/applicationinsights-web/dist-es5/applicationinsights-web.js")).then(({ApplicationInsights})=>{this._appInsights=new ApplicationInsights({config:{connectionString,enableAutoRouteTracking:!1,disableAjaxTracking:!0,samplingPercentage:100,maxBatchSizeInBytes:65536,maxBatchInterval:5e3}}),this._appInsights.addTelemetryInitializer(item=>{var _a;return item.tags=null!==(_a=item.tags)&&void 0!==_a?_a:[],item.tags["ai.user.id"]=userHash,item.tags["ai.user.authUserId"]=userHash,item.baseData&&(item.baseData.properties=Object.assign(Object.assign({},item.baseData.properties),{hbc_role:roleName,hbc_spfxVersion:"1.22.2"})),!0}),this._appInsights.loadAppInsights()}).catch(()=>{}),this._initialized=!0)}trackEvent(event){this._initialized&&this._appInsights&&this._appInsights.trackEvent({name:event.name,properties:scrubPii(event.properties),measurements:event.measurements})}trackMetric(name,value,properties){this._initialized&&this._appInsights&&this._appInsights.trackMetric({name,average:value},scrubPii(properties))}trackException(error,properties){this._initialized&&this._appInsights&&this._appInsights.trackException({exception:error,properties:scrubPii(properties)})}trackPageView(pageName,url){this._initialized&&this._appInsights&&this._appInsights.trackPageView({name:pageName,uri:url})}flush(){var _a;null===(_a=this._appInsights)||void 0===_a||_a.flush()}isInitialized(){return this._initialized}};class MockTelemetryService{constructor(){this._events=[],this._initialized=!1}initialize(_cs,_user,_role){this._initialized=!0}trackEvent(event){this._events.push(event)}trackMetric(name,value){0}trackException(error){console.error("[MockTelemetry] exception:",error.message)}trackPageView(pageName){0}flush(){}isInitialized(){return this._initialized}getEvents(){return[...this._events]}clearEvents(){this._events=[]}}new MockTelemetryService;enums.RoleName.ExecutiveLeadership,enums.RoleName.DepartmentDirector,enums.RoleName.OperationsTeam,enums.RoleName.PreconstructionTeam,enums.RoleName.BDRepresentative,enums.RoleName.EstimatingCoordinator,enums.RoleName.AccountingManager,enums.RoleName.Legal,enums.RoleName.RiskManagement,enums.RoleName.Marketing,enums.RoleName.QualityControl,enums.RoleName.Safety,enums.RoleName.IDS,enums.RoleName.SharePointAdmin;enums.Stage.LeadDiscovery,enums.Stage.GoNoGoPending,enums.Stage.ArchivedHistorical,enums.Stage.GoNoGoPending,enums.Stage.GoNoGoWait,enums.Stage.Opportunity,enums.Stage.ArchivedNoGo,enums.Stage.GoNoGoWait,enums.Stage.GoNoGoPending,enums.Stage.ArchivedNoGo,enums.Stage.Opportunity,enums.Stage.Pursuit,enums.Stage.ArchivedLoss,enums.Stage.Pursuit,enums.Stage.WonContractPending,enums.Stage.ArchivedLoss,enums.Stage.WonContractPending,enums.Stage.ActiveConstruction,enums.Stage.ActiveConstruction,enums.Stage.Closeout,enums.Stage.Closeout,enums.Stage.ArchivedHistorical;function getStageLabel(stage){return{[enums.Stage.LeadDiscovery]:"Lead / Discovery",[enums.Stage.GoNoGoPending]:"Go/No-Go Pending",[enums.Stage.GoNoGoWait]:"Go/No-Go Wait",[enums.Stage.Opportunity]:"Opportunity",[enums.Stage.Pursuit]:"Pursuit",[enums.Stage.WonContractPending]:"Won - Contract Pending",[enums.Stage.ActiveConstruction]:"Active Construction",[enums.Stage.Closeout]:"Closeout",[enums.Stage.ArchivedNoGo]:"Archived (No-Go)",[enums.Stage.ArchivedLoss]:"Archived (Loss)",[enums.Stage.ArchivedHistorical]:"Archived (Historical)"}[stage]||stage}function isActiveStage(stage){return![enums.Stage.ArchivedNoGo,enums.Stage.ArchivedLoss,enums.Stage.ArchivedHistorical].includes(stage)}var riskEngine=__webpack_require__("./packages/hbc-sp-services/src/utils/riskEngine.ts");const ROUTE_LABELS={"":"Dashboard",marketing:"Marketing Dashboard",preconstruction:"Estimating Dashboard",gonogo:"Go/No-Go Tracker",pipeline:"Pipeline","precon-tracker":"Precon Tracker","estimate-log":"Estimate Log","kickoff-list":"Kick-Off Checklists","autopsy-list":"Post-Bid Autopsies",pursuit:"Pursuit",kickoff:"Kick-Off",interview:"Interview Prep",winloss:"Win/Loss",turnover:"Turnover",autopsy:"Loss Autopsy","autopsy-form":"Autopsy Form",deliverables:"Deliverables",lead:"Lead",new:"New Lead","schedule-gonogo":"Schedule Go/No-Go",detail:"Scorecard Detail",operations:"Active Projects",project:"Project Dashboard","project-settings":"Project Settings","startup-checklist":"Startup Checklist","management-plan":"Management Plan","superintendent-plan":"Super's Plan",responsibility:"Responsibility Matrices","owner-contract":"Owner Contract","sub-contract":"Sub-Contract","closeout-checklist":"Closeout Checklist","buyout-log":"Buyout Log","contract-tracking":"Contract Tracking","compliance-log":"Compliance Log","risk-cost":"Risk & Cost",schedule:"Schedule","quality-concerns":"Quality Concerns","safety-concerns":"Safety Concerns","monthly-review":"Monthly Review","project-record":"Project Record","lessons-learned":"Lessons Learned","job-request":"Job Number Request","accounting-queue":"Accounting Queue",admin:"Admin Panel"};function buildBreadcrumbs(pathname,projectName){const segments=pathname.replace(/^\//,"").split("/").filter(Boolean),items=[{label:"Dashboard",path:"/"}];let currentPath="";for(let i=0;i<segments.length;i++){const segment=segments[i];if(currentPath+=`/${segment}`,/^\d+$/.test(segment)){items.push({label:projectName||`#${segment}`,path:currentPath});continue}const label=ROUTE_LABELS[segment]||segment.replace(/-/g," ").replace(/\b\w/g,c=>c.toUpperCase()),isLast=i===segments.length-1;items.push({label,path:isLast?void 0:currentPath})}return items}function detectSiteContext(currentSiteUrl,hubSiteUrl){const normalizedUrl=currentSiteUrl.toLowerCase().replace(/\/$/,"");if(hubSiteUrl&&normalizedUrl===hubSiteUrl.toLowerCase().replace(/\/$/,""))return{siteUrl:currentSiteUrl,hubSiteUrl,isHubSite:!0};if(hubSiteUrl){const urlParts=currentSiteUrl.split("/"),siteName=urlParts[urlParts.length-1]||urlParts[urlParts.length-2],dashedMatch=siteName.match(/(\d{2}-\d{3}-\d{2})/);let projectCode;if(dashedMatch)projectCode=dashedMatch[1];else{const dashlessMatch=siteName.match(/(\d{7})/);if(dashlessMatch){const d=dashlessMatch[1];projectCode=`${d.substring(0,2)}-${d.substring(2,5)}-${d.substring(5,7)}`}}return{siteUrl:currentSiteUrl,hubSiteUrl,isHubSite:!1,projectCode}}return{siteUrl:currentSiteUrl,isHubSite:!0}}function parseCSVLine(line){const fields=[];let current="",inQuotes=!1;for(let i=0;i<line.length;i++){const ch=line[i];inQuotes?'"'===ch?i+1<line.length&&'"'===line[i+1]?(current+='"',i++):inQuotes=!1:current+=ch:'"'===ch?inQuotes=!0:","===ch?(fields.push(current.trim()),current=""):current+=ch}return fields.push(current.trim()),fields}function parseP6Date(dateStr){if(!dateStr||""===dateStr.trim())return null;const match=dateStr.trim().match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{2}):(\d{2})$/);if(!match)return null;const[,month,day,year,hour,minute]=match;return`${year}-${month.padStart(2,"0")}-${day.padStart(2,"0")}T${hour}:${minute}:00.000Z`}function parsePredSuccList(raw){return raw&&""!==raw.trim()?raw.split(",").map(s=>s.trim()).filter(Boolean):[]}function parseSuccessorDetails(raw){if(!raw||""===raw.trim())return[];return raw.split(",").map(s=>s.trim()).filter(Boolean).map(part=>{const colonIdx=part.lastIndexOf(":");if(-1===colonIdx)return{taskCode:part.trim(),relationshipType:"FS",lag:0};const taskCode=part.substring(0,colonIdx).trim(),tokens=part.substring(colonIdx+1).trim().split(/\s+/);return{taskCode,relationshipType:tokens[0]||"FS",lag:tokens.length>1&&parseInt(tokens[1],10)||0}})}function computeVarianceDays(baselineDate,actualDate){if(!baselineDate||!actualDate)return null;const baseline=new Date(baselineDate).getTime(),actual=new Date(actualDate).getTime();return Math.round((actual-baseline)/864e5)}function parseScheduleCSV(csvText,projectCode){const lines=csvText.split(/\r?\n/).filter(line=>""!==line.trim());if(lines.length<3)return[];const activities=[],now=(new Date).toISOString();for(let i=2;i<lines.length;i++)try{const fields=parseCSVLine(lines[i]);if(fields.length<4||!fields[0])continue;const taskCode=fields[0],statusRaw=fields[1]||"Not Started",status="Completed"===statusRaw?"Completed":"In Progress"===statusRaw?"In Progress":"Not Started",originalDuration=parseFloat(fields[4])||0,remainingDuration=parseFloat(fields[5])||0,actualDuration=parseFloat(fields[6])||0,baselineStartDate=parseP6Date(fields[7]),plannedStartDate=parseP6Date(fields[8]),actualStartDate=parseP6Date(fields[9]),baselineFinishDate=parseP6Date(fields[10]),plannedFinishDate=parseP6Date(fields[11]),actualFinishDate=parseP6Date(fields[12]),remainingFloat=void 0!==fields[13]&&""!==fields[13]?parseFloat(fields[13]):null,freeFloat=void 0!==fields[14]&&""!==fields[14]?parseFloat(fields[14]):null,predecessors=parsePredSuccList(fields[16]||""),successors=parsePredSuccList(fields[17]||""),successorDetails=parseSuccessorDetails(fields[18]||""),isCritical=null!==remainingFloat&&remainingFloat<=0,percentComplete="Completed"===status?100:"In Progress"===status&&actualDuration+remainingDuration>0?Math.round(actualDuration/(actualDuration+remainingDuration)*100):0,startVarianceDays=computeVarianceDays(baselineStartDate,actualStartDate||plannedStartDate),finishVarianceDays=computeVarianceDays(baselineFinishDate,actualFinishDate||plannedFinishDate);activities.push({id:i-1,projectCode,taskCode,wbsCode:fields[2]||"",activityName:fields[3]||"",activityType:fields[15]||"Task Dependent",status,originalDuration,remainingDuration,actualDuration,baselineStartDate,baselineFinishDate,plannedStartDate,plannedFinishDate,actualStartDate,actualFinishDate,remainingFloat,freeFloat,predecessors,successors,successorDetails,resources:fields[19]||"",calendarName:fields[22]||"",primaryConstraint:fields[20]||"",secondaryConstraint:fields[21]||"",isCritical,percentComplete,startVarianceDays,finishVarianceDays,deleteFlag:"y"===(fields[23]||"").toLowerCase(),createdDate:now,modifiedDate:now})}catch(err){console.warn(`parseScheduleCSV: skipping row ${i+1} due to error:`,err);continue}return activities}function mapXERStatus(code){switch(code){case"TK_Complete":return"Completed";case"TK_Active":return"In Progress";default:return"Not Started"}}function parseXERDate(dateStr){if(!dateStr||""===dateStr.trim())return null;const trimmed=dateStr.trim();if(/^\d{4}-\d{2}-\d{2}T/.test(trimmed))return trimmed;const match=trimmed.match(/^(\d{4}-\d{2}-\d{2})\s+(\d{2}:\d{2})$/);return match?`${match[1]}T${match[2]}:00.000Z`:/^\d{4}-\d{2}-\d{2}$/.test(trimmed)?`${trimmed}T00:00:00.000Z`:null}function parseXMLDate(el,tagName){const node=null==el?void 0:el.querySelector(tagName);if(!(null==node?void 0:node.textContent))return null;const val=node.textContent.trim();return val?/^\d{4}-\d{2}-\d{2}T/.test(val)?val.endsWith("Z")?val:`${val}Z`:/^\d{4}-\d{2}-\d{2}$/.test(val)?`${val}T00:00:00.000Z`:null:null}function getElText(el,tagName){var _a,_b;return(null===(_b=null===(_a=el.querySelector(tagName))||void 0===_a?void 0:_a.textContent)||void 0===_b?void 0:_b.trim())||""}function getElNum(el,tagName){return parseFloat(getElText(el,tagName))||0}function parseScheduleXML(xmlText,projectCode){const doc=(new DOMParser).parseFromString(xmlText,"text/xml"),parseError=doc.querySelector("parsererror");if(parseError)return console.warn("parseScheduleXML: XML parse error:",parseError.textContent),[];const rootTag=doc.documentElement.tagName;return"APIBusinessObjects"===rootTag||"ProjectData"===rootTag?function parseP6PMXML(doc,projectCode){const activityEls=doc.querySelectorAll("Activity"),now=(new Date).toISOString(),activities=[];let idCounter=1;activityEls.forEach(el=>{try{const actId=getElText(el,"Id")||getElText(el,"ObjectId"),name=getElText(el,"Name");if(!actId||!name)return;const statusCode=getElText(el,"Status"),status="Completed"===statusCode?"Completed":"In Progress"===statusCode?"In Progress":"Not Started",plannedDuration=getElNum(el,"PlannedDuration")||getElNum(el,"AtCompletionDuration"),remainingDuration=getElNum(el,"RemainingDuration"),actualDuration=getElNum(el,"ActualDuration"),originalDuration=plannedDuration||actualDuration+remainingDuration,baselineStartDate=parseXMLDate(el,"PlannedStartDate"),baselineFinishDate=parseXMLDate(el,"PlannedFinishDate"),plannedStartDate=parseXMLDate(el,"StartDate")||baselineStartDate,plannedFinishDate=parseXMLDate(el,"FinishDate")||baselineFinishDate,actualStartDate=parseXMLDate(el,"ActualStartDate"),actualFinishDate=parseXMLDate(el,"ActualFinishDate"),floatVal=getElText(el,"RemainingTotalFloat")||getElText(el,"TotalFloat"),remainingFloat=floatVal?parseFloat(floatVal):null,freeFloatVal=getElText(el,"RemainingFreeFloat")||getElText(el,"FreeFloat"),freeFloat=freeFloatVal?parseFloat(freeFloatVal):null,isCritical=null!==remainingFloat&&remainingFloat<=0,pctComplete=getElNum(el,"DurationPercentComplete")||getElNum(el,"PercentComplete"),startVarianceDays=computeVarianceDays(baselineStartDate,actualStartDate||plannedStartDate),finishVarianceDays=computeVarianceDays(baselineFinishDate,actualFinishDate||plannedFinishDate);activities.push({id:idCounter++,projectCode,taskCode:actId,wbsCode:getElText(el,"WBSObjectId")||getElText(el,"WBSCode")||"",activityName:name,activityType:getElText(el,"Type")||"Task Dependent",status,originalDuration,remainingDuration,actualDuration,baselineStartDate,baselineFinishDate,plannedStartDate,plannedFinishDate,actualStartDate,actualFinishDate,remainingFloat,freeFloat,predecessors:[],successors:[],successorDetails:[],resources:getElText(el,"ResourceName")||"",calendarName:getElText(el,"CalendarName")||"",primaryConstraint:getElText(el,"PrimaryConstraintType")||"",secondaryConstraint:getElText(el,"SecondaryConstraintType")||"",isCritical,percentComplete:pctComplete,startVarianceDays,finishVarianceDays,deleteFlag:!1,createdDate:now,modifiedDate:now})}catch(err){console.warn("parseP6PMXML: skipping activity element due to error:",err)}});const codeToActivity=new Map(activities.map(a=>[a.taskCode,a])),relEls=doc.querySelectorAll("Relationship");return relEls.forEach(rel=>{const predId=getElText(rel,"PredecessorActivityId")||getElText(rel,"PredecessorActivityObjectId"),succId=getElText(rel,"SuccessorActivityId")||getElText(rel,"SuccessorActivityObjectId"),relType=getElText(rel,"Type")||"Finish to Start",lag=getElNum(rel,"Lag"),mappedType={"Finish to Start":"FS","Start to Start":"SS","Finish to Finish":"FF","Start to Finish":"SF"}[relType]||"FS",predAct=codeToActivity.get(predId),succAct=codeToActivity.get(succId);predAct&&succAct&&(predAct.successors.push(succId),predAct.successorDetails.push({taskCode:succId,relationshipType:mappedType,lag}),succAct.predecessors.push(predId))}),activities}(doc,projectCode):function parseMSProjectXML(doc,projectCode){const tasks=doc.querySelectorAll("Task"),now=(new Date).toISOString(),activities=[],uidToName=new Map;tasks.forEach(task=>{const uid=getElText(task,"UID"),name=getElText(task,"Name");uid&&uidToName.set(uid,name||uid)});let idCounter=1;tasks.forEach(task=>{try{const uid=getElText(task,"UID"),name=getElText(task,"Name");if(!uid||"0"===uid||!name)return;const durationHrs=parseMSProjectDuration(getElText(task,"Duration")),originalDuration=Math.round(durationHrs/8),percentComplete=getElNum(task,"PercentComplete"),status=percentComplete>=100?"Completed":percentComplete>0?"In Progress":"Not Started",remainingDuration="Completed"===status?0:Math.round(originalDuration*(1-percentComplete/100)),actualDuration=originalDuration-remainingDuration,plannedStartDate=parseXMLDate(task,"Start"),plannedFinishDate=parseXMLDate(task,"Finish"),baselineStartDate=parseXMLDate(task,"BaselineStart")||parseXMLDate(task,"Start"),baselineFinishDate=parseXMLDate(task,"BaselineFinish")||parseXMLDate(task,"Finish"),actualStartDate=parseXMLDate(task,"ActualStart"),actualFinishDate=parseXMLDate(task,"ActualFinish"),totalSlack=getElText(task,"TotalSlack"),remainingFloat=totalSlack?Math.round(parseMSProjectDuration(totalSlack)/8):null,freeSlack=getElText(task,"FreeSlack"),freeFloat=freeSlack?Math.round(parseMSProjectDuration(freeSlack)/8):null,predLinks=task.querySelectorAll("PredecessorLink"),predecessors=[],successorDetails=[];predLinks.forEach(link=>{const predUID=getElText(link,"PredecessorUID"),predName=uidToName.get(predUID)||predUID;predecessors.push(predName);const relType={0:"FF",1:"FS",2:"SF",3:"SS"}[getElText(link,"Type")]||"FS",lagDur=getElText(link,"LinkLag"),lagDays=lagDur?Math.round(parseInt(lagDur,10)/4800):0;successorDetails.push({taskCode:predName,relationshipType:relType,lag:lagDays})});const wbsCode=getElText(task,"WBS")||getElText(task,"OutlineNumber"),isCritical="1"===getElText(task,"Critical")||null!==remainingFloat&&remainingFloat<=0,constraintType=getElText(task,"ConstraintType"),constraintMap={0:"",1:"Must Start On",2:"Must Finish On",3:"Start No Earlier Than",4:"Start No Later Than",5:"Finish No Earlier Than",6:"Finish No Later Than",7:"As Late As Possible"},startVarianceDays=computeVarianceDays(baselineStartDate,actualStartDate||plannedStartDate),finishVarianceDays=computeVarianceDays(baselineFinishDate,actualFinishDate||plannedFinishDate);activities.push({id:idCounter++,projectCode,taskCode:`MSP-${uid}`,wbsCode,activityName:name,activityType:"1"===getElText(task,"Type")?"Resource Dependent":"Task Dependent",status,originalDuration,remainingDuration,actualDuration,baselineStartDate,baselineFinishDate,plannedStartDate,plannedFinishDate,actualStartDate,actualFinishDate,remainingFloat,freeFloat,predecessors,successors:[],successorDetails,resources:getElText(task,"ResourceName"),calendarName:getElText(task,"CalendarUID"),primaryConstraint:constraintMap[constraintType]||constraintType,secondaryConstraint:"",isCritical,percentComplete,startVarianceDays,finishVarianceDays,deleteFlag:!1,createdDate:now,modifiedDate:now})}catch(err){console.warn("parseMSProjectXML: skipping task element due to error:",err)}});const codeSet=new Set(activities.map(a=>a.taskCode));for(const act of activities)for(const pred of act.predecessors){const predAct=activities.find(a=>a.taskCode===pred||a.activityName===pred);predAct&&!predAct.successors.includes(act.taskCode)&&predAct.successors.push(act.taskCode)}for(const act of activities)act.successors=act.successors.filter(s=>codeSet.has(s));return activities}(doc,projectCode)}function parseMSProjectDuration(durStr){if(!durStr)return 0;const match=durStr.match(/PT(\d+)H(\d+)M(\d+)S/);if(match)return parseInt(match[1],10)+parseInt(match[2],10)/60;const hMatch=durStr.match(/PT(\d+)H/);if(hMatch)return parseInt(hMatch[1],10);const dMatch=durStr.match(/P(\d+)D/);return dMatch?8*parseInt(dMatch[1],10):parseFloat(durStr)||0}function parseScheduleFile(text,format,projectCode){switch(format){case"P6-CSV":case"MSProject-CSV":default:return parseScheduleCSV(text,projectCode);case"P6-XER":return function parseScheduleXER(xerText,projectCode){const lines=xerText.split(/\r?\n/);let currentTable="",fieldNames=[];const tasks=[],predMap=new Map;for(const line of lines)if(line.startsWith("%T"))currentTable=line.substring(2).trim().split(/\s+/)[0]||"",fieldNames=[];else if(line.startsWith("%F"))fieldNames=line.substring(2).trim().split("\t");else if(line.startsWith("%R")&&fieldNames.length>0){const values=line.substring(2).trim().split("\t"),row={};for(let i=0;i<fieldNames.length&&i<values.length;i++)row[fieldNames[i]]=values[i]||"";if("TASK"===currentTable)tasks.push(row);else if("TASKPRED"===currentTable){const taskId=row.task_id||"",predTaskId=row.pred_task_id||"",predType=row.pred_type||"PR_FS",lagHours=parseFloat(row.lag_hr_cnt||"0")||0;taskId&&(predMap.has(taskId)||predMap.set(taskId,[]),predMap.get(taskId).push({predTaskId,predType,lagHours}))}}const idToCode=new Map;for(const t of tasks)t.task_id&&t.task_code&&idToCode.set(t.task_id,t.task_code);const now=(new Date).toISOString(),activities=[];for(let idx=0;idx<tasks.length;idx++)try{const t=tasks[idx],taskId=t.task_id||"",taskCode=t.task_code||`TASK-${idx+1}`,status=mapXERStatus(t.status_code||""),originalDuration=(parseFloat(t.target_drtn_hr_cnt||"0")||0)/8,remainingDuration=(parseFloat(t.remain_drtn_hr_cnt||"0")||0)/8,actualDuration=Math.max(0,originalDuration-remainingDuration),baselineStartDate=parseXERDate(t.target_start_date),baselineFinishDate=parseXERDate(t.target_end_date),plannedStartDate=parseXERDate(t.early_start_date||t.target_start_date),plannedFinishDate=parseXERDate(t.early_end_date||t.target_end_date),actualStartDate=parseXERDate(t.act_start_date),actualFinishDate=parseXERDate(t.act_end_date),totalFloatHrs=parseFloat(t.total_float_hr_cnt||""),remainingFloat=isNaN(totalFloatHrs)?null:Math.round(totalFloatHrs/8),freeFloatHrs=parseFloat(t.free_float_hr_cnt||""),freeFloat=isNaN(freeFloatHrs)?null:Math.round(freeFloatHrs/8),predecessors=(predMap.get(taskId)||[]).map(p=>idToCode.get(p.predTaskId)||p.predTaskId),successorCodes=[],successorDetails=[];for(const[succTaskId,succPreds]of predMap)for(const sp of succPreds)if(sp.predTaskId===taskId){const succCode=idToCode.get(succTaskId)||succTaskId;successorCodes.push(succCode);const relTypeMap={PR_FS:"FS",PR_FF:"FF",PR_SS:"SS",PR_SF:"SF"};successorDetails.push({taskCode:succCode,relationshipType:relTypeMap[sp.predType]||"FS",lag:Math.round(sp.lagHours/8)})}const isCritical=null!==remainingFloat&&remainingFloat<=0,percentComplete="Completed"===status?100:"In Progress"===status&&actualDuration+remainingDuration>0?Math.round(actualDuration/(actualDuration+remainingDuration)*100):0,startVarianceDays=computeVarianceDays(baselineStartDate,actualStartDate||plannedStartDate),finishVarianceDays=computeVarianceDays(baselineFinishDate,actualFinishDate||plannedFinishDate);activities.push({id:idx+1,projectCode,taskCode,wbsCode:t.wbs_id||"",activityName:t.task_name||"",activityType:t.task_type||"Task Dependent",status,originalDuration,remainingDuration,actualDuration,baselineStartDate,baselineFinishDate,plannedStartDate,plannedFinishDate,actualStartDate,actualFinishDate,remainingFloat,freeFloat,predecessors,successors:successorCodes,successorDetails,resources:t.rsrc_name||"",calendarName:t.clndr_name||"",primaryConstraint:t.cstr_type||"",secondaryConstraint:t.cstr_type2||"",isCritical,percentComplete,startVarianceDays,finishVarianceDays,deleteFlag:"y"===(t.delete_flag||"").toLowerCase(),createdDate:now,modifiedDate:now})}catch(err){console.warn(`parseScheduleXER: skipping task at index ${idx} due to error:`,err);continue}return 0===activities.length&&tasks.length>0&&console.warn(`parseScheduleXER: parsed 0 activities from ${tasks.length} TASK rows â€” check XER format`),activities}(text,projectCode);case"MSProject-XML":return parseScheduleXML(text,projectCode)}}},"./packages/hbc-sp-services/src/models/enums.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var Stage,Region,Sector,Division,DepartmentOfOrigin,DeliveryMethod,GoNoGoDecision,ScorecardStatus,WinLossDecision,LossReason,RoleName,ProvisioningStatus,AuditAction,EntityType,DeliverableStatus,ActionItemStatus,Priority,TurnoverCategory,AwardStatus,EstimateSource,DeliverableType,MeetingType,NotificationType,ActiveProjectStatus,NotificationEvent,TurnoverStatus,WorkflowKey,StepAssignmentType,ConditionField,WorkflowActionType,ActionPriority,PermissionLevel;__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ActionItemStatus:()=>ActionItemStatus,ActionPriority:()=>ActionPriority,ActiveProjectStatus:()=>ActiveProjectStatus,AuditAction:()=>AuditAction,AwardStatus:()=>AwardStatus,ConditionField:()=>ConditionField,DeliverableStatus:()=>DeliverableStatus,DeliverableType:()=>DeliverableType,DeliveryMethod:()=>DeliveryMethod,DepartmentOfOrigin:()=>DepartmentOfOrigin,Division:()=>Division,EntityType:()=>EntityType,EstimateSource:()=>EstimateSource,GoNoGoDecision:()=>GoNoGoDecision,LossReason:()=>LossReason,MeetingType:()=>MeetingType,NotificationEvent:()=>NotificationEvent,NotificationType:()=>NotificationType,PermissionLevel:()=>PermissionLevel,Priority:()=>Priority,ProvisioningStatus:()=>ProvisioningStatus,Region:()=>Region,RoleName:()=>RoleName,ScorecardStatus:()=>ScorecardStatus,Sector:()=>Sector,Stage:()=>Stage,StepAssignmentType:()=>StepAssignmentType,TurnoverCategory:()=>TurnoverCategory,TurnoverStatus:()=>TurnoverStatus,WinLossDecision:()=>WinLossDecision,WorkflowActionType:()=>WorkflowActionType,WorkflowKey:()=>WorkflowKey}),function(Stage){Stage.LeadDiscovery="Lead-Discovery",Stage.GoNoGoPending="GoNoGo-Pending",Stage.GoNoGoWait="GoNoGo-Wait",Stage.Opportunity="Opportunity",Stage.Pursuit="Pursuit",Stage.WonContractPending="Won-ContractPending",Stage.ActiveConstruction="Active-Construction",Stage.Closeout="Closeout",Stage.ArchivedNoGo="Archived-NoGo",Stage.ArchivedLoss="Archived-Loss",Stage.ArchivedHistorical="Archived-Historical"}(Stage||(Stage={})),function(Region){Region.Miami="Miami",Region.WestPalmBeach="West Palm Beach",Region.MartinCounty="Martin County",Region.Orlando="Orlando",Region.Tallahassee="Tallahassee"}(Region||(Region={})),function(Sector){Sector.Airport="Airport",Sector.City="City",Sector.Commercial="Commercial",Sector.County="County",Sector.Federal="Federal",Sector.GolfClubCourse="Golf Club/Course",Sector.MixedUse="Mixed-Use",Sector.MultiFamily="Multi-Family",Sector.Municipal="Municipal",Sector.ParkingGarage="Parking Garage",Sector.State="State",Sector.Warehouse="Warehouse"}(Sector||(Sector={})),function(Division){Division.Commercial="Commercial",Division.LuxuryResidential="Luxury Residential"}(Division||(Division={})),function(DepartmentOfOrigin){DepartmentOfOrigin.BusinessDevelopment="Business Development",DepartmentOfOrigin.Estimating="Estimating",DepartmentOfOrigin.Marketing="Marketing",DepartmentOfOrigin.Operations="Operations",DepartmentOfOrigin.Other="Other"}(DepartmentOfOrigin||(DepartmentOfOrigin={})),function(DeliveryMethod){DeliveryMethod.GMP="GMP",DeliveryMethod.HardBid="Hard-Bid",DeliveryMethod.PreconWithGMP="Precon w/ GMP Amend",DeliveryMethod.Other="Other"}(DeliveryMethod||(DeliveryMethod={})),function(GoNoGoDecision){GoNoGoDecision.Go="Go",GoNoGoDecision.NoGo="No-Go",GoNoGoDecision.ConditionalGo="Conditional Go"}(GoNoGoDecision||(GoNoGoDecision={})),function(ScorecardStatus){ScorecardStatus.BDDraft="BD Draft",ScorecardStatus.AwaitingDirectorReview="Awaiting Director Review",ScorecardStatus.DirectorReturnedForRevision="Director Returned for Revision",ScorecardStatus.AwaitingCommitteeScoring="Awaiting Committee Scoring",ScorecardStatus.CommitteeReturnedForRevision="Committee Returned for Revision",ScorecardStatus.Rejected="Rejected",ScorecardStatus.NoGo="No Go",ScorecardStatus.Go="Go",ScorecardStatus.Locked="Locked",ScorecardStatus.Unlocked="Unlocked"}(ScorecardStatus||(ScorecardStatus={})),function(WinLossDecision){WinLossDecision.Win="Win",WinLossDecision.Loss="Loss"}(WinLossDecision||(WinLossDecision={})),function(LossReason){LossReason.Price="Price",LossReason.Relationship="Relationship",LossReason.Experience="Experience",LossReason.Schedule="Schedule",LossReason.Competition="Competition",LossReason.Other="Other"}(LossReason||(LossReason={})),function(RoleName){RoleName.BDRepresentative="BD Representative",RoleName.EstimatingCoordinator="Estimating Coordinator",RoleName.AccountingManager="Accounting Manager",RoleName.PreconstructionTeam="Preconstruction Team",RoleName.OperationsTeam="Operations Team",RoleName.ExecutiveLeadership="Executive Leadership",RoleName.Legal="Legal",RoleName.RiskManagement="Risk Management",RoleName.Marketing="Marketing",RoleName.QualityControl="Quality Control",RoleName.Safety="Safety",RoleName.IDS="IDS",RoleName.DepartmentDirector="Department Director",RoleName.SharePointAdmin="SharePoint Admin"}(RoleName||(RoleName={})),function(ProvisioningStatus){ProvisioningStatus.Queued="Queued",ProvisioningStatus.InProgress="InProgress",ProvisioningStatus.Completed="Completed",ProvisioningStatus.PartialFailure="PartialFailure",ProvisioningStatus.Failed="Failed"}(ProvisioningStatus||(ProvisioningStatus={})),function(AuditAction){AuditAction.LeadCreated="Lead.Created",AuditAction.LeadEdited="Lead.Edited",AuditAction.GoNoGoScoreSubmitted="GoNoGo.ScoreSubmitted",AuditAction.GoNoGoDecisionMade="GoNoGo.DecisionMade",AuditAction.SiteProvisioningTriggered="Site.ProvisioningTriggered",AuditAction.SiteProvisioningCompleted="Site.ProvisioningCompleted",AuditAction.SiteCreated="Site.Created",AuditAction.SiteListsProvisioned="Site.ListsProvisioned",AuditAction.SiteHubAssociated="Site.HubAssociated",AuditAction.SiteSecurityGroupsCreated="Site.SecurityGroupsCreated",AuditAction.SiteTemplatesCopied="Site.TemplatesCopied",AuditAction.SiteLeadDataCopied="Site.LeadDataCopied",AuditAction.EstimateCreated="Estimate.Created",AuditAction.EstimateStatusChanged="Estimate.StatusChanged",AuditAction.TurnoverInitiated="Turnover.Initiated",AuditAction.TurnoverCompleted="Turnover.Completed",AuditAction.PermissionChanged="Permission.Changed",AuditAction.MeetingScheduled="Meeting.Scheduled",AuditAction.LossRecorded="Loss.Recorded",AuditAction.AutopsyCompleted="Autopsy.Completed",AuditAction.ConfigFeatureFlagChanged="Config.FeatureFlagChanged",AuditAction.ConfigRoleChanged="Config.RoleChanged",AuditAction.ChecklistItemUpdated="Checklist.ItemUpdated",AuditAction.ChecklistItemAdded="Checklist.ItemAdded",AuditAction.ChecklistSignedOff="Checklist.SignedOff",AuditAction.MatrixAssignmentChanged="Matrix.AssignmentChanged",AuditAction.MatrixTaskAdded="Matrix.TaskAdded",AuditAction.ProjectRecordUpdated="ProjectRecord.Updated",AuditAction.ProjectRecordCreated="ProjectRecord.Created",AuditAction.PMPSubmitted="PMP.Submitted",AuditAction.PMPApproved="PMP.Approved",AuditAction.PMPReturned="PMP.Returned",AuditAction.PMPSigned="PMP.Signed",AuditAction.RiskItemUpdated="Risk.ItemUpdated",AuditAction.QualityConcernUpdated="Quality.ConcernUpdated",AuditAction.SafetyConcernUpdated="Safety.ConcernUpdated",AuditAction.ScheduleUpdated="Schedule.Updated",AuditAction.SuperPlanUpdated="SuperPlan.Updated",AuditAction.LessonAdded="Lesson.Added",AuditAction.MonthlyReviewSubmitted="MonthlyReview.Submitted",AuditAction.MonthlyReviewAdvanced="MonthlyReview.Advanced",AuditAction.ScorecardSubmitted="Scorecard.Submitted",AuditAction.ScorecardReturned="Scorecard.Returned",AuditAction.ScorecardCommitteeScored="Scorecard.CommitteeScored",AuditAction.ScorecardDecisionMade="Scorecard.DecisionMade",AuditAction.ScorecardUnlocked="Scorecard.Unlocked",AuditAction.ScorecardRelocked="Scorecard.Relocked",AuditAction.ScorecardVersionCreated="Scorecard.VersionCreated",AuditAction.WorkflowStepUpdated="Workflow.StepUpdated",AuditAction.WorkflowConditionAdded="Workflow.ConditionAdded",AuditAction.WorkflowConditionRemoved="Workflow.ConditionRemoved",AuditAction.WorkflowOverrideSet="Workflow.OverrideSet",AuditAction.WorkflowOverrideRemoved="Workflow.OverrideRemoved",AuditAction.TurnoverAgendaCreated="Turnover.AgendaCreated",AuditAction.TurnoverPrerequisiteCompleted="Turnover.PrerequisiteCompleted",AuditAction.TurnoverItemDiscussed="Turnover.ItemDiscussed",AuditAction.TurnoverSubcontractorAdded="Turnover.SubcontractorAdded",AuditAction.TurnoverSubcontractorRemoved="Turnover.SubcontractorRemoved",AuditAction.TurnoverExhibitReviewed="Turnover.ExhibitReviewed",AuditAction.TurnoverExhibitAdded="Turnover.ExhibitAdded",AuditAction.TurnoverExhibitRemoved="Turnover.ExhibitRemoved",AuditAction.TurnoverSigned="Turnover.Signed",AuditAction.TurnoverAgendaCompleted="Turnover.AgendaCompleted",AuditAction.HubNavLinkCreated="HubNav.LinkCreated",AuditAction.HubNavLinkFailed="HubNav.LinkFailed",AuditAction.HubNavLinkRetried="HubNav.LinkRetried",AuditAction.HubNavLinkRemoved="HubNav.LinkRemoved",AuditAction.HubSiteUrlUpdated="HubNav.SiteUrlUpdated",AuditAction.TemplateCreated="Permission.TemplateCreated",AuditAction.TemplateUpdated="Permission.TemplateUpdated",AuditAction.TemplateDeleted="Permission.TemplateDeleted",AuditAction.ProjectTeamAssigned="Permission.ProjectTeamAssigned",AuditAction.ProjectTeamRemoved="Permission.ProjectTeamRemoved",AuditAction.ProjectTeamOverridden="Permission.ProjectTeamOverridden",AuditAction.SecurityGroupMappingChanged="Permission.SecurityGroupMappingChanged",AuditAction.PermissionResolved="Permission.Resolved",AuditAction.ScorecardArchived="Scorecard.Archived",AuditAction.LeadFolderCreated="Lead.FolderCreated",AuditAction.AssignmentMappingUpdated="Assignment.MappingUpdated",AuditAction.GraphApiCallSucceeded="Graph.ApiCallSucceeded",AuditAction.GraphApiCallFailed="Graph.ApiCallFailed",AuditAction.GraphGroupMemberAdded="Graph.GroupMemberAdded",AuditAction.GraphGroupMemberAddFailed="Graph.GroupMemberAddFailed",AuditAction.PerformanceLogRecorded="Performance.LogRecorded",AuditAction.PerformanceAlertTriggered="Performance.AlertTriggered",AuditAction.SupportEmailSent="Support.EmailSent",AuditAction.SupportConfigUpdated="Support.ConfigUpdated",AuditAction.DataMartSynced="DataMart.Synced",AuditAction.DataMartSyncFailed="DataMart.SyncFailed",AuditAction.ServiceError="Service.Error",AuditAction.ContractTrackingSubmitted="ContractTracking.Submitted",AuditAction.ContractTrackingApproved="ContractTracking.Approved",AuditAction.ContractTrackingRejected="ContractTracking.Rejected",AuditAction.ContractTrackingSkipped="ContractTracking.Skipped",AuditAction.ScheduleActivitiesImported="Schedule.ActivitiesImported",AuditAction.ScheduleActivityUpdated="Schedule.ActivityUpdated",AuditAction.ScheduleActivityDeleted="Schedule.ActivityDeleted",AuditAction.ConstraintUpdated="Constraint.Updated",AuditAction.PermitUpdated="Permit.Updated",AuditAction.Dashboard_Loaded="Dashboard.Loaded",AuditAction.Dashboard_FilterApplied="Dashboard.FilterApplied",AuditAction.Dashboard_ChartDrilledDown="Dashboard.ChartDrilledDown",AuditAction.Dashboard_Exported="Dashboard.Exported",AuditAction.Telemetry_QueryExecuted="Telemetry.QueryExecuted",AuditAction.TemplateAppliedFromGitOps="Template.AppliedFromGitOps",AuditAction.TemplateSyncPRCreated="Template.SyncPRCreated",AuditAction.TemplateSyncDiffComputed="Template.SyncDiffComputed",AuditAction.TemplateSiteConfigUpdated="Template.SiteConfigUpdated",AuditAction.GitOpsProvisioningEnabled="Template.GitOpsEnabled",AuditAction.GitOpsProvisioningDisabled="Template.GitOpsDisabled"}(AuditAction||(AuditAction={})),function(EntityType){EntityType.Lead="Lead",EntityType.Scorecard="Scorecard",EntityType.Estimate="Estimate",EntityType.Project="Project",EntityType.Permission="Permission",EntityType.Config="Config",EntityType.Checklist="Checklist",EntityType.Matrix="Matrix",EntityType.ProjectRecord="ProjectRecord",EntityType.RiskCost="RiskCost",EntityType.Quality="Quality",EntityType.Safety="Safety",EntityType.Schedule="Schedule",EntityType.SuperintendentPlan="SuperintendentPlan",EntityType.LessonLearned="LessonLearned",EntityType.PMP="PMP",EntityType.MonthlyReview="MonthlyReview",EntityType.WorkflowDefinition="WorkflowDefinition",EntityType.TurnoverAgenda="TurnoverAgenda",EntityType.PermissionTemplate="PermissionTemplate",EntityType.ProjectTeamAssignment="ProjectTeamAssignment",EntityType.AssignmentMapping="AssignmentMapping",EntityType.Meeting="Meeting",EntityType.GraphApi="GraphApi",EntityType.Performance="Performance",EntityType.SupportRequest="SupportRequest",EntityType.DataMart="DataMart",EntityType.Closeout="Closeout",EntityType.ContractTracking="ContractTracking",EntityType.ScheduleActivity="ScheduleActivity",EntityType.Constraint="Constraint",EntityType.Permit="Permit",EntityType.Telemetry="Telemetry",EntityType.Dashboard="Dashboard",EntityType.TemplateRegistry="TemplateRegistry",EntityType.TemplateSiteConfig="TemplateSiteConfig"}(EntityType||(EntityType={})),function(DeliverableStatus){DeliverableStatus.NotStarted="Not Started",DeliverableStatus.InProgress="In Progress",DeliverableStatus.InReview="In Review",DeliverableStatus.Complete="Complete"}(DeliverableStatus||(DeliverableStatus={})),function(ActionItemStatus){ActionItemStatus.Open="Open",ActionItemStatus.InProgress="In Progress",ActionItemStatus.Complete="Complete"}(ActionItemStatus||(ActionItemStatus={})),function(Priority){Priority.Low="Low",Priority.Medium="Medium",Priority.High="High",Priority.Critical="Critical"}(Priority||(Priority={})),function(TurnoverCategory){TurnoverCategory.Documents="Documents",TurnoverCategory.Safety="Safety",TurnoverCategory.Financial="Financial",TurnoverCategory.Scheduling="Scheduling",TurnoverCategory.Staffing="Staffing",TurnoverCategory.Subcontracts="Subcontracts"}(TurnoverCategory||(TurnoverCategory={})),function(AwardStatus){AwardStatus.Pending="Pending",AwardStatus.AwardedWithPrecon="Awarded w/ Precon",AwardStatus.AwardedWithoutPrecon="Awarded w/o Precon",AwardStatus.NotAwarded="Not Awarded"}(AwardStatus||(AwardStatus={})),function(EstimateSource){EstimateSource.ClientRequest="Client Request",EstimateSource.RFP="RFP",EstimateSource.RFQ="RFQ",EstimateSource.Referral="Referral",EstimateSource.Other="Other"}(EstimateSource||(EstimateSource={})),function(DeliverableType){DeliverableType.GMP="GMP",DeliverableType.ConceptualEst="Conceptual Est",DeliverableType.LumpSumProposal="Lump Sum Proposal",DeliverableType.Schematic="Schematic",DeliverableType.DDEst="DD Est",DeliverableType.ROM="ROM",DeliverableType.RFP="RFP",DeliverableType.HardBid="Hard Bid",DeliverableType.Other="Other"}(DeliverableType||(DeliverableType={})),function(MeetingType){MeetingType.GoNoGo="GoNoGo",MeetingType.Kickoff="Kickoff",MeetingType.PreconKickoff="PreconKickoff",MeetingType.RedTeam="RedTeam",MeetingType.WinStrategy="WinStrategy",MeetingType.Autopsy="Autopsy",MeetingType.LossAutopsy="LossAutopsy",MeetingType.Turnover="Turnover",MeetingType.Other="Other"}(MeetingType||(MeetingType={})),function(NotificationType){NotificationType.Email="Email",NotificationType.Teams="Teams",NotificationType.Both="Both"}(NotificationType||(NotificationType={})),function(ActiveProjectStatus){ActiveProjectStatus.Precon="Precon",ActiveProjectStatus.Construction="Construction",ActiveProjectStatus.FinalPayment="Final Payment"}(ActiveProjectStatus||(ActiveProjectStatus={})),function(NotificationEvent){NotificationEvent.LeadSubmitted="LeadSubmitted",NotificationEvent.GoNoGoScoringRequested="GoNoGoScoringRequested",NotificationEvent.GoNoGoDecisionMade="GoNoGoDecisionMade",NotificationEvent.SiteProvisioned="SiteProvisioned",NotificationEvent.PreconKickoff="PreconKickoff",NotificationEvent.DeliverableDueApproaching="DeliverableDueApproaching",NotificationEvent.WinLossRecorded="WinLossRecorded",NotificationEvent.AutopsyScheduled="AutopsyScheduled",NotificationEvent.TurnoverCompleted="TurnoverCompleted",NotificationEvent.SafetyFolderChanged="SafetyFolderChanged",NotificationEvent.PMPSignatureRequested="PMPSignatureRequested",NotificationEvent.PMPSubmittedForApproval="PMPSubmittedForApproval",NotificationEvent.PMPApprovalRequired="PMPApprovalRequired",NotificationEvent.PMPApproved="PMPApproved",NotificationEvent.PMPReturnedForRevision="PMPReturnedForRevision",NotificationEvent.MonthlyReviewDueNotification="MonthlyReviewDueNotification",NotificationEvent.MonthlyReviewSubmittedToPX="MonthlyReviewSubmittedToPX",NotificationEvent.MonthlyReviewReturnedToPM="MonthlyReviewReturnedToPM",NotificationEvent.MonthlyReviewSubmittedToLeadership="MonthlyReviewSubmittedToLeadership",NotificationEvent.JobNumberRequested="JobNumberRequested",NotificationEvent.JobNumberAssigned="JobNumberAssigned",NotificationEvent.EstimatingKickoffScheduled="EstimatingKickoffScheduled",NotificationEvent.AutopsyFinalized="AutopsyFinalized",NotificationEvent.CommitmentSubmitted="CommitmentSubmitted",NotificationEvent.CommitmentWaiverRequired="CommitmentWaiverRequired",NotificationEvent.CommitmentApproved="CommitmentApproved",NotificationEvent.CommitmentEscalatedToCFO="CommitmentEscalatedToCFO",NotificationEvent.CommitmentRejected="CommitmentRejected",NotificationEvent.ScorecardSubmittedForReview="ScorecardSubmittedForReview",NotificationEvent.ScorecardReturnedForRevision="ScorecardReturnedForRevision",NotificationEvent.ScorecardCommitteeScoresFinalized="ScorecardCommitteeScoresFinalized",NotificationEvent.ScorecardDecisionRecorded="ScorecardDecisionRecorded",NotificationEvent.ScorecardUnlockedForEditing="ScorecardUnlockedForEditing",NotificationEvent.ScorecardSubmittedToDirector="ScorecardSubmittedToDirector",NotificationEvent.ScorecardReturnedByDirector="ScorecardReturnedByDirector",NotificationEvent.ScorecardRejectedByDirector="ScorecardRejectedByDirector",NotificationEvent.ScorecardAdvancedToCommittee="ScorecardAdvancedToCommittee",NotificationEvent.ScorecardApprovedGo="ScorecardApprovedGo",NotificationEvent.ScorecardDecidedNoGo="ScorecardDecidedNoGo",NotificationEvent.EstimatingCoordinatorNotifiedGo="EstimatingCoordinatorNotifiedGo",NotificationEvent.ContractTrackingSubmitted="ContractTrackingSubmitted",NotificationEvent.ContractTrackingStepAdvanced="ContractTrackingStepAdvanced",NotificationEvent.ContractTrackingCompleted="ContractTrackingCompleted",NotificationEvent.ContractTrackingRejected="ContractTrackingRejected"}(NotificationEvent||(NotificationEvent={})),function(TurnoverStatus){TurnoverStatus.Draft="Draft",TurnoverStatus.PrerequisitesInProgress="PrerequisitesInProgress",TurnoverStatus.MeetingScheduled="MeetingScheduled",TurnoverStatus.MeetingComplete="MeetingComplete",TurnoverStatus.PendingSignatures="PendingSignatures",TurnoverStatus.Signed="Signed",TurnoverStatus.Complete="Complete"}(TurnoverStatus||(TurnoverStatus={})),function(WorkflowKey){WorkflowKey.GO_NO_GO="GO_NO_GO",WorkflowKey.PMP_APPROVAL="PMP_APPROVAL",WorkflowKey.MONTHLY_REVIEW="MONTHLY_REVIEW",WorkflowKey.COMMITMENT_APPROVAL="COMMITMENT_APPROVAL",WorkflowKey.TURNOVER_APPROVAL="TURNOVER_APPROVAL",WorkflowKey.CONTRACT_TRACKING="CONTRACT_TRACKING"}(WorkflowKey||(WorkflowKey={})),function(StepAssignmentType){StepAssignmentType.ProjectRole="ProjectRole",StepAssignmentType.NamedPerson="NamedPerson"}(StepAssignmentType||(StepAssignmentType={})),function(ConditionField){ConditionField.Division="Division",ConditionField.Region="Region",ConditionField.Sector="Sector"}(ConditionField||(ConditionField={})),function(WorkflowActionType){WorkflowActionType.GoNoGoReview="GoNoGoReview",WorkflowActionType.GoNoGoRevision="GoNoGoRevision",WorkflowActionType.PMPApproval="PMPApproval",WorkflowActionType.PMPSignature="PMPSignature",WorkflowActionType.MonthlyReviewInput="MonthlyReviewInput",WorkflowActionType.MonthlyReviewValidation="MonthlyReviewValidation",WorkflowActionType.CommitmentApproval="CommitmentApproval",WorkflowActionType.TurnoverSignature="TurnoverSignature",WorkflowActionType.ContractTrackingApproval="ContractTrackingApproval"}(WorkflowActionType||(WorkflowActionType={})),function(ActionPriority){ActionPriority.Urgent="Urgent",ActionPriority.Normal="Normal",ActionPriority.New="New"}(ActionPriority||(ActionPriority={})),function(PermissionLevel){PermissionLevel.NONE="NONE",PermissionLevel.READ_ONLY="READ_ONLY",PermissionLevel.STANDARD="STANDARD",PermissionLevel.ADMIN="ADMIN"}(PermissionLevel||(PermissionLevel={}))},"./packages/hbc-sp-services/src/utils/riskEngine.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{RISK_THRESHOLDS:()=>RISK_THRESHOLDS,determineWaiverType:()=>determineWaiverType,evaluateCommitmentRisk:()=>evaluateCommitmentRisk});const RISK_THRESHOLDS={BOND_WAIVER_MIN:5e4,HIGH_VALUE_ESCALATION:25e4,Q_SCORE_WARNING:70};function evaluateCommitmentRisk(entry){var _a,_b,_c;const triggers=[];let requiresWaiver=!1,escalationLevel="PX";const value=null!==(_a=entry.contractValue)&&void 0!==_a?_a:0;value>=RISK_THRESHOLDS.BOND_WAIVER_MIN&&!entry.bondRequired&&(triggers.push("Bond not required for contract >= $50,000"),requiresWaiver=!0),value>=RISK_THRESHOLDS.HIGH_VALUE_ESCALATION&&(entry.enrolledInSDI&&entry.bondRequired||(triggers.push("SDI/Bond compliance gap for contract >= $250,000"),requiresWaiver=!0,escalationLevel="ComplianceManager"));const qScoreWarning=(null!==(_b=entry.qScore)&&void 0!==_b?_b:100)<RISK_THRESHOLDS.Q_SCORE_WARNING;return qScoreWarning&&triggers.push(`Q-Score (${null!==(_c=entry.qScore)&&void 0!==_c?_c:"N/A"}) is below ${RISK_THRESHOLDS.Q_SCORE_WARNING} threshold`),{triggers,requiresWaiver,escalationLevel,qScoreWarning}}function determineWaiverType(entry){const missing=[];if(entry.enrolledInSDI||missing.push("SDI"),entry.bondRequired||missing.push("Bond"),0!==missing.length)return missing.length>1?"Multiple":missing[0]}},"./src/webparts/hbcProjectControls/components/contexts/AppContext.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Dv:()=>AppProvider,Us:()=>useAppContext});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),src=__webpack_require__("./packages/hbc-sp-services/src/index.ts");const STYLE_ID="hbc-fullscreen-sp-hide";function useFullScreen(){const[isFullScreen,setIsFullScreen]=react.useState(!1),spMode=react.useRef(function isInSharePoint(){return!!window.__themeState__||null!==document.querySelector("#SuiteNavWrapper")}()),enterFullScreen=react.useCallback(()=>{if(setIsFullScreen(!0),spMode.current){if(!document.getElementById(STYLE_ID)){const style=document.createElement("style");style.id=STYLE_ID,style.textContent='\n#SuiteNavWrapper,\n#spCommandBar,\n.sp-appBar,\n[data-automationid="SiteHeader"],\n.SPPageChrome,\n.CanvasZone--read .CanvasZone-topPlaceholder,\n#sp-appBar {\n  display: none !important;\n}\n',document.head.appendChild(style)}}else{const el=document.documentElement;el.requestFullscreen?el.requestFullscreen().catch(()=>{}):el.webkitRequestFullscreen&&el.webkitRequestFullscreen().catch(()=>{})}},[]),exitFullScreen=react.useCallback(()=>{if(setIsFullScreen(!1),spMode.current){const style=document.getElementById(STYLE_ID);style&&style.remove()}else{const doc=document;document.fullscreenElement?doc.exitFullscreen().catch(()=>{}):doc.webkitExitFullscreen&&doc.webkitExitFullscreen().catch(()=>{})}},[]),toggleFullScreen=react.useCallback(()=>{isFullScreen?exitFullScreen():enterFullScreen()},[isFullScreen,enterFullScreen,exitFullScreen]);return react.useEffect(()=>{if(spMode.current)return;const handleChange=()=>{document.fullscreenElement||setIsFullScreen(!1)};return document.addEventListener("fullscreenchange",handleChange),document.addEventListener("webkitfullscreenchange",handleChange),()=>{document.removeEventListener("fullscreenchange",handleChange),document.removeEventListener("webkitfullscreenchange",handleChange)}},[]),react.useEffect(()=>()=>{const style=document.getElementById(STYLE_ID);style&&style.remove()},[]),{isFullScreen,toggleFullScreen,exitFullScreen}}const AppContext=react.createContext(void 0),AppProvider=({dataService,telemetryService,siteUrl,dataServiceMode,children})=>{const resolvedTelemetry=react.useMemo(()=>{if(telemetryService)return telemetryService;const mock=new src.ZQK;return mock.initialize("","dev","Dev"),mock},[telemetryService]),[currentUser,setCurrentUser]=react.useState(null),[featureFlags,setFeatureFlags]=react.useState([]),[isLoading,setIsLoading]=react.useState(!0),[error,setError]=react.useState(null),[selectedProject,setSelectedProject]=react.useState(null),[resolvedPermissions,setResolvedPermissions]=react.useState(null),siteContext=react.useMemo(()=>siteUrl?(0,src.Ge6)(siteUrl,src.GXp):{siteUrl:src.GXp,hubSiteUrl:src.GXp,isHubSite:!0},[siteUrl]),isProjectSite=!siteContext.isHubSite&&!!siteContext.projectCode,{isFullScreen,toggleFullScreen,exitFullScreen}=useFullScreen(),isOnline=function useOnlineStatus(){const[isOnline,setIsOnline]=react.useState(()=>"undefined"==typeof navigator||navigator.onLine);return react.useEffect(()=>{const handleOnline=()=>setIsOnline(!0),handleOffline=()=>setIsOnline(!1);return window.addEventListener("online",handleOnline),window.addEventListener("offline",handleOffline),()=>{window.removeEventListener("online",handleOnline),window.removeEventListener("offline",handleOffline)}},[]),isOnline}(),handleSetSelectedProject=react.useCallback(project=>{isProjectSite&&null===project||setSelectedProject(project)},[isProjectSite]),isPermissionEngineEnabled=react.useCallback(flags=>{const flag=flags.find(f=>"PermissionEngine"===f.FeatureName);return!0===(null==flag?void 0:flag.Enabled)},[]);react.useEffect(()=>{(async()=>{var _a;src.sVR.startMark("app:contextInit");try{setIsLoading(!0),src.sVR.startMark("app:userFlagsFetch");const[user,flags]=await Promise.all([dataService.getCurrentUser(),dataService.getFeatureFlags()]);src.sVR.endMark("app:userFlagsFetch");if(!0===(null===(_a=flags.find(f=>"PermissionEngine"===f.FeatureName))||void 0===_a?void 0:_a.Enabled)){src.sVR.startMark("app:permissionResolve");try{const resolved=await dataService.resolveUserPermissions(user.email,null);user.permissions=resolved.permissions,setResolvedPermissions(resolved)}catch(_b){console.warn("Permission engine resolution failed, using role-based fallback")}src.sVR.endMark("app:permissionResolve")}if(setCurrentUser(user),setFeatureFlags(flags),isProjectSite&&siteContext.projectCode){src.sVR.startMark("app:projectAutoSelect");try{const lead=(await dataService.searchLeads(siteContext.projectCode)).find(l=>l.ProjectCode===siteContext.projectCode);lead&&setSelectedProject({projectCode:lead.ProjectCode,projectName:lead.Title,stage:lead.Stage,region:lead.Region,division:lead.Division,leadId:lead.id,siteUrl:siteContext.siteUrl})}catch(_c){console.warn("Auto-select failed for project code:",siteContext.projectCode)}src.sVR.endMark("app:projectAutoSelect")}src.sVR.endMark("app:contextInit"),src.sVR.logWebPartLoad({userEmail:user.email,siteUrl:siteUrl||window.location.href,projectCode:void 0,isProjectSite}).catch(console.warn)}catch(err){src.sVR.endMark("app:contextInit"),setError(err instanceof Error?err.message:"Failed to initialize")}finally{setIsLoading(!1)}})().catch(console.error)},[dataService,isProjectSite,siteContext]),react.useEffect(()=>{(null==selectedProject?void 0:selectedProject.siteUrl)?dataService.setProjectSiteUrl(selectedProject.siteUrl):selectedProject||dataService.setProjectSiteUrl(null)},[selectedProject,dataService]),react.useEffect(()=>{if(!currentUser||!isPermissionEngineEnabled(featureFlags))return;const projectCode=(null==selectedProject?void 0:selectedProject.projectCode)||null;dataService.resolveUserPermissions(currentUser.email,projectCode).then(resolved=>{setCurrentUser(prev=>prev?Object.assign(Object.assign({},prev),{permissions:resolved.permissions}):prev),setResolvedPermissions(resolved)}).catch(()=>{console.warn("Permission re-resolution failed for project change")})},[selectedProject,null==currentUser?void 0:currentUser.email,dataService,featureFlags,isPermissionEngineEnabled]);const hasPermission=react.useCallback(permission=>!!currentUser&&currentUser.permissions.has(permission),[currentUser]),isFeatureEnabled=react.useCallback(featureName=>{const flag=featureFlags.find(f=>f.FeatureName===featureName);return!!flag&&(!!flag.Enabled&&(!(flag.EnabledForRoles&&flag.EnabledForRoles.length>0&&currentUser)||flag.EnabledForRoles.some(role=>currentUser.roles.includes(role))))},[featureFlags,currentUser]),value=react.useMemo(()=>({dataService,telemetryService:resolvedTelemetry,currentUser,featureFlags,isLoading,error,selectedProject,setSelectedProject:handleSetSelectedProject,hasPermission,isFeatureEnabled,resolvedPermissions,isProjectSite,isFullScreen,toggleFullScreen,exitFullScreen,dataServiceMode:null!=dataServiceMode?dataServiceMode:"mock",isOnline}),[dataService,resolvedTelemetry,currentUser,featureFlags,isLoading,error,selectedProject,handleSetSelectedProject,hasPermission,isFeatureEnabled,resolvedPermissions,isProjectSite,isFullScreen,toggleFullScreen,exitFullScreen,dataServiceMode,isOnline]);return(0,jsx_runtime.jsx)(AppContext.Provider,{value,children})},useAppContext=()=>{const context=react.useContext(AppContext);if(!context)throw new Error("useAppContext must be used within AppProvider");return context};try{AppProvider.displayName="AppProvider",AppProvider.__docgenInfo={description:"",displayName:"AppProvider",props:{dataService:{defaultValue:null,description:"",name:"dataService",required:!0,type:{name:"IDataService"}},telemetryService:{defaultValue:null,description:"",name:"telemetryService",required:!1,type:{name:"ITelemetryService"}},siteUrl:{defaultValue:null,description:"",name:"siteUrl",required:!1,type:{name:"string"}},dataServiceMode:{defaultValue:null,description:"",name:"dataServiceMode",required:!1,type:{name:"enum",value:[{value:'"mock"'},{value:'"standalone"'},{value:'"sharepoint"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/contexts/AppContext.tsx#AppProvider"]={docgenInfo:AppProvider.__docgenInfo,name:"AppProvider",path:"src/webparts/hbcProjectControls/components/contexts/AppContext.tsx#AppProvider"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/components/contexts/RouterAdapterContext.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{I:()=>RouterAdapterProvider,w:()=>useRouterAdapter});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js");const RouterAdapterContext=react__WEBPACK_IMPORTED_MODULE_1__.createContext(void 0),RouterAdapterProvider=({value,children})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(RouterAdapterContext.Provider,{value,children}),useRouterAdapter=()=>{const context=react__WEBPACK_IMPORTED_MODULE_1__.useContext(RouterAdapterContext);if(!context)throw new Error("useRouterAdapter must be used within RouterAdapterProvider");return context};try{RouterAdapterProvider.displayName="RouterAdapterProvider",RouterAdapterProvider.__docgenInfo={description:"",displayName:"RouterAdapterProvider",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"IRouterAdapterValue"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/contexts/RouterAdapterContext.tsx#RouterAdapterProvider"]={docgenInfo:RouterAdapterProvider.__docgenInfo,name:"RouterAdapterProvider",path:"src/webparts/hbcProjectControls/components/contexts/RouterAdapterContext.tsx#RouterAdapterProvider"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/components/hooks/router/useAppLocation.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{W:()=>useAppLocation});var _contexts_RouterAdapterContext__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/RouterAdapterContext.tsx");function useAppLocation(){const{pathname,search}=(0,_contexts_RouterAdapterContext__WEBPACK_IMPORTED_MODULE_0__.w)();return{pathname,search}}},"./src/webparts/hbcProjectControls/components/hooks/router/useAppNavigate.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Y:()=>useAppNavigate});var _contexts_RouterAdapterContext__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/RouterAdapterContext.tsx");function useAppNavigate(){const{navigate}=(0,_contexts_RouterAdapterContext__WEBPACK_IMPORTED_MODULE_0__.w)();return navigate}},"./src/webparts/hbcProjectControls/components/shared/ToastContainer.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{d:()=>useToast,t:()=>ToastProvider});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_theme_tokens__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");const ToastContext=react__WEBPACK_IMPORTED_MODULE_1__.createContext({addToast:()=>"",dismissToast:()=>{}}),useToast=()=>react__WEBPACK_IMPORTED_MODULE_1__.useContext(ToastContext),TOAST_COLORS={success:{bg:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.successLight,border:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.success,icon:"âœ“"},error:{bg:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.errorLight,border:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.error,icon:"âœ•"},warning:{bg:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.warningLight,border:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.warning,icon:"âš "},info:{bg:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.infoLight,border:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.info,icon:"â„¹"}};let toastCounter=0;const ToastItem=({toast,onDismiss})=>{const colors=TOAST_COLORS[toast.type];return react__WEBPACK_IMPORTED_MODULE_1__.useEffect(()=>{if(0===toast.duration)return;const timer=setTimeout(()=>onDismiss(toast.id),toast.duration||4e3);return()=>clearTimeout(timer)},[toast.id,toast.duration,onDismiss]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{role:"alert",style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 16px",backgroundColor:colors.bg,borderLeft:`4px solid ${colors.border}`,borderRadius:"6px",boxShadow:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.sp.level2,fontSize:"14px",color:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray800,animation:"toastSlideIn 0.25s ease-out",maxWidth:"400px"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{style:{fontSize:"16px",flexShrink:0},children:colors.icon}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{style:{flex:1},children:toast.message}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:()=>onDismiss(toast.id),"aria-label":"Dismiss",style:{background:"none",border:"none",cursor:"pointer",fontSize:"14px",color:_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray500,padding:"2px 4px",flexShrink:0},children:"âœ•"})]})},ToastProvider=({children})=>{const[toasts,setToasts]=react__WEBPACK_IMPORTED_MODULE_1__.useState([]),addToast=react__WEBPACK_IMPORTED_MODULE_1__.useCallback((message,type="success",duration)=>{const id="toast-"+ ++toastCounter;return setToasts(prev=>[...prev,{id,message,type,duration}]),id},[]),dismissToast=react__WEBPACK_IMPORTED_MODULE_1__.useCallback(id=>{setToasts(prev=>prev.filter(t=>t.id!==id))},[]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(ToastContext.Provider,{value:{addToast,dismissToast},children:[children,toasts.length>0&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{"aria-live":"polite",style:{position:"fixed",top:"16px",right:"16px",zIndex:2e3,display:"flex",flexDirection:"column",gap:"8px"},children:toasts.map(toast=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ToastItem,{toast,onDismiss:dismissToast},toast.id))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("style",{children:"\n        @keyframes toastSlideIn {\n          from { transform: translateX(100%); opacity: 0; }\n          to { transform: translateX(0); opacity: 1; }\n        }\n        @media (prefers-reduced-motion: reduce) {\n          @keyframes toastSlideIn {\n            from { opacity: 0; }\n            to { opacity: 1; }\n          }\n        }\n      "})]})};try{ToastProvider.displayName="ToastProvider",ToastProvider.__docgenInfo={description:"",displayName:"ToastProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/shared/ToastContainer.tsx#ToastProvider"]={docgenInfo:ToastProvider.__docgenInfo,name:"ToastProvider",path:"src/webparts/hbcProjectControls/components/shared/ToastContainer.tsx#ToastProvider"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/router/index.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{fS:()=>MemoryRouter,zy:()=>useLocation,Zp:()=>useNavigate});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),RouterAdapterContext=__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/RouterAdapterContext.tsx"),useAppNavigate=__webpack_require__("./src/webparts/hbcProjectControls/components/hooks/router/useAppNavigate.ts"),useAppLocation=__webpack_require__("./src/webparts/hbcProjectControls/components/hooks/router/useAppLocation.ts");function useNavigate(){return(0,useAppNavigate.Y)()}function useLocation(){return(0,useAppLocation.W)()}const Navigate=({to,replace})=>{const navigate=useNavigate();return(void 0).useEffect(()=>{navigate(to,{replace})},[navigate,replace,to]),null},MemoryRouter=({initialEntries,children})=>{var _a;const initial=null!==(_a=null==initialEntries?void 0:initialEntries[0])&&void 0!==_a?_a:"/",initialUrl=react.useMemo(()=>new URL(initial,"http://localhost"),[initial]),[pathname,setPathname]=react.useState(initialUrl.pathname),[search,setSearch]=react.useState(initialUrl.search),value=react.useMemo(()=>({navigate:to=>{if("number"==typeof to)return;const parsed=new URL(to,"http://localhost");setPathname(parsed.pathname),setSearch(parsed.search)},pathname,search,params:{}}),[pathname,search]);return(0,jsx_runtime.jsx)(RouterAdapterContext.I,{value,children})};try{Navigate.displayName="Navigate",Navigate.__docgenInfo={description:"",displayName:"Navigate",props:{to:{defaultValue:null,description:"",name:"to",required:!0,type:{name:"string"}},replace:{defaultValue:null,description:"",name:"replace",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/router/index.tsx#Navigate"]={docgenInfo:Navigate.__docgenInfo,name:"Navigate",path:"src/webparts/hbcProjectControls/router/index.tsx#Navigate"})}catch(__react_docgen_typescript_loader_error){}try{MemoryRouter.displayName="MemoryRouter",MemoryRouter.__docgenInfo={description:"",displayName:"MemoryRouter",props:{initialEntries:{defaultValue:null,description:"",name:"initialEntries",required:!1,type:{name:"string[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/router/index.tsx#MemoryRouter"]={docgenInfo:MemoryRouter.__docgenInfo,name:"MemoryRouter",path:"src/webparts/hbcProjectControls/router/index.tsx#MemoryRouter"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/theme/hbcEChartsTheme.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{HBC_ANIMATION:()=>HBC_ANIMATION,NAVY_GRADIENT:()=>NAVY_GRADIENT,ORANGE_GRADIENT:()=>ORANGE_GRADIENT,SECTOR_COLORS:()=>SECTOR_COLORS,SUCCESS_GRADIENT:()=>SUCCESS_GRADIENT,registerHbcTheme:()=>registerHbcTheme});var echarts_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/echarts/lib/core/echarts.js"),echarts_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/echarts/lib/extension.js"),echarts_charts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/echarts/lib/chart/line/install.js"),echarts_charts__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/echarts/lib/chart/bar/install.js"),echarts_charts__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/echarts/lib/chart/pie/install.js"),echarts_charts__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/echarts/lib/chart/scatter/install.js"),echarts_charts__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/echarts/lib/chart/radar/install.js"),echarts_charts__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/echarts/lib/chart/gauge/install.js"),echarts_charts__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/echarts/lib/chart/heatmap/install.js"),echarts_components__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/echarts/lib/component/grid/install.js"),echarts_components__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/echarts/lib/component/polar/install.js"),echarts_components__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/echarts/lib/component/tooltip/install.js"),echarts_components__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/echarts/lib/component/title/install.js"),echarts_components__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/echarts/lib/component/legend/install.js"),echarts_components__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/echarts/lib/component/dataZoom/install.js"),echarts_components__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/echarts/lib/component/visualMap/install.js"),echarts_renderers__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/echarts/lib/renderer/installCanvasRenderer.js"),_tokens__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");echarts_core__WEBPACK_IMPORTED_MODULE_1__.Y([echarts_charts__WEBPACK_IMPORTED_MODULE_3__.a,echarts_charts__WEBPACK_IMPORTED_MODULE_2__.a,echarts_charts__WEBPACK_IMPORTED_MODULE_4__.a,echarts_charts__WEBPACK_IMPORTED_MODULE_5__.a,echarts_charts__WEBPACK_IMPORTED_MODULE_6__.a,echarts_charts__WEBPACK_IMPORTED_MODULE_7__.a,echarts_charts__WEBPACK_IMPORTED_MODULE_8__.a,echarts_components__WEBPACK_IMPORTED_MODULE_9__.a,echarts_components__WEBPACK_IMPORTED_MODULE_11__.a,echarts_components__WEBPACK_IMPORTED_MODULE_13__.a,echarts_components__WEBPACK_IMPORTED_MODULE_10__.a,echarts_components__WEBPACK_IMPORTED_MODULE_14__.a,echarts_components__WEBPACK_IMPORTED_MODULE_12__.a,echarts_components__WEBPACK_IMPORTED_MODULE_15__.a,echarts_renderers__WEBPACK_IMPORTED_MODULE_16__.a]);const HBC_ECHARTS_THEME_OBJ={color:[_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.navy,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.orange,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.success,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.info,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.warning,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.lightNavy,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.lightOrange,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.scoreTierHigh,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.scoreTierMid,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.scoreTierLow,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray400,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray600],backgroundColor:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.white,textStyle:{fontFamily:"'Segoe UI', system-ui, -apple-system, sans-serif",color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray700},title:{textStyle:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.navy,fontWeight:"600",fontSize:14},subtextStyle:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray500,fontSize:12}},legend:{textStyle:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray600,fontSize:12},pageTextStyle:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray500}},tooltip:{backgroundColor:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.white,borderColor:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray200,borderWidth:1,textStyle:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray700,fontSize:12},extraCssText:"\n      border-radius: 8px;\n      box-shadow: 0 4px 16px rgba(0,0,0,0.12);\n      padding: 10px 14px;\n    ",formatter:function makeTooltipFormatter(){return params=>{var _a,_b;const items=Array.isArray(params)?params:[params],rows=items.map(p=>{var _a;return`<div style="display:flex;align-items:center;gap:8px;margin-bottom:2px">\n             ${null!==(_a=p.marker)&&void 0!==_a?_a:""}\n             <span style="font-size:12px;color:${_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray600};flex:1">${p.seriesName}</span>\n             <span style="font-size:13px;font-weight:600;color:${_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.navy}">${p.value}</span>\n           </div>`}).join(""),name=null!==(_b=null===(_a=items[0])||void 0===_a?void 0:_a.name)&&void 0!==_b?_b:"";return`\n      <div style="font-family:'Segoe UI',system-ui,sans-serif;padding:4px 0">\n        <div style="font-size:11px;color:${_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray400};margin-bottom:6px;font-weight:500">${name}</div>\n        ${rows}\n      </div>`}}()},grid:{borderColor:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray200,containLabel:!0},categoryAxis:{axisLine:{show:!0,lineStyle:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray200}},axisTick:{show:!1},axisLabel:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray500,fontSize:12},splitLine:{show:!1}},valueAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray500,fontSize:12},splitLine:{lineStyle:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray100,type:"dashed"}}},line:{smooth:!1,symbol:"circle",symbolSize:6,lineStyle:{width:2}},bar:{barMaxWidth:60,itemStyle:{borderRadius:[4,4,0,0]}},pie:{itemStyle:{borderWidth:2,borderColor:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.white}},radar:{axisLine:{lineStyle:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray200}},splitLine:{lineStyle:{color:_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray100}},splitArea:{areaStyle:{color:[_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray50,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.white]}}}};let _registered=!1;function registerHbcTheme(){_registered||(echarts_core__WEBPACK_IMPORTED_MODULE_0__.bf("hbc",HBC_ECHARTS_THEME_OBJ),_registered=!0)}const HBC_ANIMATION={duration:600,easing:"cubicOut",durationUpdate:300,easingUpdate:"cubicInOut"},NAVY_GRADIENT={type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:`${_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.navy}40`},{offset:1,color:`${_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.navy}00`}]},ORANGE_GRADIENT={type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:`${_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.orange}40`},{offset:1,color:`${_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.orange}00`}]},SUCCESS_GRADIENT={type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:`${_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.success}40`},{offset:1,color:`${_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.success}00`}]},SECTOR_COLORS=[_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.navy,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.orange,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.success,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.info,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.warning,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.lightNavy,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.lightOrange,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray400,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.scoreTierHigh,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.scoreTierMid,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.scoreTierLow,_tokens__WEBPACK_IMPORTED_MODULE_17__.rf.gray600]},"./src/webparts/hbcProjectControls/theme/tokens.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{EP:()=>RISK_INDICATOR,LO:()=>BREAKPOINTS,mF:()=>TRANSITION,rf:()=>HBC_COLORS,sp:()=>ELEVATION});const HBC_COLORS={navy:"#1B2A4A",orange:"#B45309",white:"#FFFFFF",lightNavy:"#2C3E6B",darkNavy:"#0F1A2E",lightOrange:"#F5A623",darkOrange:"#C45E0A",gray50:"#F9FAFB",gray100:"#F3F4F6",gray200:"#E5E7EB",gray300:"#D1D5DB",gray400:"#6B7280",gray500:"#4B5563",gray600:"#4B5563",gray700:"#374151",gray800:"#1F2937",gray900:"#111827",textGray:"#4B5563",textOrangeLarge:"#C45E0A",success:"#047857",successLight:"#D1FAE5",warning:"#B45309",warningLight:"#FEF3C7",error:"#B42318",errorLight:"#FEE2E2",info:"#1D4ED8",infoLight:"#DBEAFE",scoreTierHigh:"#10B981",scoreTierMid:"#F59E0B",scoreTierLow:"#EF4444"},BREAKPOINTS={mobile:768,tablet:1024,desktop:1024},ELEVATION={level0:"none",level1:"0 1px 2px rgba(0,0,0,0.06), 0 1px 3px rgba(0,0,0,0.1)",level2:"0 2px 6px rgba(0,0,0,0.1), 0 4px 12px rgba(0,0,0,0.08)",level3:"0 4px 16px rgba(0,0,0,0.12)",level4:"0 8px 32px rgba(0,0,0,0.18)"},TRANSITION={fast:"150ms ease",normal:"250ms ease",slow:"350ms ease"},RISK_INDICATOR={style:(color,glow)=>Object.assign({borderLeft:`4px solid ${color}`},glow?{boxShadow:`inset 3px 0 8px -4px ${color}40`}:{}),colors:{critical:HBC_COLORS.error,warning:HBC_COLORS.warning,success:HBC_COLORS.success,info:HBC_COLORS.info,neutral:HBC_COLORS.gray300}}},"./src lazy recursive ^\\.\\/.*$ include: (?%21.*node_modules)(?:\\/src(?:\\/(?%21\\.)(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/%7C\\/%7C$)(?%21\\.)(?=.)[^/]*?\\.stories\\.(ts%7Ctsx%7Cmdx))$"(module,__unused_webpack_exports,__webpack_require__){var map={"./webparts/hbcProjectControls/components/guards/FeatureGate.stories":["./src/webparts/hbcProjectControls/components/guards/FeatureGate.stories.tsx",[634]],"./webparts/hbcProjectControls/components/guards/FeatureGate.stories.tsx":["./src/webparts/hbcProjectControls/components/guards/FeatureGate.stories.tsx",[634]],"./webparts/hbcProjectControls/components/guards/RoleGate.stories":["./src/webparts/hbcProjectControls/components/guards/RoleGate.stories.tsx",[470]],"./webparts/hbcProjectControls/components/guards/RoleGate.stories.tsx":["./src/webparts/hbcProjectControls/components/guards/RoleGate.stories.tsx",[470]],"./webparts/hbcProjectControls/components/layouts/NavigationSidebar.stories":["./src/webparts/hbcProjectControls/components/layouts/NavigationSidebar.stories.tsx",[445,558,867,267,309,36]],"./webparts/hbcProjectControls/components/layouts/NavigationSidebar.stories.tsx":["./src/webparts/hbcProjectControls/components/layouts/NavigationSidebar.stories.tsx",[445,558,867,267,309,36]],"./webparts/hbcProjectControls/components/pages/project/BuyoutLogPage.stories":["./src/webparts/hbcProjectControls/components/pages/project/BuyoutLogPage.stories.tsx",[267,654,309,76]],"./webparts/hbcProjectControls/components/pages/project/BuyoutLogPage.stories.tsx":["./src/webparts/hbcProjectControls/components/pages/project/BuyoutLogPage.stories.tsx",[267,654,309,76]],"./webparts/hbcProjectControls/components/pages/project/MonthlyProjectReview.stories":["./src/webparts/hbcProjectControls/components/pages/project/MonthlyProjectReview.stories.tsx",[445,558,867,235]],"./webparts/hbcProjectControls/components/pages/project/MonthlyProjectReview.stories.tsx":["./src/webparts/hbcProjectControls/components/pages/project/MonthlyProjectReview.stories.tsx",[445,558,867,235]],"./webparts/hbcProjectControls/components/pages/project/SchedulePage.stories":["./src/webparts/hbcProjectControls/components/pages/project/SchedulePage.stories.tsx",[445,558,867,506,491]],"./webparts/hbcProjectControls/components/pages/project/SchedulePage.stories.tsx":["./src/webparts/hbcProjectControls/components/pages/project/SchedulePage.stories.tsx",[445,558,867,506,491]],"./webparts/hbcProjectControls/components/shared/EmptyState.stories":["./src/webparts/hbcProjectControls/components/shared/EmptyState.stories.tsx",[146]],"./webparts/hbcProjectControls/components/shared/EmptyState.stories.tsx":["./src/webparts/hbcProjectControls/components/shared/EmptyState.stories.tsx",[146]],"./webparts/hbcProjectControls/components/shared/HbcEChart.stories":["./src/webparts/hbcProjectControls/components/shared/HbcEChart.stories.tsx",[445,558,778]],"./webparts/hbcProjectControls/components/shared/HbcEChart.stories.tsx":["./src/webparts/hbcProjectControls/components/shared/HbcEChart.stories.tsx",[445,558,778]],"./webparts/hbcProjectControls/components/shared/HbcTanStackTable.stories":["./src/webparts/hbcProjectControls/components/shared/HbcTanStackTable.stories.tsx",[445,558,867,961,272,894]],"./webparts/hbcProjectControls/components/shared/HbcTanStackTable.stories.tsx":["./src/webparts/hbcProjectControls/components/shared/HbcTanStackTable.stories.tsx",[445,558,867,961,272,894]],"./webparts/hbcProjectControls/components/shared/KPICard.stories":["./src/webparts/hbcProjectControls/components/shared/KPICard.stories.tsx",[445,558,867,696]],"./webparts/hbcProjectControls/components/shared/KPICard.stories.tsx":["./src/webparts/hbcProjectControls/components/shared/KPICard.stories.tsx",[445,558,867,696]],"./webparts/hbcProjectControls/components/shared/PageHeader.stories":["./src/webparts/hbcProjectControls/components/shared/PageHeader.stories.tsx",[445,558,867,282]],"./webparts/hbcProjectControls/components/shared/PageHeader.stories.tsx":["./src/webparts/hbcProjectControls/components/shared/PageHeader.stories.tsx",[445,558,867,282]],"./webparts/hbcProjectControls/components/shared/StatusBadge.stories":["./src/webparts/hbcProjectControls/components/shared/StatusBadge.stories.tsx",[445,867,115]],"./webparts/hbcProjectControls/components/shared/StatusBadge.stories.tsx":["./src/webparts/hbcProjectControls/components/shared/StatusBadge.stories.tsx",[445,867,115]]};function webpackAsyncContext(req){if(!__webpack_require__.o(map,req))return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e});var ids=map[req],id=ids[0];return Promise.all(ids[1].map(__webpack_require__.e)).then(()=>__webpack_require__(id))}webpackAsyncContext.keys=()=>Object.keys(map),webpackAsyncContext.id="./src lazy recursive ^\\.\\/.*$ include: (?%21.*node_modules)(?:\\/src(?:\\/(?%21\\.)(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/%7C\\/%7C$)(?%21\\.)(?=.)[^/]*?\\.stories\\.(ts%7Ctsx%7Cmdx))$",module.exports=webpackAsyncContext},"storybook/internal/channels"(module){"use strict";module.exports=__STORYBOOK_MODULE_CHANNELS__},"storybook/internal/client-logger"(module){"use strict";module.exports=__STORYBOOK_MODULE_CLIENT_LOGGER__},"storybook/internal/preview-errors"(module){"use strict";module.exports=__STORYBOOK_MODULE_CORE_EVENTS_PREVIEW_ERRORS__},"storybook/internal/core-events"(module){"use strict";module.exports=__STORYBOOK_MODULE_CORE_EVENTS__},"@storybook/global"(module){"use strict";module.exports=__STORYBOOK_MODULE_GLOBAL__},"storybook/internal/preview-api"(module){"use strict";module.exports=__STORYBOOK_MODULE_PREVIEW_API__},"./packages/hbc-sp-services/src/mock/templateRegistry.json"(module){"use strict";module.exports=JSON.parse('[{"id":1,"TemplateName":"Subcontractor Agreement","SourceURL":"/sites/Templates/Contracts/SubcontractorAgreement.docx","TargetFolder":"00_Project_Admin/Contracts/Templates","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-001","fileSize":52000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":2,"TemplateName":"GMP Amendment","SourceURL":"/sites/Templates/Contracts/GMPAmendment.docx","TargetFolder":"00_Project_Admin/Contracts/Templates","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-002","fileSize":52000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":3,"TemplateName":"Change Order Template","SourceURL":"/sites/Templates/Contracts/ChangeOrder.docx","TargetFolder":"00_Project_Admin/Change_Orders","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-003","fileSize":52000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":4,"TemplateName":"Safety Plan Template","SourceURL":"/sites/Templates/Safety/SafetyPlan.docx","TargetFolder":"02_Safety/Plans","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-004","fileSize":52000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":5,"TemplateName":"Quality Control Plan","SourceURL":"/sites/Templates/Quality/QCPlan.docx","TargetFolder":"03_Quality_Control","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-005","fileSize":52000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":6,"TemplateName":"Schedule Template","SourceURL":"/sites/Templates/Scheduling/MasterSchedule.mpp","TargetFolder":"10_Scheduling","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-006","fileSize":102000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":7,"TemplateName":"Budget Template","SourceURL":"/sites/Templates/Budget/ProjectBudget.xlsx","TargetFolder":"05_Budget","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-007","fileSize":31000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":8,"TemplateName":"RFI Log","SourceURL":"/sites/Templates/Admin/RFILog.xlsx","TargetFolder":"00_Project_Admin/RFI","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-008","fileSize":31000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":9,"TemplateName":"Submittal Log","SourceURL":"/sites/Templates/Admin/SubmittalLog.xlsx","TargetFolder":"00_Project_Admin/Submittals","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-009","fileSize":31000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":10,"TemplateName":"Luxury Finish Schedule","SourceURL":"/sites/Templates/LuxRes/FinishSchedule.xlsx","TargetFolder":"04_Design/Finish_Schedules","Division":"Luxury Residential","Active":true,"fileHash":"sha256:placeholder-hash-010","fileSize":31000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":11,"TemplateName":"Preconstruction Proposal","SourceURL":"/sites/Templates/Precon/PreconProposal.docx","TargetFolder":"01_Preconstruction/Proposals","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-011","fileSize":52000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"},{"id":12,"TemplateName":"Turnover Checklist","SourceURL":"/sites/Templates/Ops/TurnoverChecklist.xlsx","TargetFolder":"00_Project_Admin/Turnover","Division":"Both","Active":true,"fileHash":"sha256:placeholder-hash-012","fileSize":31000,"lastModifiedInTemplateSite":"2026-01-15T10:00:00Z"}]')}},__webpack_require__=>{__webpack_require__.O(0,[447],()=>{return moduleId="./storybook-config-entry.js",__webpack_require__(__webpack_require__.s=moduleId);var moduleId});__webpack_require__.O()}]);