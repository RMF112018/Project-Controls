"use strict";(self.webpackChunkhbc_project_controls=self.webpackChunkhbc_project_controls||[]).push([[235],{"./src/webparts/hbcProjectControls/components/pages/project/MonthlyProjectReview.stories.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>MonthlyProjectReview_stories});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),router=__webpack_require__("./src/webparts/hbcProjectControls/router/index.tsx"),AppContext=__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/AppContext.tsx"),SignalRContext=__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/SignalRContext.tsx"),useSignalR=__webpack_require__("./src/webparts/hbcProjectControls/components/hooks/useSignalR.ts"),src=__webpack_require__("./packages/hbc-sp-services/src/index.ts");var PageHeader=__webpack_require__("./src/webparts/hbcProjectControls/components/shared/PageHeader.tsx"),Breadcrumb=__webpack_require__("./src/webparts/hbcProjectControls/components/shared/Breadcrumb.tsx"),SkeletonLoader=__webpack_require__("./src/webparts/hbcProjectControls/components/shared/SkeletonLoader.tsx"),tokens=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");const STATUS_STEPS=["NotStarted","InProgress","PendingPXReview","PXReviewComplete","PMRevising","PendingPXValidation","SubmittedToLeadership","FollowUpPending","Complete"],STATUS_LABELS={NotStarted:"Not Started",InProgress:"In Progress",PendingPXReview:"PX Review",PXReviewComplete:"PX Complete",PMRevising:"PM Revising",PendingPXValidation:"PX Validation",SubmittedToLeadership:"Leadership",FollowUpPending:"Follow-Up",Complete:"Complete"},cardStyle={backgroundColor:"#fff",borderRadius:8,padding:20,boxShadow:tokens.sp.level1,marginBottom:12},MonthlyProjectReview=()=>{var _a,_b;const location=(0,router.zy)(),breadcrumbs=(0,src.ZFx)(location.pathname),{selectedProject,hasPermission,dataService,currentUser}=(0,AppContext.Us)(),{reviews,currentReview,isLoading,error,fetchReviews,createReview,updateReview,advanceStatus,addFollowUp,selectReview}=function useMonthlyReview(){const{dataService,currentUser}=(0,AppContext.Us)(),{broadcastChange}=(0,SignalRContext.$)(),[reviews,setReviews]=react.useState([]),[currentReview,setCurrentReview]=react.useState(null),[isLoading,setIsLoading]=react.useState(!1),[error,setError]=react.useState(null),lastProjectCodeRef=react.useRef(null),fetchReviews=react.useCallback(async projectCode=>{try{setIsLoading(!0),setError(null),lastProjectCodeRef.current=projectCode;const result=await dataService.getMonthlyReviews(projectCode);setReviews(result),result.length>0&&!currentReview&&setCurrentReview(result[0])}catch(err){setError(err instanceof Error?err.message:"Failed to fetch monthly reviews")}finally{setIsLoading(!1)}},[dataService,currentReview]);(0,useSignalR.k)({entityType:src.ckT.MonthlyReview,onEntityChanged:react.useCallback(()=>{lastProjectCodeRef.current&&fetchReviews(lastProjectCodeRef.current)},[fetchReviews])});const broadcastMonthlyReviewChange=react.useCallback((entityId,action,summary)=>{var _a;broadcastChange({type:"EntityChanged",entityType:src.ckT.MonthlyReview,entityId:String(entityId),action,changedBy:null!==(_a=null==currentUser?void 0:currentUser.email)&&void 0!==_a?_a:"unknown",changedByName:null==currentUser?void 0:currentUser.displayName,timestamp:(new Date).toISOString(),summary,projectCode:lastProjectCodeRef.current||void 0})},[broadcastChange,currentUser]),createReview=react.useCallback(async data=>{const created=await dataService.createMonthlyReview(data);return setReviews(prev=>[created,...prev]),setCurrentReview(created),broadcastMonthlyReviewChange(created.id,"created","Monthly review created"),created},[dataService,broadcastMonthlyReviewChange]),updateReview=react.useCallback(async(reviewId,data)=>{const updated=await dataService.updateMonthlyReview(reviewId,data);setReviews(prev=>prev.map(r=>r.id===reviewId?updated:r)),(null==currentReview?void 0:currentReview.id)===reviewId&&setCurrentReview(updated),broadcastMonthlyReviewChange(reviewId,"updated","Monthly review updated")},[dataService,currentReview,broadcastMonthlyReviewChange]),advanceStatus=react.useCallback(async(reviewId,newStatus)=>{const dateField={PendingPXReview:"pmSubmittedDate",PXReviewComplete:"pxReviewDate",PendingPXValidation:"pxValidationDate",SubmittedToLeadership:"leadershipSubmitDate",Complete:"completedDate"}[newStatus],updateData={status:newStatus};dateField&&(updateData[dateField]=(new Date).toISOString());const updated=await dataService.updateMonthlyReview(reviewId,updateData);setReviews(prev=>prev.map(r=>r.id===reviewId?updated:r)),(null==currentReview?void 0:currentReview.id)===reviewId&&setCurrentReview(updated),broadcastMonthlyReviewChange(reviewId,"updated",`Monthly review status advanced to ${newStatus}`),dataService.syncToDataMart(updated.projectCode).catch(()=>{})},[dataService,currentReview,broadcastMonthlyReviewChange]),addFollowUp=react.useCallback(async(reviewId,followUp)=>{var _a,_b,_c;const review=reviews.find(r=>r.id===reviewId);if(!review)return;const newFollowUp={id:Date.now(),question:null!==(_a=followUp.question)&&void 0!==_a?_a:"",requestedBy:null!==(_b=followUp.requestedBy)&&void 0!==_b?_b:"",requestedDate:null!==(_c=followUp.requestedDate)&&void 0!==_c?_c:(new Date).toISOString().split("T")[0],pmResponse:"",responseDate:null,pxForwardedDate:null,status:"Open"},updatedFollowUps=[...review.followUps,newFollowUp];await updateReview(reviewId,{followUps:updatedFollowUps}),broadcastMonthlyReviewChange(reviewId,"updated","Follow-up added to monthly review")},[reviews,updateReview,broadcastMonthlyReviewChange]),selectReview=react.useCallback(reviewId=>{const review=reviews.find(r=>r.id===reviewId);review&&setCurrentReview(review)},[reviews]);return{reviews,currentReview,isLoading,error,fetchReviews,createReview,updateReview,advanceStatus,addFollowUp,selectReview}}(),projectCode=null!==(_a=null==selectedProject?void 0:selectedProject.projectCode)&&void 0!==_a?_a:"",isPM=hasPermission(src.JjK.MONTHLY_REVIEW_PM),isPX=hasPermission(src.JjK.MONTHLY_REVIEW_PX),canCreate=hasPermission(src.JjK.MONTHLY_REVIEW_CREATE),[expandedSections,setExpandedSections]=react.useState(new Set),[newFollowUpQuestion,setNewFollowUpQuestion]=react.useState("");react.useEffect(()=>{projectCode&&fetchReviews(projectCode).catch(console.error)},[projectCode,fetchReviews]);const handleCreateReview=react.useCallback(async()=>{var _a;const now=new Date,reviewMonth=`${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,"0")}`,dueDate=new Date(now.getFullYear(),now.getMonth()+1,10).toISOString().split("T")[0],checklistItems=[];let itemId=1;src.AMU.forEach(sec=>{sec.items.forEach(item=>{checklistItems.push({id:itemId++,sectionKey:sec.key,sectionTitle:sec.title,itemKey:item.key,itemDescription:item.description,pmComment:"",pxComment:"",pxInitial:""})})}),await createReview({projectCode,reviewMonth,dueDate,checklistItems}),dataService.logAudit({Action:src.IM5.MonthlyReviewSubmitted,EntityType:src.ckT.MonthlyReview,EntityId:projectCode,User:null!==(_a=null==currentUser?void 0:currentUser.email)&&void 0!==_a?_a:"",Details:`Created review for ${reviewMonth}`,ProjectCode:projectCode}).catch(console.error)},[projectCode,createReview,dataService,currentUser]),handleChecklistBlur=react.useCallback(async(itemId,field,value)=>{if(!currentReview)return;const updatedItems=currentReview.checklistItems.map(item=>item.id===itemId?Object.assign(Object.assign({},item),{[field]:value}):item);await updateReview(currentReview.id,{checklistItems:updatedItems})},[currentReview,updateReview]),handleAdvance=react.useCallback(async newStatus=>{var _a;currentReview&&(await advanceStatus(currentReview.id,newStatus),dataService.logAudit({Action:src.IM5.MonthlyReviewAdvanced,EntityType:src.ckT.MonthlyReview,EntityId:String(currentReview.id),User:null!==(_a=null==currentUser?void 0:currentUser.email)&&void 0!==_a?_a:"",Details:`Status → ${newStatus}`,ProjectCode:projectCode}).catch(console.error))},[currentReview,advanceStatus,dataService,currentUser,projectCode]),handleAddFollowUp=react.useCallback(async()=>{var _a;currentReview&&newFollowUpQuestion.trim()&&(await addFollowUp(currentReview.id,{question:newFollowUpQuestion,requestedBy:null!==(_a=null==currentUser?void 0:currentUser.email)&&void 0!==_a?_a:""}),setNewFollowUpQuestion(""))},[currentReview,newFollowUpQuestion,addFollowUp,currentUser]);if(isLoading)return(0,jsx_runtime.jsx)(SkeletonLoader.j,{variant:"table",rows:6,columns:4});if(error)return(0,jsx_runtime.jsx)("div",{style:{padding:24,color:tokens.rf.error},children:error});const nextAction=(()=>{if(!currentReview)return null;const s=currentReview.status;return isPM&&"InProgress"===s?{label:"Submit to PX",status:"PendingPXReview"}:isPX&&"PendingPXReview"===s?{label:"Complete PX Review",status:"PXReviewComplete"}:isPM&&"PXReviewComplete"===s?{label:"Mark as Revised",status:"PendingPXValidation"}:isPM&&"PMRevising"===s?{label:"Resubmit",status:"PendingPXValidation"}:isPX&&"PendingPXValidation"===s?{label:"Submit to Leadership",status:"SubmittedToLeadership"}:isPX&&"SubmittedToLeadership"===s||isPX&&"FollowUpPending"===s?{label:"Complete Review",status:"Complete"}:null})();return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(PageHeader.z,{title:"Monthly Project Review",subtitle:projectCode,breadcrumb:(0,jsx_runtime.jsx)(Breadcrumb.Q,{items:breadcrumbs})}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:16,alignItems:"center",flexWrap:"wrap"},children:[(0,jsx_runtime.jsxs)("select",{value:null!==(_b=null==currentReview?void 0:currentReview.id)&&void 0!==_b?_b:"",onChange:e=>selectReview(parseInt(e.target.value)),style:{border:`1px solid ${tokens.rf.gray200}`,borderRadius:4,padding:"8px 12px",fontSize:13},children:[reviews.map(r=>(0,jsx_runtime.jsxs)("option",{value:r.id,children:[r.reviewMonth," — ",STATUS_LABELS[r.status]]},r.id)),0===reviews.length&&(0,jsx_runtime.jsx)("option",{value:"",children:"No reviews"})]}),(canCreate||isPX)&&(0,jsx_runtime.jsx)("button",{onClick:handleCreateReview,style:{padding:"8px 16px",backgroundColor:tokens.rf.navy,color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:13},children:"+ New Review"})]}),currentReview&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{style:Object.assign(Object.assign({},cardStyle),{padding:16}),children:[(0,jsx_runtime.jsx)("div",{style:{display:"flex",gap:2,alignItems:"center"},children:STATUS_STEPS.map((step,i)=>{const stepIndex=STATUS_STEPS.indexOf(currentReview.status),isActive=i===stepIndex,isDone=i<stepIndex;return(0,jsx_runtime.jsxs)(react.Fragment,{children:[i>0&&(0,jsx_runtime.jsx)("div",{style:{flex:1,height:2,backgroundColor:isDone?tokens.rf.success:tokens.rf.gray200}}),(0,jsx_runtime.jsx)("div",{style:{width:20,height:20,borderRadius:"50%",backgroundColor:isDone?tokens.rf.success:isActive?tokens.rf.orange:tokens.rf.gray200,display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,color:isDone||isActive?"#fff":tokens.rf.gray400,fontWeight:600,flexShrink:0},title:STATUS_LABELS[step],children:isDone?"✓":i+1})]},step)})}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8},children:[(0,jsx_runtime.jsxs)("span",{style:{fontSize:12,color:tokens.rf.gray500},children:["Due: ",currentReview.dueDate]}),(0,jsx_runtime.jsx)("span",{style:{fontSize:12,fontWeight:600,color:tokens.rf.navy},children:STATUS_LABELS[currentReview.status]})]}),nextAction&&(0,jsx_runtime.jsx)("button",{onClick:()=>handleAdvance(nextAction.status),style:{marginTop:12,padding:"8px 20px",backgroundColor:tokens.rf.orange,color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:13,fontWeight:600},children:nextAction.label})]}),src.AMU.map(sec=>{const sectionItems=currentReview.checklistItems.filter(i=>i.sectionKey===sec.key),isExpanded=expandedSections.has(sec.key);return(0,jsx_runtime.jsxs)("div",{style:Object.assign(Object.assign({},cardStyle),{overflow:"hidden",padding:0}),children:[(0,jsx_runtime.jsx)("div",{onClick:()=>{return key=sec.key,void setExpandedSections(prev=>{const next=new Set(prev);return next.has(key)?next.delete(key):next.add(key),next});var key},style:{padding:"14px 20px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:isExpanded?tokens.rf.gray50:"#fff"},children:(0,jsx_runtime.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,jsx_runtime.jsx)("span",{style:{fontSize:14,color:tokens.rf.gray400},children:isExpanded?"▼":"▶"}),(0,jsx_runtime.jsx)("span",{style:{fontWeight:600,color:tokens.rf.navy,fontSize:14},children:sec.title}),(0,jsx_runtime.jsxs)("span",{style:{fontSize:11,color:tokens.rf.gray400},children:["(",sectionItems.length," items)"]})]})}),isExpanded&&(0,jsx_runtime.jsx)("div",{style:{padding:"0 20px 16px"},children:sectionItems.map(item=>(0,jsx_runtime.jsxs)("div",{style:{borderBottom:`1px solid ${tokens.rf.gray100}`,padding:"12px 0"},children:[(0,jsx_runtime.jsx)("div",{style:{fontSize:13,fontWeight:500,marginBottom:8},children:item.itemDescription}),(0,jsx_runtime.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 60px",gap:8},children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{style:{fontSize:10,color:tokens.rf.gray400},children:"PM Comment"}),(0,jsx_runtime.jsx)("textarea",{defaultValue:item.pmComment,onBlur:e=>handleChecklistBlur(item.id,"pmComment",e.target.value),disabled:!isPM,style:{width:"100%",border:`1px solid ${tokens.rf.gray200}`,borderRadius:4,padding:6,fontSize:12,minHeight:40,resize:"vertical"}})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{style:{fontSize:10,color:tokens.rf.gray400},children:"PX Comment"}),(0,jsx_runtime.jsx)("textarea",{defaultValue:item.pxComment,onBlur:e=>handleChecklistBlur(item.id,"pxComment",e.target.value),disabled:!isPX,style:{width:"100%",border:`1px solid ${tokens.rf.gray200}`,borderRadius:4,padding:6,fontSize:12,minHeight:40,resize:"vertical"}})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{style:{fontSize:10,color:tokens.rf.gray400},children:"PX Init."}),(0,jsx_runtime.jsx)("input",{defaultValue:item.pxInitial,onBlur:e=>handleChecklistBlur(item.id,"pxInitial",e.target.value),disabled:!isPX,style:{width:"100%",border:`1px solid ${tokens.rf.gray200}`,borderRadius:4,padding:6,fontSize:12,textAlign:"center"}})]})]})]},item.id))})]},sec.key)}),(0,jsx_runtime.jsxs)("div",{style:cardStyle,children:[(0,jsx_runtime.jsx)("h3",{style:{margin:"0 0 12px",color:tokens.rf.navy,fontSize:16},children:"Follow-Up Items"}),currentReview.followUps.map(fu=>(0,jsx_runtime.jsxs)("div",{style:{borderBottom:`1px solid ${tokens.rf.gray100}`,padding:"10px 0"},children:[(0,jsx_runtime.jsx)("div",{style:{fontSize:13,fontWeight:500},children:fu.question}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",gap:16,fontSize:11,color:tokens.rf.gray400,marginTop:4},children:[(0,jsx_runtime.jsxs)("span",{children:["By: ",fu.requestedBy.split("@")[0]]}),(0,jsx_runtime.jsx)("span",{children:fu.requestedDate}),(0,jsx_runtime.jsx)("span",{style:{padding:"1px 6px",borderRadius:10,fontSize:10,fontWeight:600,backgroundColor:"Closed"===fu.status?`${tokens.rf.success}20`:`${tokens.rf.warning}20`,color:"Closed"===fu.status?tokens.rf.success:tokens.rf.warning},children:fu.status})]}),fu.pmResponse&&(0,jsx_runtime.jsxs)("div",{style:{fontSize:12,marginTop:4,backgroundColor:tokens.rf.gray50,padding:"6px 8px",borderRadius:4},children:["Response: ",fu.pmResponse]})]},fu.id)),isPX&&(0,jsx_runtime.jsxs)("div",{style:{display:"flex",gap:8,marginTop:12},children:[(0,jsx_runtime.jsx)("input",{value:newFollowUpQuestion,onChange:e=>setNewFollowUpQuestion(e.target.value),placeholder:"Add follow-up question...",style:{flex:1,border:`1px solid ${tokens.rf.gray200}`,borderRadius:4,padding:"8px",fontSize:13}}),(0,jsx_runtime.jsx)("button",{onClick:handleAddFollowUp,style:{padding:"8px 16px",backgroundColor:tokens.rf.navy,color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:13},children:"Add"})]})]}),currentReview.reportDocumentUrls.length>0&&(0,jsx_runtime.jsxs)("div",{style:cardStyle,children:[(0,jsx_runtime.jsx)("h3",{style:{margin:"0 0 8px",color:tokens.rf.navy,fontSize:14},children:"Report Documents"}),currentReview.reportDocumentUrls.map((url,i)=>(0,jsx_runtime.jsx)("div",{style:{fontSize:12,marginBottom:4},children:(0,jsx_runtime.jsx)("a",{href:url,target:"_blank",rel:"noopener noreferrer",style:{color:"#3B82F6"},children:url.split("/").pop()})},i))]})]}),!currentReview&&0===reviews.length&&(0,jsx_runtime.jsx)("div",{style:{padding:48,textAlign:"center",color:tokens.rf.gray400},children:"No monthly reviews yet. Create one to get started."})]})};try{MonthlyProjectReview.displayName="MonthlyProjectReview",MonthlyProjectReview.__docgenInfo={description:"",displayName:"MonthlyProjectReview",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/pages/project/MonthlyProjectReview.tsx#MonthlyProjectReview"]={docgenInfo:MonthlyProjectReview.__docgenInfo,name:"MonthlyProjectReview",path:"src/webparts/hbcProjectControls/components/pages/project/MonthlyProjectReview.tsx#MonthlyProjectReview"})}catch(__react_docgen_typescript_loader_error){}const MonthlyProjectReview_stories={title:"Pages/MonthlyProjectReview",component:MonthlyProjectReview,tags:["autodocs"],parameters:{layout:"fullscreen",initialRoute:"/operations/monthly-review"}},Default={},__namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{}",...Default.parameters?.docs?.source}}}},"./src/webparts/hbcProjectControls/components/contexts/SignalRContext.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$:()=>useSignalRContext});__webpack_require__("./node_modules/react/jsx-runtime.js");var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js");__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/AppContext.tsx"),__webpack_require__("./packages/hbc-sp-services/src/index.ts");const SignalRContext=react__WEBPACK_IMPORTED_MODULE_1__.createContext({connectionStatus:"disconnected",isEnabled:!1,subscribe:()=>()=>{},broadcastChange:()=>{}}),useSignalRContext=()=>react__WEBPACK_IMPORTED_MODULE_1__.useContext(SignalRContext),SignalRProvider=({children})=>{const{isFeatureEnabled,selectedProject}=(void 0)(),isEnabled=isFeatureEnabled("RealTimeUpdates"),[connectionStatus,setConnectionStatus]=(void 0).useState((void 0).status),prevProjectRef=(void 0).useRef(null);(void 0).useEffect(()=>(void 0).onStatusChange(setConnectionStatus),[]),(void 0).useEffect(()=>{isEnabled?(void 0).connect():(void 0).disconnect()},[isEnabled]),(void 0).useEffect(()=>{if(!isEnabled||"connected"!==connectionStatus)return;const prevCode=prevProjectRef.current,newCode=(null==selectedProject?void 0:selectedProject.projectCode)||null;prevCode!==newCode&&(prevCode&&(void 0).leaveGroup(`project:${prevCode.toLowerCase()}`),newCode&&(void 0).joinGroup(`project:${newCode.toLowerCase()}`),prevProjectRef.current=newCode)},[isEnabled,connectionStatus,selectedProject]),(void 0).useEffect(()=>{if(!isEnabled)return;return(void 0).subscribe("EntityChanged",msg=>{if("EntityChanged"!==msg.type)return;const entityMsg=msg;(function entityTypeToCacheKeys(entityType,projectCode){const keys=[],baseKeys={[(void 0).Lead]:[(void 0).LEADS],[(void 0).Scorecard]:[(void 0).SCORECARDS],[(void 0).Estimate]:[(void 0).ESTIMATES,(void 0).KICKOFFS],[(void 0).Project]:[(void 0).PROJECTS,(void 0).ACTIVE_PROJECTS,(void 0).PORTFOLIO_SUMMARY,(void 0).PERSONNEL_WORKLOAD,(void 0).DATA_MART],[(void 0).Meeting]:[(void 0).MEETINGS],[(void 0).ProjectRecord]:[(void 0).MARKETING_RECORDS],[(void 0).Permission]:[(void 0).PERMISSIONS],[(void 0).PermissionTemplate]:[(void 0).TEMPLATES],[(void 0).ProjectTeamAssignment]:[(void 0).PERMISSIONS,(void 0).ASSIGNMENTS,(void 0).ACCESSIBLE_PROJECTS],[(void 0).Config]:[(void 0).CONFIG,(void 0).FEATURE_FLAGS,(void 0).SECTORS],[(void 0).WorkflowDefinition]:[(void 0).WORKFLOWS],[(void 0).AssignmentMapping]:[(void 0).ASSIGNMENTS],[(void 0).Quality]:[(void 0).QUALITY],[(void 0).Safety]:[(void 0).SAFETY],[(void 0).RiskCost]:[(void 0).RISK_COST,(void 0).BUYOUT],[(void 0).Schedule]:[(void 0).SCHEDULE],[(void 0).SuperintendentPlan]:[(void 0).SUPER_PLAN],[(void 0).LessonLearned]:[(void 0).LESSONS],[(void 0).PMP]:[(void 0).PMP],[(void 0).MonthlyReview]:[(void 0).MONTHLY_REVIEW],[(void 0).Checklist]:[(void 0).CHECKLIST],[(void 0).Matrix]:[(void 0).MATRIX],[(void 0).TurnoverAgenda]:[(void 0).TURNOVER]}[entityType];return baseKeys&&(keys.push(...baseKeys),projectCode&&baseKeys.forEach(k=>keys.push(`${k}_${projectCode}`))),keys})(entityMsg.entityType,entityMsg.projectCode).forEach(key=>(void 0).removeByPrefix(key))})},[isEnabled]);const subscribe=(void 0).useCallback((channelKey,callback)=>(void 0).subscribe(channelKey,callback),[]),broadcastChange=(void 0).useCallback(message=>{(void 0).broadcastChange(message).catch(console.warn)},[]),value=(void 0).useMemo(()=>({connectionStatus,isEnabled,subscribe,broadcastChange}),[connectionStatus,isEnabled,subscribe,broadcastChange]);return(void 0)(SignalRContext.Provider,{value,children})};try{SignalRProvider.displayName="SignalRProvider",SignalRProvider.__docgenInfo={description:"",displayName:"SignalRProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/contexts/SignalRContext.tsx#SignalRProvider"]={docgenInfo:SignalRProvider.__docgenInfo,name:"SignalRProvider",path:"src/webparts/hbcProjectControls/components/contexts/SignalRContext.tsx#SignalRProvider"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/components/hooks/router/useTransitionNavigate.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Y:()=>useTransitionNavigate});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_useAppNavigate__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/webparts/hbcProjectControls/components/hooks/router/useAppNavigate.ts");function useTransitionNavigate(){const navigate=(0,_useAppNavigate__WEBPACK_IMPORTED_MODULE_1__.Y)();return react__WEBPACK_IMPORTED_MODULE_0__.useCallback((to,replace=!1)=>{react__WEBPACK_IMPORTED_MODULE_0__.startTransition(()=>{navigate(to,{replace})})},[navigate])}},"./src/webparts/hbcProjectControls/components/hooks/useSignalR.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{k:()=>useSignalR});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_contexts_SignalRContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/SignalRContext.tsx");function useSignalR(options={}){const{connectionStatus,isEnabled,subscribe}=(0,_contexts_SignalRContext__WEBPACK_IMPORTED_MODULE_1__.$)(),{entityType,projectCode,onEntityChanged,onWorkflowAdvanced}=options,onEntityChangedRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(onEntityChanged),onWorkflowAdvancedRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(onWorkflowAdvanced);return onEntityChangedRef.current=onEntityChanged,onWorkflowAdvancedRef.current=onWorkflowAdvanced,react__WEBPACK_IMPORTED_MODULE_0__.useEffect(()=>{if(!isEnabled||!onEntityChangedRef.current)return;return subscribe("EntityChanged",msg=>{var _a;if("EntityChanged"!==msg.type)return;const entityMsg=msg;entityType&&entityMsg.entityType!==entityType||projectCode&&entityMsg.projectCode!==projectCode||null===(_a=onEntityChangedRef.current)||void 0===_a||_a.call(onEntityChangedRef,entityMsg)})},[isEnabled,subscribe,entityType,projectCode]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect(()=>{if(!isEnabled||!onWorkflowAdvancedRef.current)return;return subscribe("WorkflowAdvanced",msg=>{var _a;if("WorkflowAdvanced"!==msg.type)return;const wfMsg=msg;entityType&&wfMsg.entityType!==entityType||projectCode&&wfMsg.projectCode!==projectCode||null===(_a=onWorkflowAdvancedRef.current)||void 0===_a||_a.call(onWorkflowAdvancedRef,wfMsg)})},[isEnabled,subscribe,entityType,projectCode]),{connectionStatus,isEnabled}}},"./src/webparts/hbcProjectControls/components/shared/Breadcrumb.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Q:()=>Breadcrumb});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_hooks_router_useTransitionNavigate__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/webparts/hbcProjectControls/components/hooks/router/useTransitionNavigate.ts"),_theme_tokens__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");const Breadcrumb=({items})=>{const navigate=(0,_hooks_router_useTransitionNavigate__WEBPACK_IMPORTED_MODULE_2__.Y)();return items.length<=1?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("nav",{"aria-label":"Breadcrumb",style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"13px",flexWrap:"wrap"},children:items.map((item,index)=>{const isLast=index===items.length-1;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:[index>0&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{style:{color:_theme_tokens__WEBPACK_IMPORTED_MODULE_3__.rf.gray400,userSelect:"none"},"aria-hidden":"true",children:"/"}),isLast||!item.path?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{style:{color:_theme_tokens__WEBPACK_IMPORTED_MODULE_3__.rf.gray600,fontWeight:isLast?600:400},children:item.label}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{role:"link",tabIndex:0,onClick:()=>navigate(item.path),onKeyDown:e=>{"Enter"===e.key&&navigate(item.path)},style:{color:_theme_tokens__WEBPACK_IMPORTED_MODULE_3__.rf.info,cursor:"pointer",textDecoration:"none"},onMouseEnter:e=>{e.currentTarget.style.textDecoration="underline"},onMouseLeave:e=>{e.currentTarget.style.textDecoration="none"},children:item.label})]},index)})})};try{Breadcrumb.displayName="Breadcrumb",Breadcrumb.__docgenInfo={description:"",displayName:"Breadcrumb",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"IBreadcrumbItem[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/shared/Breadcrumb.tsx#Breadcrumb"]={docgenInfo:Breadcrumb.__docgenInfo,name:"Breadcrumb",path:"src/webparts/hbcProjectControls/components/shared/Breadcrumb.tsx#Breadcrumb"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/components/shared/PageHeader.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{z:()=>PageHeader});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./node_modules/@griffel/core/index.esm.js")),_fluentui_react_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@griffel/react/makeStyles.esm.js"),_fluentui_react_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@fluentui/tokens/lib/tokens.js"),_theme_tokens__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");const useStyles=(0,_fluentui_react_components__WEBPACK_IMPORTED_MODULE_3__.n)({root:{marginBottom:"24px"},breadcrumbRow:{marginBottom:"8px"},titleRow:Object.assign({display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap"},_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__.Pt.gap("12px")),title:Object.assign(Object.assign({},_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__.Pt.margin("0")),{fontSize:"24px",fontWeight:"700",color:_theme_tokens__WEBPACK_IMPORTED_MODULE_5__.rf.navy}),subtitle:Object.assign(Object.assign({},_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__.Pt.margin("4px","0","0","0")),{fontSize:"14px",color:_fluentui_react_components__WEBPACK_IMPORTED_MODULE_4__.L.colorNeutralForeground3}),actions:Object.assign(Object.assign({display:"flex"},_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__.Pt.gap("8px")),{alignItems:"center"})}),PageHeader=({title,subtitle,actions,breadcrumb})=>{const styles=useStyles();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:styles.root,children:[breadcrumb&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:styles.breadcrumbRow,children:breadcrumb}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:styles.titleRow,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h1",{className:styles.title,children:title}),subtitle&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:styles.subtitle,children:subtitle})]}),actions&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:styles.actions,children:actions})]})]})};try{PageHeader.displayName="PageHeader",PageHeader.__docgenInfo={description:"",displayName:"PageHeader",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},subtitle:{defaultValue:null,description:"",name:"subtitle",required:!1,type:{name:"string"}},actions:{defaultValue:null,description:"",name:"actions",required:!1,type:{name:"ReactNode"}},breadcrumb:{defaultValue:null,description:"",name:"breadcrumb",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/shared/PageHeader.tsx#PageHeader"]={docgenInfo:PageHeader.__docgenInfo,name:"PageHeader",path:"src/webparts/hbcProjectControls/components/shared/PageHeader.tsx#PageHeader"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/components/shared/SkeletonLoader.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{j:()=>SkeletonLoader});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_theme_tokens__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");const barStyle={background:`linear-gradient(90deg, ${_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray100} 25%, ${_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray200} 50%, ${_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray100} 75%)`,backgroundSize:"800px 100%",animation:"hbc-shimmer 1.5s infinite linear",borderRadius:"4px"},SkeletonBar=({width="100%",height="14px",style:extra})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"hbc-skeleton-bar",style:Object.assign(Object.assign(Object.assign({},barStyle),{width,height}),extra)});function TableSkeleton({rows=5,columns=5}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"8px",padding:"16px",overflow:"hidden"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{display:"flex",gap:"16px",marginBottom:"16px",paddingBottom:"12px",borderBottom:`2px solid ${_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray200}`},children:Array.from({length:columns}).map((_,i)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:0===i?"30%":`${Math.floor(70/(columns-1))}%`,height:"12px"},i))}),Array.from({length:rows}).map((_,r)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{display:"flex",gap:"16px",padding:"10px 0",borderBottom:`1px solid ${_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray100}`},children:Array.from({length:columns}).map((_,i)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:0===i?"30%":`${Math.floor(70/(columns-1))}%`,height:"14px"},i))},r))]})}function KPIGridSkeleton({columns=4}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{display:"grid",gridTemplateColumns:`repeat(${columns}, 1fr)`,gap:"16px"},children:Array.from({length:columns}).map((_,i)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"8px",padding:"20px"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"60%",height:"12px"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"40%",height:"28px",style:{marginTop:"12px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"50%",height:"10px",style:{marginTop:"8px"}})]},i))})}function FormSkeleton({rows=6}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{backgroundColor:"#fff",borderRadius:"8px",padding:"24px"},children:Array.from({length:rows}).map((_,i)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"120px",height:"12px",style:{marginBottom:"8px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"100%",height:"36px"})]},i))})}function CardSkeleton(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"8px",padding:"20px"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"70%",height:"16px"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"100%",height:"14px",style:{marginTop:"12px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"90%",height:"14px",style:{marginTop:"8px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"40%",height:"14px",style:{marginTop:"8px"}})]})}function TextSkeleton({rows=3}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{children:Array.from({length:rows}).map((_,i)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:i===rows-1?"60%":"100%",height:"14px",style:{marginBottom:"10px"}},i))})}const SkeletonLoader=({variant,rows,columns,style})=>{react__WEBPACK_IMPORTED_MODULE_1__.useEffect(()=>{!function ensureShimmerStyles(){if("undefined"==typeof document)return;if(document.getElementById("hbc-skeleton-shimmer"))return;const style=document.createElement("style");style.id="hbc-skeleton-shimmer",style.textContent="\n    @keyframes hbc-shimmer {\n      0% { background-position: -400px 0; }\n      100% { background-position: 400px 0; }\n    }\n    @media (prefers-reduced-motion: reduce) {\n      .hbc-skeleton-bar {\n        animation: none !important;\n      }\n    }\n  ",document.head.appendChild(style)}()},[]);const content=(()=>{switch(variant){case"table":default:return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(TableSkeleton,{rows,columns});case"kpi-grid":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(KPIGridSkeleton,{columns});case"form":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(FormSkeleton,{rows});case"card":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(CardSkeleton,{});case"text":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(TextSkeleton,{rows})}})();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style,children:content})};try{SkeletonLoader.displayName="SkeletonLoader",SkeletonLoader.__docgenInfo={description:"",displayName:"SkeletonLoader",props:{variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"enum",value:[{value:'"table"'},{value:'"kpi-grid"'},{value:'"form"'},{value:'"card"'},{value:'"text"'}]}},rows:{defaultValue:null,description:"",name:"rows",required:!1,type:{name:"number"}},columns:{defaultValue:null,description:"",name:"columns",required:!1,type:{name:"number"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/shared/SkeletonLoader.tsx#SkeletonLoader"]={docgenInfo:SkeletonLoader.__docgenInfo,name:"SkeletonLoader",path:"src/webparts/hbcProjectControls/components/shared/SkeletonLoader.tsx#SkeletonLoader"})}catch(__react_docgen_typescript_loader_error){}}}]);