"use strict";(self.webpackChunkhbc_project_controls=self.webpackChunkhbc_project_controls||[]).push([[491],{"./src/webparts/hbcProjectControls/components/pages/project/SchedulePage.stories.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{GanttTab:()=>SchedulePage_stories_GanttTab,Overview:()=>Overview,__namedExportsOrder:()=>__namedExportsOrder,default:()=>SchedulePage_stories});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),router=__webpack_require__("./src/webparts/hbcProjectControls/router/index.tsx"),AppContext=__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/AppContext.tsx"),SignalRContext=__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/SignalRContext.tsx"),useSignalR=__webpack_require__("./src/webparts/hbcProjectControls/components/hooks/useSignalR.ts"),src=__webpack_require__("./packages/hbc-sp-services/src/index.ts");function writeActivityCache(projectCode,data){try{sessionStorage.setItem(`hbc-schedule-cache-${projectCode}`,JSON.stringify({data,timestamp:Date.now()}))}catch(_a){}}function useScheduleActivities(){const{dataService,currentUser}=(0,AppContext.Us)(),{broadcastChange}=(0,SignalRContext.$)(),[activities,setActivities]=react.useState([]),[imports,setImports]=react.useState([]),[isLoading,setIsLoading]=react.useState(!1),[error,setError]=react.useState(null),lastProjectCodeRef=react.useRef(null),fetchActivities=react.useCallback(async(projectCode,bypassCache=!1)=>{if(lastProjectCodeRef.current=projectCode,!bypassCache){const cached=function readActivityCache(projectCode){try{const raw=sessionStorage.getItem(`hbc-schedule-cache-${projectCode}`);if(!raw)return null;const cached=JSON.parse(raw);return Date.now()-cached.timestamp>3e5?(sessionStorage.removeItem(`hbc-schedule-cache-${projectCode}`),null):cached.data}catch(_a){return null}}(projectCode);if(cached)return void setActivities(cached)}setIsLoading(!0),setError(null);try{const data=await dataService.getScheduleActivities(projectCode);setActivities(data),writeActivityCache(projectCode,data)}catch(err){setError(err instanceof Error?err.message:"Failed to load schedule activities")}finally{setIsLoading(!1)}},[dataService]),fetchImports=react.useCallback(async projectCode=>{try{const data=await dataService.getScheduleImports(projectCode);setImports(data)}catch(_a){}},[dataService]);(0,useSignalR.k)({entityType:src.ckT.ScheduleActivity,onEntityChanged:react.useCallback(()=>{lastProjectCodeRef.current&&fetchActivities(lastProjectCodeRef.current,!0)},[fetchActivities])});const broadcastScheduleChange=react.useCallback((entityId,action,summary)=>{var _a;broadcastChange({type:"EntityChanged",entityType:src.ckT.ScheduleActivity,entityId:String(entityId),action,changedBy:null!==(_a=null==currentUser?void 0:currentUser.email)&&void 0!==_a?_a:"unknown",changedByName:null==currentUser?void 0:currentUser.displayName,timestamp:(new Date).toISOString(),summary,projectCode:lastProjectCodeRef.current||void 0})},[broadcastChange,currentUser]),importActivities=react.useCallback(async(projectCode,parsedActivities,importMeta)=>{setIsLoading(!0),setError(null);try{const imported=await dataService.importScheduleActivities(projectCode,parsedActivities,importMeta);return setActivities(imported),writeActivityCache(projectCode,imported),broadcastScheduleChange(projectCode,"created",`Imported ${parsedActivities.length} activities`),fetchImports(projectCode),dataService.syncToDataMart(projectCode).catch(()=>{}),imported}catch(err){throw setError(err instanceof Error?err.message:"Failed to import activities"),err}finally{setIsLoading(!1)}},[dataService,broadcastScheduleChange,fetchImports]),updateActivity=react.useCallback(async(projectCode,activityId,data)=>{setError(null);try{const updated=await dataService.updateScheduleActivity(projectCode,activityId,data);return setActivities(prev=>{const newList=prev.map(a=>a.id===activityId?updated:a);return writeActivityCache(projectCode,newList),newList}),broadcastScheduleChange(activityId,"updated","Activity updated"),dataService.syncToDataMart(projectCode).catch(()=>{}),updated}catch(err){throw setError(err instanceof Error?err.message:"Failed to update activity"),err}},[dataService,broadcastScheduleChange]),deleteActivity=react.useCallback(async(projectCode,activityId)=>{setError(null);try{await dataService.deleteScheduleActivity(projectCode,activityId),setActivities(prev=>{const newList=prev.filter(a=>a.id!==activityId);return writeActivityCache(projectCode,newList),newList}),broadcastScheduleChange(activityId,"deleted","Activity deleted"),dataService.syncToDataMart(projectCode).catch(()=>{})}catch(err){throw setError(err instanceof Error?err.message:"Failed to delete activity"),err}},[dataService,broadcastScheduleChange]),metrics=react.useMemo(()=>(0,src.sfZ)(activities),[activities]);return{activities,imports,isLoading,error,metrics,fetchActivities,fetchImports,importActivities,updateActivity,deleteActivity}}var usePersistedState=__webpack_require__("./src/webparts/hbcProjectControls/components/hooks/usePersistedState.ts"),PageHeader=__webpack_require__("./src/webparts/hbcProjectControls/components/shared/PageHeader.tsx"),Breadcrumb=__webpack_require__("./src/webparts/hbcProjectControls/components/shared/Breadcrumb.tsx"),SkeletonLoader=__webpack_require__("./src/webparts/hbcProjectControls/components/shared/SkeletonLoader.tsx"),makeStyles_esm=__webpack_require__("./node_modules/@griffel/react/makeStyles.esm.js"),index_esm=__webpack_require__("./node_modules/@griffel/core/index.esm.js"),tokens=__webpack_require__("./node_modules/@fluentui/tokens/lib/tokens.js"),Button=__webpack_require__("./node_modules/@fluentui/react-button/lib/components/Button/Button.js");const useStyles=(0,makeStyles_esm.n)({container:Object.assign(Object.assign({display:"flex"},index_esm.Pt.gap("4px")),{alignItems:"center"}),label:{fontSize:"12px",color:tokens.L.colorNeutralForeground4,marginRight:"4px"},btn:{fontSize:"12px",minWidth:"auto"}}),exportService=new src._Th,ExportButtons=({pdfElementId,data,filename,title})=>{const styles=useStyles(),[exporting,setExporting]=react.useState(null),handleExport=async format=>{try{setExporting(format),"pdf"===format&&pdfElementId?await exportService.exportToPDF(pdfElementId,{filename,title}):"excel"===format&&data?await exportService.exportToExcel(data,{filename,title}):"csv"===format&&data&&exportService.exportToCSV(data,{filename,title})}catch(err){console.error(`Export to ${format} failed:`,err)}finally{setExporting(null)}};return(0,jsx_runtime.jsxs)("div",{className:styles.container,children:[(0,jsx_runtime.jsx)("span",{className:styles.label,children:"Export:"}),pdfElementId&&(0,jsx_runtime.jsx)(Button.$,{size:"small",appearance:"subtle",className:styles.btn,disabled:!!exporting,onClick:()=>handleExport("pdf"),children:"pdf"===exporting?"...":"PDF"}),data&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Button.$,{size:"small",appearance:"subtle",className:styles.btn,disabled:!!exporting,onClick:()=>handleExport("excel"),children:"excel"===exporting?"...":"Excel"}),(0,jsx_runtime.jsx)(Button.$,{size:"small",appearance:"subtle",className:styles.btn,disabled:!!exporting,onClick:()=>handleExport("csv"),children:"csv"===exporting?"...":"CSV"})]})]})};try{ExportButtons.displayName="ExportButtons",ExportButtons.__docgenInfo={description:"",displayName:"ExportButtons",props:{pdfElementId:{defaultValue:null,description:"",name:"pdfElementId",required:!1,type:{name:"string"}},data:{defaultValue:null,description:"",name:"data",required:!1,type:{name:"Record<string, unknown>[]"}},filename:{defaultValue:null,description:"",name:"filename",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/shared/ExportButtons.tsx#ExportButtons"]={docgenInfo:ExportButtons.__docgenInfo,name:"ExportButtons",path:"src/webparts/hbcProjectControls/components/shared/ExportButtons.tsx#ExportButtons"})}catch(__react_docgen_typescript_loader_error){}var ToastContainer=__webpack_require__("./src/webparts/hbcProjectControls/components/shared/ToastContainer.tsx"),theme_tokens=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");const ScheduleImportModal=({isOpen,onClose,onImport,projectCode})=>{const[file,setFile]=react.useState(null),[format,setFormat]=react.useState("P6-CSV"),[parsed,setParsed]=react.useState([]),[importing,setImporting]=react.useState(!1),[isParsing,setIsParsing]=react.useState(!1),[parseError,setParseError]=react.useState(null),[notes,setNotes]=react.useState("");react.useEffect(()=>{isOpen||(setFile(null),setFormat("P6-CSV"),setParsed([]),setIsParsing(!1),setParseError(null),setNotes(""))},[isOpen]);const detectFormat=react.useCallback(fileName=>{var _a;const ext=null===(_a=fileName.split(".").pop())||void 0===_a?void 0:_a.toLowerCase();return"xer"===ext?"P6-XER":"xml"===ext?"MSProject-XML":"P6-CSV"},[]),parseFile=react.useCallback(async(f,fmt)=>{setParseError(null),setIsParsing(!0);try{const text=await f.text(),activities=(0,src.JJF)(text,fmt,projectCode);0===activities.length?(setParseError(`No activities found. Check the file format matches "${fmt}".`),setParsed([])):setParsed(activities)}catch(err){setParseError(err instanceof Error?err.message:"Failed to parse file"),setParsed([])}finally{setIsParsing(!1)}},[projectCode]),handleFileSelect=react.useCallback(async e=>{var _a;const f=null===(_a=e.target.files)||void 0===_a?void 0:_a[0];if(!f)return;setFile(f);const detected=detectFormat(f.name);setFormat(detected),await parseFile(f,detected)},[detectFormat,parseFile]),handleFormatChange=react.useCallback(async newFormat=>{setFormat(newFormat),file&&await parseFile(file,newFormat)},[file,parseFile]),handleImport=react.useCallback(async()=>{if(0!==parsed.length&&file){setImporting(!0);try{await onImport(parsed,{fileName:file.name,format,notes}),onClose()}catch(_a){}finally{setImporting(!1)}}},[parsed,file,format,notes,onImport,onClose]),summary=react.useMemo(()=>{if(0===parsed.length)return null;const completed=parsed.filter(a=>"Completed"===a.status).length,inProgress=parsed.filter(a=>"In Progress"===a.status).length,notStarted=parsed.filter(a=>"Not Started"===a.status).length,critical=parsed.filter(a=>a.isCritical).length,dates=parsed.map(a=>a.plannedStartDate||a.actualStartDate).filter(Boolean).sort(),endDates=parsed.map(a=>a.plannedFinishDate||a.actualFinishDate).filter(Boolean).sort();return{total:parsed.length,completed,inProgress,notStarted,critical,earliestStart:dates[0]||null,latestFinish:endDates[endDates.length-1]||null}},[parsed]);return isOpen?(0,jsx_runtime.jsx)("div",{style:overlay,role:"dialog","aria-modal":"true","aria-labelledby":"schedule-import-title",children:(0,jsx_runtime.jsxs)("div",{style:modal,children:[(0,jsx_runtime.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,jsx_runtime.jsx)("h3",{id:"schedule-import-title",style:{margin:0,fontSize:18,color:theme_tokens.rf.navy},children:"Import Schedule"}),(0,jsx_runtime.jsx)("button",{onClick:onClose,style:closeBtn,"aria-label":"Close import dialog",children:"×"})]}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:16},children:[(0,jsx_runtime.jsxs)("div",{style:{flex:1},children:[(0,jsx_runtime.jsx)("label",{style:{display:"block",fontSize:13,fontWeight:600,marginBottom:6},children:"Select File"}),(0,jsx_runtime.jsx)("input",{type:"file",accept:".csv,.xer,.xml",onChange:handleFileSelect,style:{fontSize:13},"aria-label":"Select schedule file"})]}),(0,jsx_runtime.jsxs)("div",{style:{width:180},children:[(0,jsx_runtime.jsx)("label",{style:{display:"block",fontSize:13,fontWeight:600,marginBottom:6},children:"Format"}),(0,jsx_runtime.jsxs)("select",{value:format,onChange:e=>handleFormatChange(e.target.value),style:{width:"100%",padding:"6px 8px",fontSize:13,borderRadius:6,border:"1px solid #D1D5DB"},"aria-label":"Schedule file format",children:[(0,jsx_runtime.jsx)("option",{value:"P6-CSV",children:"P6 CSV"}),(0,jsx_runtime.jsx)("option",{value:"P6-XER",children:"P6 XER"}),(0,jsx_runtime.jsx)("option",{value:"MSProject-XML",children:"MSProject XML"}),(0,jsx_runtime.jsx)("option",{value:"MSProject-CSV",children:"MSProject CSV"})]})]})]}),isParsing&&(0,jsx_runtime.jsxs)("div",{style:{padding:"8px 12px",color:theme_tokens.rf.navy,fontSize:13,marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[(0,jsx_runtime.jsx)("span",{style:{display:"inline-block",width:14,height:14,border:`2px solid ${theme_tokens.rf.gray200}`,borderTopColor:theme_tokens.rf.navy,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),"Parsing file..."]}),parseError&&(0,jsx_runtime.jsx)("div",{style:{padding:"8px 12px",backgroundColor:theme_tokens.rf.errorLight,color:"#991B1B",borderRadius:6,fontSize:13,marginBottom:12},children:parseError}),summary&&(0,jsx_runtime.jsxs)("div",{style:{padding:12,backgroundColor:"#F8FAFC",borderRadius:8,border:"1px solid #E2E8F0",marginBottom:16},children:[(0,jsx_runtime.jsx)("div",{style:{fontSize:14,fontWeight:600,marginBottom:8,color:theme_tokens.rf.navy},children:"Parse Preview"}),(0,jsx_runtime.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8},children:[(0,jsx_runtime.jsx)(StatBox,{label:"Total",value:summary.total,color:theme_tokens.rf.navy}),(0,jsx_runtime.jsx)(StatBox,{label:"Completed",value:summary.completed,color:theme_tokens.rf.success}),(0,jsx_runtime.jsx)(StatBox,{label:"In Progress",value:summary.inProgress,color:theme_tokens.rf.warning}),(0,jsx_runtime.jsx)(StatBox,{label:"Critical",value:summary.critical,color:theme_tokens.rf.error})]}),summary.earliestStart&&summary.latestFinish&&(0,jsx_runtime.jsxs)("div",{style:{fontSize:12,color:"#64748B",marginTop:8},children:["Date range: ",new Date(summary.earliestStart).toLocaleDateString()," – ",new Date(summary.latestFinish).toLocaleDateString()]}),(0,jsx_runtime.jsxs)("div",{style:{marginTop:12,fontSize:12,color:"#475569"},children:[(0,jsx_runtime.jsx)("strong",{children:"First 5 activities:"}),(0,jsx_runtime.jsxs)("table",{style:{width:"100%",marginTop:4,borderCollapse:"collapse"},children:[(0,jsx_runtime.jsx)("thead",{children:(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("th",{style:previewTh,children:"ID"}),(0,jsx_runtime.jsx)("th",{style:previewTh,children:"Name"}),(0,jsx_runtime.jsx)("th",{style:previewTh,children:"Status"}),(0,jsx_runtime.jsx)("th",{style:previewTh,children:"Duration"})]})}),(0,jsx_runtime.jsx)("tbody",{children:parsed.slice(0,5).map(a=>(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{style:previewTd,children:a.taskCode}),(0,jsx_runtime.jsx)("td",{style:previewTd,children:a.activityName}),(0,jsx_runtime.jsx)("td",{style:previewTd,children:a.status}),(0,jsx_runtime.jsxs)("td",{style:previewTd,children:[a.originalDuration,"d"]})]},a.taskCode))})]})]})]}),(0,jsx_runtime.jsxs)("div",{style:{marginBottom:16},children:[(0,jsx_runtime.jsx)("label",{htmlFor:"schedule-import-notes",style:{display:"block",fontSize:13,fontWeight:600,marginBottom:6},children:"Notes (optional)"}),(0,jsx_runtime.jsx)("textarea",{id:"schedule-import-notes",value:notes,onChange:e=>setNotes(e.target.value),style:{width:"100%",minHeight:60,fontSize:13,padding:8,borderRadius:6,border:"1px solid #D1D5DB",resize:"vertical"},placeholder:"Import notes..."})]}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,jsx_runtime.jsx)("button",{onClick:onClose,style:cancelBtn,children:"Cancel"}),(0,jsx_runtime.jsx)("button",{onClick:handleImport,disabled:0===parsed.length||importing,style:Object.assign(Object.assign({},importBtn),{opacity:0===parsed.length||importing?.5:1}),"aria-label":importing?"Importing activities":`Import ${parsed.length} activities`,children:importing?"Importing...":`Import ${parsed.length} Activities`})]})]})}):null},StatBox=({label,value,color})=>(0,jsx_runtime.jsxs)("div",{style:{textAlign:"center",padding:"6px 4px",backgroundColor:"white",borderRadius:6,border:"1px solid #E2E8F0"},children:[(0,jsx_runtime.jsx)("div",{style:{fontSize:18,fontWeight:700,color},children:value}),(0,jsx_runtime.jsx)("div",{style:{fontSize:11,color:"#64748B"},children:label})]}),overlay={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modal={backgroundColor:"white",borderRadius:12,padding:24,width:560,maxHeight:"80vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},closeBtn={background:"none",border:"none",fontSize:22,cursor:"pointer",color:"#94A3B8",padding:"0 4px"},cancelBtn={padding:"8px 16px",fontSize:13,borderRadius:6,border:"1px solid #D1D5DB",backgroundColor:"white",cursor:"pointer"},importBtn={padding:"8px 16px",fontSize:13,fontWeight:600,borderRadius:6,border:"none",backgroundColor:theme_tokens.rf.navy,color:"white",cursor:"pointer"},previewTh={textAlign:"left",padding:"3px 6px",borderBottom:"1px solid #E2E8F0",fontWeight:600},previewTd={padding:"3px 6px",borderBottom:"1px solid #F1F5F9"};try{ScheduleImportModal.displayName="ScheduleImportModal",ScheduleImportModal.__docgenInfo={description:"",displayName:"ScheduleImportModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},onImport:{defaultValue:null,description:"",name:"onImport",required:!0,type:{name:"(activities: IScheduleActivity[], meta: Partial<IScheduleImport>) => Promise<void>"}},projectCode:{defaultValue:null,description:"",name:"projectCode",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/pages/project/ScheduleImportModal.tsx#ScheduleImportModal"]={docgenInfo:ScheduleImportModal.__docgenInfo,name:"ScheduleImportModal",path:"src/webparts/hbcProjectControls/components/pages/project/ScheduleImportModal.tsx#ScheduleImportModal"})}catch(__react_docgen_typescript_loader_error){}var HbcEChart=__webpack_require__("./src/webparts/hbcProjectControls/components/shared/HbcEChart.tsx");const CHART_COLORS=[theme_tokens.rf.navy,theme_tokens.rf.orange,theme_tokens.rf.info,theme_tokens.rf.success,theme_tokens.rf.warning,theme_tokens.rf.error],FLOAT_COLORS={negative:theme_tokens.rf.error,zero:theme_tokens.rf.warning,low:"#D97706",medium:theme_tokens.rf.info,high:theme_tokens.rf.success},ScheduleAnalysisTab=({activities,metrics,projectCode})=>0===activities.length?(0,jsx_runtime.jsx)("div",{style:{padding:48,textAlign:"center",color:theme_tokens.rf.gray400},children:"No schedule data available for analysis. Import a schedule to see charts."}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:(0,jsx_runtime.jsx)(ExportButtons,{pdfElementId:"schedule-analysis-charts",filename:`schedule-analysis-${projectCode}`,title:"Schedule Analysis"})}),(0,jsx_runtime.jsxs)("div",{id:"schedule-analysis-charts",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(440px, 1fr))",gap:16},children:[(0,jsx_runtime.jsx)(VarianceChart,{activities}),(0,jsx_runtime.jsx)(FloatDistributionChart,{metrics}),(0,jsx_runtime.jsx)(SensitivityChart,{activities}),(0,jsx_runtime.jsx)(ScheduleHealthChart,{metrics}),(0,jsx_runtime.jsx)(LogicMetricsChart,{metrics}),(0,jsx_runtime.jsx)(ConstraintChart,{metrics}),(0,jsx_runtime.jsx)(StatusBreakdownChart,{metrics}),(0,jsx_runtime.jsx)(EarnedValueChart,{metrics})]})]}),VarianceChart=({activities})=>{const scatterData=react.useMemo(()=>activities.filter(a=>null!==a.startVarianceDays&&null!==a.finishVarianceDays).map(a=>{var _a,_b;return{name:a.taskCode,startVar:null!==(_a=a.startVarianceDays)&&void 0!==_a?_a:0,finishVar:null!==(_b=a.finishVarianceDays)&&void 0!==_b?_b:0}}),[activities]),option=react.useMemo(()=>({grid:{top:10,right:20,bottom:10,left:0,containLabel:!0},tooltip:{trigger:"item",formatter:p=>{const params=p;return`<div style="font-size:12px;font-family:'Segoe UI',sans-serif;padding:4px 0"><b>${params.name}</b><br/>Start: ${params.value[0]}d<br/>Finish: ${params.value[1]}d</div>`},extraCssText:"border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.12);padding:10px 14px;"},xAxis:{type:"value",name:"Start Variance (d)",nameLocation:"end",axisLabel:{fontSize:11,formatter:v=>`${v}d`},splitLine:{lineStyle:{color:theme_tokens.rf.gray200,type:"dashed"}},axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"value",name:"Finish Variance (d)",axisLabel:{fontSize:11,formatter:v=>`${v}d`},splitLine:{lineStyle:{color:theme_tokens.rf.gray100,type:"dashed"}},axisLine:{show:!1},axisTick:{show:!1}},series:[{type:"scatter",symbolSize:8,data:scatterData.map(d=>({name:d.name,value:[d.startVar,d.finishVar],itemStyle:{color:d.startVar>5||d.finishVar>5?theme_tokens.rf.error:d.startVar>0||d.finishVar>0?theme_tokens.rf.warning:theme_tokens.rf.success}}))}]}),[scatterData]);return(0,jsx_runtime.jsx)(ChartCard,{title:"Variance Analysis",subtitle:"Start vs Finish variance (days)",children:(0,jsx_runtime.jsx)(HbcEChart.D,{option,height:300,empty:0===scatterData.length,ariaLabel:"Variance analysis scatter chart"})})},FloatDistributionChart=({metrics})=>{const floatData=[{name:"Negative",value:metrics.floatDistribution.negative,color:FLOAT_COLORS.negative},{name:"Zero",value:metrics.floatDistribution.zero,color:FLOAT_COLORS.zero},{name:"Low (1-10d)",value:metrics.floatDistribution.low,color:FLOAT_COLORS.low},{name:"Med (11-30d)",value:metrics.floatDistribution.medium,color:FLOAT_COLORS.medium},{name:"High (30d+)",value:metrics.floatDistribution.high,color:FLOAT_COLORS.high}],option=react.useMemo(()=>({grid:{top:10,right:20,bottom:10,left:0,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},extraCssText:"border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.12);padding:10px 14px;"},xAxis:{type:"category",data:floatData.map(d=>d.name),axisLabel:{fontSize:11,color:theme_tokens.rf.gray500},axisLine:{lineStyle:{color:theme_tokens.rf.gray200}},axisTick:{show:!1}},yAxis:{type:"value",axisLabel:{fontSize:11,color:theme_tokens.rf.gray500},splitLine:{lineStyle:{color:theme_tokens.rf.gray100,type:"dashed"}},axisLine:{show:!1},axisTick:{show:!1}},series:[{type:"bar",name:"Activities",data:floatData.map(d=>({value:d.value,itemStyle:{color:d.color,borderRadius:[4,4,0,0]}})),barMaxWidth:60}]}),[floatData]);return(0,jsx_runtime.jsx)(ChartCard,{title:"Float Distribution",subtitle:"Activity count by float range",children:(0,jsx_runtime.jsx)(HbcEChart.D,{option,height:300,ariaLabel:"Float distribution bar chart"})})},SensitivityChart=({activities})=>{const nearCritical=react.useMemo(()=>activities.filter(a=>null!==a.remainingFloat&&a.remainingFloat>=0&&a.remainingFloat<=10).sort((a,b)=>{var _a,_b;return(null!==(_a=a.remainingFloat)&&void 0!==_a?_a:0)-(null!==(_b=b.remainingFloat)&&void 0!==_b?_b:0)}).slice(0,20).map(a=>{var _a;return{name:a.taskCode.length>16?`${a.taskCode.substring(0,14)}..`:a.taskCode,float:null!==(_a=a.remainingFloat)&&void 0!==_a?_a:0}}),[activities]),option=react.useMemo(()=>({grid:{top:10,right:20,bottom:10,left:80,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},extraCssText:"border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.12);padding:10px 14px;"},xAxis:{type:"value",axisLabel:{fontSize:11,formatter:v=>`${v}d`,color:theme_tokens.rf.gray500},splitLine:{lineStyle:{color:theme_tokens.rf.gray100,type:"dashed"}},axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"category",data:nearCritical.map(d=>d.name),axisLabel:{fontSize:10,color:theme_tokens.rf.gray600},axisLine:{lineStyle:{color:theme_tokens.rf.gray200}},axisTick:{show:!1}},series:[{type:"bar",name:"Float (days)",data:nearCritical.map(d=>({value:d.float,itemStyle:{color:0===d.float?theme_tokens.rf.error:d.float<=5?theme_tokens.rf.warning:"#D97706",borderRadius:[0,4,4,0]}})),barMaxWidth:30}]}),[nearCritical]);return 0===nearCritical.length?(0,jsx_runtime.jsx)(ChartCard,{title:"Near-Critical Activities",subtitle:"Activities with 0-10 days float",children:(0,jsx_runtime.jsx)(EmptyChart,{})}):(0,jsx_runtime.jsx)(ChartCard,{title:"Near-Critical Activities",subtitle:"Activities with 0-10 days float",children:(0,jsx_runtime.jsx)(HbcEChart.D,{option,height:300,ariaLabel:"Near-critical activities horizontal bar chart"})})},ScheduleHealthChart=({metrics})=>{const{earnedValueMetrics:ev,logicMetrics:lm}=metrics,pctComplete=Math.min(100,metrics.percentComplete),spiScore=null!==ev.spi?Math.min(100,Math.round(100*ev.spi)):50,floatHealth=metrics.totalActivities>0?Math.round((metrics.totalActivities-metrics.negativeFloatCount)/metrics.totalActivities*100):100,logicQuality=metrics.totalActivities>0?Math.round((metrics.totalActivities-lm.openEnds.noSuccessor-lm.openEnds.noPredecessor)/metrics.totalActivities*100):100,criticalRatio=metrics.totalActivities>0?Math.round((metrics.totalActivities-metrics.criticalActivityCount)/metrics.totalActivities*100):100,dimensions=["% Complete","SPI","Float Health","Logic Quality","Critical Ratio"],values=[Math.max(0,pctComplete),Math.max(0,spiScore),Math.max(0,floatHealth),Math.max(0,Math.min(100,logicQuality)),Math.max(0,criticalRatio)],option=react.useMemo(()=>({radar:{indicator:dimensions.map(name=>({name,max:100})),axisLine:{lineStyle:{color:theme_tokens.rf.gray200}},splitLine:{lineStyle:{color:theme_tokens.rf.gray100}},splitArea:{areaStyle:{color:[theme_tokens.rf.gray50,theme_tokens.rf.white]}},axisName:{color:theme_tokens.rf.gray600,fontSize:11}},tooltip:{extraCssText:"border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.12);padding:10px 14px;"},series:[{type:"radar",data:[{value:values,name:"Health Score",lineStyle:{color:theme_tokens.rf.navy,width:2},itemStyle:{color:theme_tokens.rf.navy},areaStyle:{color:`${theme_tokens.rf.navy}40`}}]}]}),[metrics]);return(0,jsx_runtime.jsx)(ChartCard,{title:"Schedule Health",subtitle:"Multi-dimensional health score (0-100)",children:(0,jsx_runtime.jsx)(HbcEChart.D,{option,height:300,ariaLabel:"Schedule health radar chart"})})},LogicMetricsChart=({metrics})=>{const logicData=Object.entries(metrics.logicMetrics.relationshipTypes).filter(([,count])=>count>0).map(([type,count])=>({name:type,value:count})),option=react.useMemo(()=>({tooltip:{trigger:"item",formatter:p=>{const params=p;return`<div style="font-family:'Segoe UI',sans-serif;padding:4px 0"><div style="font-size:13px;font-weight:600;color:${theme_tokens.rf.navy}">${params.marker}${params.name}: ${params.value} (${params.percent}%)</div></div>`},extraCssText:"border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.12);padding:10px 14px;"},legend:{bottom:0,textStyle:{fontSize:11,color:theme_tokens.rf.gray600}},series:[{type:"pie",radius:"65%",center:["50%","45%"],label:{formatter:p=>{const pi=p;return`${pi.name} ${(100*pi.percent).toFixed(0)}%`},fontSize:11},data:logicData.map((d,i)=>({name:d.name,value:d.value,itemStyle:{color:CHART_COLORS[i%CHART_COLORS.length],borderWidth:2,borderColor:"#fff"}}))}]}),[logicData]);return 0===logicData.length?(0,jsx_runtime.jsx)(ChartCard,{title:"Relationship Types",subtitle:"Logic tie distribution",children:(0,jsx_runtime.jsx)(EmptyChart,{})}):(0,jsx_runtime.jsxs)(ChartCard,{title:"Relationship Types",subtitle:"Logic tie distribution",children:[(0,jsx_runtime.jsx)(HbcEChart.D,{option,height:300,ariaLabel:"Relationship type distribution pie chart"}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",gap:16,fontSize:12,color:theme_tokens.rf.gray500,marginTop:8},children:[(0,jsx_runtime.jsxs)("span",{children:["Total: ",metrics.logicMetrics.totalRelationships]}),(0,jsx_runtime.jsxs)("span",{children:["Avg Pred: ",metrics.logicMetrics.avgPredecessors]}),(0,jsx_runtime.jsxs)("span",{children:["Avg Succ: ",metrics.logicMetrics.avgSuccessors]}),(0,jsx_runtime.jsxs)("span",{children:["Open Ends: ",metrics.logicMetrics.openEnds.noPredecessor+metrics.logicMetrics.openEnds.noSuccessor]})]})]})},ConstraintChart=({metrics})=>{const constraintData=Object.entries(metrics.constraintAnalysis.byType).sort(([,a],[,b])=>b-a).slice(0,10).map(([type,count])=>({name:type.length>22?`${type.substring(0,20)}..`:type,count})),option=react.useMemo(()=>({grid:{top:10,right:20,bottom:10,left:120,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},extraCssText:"border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.12);padding:10px 14px;"},xAxis:{type:"value",axisLabel:{fontSize:11,color:theme_tokens.rf.gray500},splitLine:{lineStyle:{color:theme_tokens.rf.gray100,type:"dashed"}},axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"category",data:constraintData.map(d=>d.name),axisLabel:{fontSize:10,color:theme_tokens.rf.gray600},axisLine:{lineStyle:{color:theme_tokens.rf.gray200}},axisTick:{show:!1}},series:[{type:"bar",name:"Activities",data:constraintData.map(d=>({value:d.count,itemStyle:{color:theme_tokens.rf.orange,borderRadius:[0,4,4,0]}})),barMaxWidth:30}]}),[constraintData]);return 0===constraintData.length?(0,jsx_runtime.jsx)(ChartCard,{title:"Constraint Analysis",subtitle:"Constraint types applied",children:(0,jsx_runtime.jsx)(EmptyChart,{message:"No constraints found"})}):(0,jsx_runtime.jsx)(ChartCard,{title:"Constraint Analysis",subtitle:`${metrics.constraintAnalysis.totalConstrained} constrained activities`,children:(0,jsx_runtime.jsx)(HbcEChart.D,{option,height:300,ariaLabel:"Constraint analysis horizontal bar chart"})})},StatusBreakdownChart=({metrics})=>{const statusData=[{name:"Completed",value:metrics.completedCount,color:theme_tokens.rf.success},{name:"In Progress",value:metrics.inProgressCount,color:theme_tokens.rf.warning},{name:"Not Started",value:metrics.notStartedCount,color:theme_tokens.rf.gray400}].filter(d=>d.value>0),option=react.useMemo(()=>({tooltip:{trigger:"item",formatter:p=>{const params=p;return`<div style="font-family:'Segoe UI',sans-serif;padding:4px 0"><div style="font-size:13px;font-weight:600;color:${theme_tokens.rf.navy}">${params.marker}${params.name}: ${params.value} (${params.percent}%)</div></div>`},extraCssText:"border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.12);padding:10px 14px;"},legend:{bottom:0,textStyle:{fontSize:11,color:theme_tokens.rf.gray600}},series:[{type:"pie",radius:["40%","65%"],center:["50%","45%"],label:{formatter:p=>{const pi=p;return`${pi.name}: ${pi.value}`},fontSize:11},data:statusData.map(d=>({name:d.name,value:d.value,itemStyle:{color:d.color,borderWidth:2,borderColor:"#fff"}}))}]}),[statusData]);return(0,jsx_runtime.jsx)(ChartCard,{title:"Status Breakdown",subtitle:`${metrics.totalActivities} total activities`,children:(0,jsx_runtime.jsx)(HbcEChart.D,{option,height:300,empty:0===statusData.length,ariaLabel:"Activity status breakdown donut chart"})})},EarnedValueChart=({metrics})=>{var _a,_b;const{earnedValueMetrics:ev}=metrics,evCategories=["PV","EV","AC","BAC"],evValues=[ev.pv,ev.ev,ev.actualDuration,ev.bac],evColors=[theme_tokens.rf.info,theme_tokens.rf.success,theme_tokens.rf.error,theme_tokens.rf.navy],option=react.useMemo(()=>({grid:{top:10,right:20,bottom:10,left:0,containLabel:!0},tooltip:{trigger:"axis",formatter:p=>{const params=p;return`<div style="font-family:'Segoe UI',sans-serif;padding:4px 0"><div style="font-size:11px;color:${theme_tokens.rf.gray500};margin-bottom:4px">${params[0].name}</div><div style="font-size:13px;font-weight:600;color:${theme_tokens.rf.navy}">${params[0].marker}${params[0].value}d</div></div>`},extraCssText:"border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.12);padding:10px 14px;"},xAxis:{type:"category",data:evCategories,axisLabel:{fontSize:12,fontWeight:600,color:theme_tokens.rf.gray700},axisLine:{lineStyle:{color:theme_tokens.rf.gray200}},axisTick:{show:!1}},yAxis:{type:"value",axisLabel:{fontSize:11,formatter:v=>`${v}d`,color:theme_tokens.rf.gray500},splitLine:{lineStyle:{color:theme_tokens.rf.gray100,type:"dashed"}},axisLine:{show:!1},axisTick:{show:!1}},series:[{type:"line",name:"Earned Value",data:evValues.map((v,i)=>({value:v,label:{show:!0,formatter:`${v}d`,fontSize:11,color:evColors[i]},itemStyle:{color:evColors[i]}})),lineStyle:{color:theme_tokens.rf.navy,width:2},symbol:"circle",symbolSize:8,areaStyle:{color:`${theme_tokens.rf.info}20`}}]}),[ev]);return(0,jsx_runtime.jsx)(ChartCard,{title:"Earned Value",subtitle:`SV: ${ev.sv>=0?"+":""}${ev.sv}d | SPI: ${null!==(_a=ev.spi)&&void 0!==_a?_a:"N/A"} | CPI: ${null!==(_b=ev.cpi)&&void 0!==_b?_b:"N/A"}`,children:(0,jsx_runtime.jsx)(HbcEChart.D,{option,height:300,ariaLabel:"Earned value metrics line chart"})})},ChartCard=({title,subtitle,children})=>(0,jsx_runtime.jsxs)("div",{style:cardStyle,role:"img","aria-label":`${title}${subtitle?`: ${subtitle}`:""}`,children:[(0,jsx_runtime.jsx)("div",{style:{fontSize:14,fontWeight:600,color:theme_tokens.rf.navy,marginBottom:2},children:title}),subtitle&&(0,jsx_runtime.jsx)("div",{style:{fontSize:11,color:theme_tokens.rf.gray400,marginBottom:12},children:subtitle}),children]}),EmptyChart=({message})=>(0,jsx_runtime.jsx)("div",{style:{height:300,display:"flex",alignItems:"center",justifyContent:"center",color:theme_tokens.rf.gray400,fontSize:13},children:message||"No data available"}),cardStyle={backgroundColor:"#fff",borderRadius:8,border:`1px solid ${theme_tokens.rf.gray200}`,padding:20,boxShadow:theme_tokens.sp.level1};try{ScheduleAnalysisTab.displayName="ScheduleAnalysisTab",ScheduleAnalysisTab.__docgenInfo={description:"",displayName:"ScheduleAnalysisTab",props:{activities:{defaultValue:null,description:"",name:"activities",required:!0,type:{name:"IScheduleActivity[]"}},metrics:{defaultValue:null,description:"",name:"metrics",required:!0,type:{name:"IScheduleMetrics"}},projectCode:{defaultValue:null,description:"",name:"projectCode",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/pages/project/ScheduleAnalysisTab.tsx#ScheduleAnalysisTab"]={docgenInfo:ScheduleAnalysisTab.__docgenInfo,name:"ScheduleAnalysisTab",path:"src/webparts/hbcProjectControls/components/pages/project/ScheduleAnalysisTab.tsx#ScheduleAnalysisTab"})}catch(__react_docgen_typescript_loader_error){}const STATUS_COLORS={Active:theme_tokens.rf.error,Monitoring:"#3B82F6",Resolved:theme_tokens.rf.success},ProjectScheduleCriticalPath_cardStyle={backgroundColor:"#fff",borderRadius:8,padding:24,boxShadow:theme_tokens.sp.level1,marginBottom:16},ProjectScheduleCriticalPath=()=>{var _a,_b,_c,_d,_e,_f,_g,_h;const location=(0,router.zy)(),breadcrumbs=(0,src.ZFx)(location.pathname),{selectedProject,hasPermission,dataService,currentUser}=(0,AppContext.Us)(),{schedule,isLoading,error,fetchSchedule,updateSchedule,addCriticalPathItem,daysToCompletion}=function useProjectSchedule(){const{dataService,currentUser}=(0,AppContext.Us)(),{broadcastChange}=(0,SignalRContext.$)(),[schedule,setSchedule]=react.useState(null),[isLoading,setIsLoading]=react.useState(!1),[error,setError]=react.useState(null),lastProjectCodeRef=react.useRef(null),fetchSchedule=react.useCallback(async projectCode=>{try{setIsLoading(!0),setError(null),lastProjectCodeRef.current=projectCode;const result=await dataService.getProjectSchedule(projectCode);setSchedule(result)}catch(err){setError(err instanceof Error?err.message:"Failed to fetch schedule")}finally{setIsLoading(!1)}},[dataService]);(0,useSignalR.k)({entityType:src.ckT.Schedule,onEntityChanged:react.useCallback(()=>{lastProjectCodeRef.current&&fetchSchedule(lastProjectCodeRef.current)},[fetchSchedule])});const broadcastScheduleChange=react.useCallback((entityId,action,summary)=>{var _a;broadcastChange({type:"EntityChanged",entityType:src.ckT.Schedule,entityId:String(entityId),action,changedBy:null!==(_a=null==currentUser?void 0:currentUser.email)&&void 0!==_a?_a:"unknown",changedByName:null==currentUser?void 0:currentUser.displayName,timestamp:(new Date).toISOString(),summary,projectCode:lastProjectCodeRef.current||void 0})},[broadcastChange,currentUser]),updateSchedule=react.useCallback(async(projectCode,data)=>{const updated=await dataService.updateProjectSchedule(projectCode,data);setSchedule(updated),broadcastScheduleChange("schedule","updated","Schedule updated"),dataService.syncToDataMart(projectCode).catch(()=>{})},[dataService,broadcastScheduleChange]),addCriticalPathItem=react.useCallback(async(projectCode,item)=>{const created=await dataService.addCriticalPathItem(projectCode,item),refreshed=await dataService.getProjectSchedule(projectCode);return setSchedule(refreshed),broadcastScheduleChange(created.id,"created","Critical path item added"),dataService.syncToDataMart(projectCode).catch(()=>{}),created},[dataService,broadcastScheduleChange]),daysToCompletion=react.useMemo(()=>{if(!(null==schedule?void 0:schedule.substantialCompletionDate))return null;const today=new Date,completion=new Date(schedule.substantialCompletionDate);return Math.ceil((completion.getTime()-today.getTime())/864e5)},[schedule]);return{schedule,isLoading,error,fetchSchedule,updateSchedule,addCriticalPathItem,daysToCompletion}}(),projectCode=null!==(_a=null==selectedProject?void 0:selectedProject.projectCode)&&void 0!==_a?_a:"",canEdit=hasPermission(src.JjK.SCHEDULE_EDIT);react.useEffect(()=>{projectCode&&fetchSchedule(projectCode).catch(console.error)},[projectCode,fetchSchedule]);const handleFieldBlur=react.useCallback(async(field,value)=>{var _a;canEdit&&schedule&&(await updateSchedule(projectCode,{[field]:value}),dataService.logAudit({Action:src.IM5.ScheduleUpdated,EntityType:src.ckT.Schedule,EntityId:projectCode,User:null!==(_a=null==currentUser?void 0:currentUser.email)&&void 0!==_a?_a:"",Details:`Updated ${field}`,ProjectCode:projectCode}).catch(console.error))},[canEdit,schedule,projectCode,updateSchedule,dataService,currentUser]),handleAddConcern=react.useCallback(async()=>{var _a;if(!schedule)return;const nextLetter=String.fromCharCode(65+schedule.criticalPathConcerns.length);await addCriticalPathItem(projectCode,{letter:nextLetter}),dataService.logAudit({Action:src.IM5.ScheduleUpdated,EntityType:src.ckT.Schedule,EntityId:projectCode,User:null!==(_a=null==currentUser?void 0:currentUser.email)&&void 0!==_a?_a:"",Details:`Added critical path item ${nextLetter}`,ProjectCode:projectCode}).catch(console.error)},[schedule,projectCode,addCriticalPathItem,dataService,currentUser]);if(isLoading)return(0,jsx_runtime.jsx)(SkeletonLoader.j,{variant:"card"});if(error)return(0,jsx_runtime.jsx)("div",{style:{padding:24,color:theme_tokens.rf.error},children:error});if(!schedule)return(0,jsx_runtime.jsx)("div",{style:{padding:48,textAlign:"center",color:theme_tokens.rf.gray400},children:"No schedule data for this project."});const inputStyle={border:`1px solid ${theme_tokens.rf.gray200}`,borderRadius:4,padding:"6px 8px",fontSize:13,width:"100%"},labelStyle={fontSize:12,color:theme_tokens.rf.gray500,display:"block",marginBottom:4};return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(PageHeader.z,{title:"Schedule & Critical Path",subtitle:projectCode,breadcrumb:(0,jsx_runtime.jsx)(Breadcrumb.Q,{items:breadcrumbs})}),null!==daysToCompletion&&(0,jsx_runtime.jsxs)("div",{style:Object.assign(Object.assign({},ProjectScheduleCriticalPath_cardStyle),{display:"flex",gap:24,alignItems:"center"}),children:[(0,jsx_runtime.jsx)("div",{style:{fontSize:32,fontWeight:700,color:daysToCompletion>90?theme_tokens.rf.success:daysToCompletion>30?theme_tokens.rf.warning:theme_tokens.rf.error},children:daysToCompletion}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{style:{fontSize:14,fontWeight:600},children:"Days to Substantial Completion"}),(0,jsx_runtime.jsxs)("div",{style:{fontSize:12,color:theme_tokens.rf.gray500},children:["Target: ",schedule.substantialCompletionDate]})]})]}),(0,jsx_runtime.jsxs)("div",{style:ProjectScheduleCriticalPath_cardStyle,children:[(0,jsx_runtime.jsx)("h3",{style:{margin:"0 0 16px",color:theme_tokens.rf.navy,fontSize:16},children:"Key Dates"}),(0,jsx_runtime.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[{label:"Start Date",field:"startDate",value:schedule.startDate},{label:"Substantial Completion",field:"substantialCompletionDate",value:schedule.substantialCompletionDate},{label:"NTP Date",field:"ntpDate",value:schedule.ntpDate},{label:"NOC Date",field:"nocDate",value:schedule.nocDate}].map(d=>{var _a,_b;return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{style:labelStyle,children:d.label}),canEdit?(0,jsx_runtime.jsx)("input",{type:"date",defaultValue:null!==(_a=d.value)&&void 0!==_a?_a:"",onBlur:e=>handleFieldBlur(d.field,e.target.value||null),style:inputStyle}):(0,jsx_runtime.jsx)("span",{style:{fontSize:14},children:null!==(_b=d.value)&&void 0!==_b?_b:"-"})]},d.field)})}),(0,jsx_runtime.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginTop:16},children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{style:labelStyle,children:"Contract Calendar Days"}),canEdit?(0,jsx_runtime.jsx)("input",{type:"number",defaultValue:null!==(_b=schedule.contractCalendarDays)&&void 0!==_b?_b:"",onBlur:e=>handleFieldBlur("contractCalendarDays",e.target.value?parseInt(e.target.value):null),style:inputStyle}):(0,jsx_runtime.jsx)("span",{style:{fontSize:14},children:null!==(_c=schedule.contractCalendarDays)&&void 0!==_c?_c:"-"})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{style:labelStyle,children:"Basis Type"}),canEdit?(0,jsx_runtime.jsx)("input",{defaultValue:schedule.contractBasisType,onBlur:e=>handleFieldBlur("contractBasisType",e.target.value),style:inputStyle}):(0,jsx_runtime.jsx)("span",{style:{fontSize:14},children:schedule.contractBasisType})]})]})]}),(0,jsx_runtime.jsxs)("div",{style:ProjectScheduleCriticalPath_cardStyle,children:[(0,jsx_runtime.jsx)("h3",{style:{margin:"0 0 12px",color:theme_tokens.rf.navy,fontSize:16},children:"Team Goal"}),(0,jsx_runtime.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",gap:16},children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{style:labelStyle,children:"Days Ahead"}),canEdit?(0,jsx_runtime.jsx)("input",{type:"number",defaultValue:null!==(_d=schedule.teamGoalDaysAhead)&&void 0!==_d?_d:"",onBlur:e=>handleFieldBlur("teamGoalDaysAhead",e.target.value?parseInt(e.target.value):null),style:inputStyle}):(0,jsx_runtime.jsx)("span",{style:{fontSize:14},children:null!==(_e=schedule.teamGoalDaysAhead)&&void 0!==_e?_e:"-"})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{style:labelStyle,children:"Description"}),canEdit?(0,jsx_runtime.jsx)("input",{defaultValue:schedule.teamGoalDescription,onBlur:e=>handleFieldBlur("teamGoalDescription",e.target.value),style:inputStyle}):(0,jsx_runtime.jsx)("span",{style:{fontSize:14},children:schedule.teamGoalDescription})]})]})]}),(0,jsx_runtime.jsxs)("div",{style:ProjectScheduleCriticalPath_cardStyle,children:[(0,jsx_runtime.jsx)("h3",{style:{margin:"0 0 12px",color:theme_tokens.rf.navy,fontSize:16},children:"Liquidated Damages"}),(0,jsx_runtime.jsx)("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:12},children:(0,jsx_runtime.jsxs)("label",{style:{fontSize:13},children:[(0,jsx_runtime.jsx)("input",{type:"checkbox",checked:schedule.hasLiquidatedDamages,onChange:e=>handleFieldBlur("hasLiquidatedDamages",e.target.checked),disabled:!canEdit,style:{marginRight:8}}),"Liquidated Damages Apply"]})}),schedule.hasLiquidatedDamages&&(0,jsx_runtime.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"200px 1fr",gap:16},children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{style:labelStyle,children:"Amount (per day)"}),canEdit?(0,jsx_runtime.jsx)("input",{type:"number",defaultValue:null!==(_f=schedule.liquidatedDamagesAmount)&&void 0!==_f?_f:"",onBlur:e=>handleFieldBlur("liquidatedDamagesAmount",e.target.value?parseFloat(e.target.value):null),style:inputStyle}):(0,jsx_runtime.jsxs)("span",{style:{fontSize:14},children:["$",null!==(_h=null===(_g=schedule.liquidatedDamagesAmount)||void 0===_g?void 0:_g.toLocaleString())&&void 0!==_h?_h:"-"]})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{style:labelStyle,children:"Terms"}),canEdit?(0,jsx_runtime.jsx)("input",{defaultValue:schedule.liquidatedDamagesTerms,onBlur:e=>handleFieldBlur("liquidatedDamagesTerms",e.target.value),style:inputStyle}):(0,jsx_runtime.jsx)("span",{style:{fontSize:14},children:schedule.liquidatedDamagesTerms})]})]})]}),(0,jsx_runtime.jsxs)("div",{style:ProjectScheduleCriticalPath_cardStyle,children:[(0,jsx_runtime.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,jsx_runtime.jsx)("h3",{style:{margin:0,color:theme_tokens.rf.navy,fontSize:16},children:"Critical Path Concerns"}),canEdit&&(0,jsx_runtime.jsx)("button",{onClick:handleAddConcern,style:{padding:"6px 12px",backgroundColor:theme_tokens.rf.navy,color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:13},children:"+ Add"})]}),(0,jsx_runtime.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[(0,jsx_runtime.jsx)("thead",{children:(0,jsx_runtime.jsxs)("tr",{style:{borderBottom:`2px solid ${theme_tokens.rf.gray200}`},children:[(0,jsx_runtime.jsx)("th",{style:{textAlign:"left",padding:"8px 4px",width:40},children:"#"}),(0,jsx_runtime.jsx)("th",{style:{textAlign:"left",padding:"8px 4px"},children:"Description"}),(0,jsx_runtime.jsx)("th",{style:{textAlign:"left",padding:"8px 4px"},children:"Impact"}),(0,jsx_runtime.jsx)("th",{style:{textAlign:"center",padding:"8px 4px",width:100},children:"Status"}),(0,jsx_runtime.jsx)("th",{style:{textAlign:"left",padding:"8px 4px"},children:"Mitigation Plan"})]})}),(0,jsx_runtime.jsxs)("tbody",{children:[schedule.criticalPathConcerns.map(item=>(0,jsx_runtime.jsxs)("tr",{style:{borderBottom:`1px solid ${theme_tokens.rf.gray100}`},children:[(0,jsx_runtime.jsx)("td",{style:{padding:"8px 4px",fontWeight:600},children:item.letter}),(0,jsx_runtime.jsx)("td",{style:{padding:"8px 4px"},children:item.description||(0,jsx_runtime.jsx)("span",{style:{color:theme_tokens.rf.gray300},children:"Enter description..."})}),(0,jsx_runtime.jsx)("td",{style:{padding:"8px 4px",fontSize:12},children:item.impactDescription}),(0,jsx_runtime.jsx)("td",{style:{padding:"8px 4px",textAlign:"center"},children:(0,jsx_runtime.jsx)("span",{style:{padding:"2px 8px",borderRadius:12,fontSize:11,fontWeight:600,backgroundColor:`${STATUS_COLORS[item.status]}20`,color:STATUS_COLORS[item.status]},children:item.status})}),(0,jsx_runtime.jsx)("td",{style:{padding:"8px 4px",fontSize:12},children:item.mitigationPlan})]},item.id)),0===schedule.criticalPathConcerns.length&&(0,jsx_runtime.jsx)("tr",{children:(0,jsx_runtime.jsx)("td",{colSpan:5,style:{padding:16,textAlign:"center",color:theme_tokens.rf.gray400},children:"No critical path concerns"})})]})]})]})]})};try{ProjectScheduleCriticalPath.displayName="ProjectScheduleCriticalPath",ProjectScheduleCriticalPath.__docgenInfo={description:"",displayName:"ProjectScheduleCriticalPath",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/pages/project/ProjectScheduleCriticalPath.tsx#ProjectScheduleCriticalPath"]={docgenInfo:ProjectScheduleCriticalPath.__docgenInfo,name:"ProjectScheduleCriticalPath",path:"src/webparts/hbcProjectControls/components/pages/project/ProjectScheduleCriticalPath.tsx#ProjectScheduleCriticalPath"})}catch(__react_docgen_typescript_loader_error){}const TABS=["overview","activities","gantt","critical-path","analysis","import"],TAB_LABELS={overview:"Overview",activities:"Activities",gantt:"Gantt","critical-path":"Critical Path",analysis:"Analysis",import:"Import"},STATUS_OPTIONS=["Completed","In Progress","Not Started"],SchedulePage_STATUS_COLORS={Completed:theme_tokens.rf.success,"In Progress":theme_tokens.rf.warning,"Not Started":theme_tokens.rf.gray400},SchedulePage=()=>{var _a;const location=(0,router.zy)(),breadcrumbs=(0,src.ZFx)(location.pathname),{selectedProject,hasPermission}=(0,AppContext.Us)(),{activities,imports,isLoading,error,metrics,fetchActivities,fetchImports,importActivities}=useScheduleActivities(),{addToast}=(0,ToastContainer.d)(),projectCode=null!==(_a=null==selectedProject?void 0:selectedProject.projectCode)&&void 0!==_a?_a:"",canView=hasPermission(src.JjK.SCHEDULE_VIEW),canImport=hasPermission(src.JjK.SCHEDULE_IMPORT),[activeTab,setTab]=function useTabFromUrl(defaultTab,validTabs){const location=(0,router.zy)(),navigate=(0,router.Zp)(),initialTab=react.useMemo(()=>{const searchStr=location.search||"",urlTab=new URLSearchParams(searchStr).get("tab");return urlTab&&validTabs.includes(urlTab)?urlTab:defaultTab},[]),[activeTab,setActiveTab]=react.useState(initialTab);return[activeTab,react.useCallback(tab=>{setActiveTab(tab);const params=new URLSearchParams(location.search||"");tab===defaultTab?params.delete("tab"):params.set("tab",tab);const qs=params.toString(),newPath=qs?`${location.pathname}?${qs}`:location.pathname;navigate(newPath,{replace:!0})},[defaultTab,location.pathname,location.search,navigate])]}("overview",TABS),[search,setSearch]=(0,usePersistedState.y)("schedule-search",""),[statusFilter,setStatusFilter]=(0,usePersistedState.y)("schedule-status","all"),[criticalOnly,setCriticalOnly]=(0,usePersistedState.y)("schedule-critical",!1),[wbsFilter,setWbsFilter]=(0,usePersistedState.y)("schedule-wbs","all"),[dateStart,setDateStart]=(0,usePersistedState.y)("schedule-date-start",""),[dateEnd,setDateEnd]=(0,usePersistedState.y)("schedule-date-end",""),[floatMin,setFloatMin]=(0,usePersistedState.y)("schedule-float-min",""),[floatMax,setFloatMax]=(0,usePersistedState.y)("schedule-float-max",""),[actTypeFilter,setActTypeFilter]=(0,usePersistedState.y)("schedule-acttype","all"),[sortField,setSortField]=react.useState("taskCode"),[sortDir,setSortDir]=react.useState("asc"),[showImport,setShowImport]=react.useState(!1);react.useEffect(()=>{projectCode&&(fetchActivities(projectCode).catch(console.error),fetchImports(projectCode).catch(console.error))},[projectCode,fetchActivities,fetchImports]);const wbsPrefixes=react.useMemo(()=>{const set=new Set;return activities.forEach(a=>{if(a.wbsCode){const parts=a.wbsCode.split(".");set.add(parts.slice(0,2).join("."))}}),Array.from(set).sort()},[activities]),activityTypes=react.useMemo(()=>{const set=new Set;return activities.forEach(a=>{a.activityType&&set.add(a.activityType)}),Array.from(set).sort()},[activities]),filtered=react.useMemo(()=>{let list=activities;if(search){const q=search.toLowerCase();list=list.filter(a=>a.taskCode.toLowerCase().includes(q)||a.activityName.toLowerCase().includes(q)||a.wbsCode.toLowerCase().includes(q))}if("all"!==statusFilter&&(list=list.filter(a=>a.status===statusFilter)),criticalOnly&&(list=list.filter(a=>a.isCritical)),"all"!==wbsFilter&&(list=list.filter(a=>a.wbsCode.startsWith(wbsFilter))),"all"!==actTypeFilter&&(list=list.filter(a=>a.activityType===actTypeFilter)),dateStart){const ds=new Date(dateStart).getTime();list=list.filter(a=>{const d=a.plannedStartDate?new Date(a.plannedStartDate).getTime():null;return null!==d&&d>=ds})}if(dateEnd){const de=new Date(dateEnd).getTime();list=list.filter(a=>{const d=a.plannedStartDate?new Date(a.plannedStartDate).getTime():null;return null!==d&&d<=de})}if(""!==floatMin){const fMin=parseFloat(floatMin);isNaN(fMin)||(list=list.filter(a=>null!==a.remainingFloat&&a.remainingFloat>=fMin))}if(""!==floatMax){const fMax=parseFloat(floatMax);isNaN(fMax)||(list=list.filter(a=>null!==a.remainingFloat&&a.remainingFloat<=fMax))}return list=[...list].sort((a,b)=>{const aVal=a[sortField],bVal=b[sortField];if(null==aVal&&null==bVal)return 0;if(null==aVal)return 1;if(null==bVal)return-1;const cmp="string"==typeof aVal?aVal.localeCompare(bVal):aVal-bVal;return"asc"===sortDir?cmp:-cmp}),list},[activities,search,statusFilter,criticalOnly,wbsFilter,actTypeFilter,dateStart,dateEnd,floatMin,floatMax,sortField,sortDir]),criticalActivities=react.useMemo(()=>activities.filter(a=>a.isCritical),[activities]),ganttRange=react.useMemo(()=>{const starts=activities.map(a=>a.plannedStartDate||a.actualStartDate).filter(Boolean),ends=activities.map(a=>a.plannedFinishDate||a.actualFinishDate).filter(Boolean);if(0===starts.length||0===ends.length)return null;const min=new Date(starts.sort()[0]),max=new Date(ends.sort()[ends.length-1]),totalDays=Math.max(1,Math.ceil((max.getTime()-min.getTime())/864e5));return{min,max,totalDays}},[activities]);return isLoading&&0===activities.length?(0,jsx_runtime.jsx)(SkeletonLoader.j,{variant:"table",rows:8,columns:6}):error?(0,jsx_runtime.jsx)("div",{style:{padding:48,textAlign:"center",color:theme_tokens.rf.error},children:error}):(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(PageHeader.z,{title:"Schedule Management",subtitle:projectCode,breadcrumb:(0,jsx_runtime.jsx)(Breadcrumb.Q,{items:breadcrumbs}),actions:canImport?(0,jsx_runtime.jsx)("button",{onClick:()=>setShowImport(!0),style:btnPrimary,"aria-label":"Import schedule file",children:"Import Schedule"}):void 0}),(0,jsx_runtime.jsx)("div",{role:"tablist","aria-label":"Schedule management tabs",style:{display:"flex",gap:0,borderBottom:`2px solid ${theme_tokens.rf.gray200}`,marginBottom:24},children:TABS.map(tab=>"import"!==tab||canImport?(0,jsx_runtime.jsx)("button",{role:"tab","aria-selected":activeTab===tab,onClick:()=>setTab(tab),style:{padding:"10px 20px",fontSize:13,fontWeight:activeTab===tab?600:400,color:activeTab===tab?theme_tokens.rf.navy:theme_tokens.rf.gray500,backgroundColor:"transparent",border:"none",borderBottom:activeTab===tab?`2px solid ${theme_tokens.rf.orange}`:"2px solid transparent",cursor:"pointer",marginBottom:-2},children:TAB_LABELS[tab]},tab):null)}),"overview"===activeTab&&(0,jsx_runtime.jsx)(OverviewTab,{metrics,activities,canImport,onOpenImport:()=>setShowImport(!0)}),"activities"===activeTab&&(0,jsx_runtime.jsx)(ActivitiesTab,{filtered,search,onSearchChange:setSearch,statusFilter,onStatusFilterChange:setStatusFilter,criticalOnly,onCriticalOnlyChange:setCriticalOnly,wbsFilter,onWbsFilterChange:setWbsFilter,wbsPrefixes,actTypeFilter,onActTypeFilterChange:setActTypeFilter,activityTypes,dateStart,onDateStartChange:setDateStart,dateEnd,onDateEndChange:setDateEnd,floatMin,onFloatMinChange:setFloatMin,floatMax,onFloatMaxChange:setFloatMax,sortField,sortDir,onSort:field=>{sortField===field?setSortDir(d=>"asc"===d?"desc":"asc"):(setSortField(field),setSortDir("asc"))},canView,projectCode}),"gantt"===activeTab&&(0,jsx_runtime.jsx)(GanttTab,{activities:filtered,ganttRange}),"critical-path"===activeTab&&(0,jsx_runtime.jsx)(CriticalPathTab,{criticalActivities}),"analysis"===activeTab&&(0,jsx_runtime.jsx)(ScheduleAnalysisTab,{activities,metrics,projectCode}),"import"===activeTab&&canImport&&(0,jsx_runtime.jsx)(ImportTab,{imports,onOpenImport:()=>setShowImport(!0)}),(0,jsx_runtime.jsx)(ScheduleImportModal,{isOpen:showImport,onClose:()=>setShowImport(!1),onImport:async(parsedActivities,meta)=>{await importActivities(projectCode,parsedActivities,meta),addToast(`Imported ${parsedActivities.length} activities`,"success")},projectCode})]})},OverviewTab=({metrics,activities,canImport,onOpenImport})=>{if(0===activities.length)return(0,jsx_runtime.jsxs)("div",{style:{padding:48,textAlign:"center",color:theme_tokens.rf.gray400},children:[(0,jsx_runtime.jsx)("div",{children:"No schedule data. Import a schedule file to get started."}),canImport&&(0,jsx_runtime.jsx)("button",{onClick:onOpenImport,style:Object.assign(Object.assign({},btnPrimary),{marginTop:16}),"aria-label":"Import schedule file",children:"Import Schedule"})]});const{earnedValueMetrics:ev}=metrics;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:16,marginBottom:16},children:[(0,jsx_runtime.jsx)(MetricCard,{label:"Total Activities",value:String(metrics.totalActivities),color:theme_tokens.rf.navy}),(0,jsx_runtime.jsx)(MetricCard,{label:"% Complete",value:`${metrics.percentComplete}%`,color:"#3B82F6"}),(0,jsx_runtime.jsx)(MetricCard,{label:"Critical Activities",value:String(metrics.criticalActivityCount),color:theme_tokens.rf.error,subtitle:`${metrics.negativeFloatCount} negative float`}),(0,jsx_runtime.jsx)(MetricCard,{label:"Avg Float",value:`${metrics.averageFloat}d`,color:metrics.averageFloat<5?theme_tokens.rf.error:metrics.averageFloat<15?theme_tokens.rf.warning:theme_tokens.rf.success}),(0,jsx_runtime.jsx)(MetricCard,{label:"SPI (approx)",value:null!==metrics.spiApproximation?String(metrics.spiApproximation):"N/A",color:null!==metrics.spiApproximation&&metrics.spiApproximation>=1?theme_tokens.rf.success:theme_tokens.rf.warning})]}),(0,jsx_runtime.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16,marginBottom:24},children:[(0,jsx_runtime.jsx)(MetricCard,{label:"CPI",value:null!==ev.cpi?String(ev.cpi):"N/A",color:null!==ev.cpi&&ev.cpi>=1?theme_tokens.rf.success:theme_tokens.rf.warning,subtitle:"Cost Performance Index"}),(0,jsx_runtime.jsx)(MetricCard,{label:"Neg Float %",value:`${metrics.negativeFloatPercent}%`,color:metrics.negativeFloatPercent>10?theme_tokens.rf.error:metrics.negativeFloatPercent>5?theme_tokens.rf.warning:theme_tokens.rf.success}),(0,jsx_runtime.jsx)(MetricCard,{label:"Schedule Var",value:`${ev.sv>=0?"+":""}${ev.sv}d`,color:ev.sv>=0?theme_tokens.rf.success:theme_tokens.rf.error,subtitle:`EV: ${ev.ev}d / PV: ${ev.pv}d`}),(0,jsx_runtime.jsx)(MetricCard,{label:"Open Ends",value:String(metrics.logicMetrics.openEnds.noPredecessor+metrics.logicMetrics.openEnds.noSuccessor),color:theme_tokens.rf.info,subtitle:`${metrics.logicMetrics.openEnds.noPredecessor} no pred, ${metrics.logicMetrics.openEnds.noSuccessor} no succ`})]}),(0,jsx_runtime.jsxs)("div",{style:SchedulePage_cardStyle,children:[(0,jsx_runtime.jsx)("div",{style:{fontSize:14,fontWeight:600,color:theme_tokens.rf.navy,marginBottom:12},children:"Status Distribution"}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",height:32,borderRadius:6,overflow:"hidden",marginBottom:8},children:[metrics.completedCount>0&&(0,jsx_runtime.jsx)("div",{style:{flex:metrics.completedCount,backgroundColor:theme_tokens.rf.success,display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:11,fontWeight:600},children:metrics.completedCount}),metrics.inProgressCount>0&&(0,jsx_runtime.jsx)("div",{style:{flex:metrics.inProgressCount,backgroundColor:theme_tokens.rf.warning,display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:11,fontWeight:600},children:metrics.inProgressCount}),metrics.notStartedCount>0&&(0,jsx_runtime.jsx)("div",{style:{flex:metrics.notStartedCount,backgroundColor:theme_tokens.rf.gray400,display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:11,fontWeight:600},children:metrics.notStartedCount})]}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",gap:16,fontSize:12},children:[(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)("span",{style:{display:"inline-block",width:10,height:10,borderRadius:2,backgroundColor:theme_tokens.rf.success,marginRight:4}}),"Completed (",metrics.completedCount,")"]}),(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)("span",{style:{display:"inline-block",width:10,height:10,borderRadius:2,backgroundColor:theme_tokens.rf.warning,marginRight:4}}),"In Progress (",metrics.inProgressCount,")"]}),(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)("span",{style:{display:"inline-block",width:10,height:10,borderRadius:2,backgroundColor:theme_tokens.rf.gray400,marginRight:4}}),"Not Started (",metrics.notStartedCount,")"]})]})]})]})},ActivitiesTab=({filtered,search,onSearchChange,statusFilter,onStatusFilterChange,criticalOnly,onCriticalOnlyChange,wbsFilter,onWbsFilterChange,wbsPrefixes,actTypeFilter,onActTypeFilterChange,activityTypes,dateStart,onDateStartChange,dateEnd,onDateEndChange,floatMin,onFloatMinChange,floatMax,onFloatMaxChange,sortField,sortDir,onSort,projectCode})=>{const exportData=react.useMemo(()=>filtered.map(a=>({"Activity ID":a.taskCode,WBS:a.wbsCode,Name:a.activityName,Status:a.status,"Orig Duration":a.originalDuration,Remaining:a.remainingDuration,Start:a.plannedStartDate||a.actualStartDate||"",Finish:a.plannedFinishDate||a.actualFinishDate||"",Float:a.remainingFloat,"% Complete":a.percentComplete,Critical:a.isCritical?"Yes":"No"})),[filtered]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:8,alignItems:"center"},children:[(0,jsx_runtime.jsx)("input",{type:"text",placeholder:"Search activities...",value:search,onChange:e=>onSearchChange(e.target.value),style:Object.assign(Object.assign({},inputStyle),{flex:1}),"aria-label":"Search schedule activities"}),(0,jsx_runtime.jsxs)("select",{value:statusFilter,onChange:e=>onStatusFilterChange(e.target.value),style:Object.assign(Object.assign({},inputStyle),{width:150}),"aria-label":"Filter by status",children:[(0,jsx_runtime.jsx)("option",{value:"all",children:"All Statuses"}),STATUS_OPTIONS.map(s=>(0,jsx_runtime.jsx)("option",{value:s,children:s},s))]}),wbsPrefixes.length>0&&(0,jsx_runtime.jsxs)("select",{value:wbsFilter,onChange:e=>onWbsFilterChange(e.target.value),style:Object.assign(Object.assign({},inputStyle),{width:150}),"aria-label":"Filter by WBS",children:[(0,jsx_runtime.jsx)("option",{value:"all",children:"All WBS"}),wbsPrefixes.map(w=>(0,jsx_runtime.jsx)("option",{value:w,children:w},w))]}),activityTypes.length>1&&(0,jsx_runtime.jsxs)("select",{value:actTypeFilter,onChange:e=>onActTypeFilterChange(e.target.value),style:Object.assign(Object.assign({},inputStyle),{width:160}),"aria-label":"Filter by activity type",children:[(0,jsx_runtime.jsx)("option",{value:"all",children:"All Types"}),activityTypes.map(t=>(0,jsx_runtime.jsx)("option",{value:t,children:t},t))]}),(0,jsx_runtime.jsxs)("label",{style:{fontSize:13,display:"flex",alignItems:"center",gap:4,whiteSpace:"nowrap"},children:[(0,jsx_runtime.jsx)("input",{type:"checkbox",checked:criticalOnly,onChange:e=>onCriticalOnlyChange(e.target.checked)}),"Critical Only"]})]}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:16,alignItems:"center"},children:[(0,jsx_runtime.jsx)("label",{style:{fontSize:12,color:theme_tokens.rf.gray500,whiteSpace:"nowrap"},children:"Start from:"}),(0,jsx_runtime.jsx)("input",{type:"date",value:dateStart,onChange:e=>onDateStartChange(e.target.value),style:Object.assign(Object.assign({},inputStyle),{width:140}),"aria-label":"Filter date range start"}),(0,jsx_runtime.jsx)("label",{style:{fontSize:12,color:theme_tokens.rf.gray500,whiteSpace:"nowrap"},children:"to:"}),(0,jsx_runtime.jsx)("input",{type:"date",value:dateEnd,onChange:e=>onDateEndChange(e.target.value),style:Object.assign(Object.assign({},inputStyle),{width:140}),"aria-label":"Filter date range end"}),(0,jsx_runtime.jsx)("div",{style:{width:1,height:20,backgroundColor:theme_tokens.rf.gray200}}),(0,jsx_runtime.jsx)("label",{style:{fontSize:12,color:theme_tokens.rf.gray500,whiteSpace:"nowrap"},children:"Float:"}),(0,jsx_runtime.jsx)("input",{type:"number",placeholder:"Min",value:floatMin,onChange:e=>onFloatMinChange(e.target.value),style:Object.assign(Object.assign({},inputStyle),{width:70}),"aria-label":"Minimum float filter"}),(0,jsx_runtime.jsx)("span",{style:{fontSize:12,color:theme_tokens.rf.gray500},children:"-"}),(0,jsx_runtime.jsx)("input",{type:"number",placeholder:"Max",value:floatMax,onChange:e=>onFloatMaxChange(e.target.value),style:Object.assign(Object.assign({},inputStyle),{width:70}),"aria-label":"Maximum float filter"}),(0,jsx_runtime.jsx)("div",{style:{flex:1}}),(0,jsx_runtime.jsx)(ExportButtons,{pdfElementId:"schedule-activities-table",data:exportData,filename:`schedule-activities-${projectCode}`,title:"Schedule Activities"})]}),(0,jsx_runtime.jsxs)("div",{style:{fontSize:12,color:theme_tokens.rf.gray500,marginBottom:8},children:["Showing ",filtered.length," activities"]}),(0,jsx_runtime.jsx)("div",{id:"schedule-activities-table",style:{overflowX:"auto"},children:(0,jsx_runtime.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[(0,jsx_runtime.jsx)("thead",{children:(0,jsx_runtime.jsxs)("tr",{style:{borderBottom:`2px solid ${theme_tokens.rf.gray200}`},children:[(0,jsx_runtime.jsx)(ThSort,{field:"taskCode",current:sortField,dir:sortDir,onSort,children:"Activity ID"}),(0,jsx_runtime.jsx)(Th,{children:"WBS"}),(0,jsx_runtime.jsx)(ThSort,{field:"activityName",current:sortField,dir:sortDir,onSort,children:"Name"}),(0,jsx_runtime.jsx)(ThSort,{field:"status",current:sortField,dir:sortDir,onSort,children:"Status"}),(0,jsx_runtime.jsx)(ThSort,{field:"originalDuration",current:sortField,dir:sortDir,onSort,children:"Orig Dur"}),(0,jsx_runtime.jsx)(Th,{children:"Remaining"}),(0,jsx_runtime.jsx)(Th,{children:"Start"}),(0,jsx_runtime.jsx)(Th,{children:"Finish"}),(0,jsx_runtime.jsx)(ThSort,{field:"remainingFloat",current:sortField,dir:sortDir,onSort,children:"Float"}),(0,jsx_runtime.jsx)(ThSort,{field:"percentComplete",current:sortField,dir:sortDir,onSort,children:"% Complete"}),(0,jsx_runtime.jsx)(Th,{align:"center",children:"Critical"})]})}),(0,jsx_runtime.jsxs)("tbody",{children:[filtered.map(a=>(0,jsx_runtime.jsxs)("tr",{style:{borderBottom:`1px solid ${theme_tokens.rf.gray100}`,backgroundColor:a.isCritical?"#FEF2F2":void 0},children:[(0,jsx_runtime.jsx)(Td,{bold:!0,children:a.taskCode}),(0,jsx_runtime.jsx)(Td,{children:(0,jsx_runtime.jsx)("span",{style:{fontSize:11,color:theme_tokens.rf.gray500},children:a.wbsCode})}),(0,jsx_runtime.jsx)(Td,{children:a.activityName}),(0,jsx_runtime.jsx)(Td,{children:(0,jsx_runtime.jsx)(StatusBadge,{status:a.status})}),(0,jsx_runtime.jsxs)(Td,{align:"center",children:[a.originalDuration,"d"]}),(0,jsx_runtime.jsxs)(Td,{align:"center",children:[a.remainingDuration,"d"]}),(0,jsx_runtime.jsx)(Td,{children:formatDate(a.plannedStartDate||a.actualStartDate)}),(0,jsx_runtime.jsx)(Td,{children:formatDate(a.plannedFinishDate||a.actualFinishDate)}),(0,jsx_runtime.jsx)(Td,{align:"center",children:(0,jsx_runtime.jsx)(FloatBadge,{value:a.remainingFloat})}),(0,jsx_runtime.jsxs)(Td,{align:"center",children:[a.percentComplete,"%"]}),(0,jsx_runtime.jsx)(Td,{align:"center",children:a.isCritical?(0,jsx_runtime.jsx)("span",{style:{color:theme_tokens.rf.error,fontWeight:700},children:"●"}):""})]},a.id)),0===filtered.length&&(0,jsx_runtime.jsx)("tr",{children:(0,jsx_runtime.jsx)("td",{colSpan:11,style:{padding:24,textAlign:"center",color:theme_tokens.rf.gray400},children:"No matching activities"})})]})]})})]})},GanttTab=({activities,ganttRange})=>{if(!ganttRange||0===activities.length)return(0,jsx_runtime.jsx)("div",{style:{padding:48,textAlign:"center",color:theme_tokens.rf.gray400},children:"No activities to display in Gantt view."});const{min,totalDays}=ganttRange,today=new Date,todayOffset=Math.max(0,Math.min(100,(today.getTime()-min.getTime())/864e5/totalDays*100)),visible=activities.slice(0,50);return(0,jsx_runtime.jsxs)("div",{style:{overflowX:"auto"},children:[(0,jsx_runtime.jsxs)("div",{style:{fontSize:12,color:theme_tokens.rf.gray500,marginBottom:8},children:["Showing ",visible.length," of ",activities.length," activities"]}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",minWidth:900},children:[(0,jsx_runtime.jsxs)("div",{style:{width:240,flexShrink:0,borderRight:`1px solid ${theme_tokens.rf.gray200}`},children:[(0,jsx_runtime.jsx)("div",{style:{height:32,padding:"0 8px",display:"flex",alignItems:"center",fontSize:11,fontWeight:600,color:theme_tokens.rf.gray600,borderBottom:`2px solid ${theme_tokens.rf.gray200}`},children:"Activity"}),visible.map(a=>(0,jsx_runtime.jsx)("div",{style:{height:28,padding:"0 8px",display:"flex",alignItems:"center",fontSize:11,borderBottom:`1px solid ${theme_tokens.rf.gray100}`,backgroundColor:a.isCritical?"#FEF2F2":void 0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:a.activityName,children:a.taskCode},a.id))]}),(0,jsx_runtime.jsxs)("div",{style:{flex:1,position:"relative"},children:[(0,jsx_runtime.jsx)("div",{style:{height:32,borderBottom:`2px solid ${theme_tokens.rf.gray200}`,position:"relative"},children:(0,jsx_runtime.jsx)(GanttMonthHeaders,{min,totalDays})}),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:0,bottom:0,left:`${todayOffset}%`,width:1,backgroundColor:theme_tokens.rf.error,zIndex:2}}),visible.map(a=>{const startStr=a.plannedStartDate||a.actualStartDate,endStr=a.plannedFinishDate||a.actualFinishDate;if(!startStr||!endStr)return(0,jsx_runtime.jsx)("div",{style:{height:28,borderBottom:`1px solid ${theme_tokens.rf.gray100}`}},a.id);const startDate=new Date(startStr),endDate=new Date(endStr),leftPct=(startDate.getTime()-min.getTime())/864e5/totalDays*100,widthPct=Math.max(.5,(endDate.getTime()-startDate.getTime())/864e5/totalDays*100);return(0,jsx_runtime.jsx)("div",{style:{height:28,borderBottom:`1px solid ${theme_tokens.rf.gray100}`,position:"relative",backgroundColor:a.isCritical?"#FEF2F2":void 0},children:(0,jsx_runtime.jsx)("div",{title:`${a.activityName} (${a.originalDuration}d)`,style:{position:"absolute",top:5,left:`${Math.max(0,leftPct)}%`,width:`${Math.min(widthPct,100-Math.max(0,leftPct))}%`,height:18,borderRadius:3,backgroundColor:a.isCritical?theme_tokens.rf.error:SchedulePage_STATUS_COLORS[a.status],opacity:.85}})},a.id)})]})]})]})},GanttMonthHeaders=({min,totalDays})=>{const months=[],d=new Date(min.getFullYear(),min.getMonth(),1),endMs=min.getTime()+864e5*totalDays;for(;d.getTime()<endMs;){const offset=(d.getTime()-min.getTime())/864e5;months.push({label:d.toLocaleDateString("en-US",{month:"short",year:"2-digit"}),leftPct:offset/totalDays*100}),d.setMonth(d.getMonth()+1)}return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:months.map((m,i)=>(0,jsx_runtime.jsx)("div",{style:{position:"absolute",left:`${Math.max(0,m.leftPct)}%`,top:0,height:"100%",display:"flex",alignItems:"center",fontSize:10,color:theme_tokens.rf.gray500,paddingLeft:4,borderLeft:`1px solid ${theme_tokens.rf.gray200}`},children:m.label},i))})},CriticalPathTab=({criticalActivities})=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(ProjectScheduleCriticalPath,{}),criticalActivities.length>0&&(0,jsx_runtime.jsxs)("div",{style:Object.assign(Object.assign({},SchedulePage_cardStyle),{marginTop:24}),children:[(0,jsx_runtime.jsxs)("div",{style:{fontSize:14,fontWeight:600,color:theme_tokens.rf.navy,marginBottom:12},children:["Critical Activities (",criticalActivities.length,")"]}),(0,jsx_runtime.jsx)("div",{style:{overflowX:"auto"},children:(0,jsx_runtime.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[(0,jsx_runtime.jsx)("thead",{children:(0,jsx_runtime.jsxs)("tr",{style:{borderBottom:`2px solid ${theme_tokens.rf.gray200}`},children:[(0,jsx_runtime.jsx)(Th,{children:"Activity ID"}),(0,jsx_runtime.jsx)(Th,{children:"Name"}),(0,jsx_runtime.jsx)(Th,{children:"Status"}),(0,jsx_runtime.jsx)(Th,{align:"center",children:"Duration"}),(0,jsx_runtime.jsx)(Th,{children:"Start"}),(0,jsx_runtime.jsx)(Th,{children:"Finish"}),(0,jsx_runtime.jsx)(Th,{align:"center",children:"Float"})]})}),(0,jsx_runtime.jsx)("tbody",{children:criticalActivities.map(a=>(0,jsx_runtime.jsxs)("tr",{style:{borderBottom:`1px solid ${theme_tokens.rf.gray100}`,backgroundColor:"#FEF2F2"},children:[(0,jsx_runtime.jsx)(Td,{bold:!0,children:a.taskCode}),(0,jsx_runtime.jsx)(Td,{children:a.activityName}),(0,jsx_runtime.jsx)(Td,{children:(0,jsx_runtime.jsx)(StatusBadge,{status:a.status})}),(0,jsx_runtime.jsxs)(Td,{align:"center",children:[a.originalDuration,"d"]}),(0,jsx_runtime.jsx)(Td,{children:formatDate(a.plannedStartDate||a.actualStartDate)}),(0,jsx_runtime.jsx)(Td,{children:formatDate(a.plannedFinishDate||a.actualFinishDate)}),(0,jsx_runtime.jsx)(Td,{align:"center",children:(0,jsx_runtime.jsx)(FloatBadge,{value:a.remainingFloat})})]},a.id))})]})})]})]}),ImportTab=({imports,onOpenImport})=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{style:{marginBottom:24},children:(0,jsx_runtime.jsx)("button",{onClick:onOpenImport,style:btnPrimary,children:"Upload Schedule File"})}),imports.length>0&&(0,jsx_runtime.jsxs)("div",{style:SchedulePage_cardStyle,children:[(0,jsx_runtime.jsx)("div",{style:{fontSize:14,fontWeight:600,color:theme_tokens.rf.navy,marginBottom:12},children:"Import History"}),(0,jsx_runtime.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[(0,jsx_runtime.jsx)("thead",{children:(0,jsx_runtime.jsxs)("tr",{style:{borderBottom:`2px solid ${theme_tokens.rf.gray200}`},children:[(0,jsx_runtime.jsx)(Th,{children:"Date"}),(0,jsx_runtime.jsx)(Th,{children:"File"}),(0,jsx_runtime.jsx)(Th,{children:"Format"}),(0,jsx_runtime.jsx)(Th,{align:"center",children:"Activities"}),(0,jsx_runtime.jsx)(Th,{children:"Imported By"}),(0,jsx_runtime.jsx)(Th,{children:"Notes"})]})}),(0,jsx_runtime.jsx)("tbody",{children:imports.map(imp=>(0,jsx_runtime.jsxs)("tr",{style:{borderBottom:`1px solid ${theme_tokens.rf.gray100}`},children:[(0,jsx_runtime.jsx)(Td,{children:new Date(imp.importDate).toLocaleDateString()}),(0,jsx_runtime.jsx)(Td,{bold:!0,children:imp.fileName}),(0,jsx_runtime.jsx)(Td,{children:imp.format}),(0,jsx_runtime.jsx)(Td,{align:"center",children:imp.activityCount}),(0,jsx_runtime.jsx)(Td,{children:imp.importedBy}),(0,jsx_runtime.jsx)(Td,{children:(0,jsx_runtime.jsx)("span",{style:{fontSize:12,color:theme_tokens.rf.gray500},children:imp.notes||"-"})})]},imp.id))})]})]}),0===imports.length&&(0,jsx_runtime.jsx)("div",{style:{padding:32,textAlign:"center",color:theme_tokens.rf.gray400,fontSize:13},children:"No imports yet. Upload a schedule file (CSV, XER, or XML) to get started."})]}),MetricCard=({label,value,color,subtitle})=>(0,jsx_runtime.jsxs)("div",{style:Object.assign(Object.assign(Object.assign({},SchedulePage_cardStyle),{padding:20}),theme_tokens.EP.style(color)),children:[(0,jsx_runtime.jsx)("div",{style:{fontSize:12,fontWeight:500,color:theme_tokens.rf.gray500,marginBottom:4},children:label}),(0,jsx_runtime.jsx)("div",{style:{fontSize:22,fontWeight:700,color},children:value}),subtitle&&(0,jsx_runtime.jsx)("div",{style:{fontSize:11,color:theme_tokens.rf.gray400,marginTop:2},children:subtitle})]}),Th=({children,align})=>(0,jsx_runtime.jsx)("th",{style:{padding:"10px 8px",textAlign:align||"left",fontWeight:600,fontSize:11,color:theme_tokens.rf.gray600,textTransform:"uppercase",letterSpacing:"0.3px",whiteSpace:"nowrap"},children}),ThSort=({children,field,current,dir,onSort})=>{const ariaSort=current===field?"asc"===dir?"ascending":"descending":"none";return(0,jsx_runtime.jsxs)("th",{onClick:()=>onSort(field),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),onSort(field))},tabIndex:0,"aria-sort":ariaSort,style:{padding:"10px 8px",textAlign:"left",fontWeight:600,fontSize:11,color:theme_tokens.rf.gray600,textTransform:"uppercase",letterSpacing:"0.3px",whiteSpace:"nowrap",cursor:"pointer",userSelect:"none"},children:[children," ",current===field?"asc"===dir?"▲":"▼":""]})},Td=({children,align,bold})=>(0,jsx_runtime.jsx)("td",{style:{padding:"8px 8px",textAlign:align||"left",fontWeight:bold?600:400,whiteSpace:"nowrap",verticalAlign:"middle"},children}),StatusBadge=({status})=>(0,jsx_runtime.jsx)("span",{style:{padding:"2px 8px",borderRadius:12,fontSize:11,fontWeight:600,backgroundColor:`${SchedulePage_STATUS_COLORS[status]}20`,color:SchedulePage_STATUS_COLORS[status]},children:status}),FloatBadge=({value})=>{if(null===value)return(0,jsx_runtime.jsx)("span",{style:{color:theme_tokens.rf.gray400},children:"-"});const color=value<0?theme_tokens.rf.error:0===value?theme_tokens.rf.warning:value<=10?"#D97706":theme_tokens.rf.success;return(0,jsx_runtime.jsxs)("span",{style:{fontWeight:600,color},children:[value,"d"]})},formatDate=d=>d?new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"}):"-",SchedulePage_cardStyle={backgroundColor:"#fff",borderRadius:8,border:`1px solid ${theme_tokens.rf.gray200}`,padding:20,marginBottom:16,boxShadow:theme_tokens.sp.level1},inputStyle={padding:"8px 12px",border:`1px solid ${theme_tokens.rf.gray300}`,borderRadius:6,fontSize:14,outline:"none",width:"100%",boxSizing:"border-box"},btnPrimary={padding:"8px 20px",backgroundColor:theme_tokens.rf.orange,color:"#fff",border:"none",borderRadius:6,fontWeight:600,fontSize:14,cursor:"pointer"};try{SchedulePage.displayName="SchedulePage",SchedulePage.__docgenInfo={description:"",displayName:"SchedulePage",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/pages/project/SchedulePage.tsx#SchedulePage"]={docgenInfo:SchedulePage.__docgenInfo,name:"SchedulePage",path:"src/webparts/hbcProjectControls/components/pages/project/SchedulePage.tsx#SchedulePage"})}catch(__react_docgen_typescript_loader_error){}const SchedulePage_stories={title:"Pages/SchedulePage",component:SchedulePage,tags:["autodocs"],parameters:{layout:"fullscreen"}},Overview={parameters:{initialRoute:"/operations/schedule"}},SchedulePage_stories_GanttTab={parameters:{initialRoute:"/operations/schedule?tab=gantt"}},__namedExportsOrder=["Overview","GanttTab"];Overview.parameters={...Overview.parameters,docs:{...Overview.parameters?.docs,source:{originalSource:"{\n  parameters: {\n    initialRoute: '/operations/schedule'\n  }\n}",...Overview.parameters?.docs?.source}}},SchedulePage_stories_GanttTab.parameters={...SchedulePage_stories_GanttTab.parameters,docs:{...SchedulePage_stories_GanttTab.parameters?.docs,source:{originalSource:"{\n  parameters: {\n    initialRoute: '/operations/schedule?tab=gantt'\n  }\n}",...SchedulePage_stories_GanttTab.parameters?.docs?.source}}}},"./src/webparts/hbcProjectControls/components/contexts/SignalRContext.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$:()=>useSignalRContext});__webpack_require__("./node_modules/react/jsx-runtime.js");var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js");__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/AppContext.tsx"),__webpack_require__("./packages/hbc-sp-services/src/index.ts");const SignalRContext=react__WEBPACK_IMPORTED_MODULE_1__.createContext({connectionStatus:"disconnected",isEnabled:!1,subscribe:()=>()=>{},broadcastChange:()=>{}}),useSignalRContext=()=>react__WEBPACK_IMPORTED_MODULE_1__.useContext(SignalRContext),SignalRProvider=({children})=>{const{isFeatureEnabled,selectedProject}=(void 0)(),isEnabled=isFeatureEnabled("RealTimeUpdates"),[connectionStatus,setConnectionStatus]=(void 0).useState((void 0).status),prevProjectRef=(void 0).useRef(null);(void 0).useEffect(()=>(void 0).onStatusChange(setConnectionStatus),[]),(void 0).useEffect(()=>{isEnabled?(void 0).connect():(void 0).disconnect()},[isEnabled]),(void 0).useEffect(()=>{if(!isEnabled||"connected"!==connectionStatus)return;const prevCode=prevProjectRef.current,newCode=(null==selectedProject?void 0:selectedProject.projectCode)||null;prevCode!==newCode&&(prevCode&&(void 0).leaveGroup(`project:${prevCode.toLowerCase()}`),newCode&&(void 0).joinGroup(`project:${newCode.toLowerCase()}`),prevProjectRef.current=newCode)},[isEnabled,connectionStatus,selectedProject]),(void 0).useEffect(()=>{if(!isEnabled)return;return(void 0).subscribe("EntityChanged",msg=>{if("EntityChanged"!==msg.type)return;const entityMsg=msg;(function entityTypeToCacheKeys(entityType,projectCode){const keys=[],baseKeys={[(void 0).Lead]:[(void 0).LEADS],[(void 0).Scorecard]:[(void 0).SCORECARDS],[(void 0).Estimate]:[(void 0).ESTIMATES,(void 0).KICKOFFS],[(void 0).Project]:[(void 0).PROJECTS,(void 0).ACTIVE_PROJECTS,(void 0).PORTFOLIO_SUMMARY,(void 0).PERSONNEL_WORKLOAD,(void 0).DATA_MART],[(void 0).Meeting]:[(void 0).MEETINGS],[(void 0).ProjectRecord]:[(void 0).MARKETING_RECORDS],[(void 0).Permission]:[(void 0).PERMISSIONS],[(void 0).PermissionTemplate]:[(void 0).TEMPLATES],[(void 0).ProjectTeamAssignment]:[(void 0).PERMISSIONS,(void 0).ASSIGNMENTS,(void 0).ACCESSIBLE_PROJECTS],[(void 0).Config]:[(void 0).CONFIG,(void 0).FEATURE_FLAGS,(void 0).SECTORS],[(void 0).WorkflowDefinition]:[(void 0).WORKFLOWS],[(void 0).AssignmentMapping]:[(void 0).ASSIGNMENTS],[(void 0).Quality]:[(void 0).QUALITY],[(void 0).Safety]:[(void 0).SAFETY],[(void 0).RiskCost]:[(void 0).RISK_COST,(void 0).BUYOUT],[(void 0).Schedule]:[(void 0).SCHEDULE],[(void 0).SuperintendentPlan]:[(void 0).SUPER_PLAN],[(void 0).LessonLearned]:[(void 0).LESSONS],[(void 0).PMP]:[(void 0).PMP],[(void 0).MonthlyReview]:[(void 0).MONTHLY_REVIEW],[(void 0).Checklist]:[(void 0).CHECKLIST],[(void 0).Matrix]:[(void 0).MATRIX],[(void 0).TurnoverAgenda]:[(void 0).TURNOVER]}[entityType];return baseKeys&&(keys.push(...baseKeys),projectCode&&baseKeys.forEach(k=>keys.push(`${k}_${projectCode}`))),keys})(entityMsg.entityType,entityMsg.projectCode).forEach(key=>(void 0).removeByPrefix(key))})},[isEnabled]);const subscribe=(void 0).useCallback((channelKey,callback)=>(void 0).subscribe(channelKey,callback),[]),broadcastChange=(void 0).useCallback(message=>{(void 0).broadcastChange(message).catch(console.warn)},[]),value=(void 0).useMemo(()=>({connectionStatus,isEnabled,subscribe,broadcastChange}),[connectionStatus,isEnabled,subscribe,broadcastChange]);return(void 0)(SignalRContext.Provider,{value,children})};try{SignalRProvider.displayName="SignalRProvider",SignalRProvider.__docgenInfo={description:"",displayName:"SignalRProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/contexts/SignalRContext.tsx#SignalRProvider"]={docgenInfo:SignalRProvider.__docgenInfo,name:"SignalRProvider",path:"src/webparts/hbcProjectControls/components/contexts/SignalRContext.tsx#SignalRProvider"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/components/hooks/router/useTransitionNavigate.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Y:()=>useTransitionNavigate});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_useAppNavigate__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/webparts/hbcProjectControls/components/hooks/router/useAppNavigate.ts");function useTransitionNavigate(){const navigate=(0,_useAppNavigate__WEBPACK_IMPORTED_MODULE_1__.Y)();return react__WEBPACK_IMPORTED_MODULE_0__.useCallback((to,replace=!1)=>{react__WEBPACK_IMPORTED_MODULE_0__.startTransition(()=>{navigate(to,{replace})})},[navigate])}},"./src/webparts/hbcProjectControls/components/hooks/usePersistedState.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{y:()=>usePersistedState});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function usePersistedState(key,defaultValue){const[state,setState]=react__WEBPACK_IMPORTED_MODULE_0__.useState(()=>function readStorage(key,defaultValue){try{const raw=sessionStorage.getItem(`hbc-persist-${key}`);return null!==raw?JSON.parse(raw):defaultValue}catch(_a){return defaultValue}}(key,defaultValue));return react__WEBPACK_IMPORTED_MODULE_0__.useEffect(()=>{!function writeStorage(key,value){try{sessionStorage.setItem(`hbc-persist-${key}`,JSON.stringify(value))}catch(_a){}}(key,state)},[key,state]),[state,setState]}},"./src/webparts/hbcProjectControls/components/hooks/useSignalR.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{k:()=>useSignalR});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_contexts_SignalRContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/webparts/hbcProjectControls/components/contexts/SignalRContext.tsx");function useSignalR(options={}){const{connectionStatus,isEnabled,subscribe}=(0,_contexts_SignalRContext__WEBPACK_IMPORTED_MODULE_1__.$)(),{entityType,projectCode,onEntityChanged,onWorkflowAdvanced}=options,onEntityChangedRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(onEntityChanged),onWorkflowAdvancedRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(onWorkflowAdvanced);return onEntityChangedRef.current=onEntityChanged,onWorkflowAdvancedRef.current=onWorkflowAdvanced,react__WEBPACK_IMPORTED_MODULE_0__.useEffect(()=>{if(!isEnabled||!onEntityChangedRef.current)return;return subscribe("EntityChanged",msg=>{var _a;if("EntityChanged"!==msg.type)return;const entityMsg=msg;entityType&&entityMsg.entityType!==entityType||projectCode&&entityMsg.projectCode!==projectCode||null===(_a=onEntityChangedRef.current)||void 0===_a||_a.call(onEntityChangedRef,entityMsg)})},[isEnabled,subscribe,entityType,projectCode]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect(()=>{if(!isEnabled||!onWorkflowAdvancedRef.current)return;return subscribe("WorkflowAdvanced",msg=>{var _a;if("WorkflowAdvanced"!==msg.type)return;const wfMsg=msg;entityType&&wfMsg.entityType!==entityType||projectCode&&wfMsg.projectCode!==projectCode||null===(_a=onWorkflowAdvancedRef.current)||void 0===_a||_a.call(onWorkflowAdvancedRef,wfMsg)})},[isEnabled,subscribe,entityType,projectCode]),{connectionStatus,isEnabled}}},"./src/webparts/hbcProjectControls/components/shared/Breadcrumb.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Q:()=>Breadcrumb});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_hooks_router_useTransitionNavigate__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/webparts/hbcProjectControls/components/hooks/router/useTransitionNavigate.ts"),_theme_tokens__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");const Breadcrumb=({items})=>{const navigate=(0,_hooks_router_useTransitionNavigate__WEBPACK_IMPORTED_MODULE_2__.Y)();return items.length<=1?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("nav",{"aria-label":"Breadcrumb",style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"13px",flexWrap:"wrap"},children:items.map((item,index)=>{const isLast=index===items.length-1;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:[index>0&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{style:{color:_theme_tokens__WEBPACK_IMPORTED_MODULE_3__.rf.gray400,userSelect:"none"},"aria-hidden":"true",children:"/"}),isLast||!item.path?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{style:{color:_theme_tokens__WEBPACK_IMPORTED_MODULE_3__.rf.gray600,fontWeight:isLast?600:400},children:item.label}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{role:"link",tabIndex:0,onClick:()=>navigate(item.path),onKeyDown:e=>{"Enter"===e.key&&navigate(item.path)},style:{color:_theme_tokens__WEBPACK_IMPORTED_MODULE_3__.rf.info,cursor:"pointer",textDecoration:"none"},onMouseEnter:e=>{e.currentTarget.style.textDecoration="underline"},onMouseLeave:e=>{e.currentTarget.style.textDecoration="none"},children:item.label})]},index)})})};try{Breadcrumb.displayName="Breadcrumb",Breadcrumb.__docgenInfo={description:"",displayName:"Breadcrumb",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"IBreadcrumbItem[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/shared/Breadcrumb.tsx#Breadcrumb"]={docgenInfo:Breadcrumb.__docgenInfo,name:"Breadcrumb",path:"src/webparts/hbcProjectControls/components/shared/Breadcrumb.tsx#Breadcrumb"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/components/shared/HbcEChart.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{D:()=>HbcEChart});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@griffel/react/makeStyles.esm.js"),_fluentui_react_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@fluentui/tokens/lib/tokens.js");const DEFAULT_ANIMATION_duration=600,DEFAULT_ANIMATION_easing="cubicOut",DEFAULT_ANIMATION_durationUpdate=300,DEFAULT_ANIMATION_easingUpdate="cubicOut",useStyles=(0,_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__.n)({container:{position:"relative",width:"100%"},emptyState:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:_fluentui_react_components__WEBPACK_IMPORTED_MODULE_3__.L.colorNeutralBackground2,borderRadius:_fluentui_react_components__WEBPACK_IMPORTED_MODULE_3__.L.borderRadiusMedium,color:_fluentui_react_components__WEBPACK_IMPORTED_MODULE_3__.L.colorNeutralForeground3,fontSize:_fluentui_react_components__WEBPACK_IMPORTED_MODULE_3__.L.fontSizeBase200}}),srOnly={position:"absolute",width:"1px",height:"1px",overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap"},HbcEChart=({option,height=300,width="100%",loading=!1,empty=!1,emptyMessage="No data available",style,notMerge=!1,lazyUpdate=!1,ariaLabel,ariaDescription,onEvents,onChartReady})=>{const styles=useStyles(),chartRef=react__WEBPACK_IMPORTED_MODULE_1__.useRef(null),containerRef=react__WEBPACK_IMPORTED_MODULE_1__.useRef(null),[runtime,setRuntime]=react__WEBPACK_IMPORTED_MODULE_1__.useState(null),descriptionId=react__WEBPACK_IMPORTED_MODULE_1__.useId();react__WEBPACK_IMPORTED_MODULE_1__.useEffect(()=>{let isMounted=!0;return(async()=>{const[echartsReactMod,echartsCoreMod,themeMod]=await Promise.all([__webpack_require__.e(354).then(__webpack_require__.bind(__webpack_require__,"./node_modules/echarts-for-react/esm/index.js")),__webpack_require__.e(354).then(__webpack_require__.bind(__webpack_require__,"./node_modules/echarts/core.js")),__webpack_require__.e(354).then(__webpack_require__.bind(__webpack_require__,"./src/webparts/hbcProjectControls/theme/hbcEChartsTheme.ts"))]);themeMod.registerHbcTheme(),isMounted&&setRuntime({ReactECharts:echartsReactMod.default,echartsCore:echartsCoreMod,animation:{duration:themeMod.HBC_ANIMATION.duration,easing:themeMod.HBC_ANIMATION.easing,durationUpdate:themeMod.HBC_ANIMATION.durationUpdate,easingUpdate:themeMod.HBC_ANIMATION.easingUpdate}})})().catch(err=>{console.error("[HbcEChart] Failed to load ECharts runtime:",err)}),()=>{isMounted=!1}},[]);const mergedOption=react__WEBPACK_IMPORTED_MODULE_1__.useMemo(()=>{var _a,_b,_c,_d;return Object.assign({animation:!0,animationDuration:null!==(_a=null==runtime?void 0:runtime.animation.duration)&&void 0!==_a?_a:DEFAULT_ANIMATION_duration,animationEasing:null!==(_b=null==runtime?void 0:runtime.animation.easing)&&void 0!==_b?_b:DEFAULT_ANIMATION_easing,animationDurationUpdate:null!==(_c=null==runtime?void 0:runtime.animation.durationUpdate)&&void 0!==_c?_c:DEFAULT_ANIMATION_durationUpdate,animationEasingUpdate:null!==(_d=null==runtime?void 0:runtime.animation.easingUpdate)&&void 0!==_d?_d:DEFAULT_ANIMATION_easingUpdate},option)},[option,runtime]);if(react__WEBPACK_IMPORTED_MODULE_1__.useEffect(()=>{if(!containerRef.current)return;const observer=new ResizeObserver(()=>{var _a,_b;const instance=null===(_b=null===(_a=chartRef.current)||void 0===_a?void 0:_a.getEchartsInstance)||void 0===_b?void 0:_b.call(_a);instance&&instance.resize()});return observer.observe(containerRef.current),()=>observer.disconnect()},[]),empty)return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{ref:containerRef,className:styles.emptyState,style:Object.assign({height,width},style),role:"img","aria-label":null!=ariaLabel?ariaLabel:"Empty chart",children:emptyMessage});if(!runtime)return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{ref:containerRef,className:styles.emptyState,style:Object.assign({height,width},style),role:"status","aria-live":"polite",children:"Loading chart..."});const ReactECharts=runtime.ReactECharts;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{ref:containerRef,className:styles.container,style:Object.assign({height,width},style),role:"img","aria-label":ariaLabel,"aria-describedby":ariaDescription?descriptionId:void 0,children:[ariaDescription&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{id:descriptionId,style:srOnly,children:ariaDescription}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ReactECharts,{ref:chartRef,echarts:runtime.echartsCore,option:mergedOption,theme:"hbc",notMerge,lazyUpdate,showLoading:loading,loadingOption:{text:"",color:"#1B2A4A",maskColor:"rgba(255, 255, 255, 0.7)"},opts:{renderer:"canvas",useDirtyRect:!0},onEvents,onChartReady,style:{height:"100%",width:"100%"}})]})};try{HbcEChart.displayName="HbcEChart",HbcEChart.__docgenInfo={description:"",displayName:"HbcEChart",props:{option:{defaultValue:null,description:"The ECharts option object — should be built via useMemo in consuming component",name:"option",required:!0,type:{name:"EChartsOption"}},height:{defaultValue:{value:"300"},description:"Chart height in pixels. Defaults to 300.",name:"height",required:!1,type:{name:"number"}},width:{defaultValue:{value:"100%"},description:"Chart width. Defaults to '100%'.",name:"width",required:!1,type:{name:"string | number"}},loading:{defaultValue:{value:"false"},description:"Shows loading overlay when true",name:"loading",required:!1,type:{name:"boolean"}},empty:{defaultValue:{value:"false"},description:"Shows empty state when true",name:"empty",required:!1,type:{name:"boolean"}},emptyMessage:{defaultValue:{value:"No data available"},description:"Message shown in empty state",name:"emptyMessage",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"Additional container styles",name:"style",required:!1,type:{name:"CSSProperties"}},notMerge:{defaultValue:{value:"false"},description:"When false (default), ECharts merges new options for smooth transitions",name:"notMerge",required:!1,type:{name:"boolean"}},lazyUpdate:{defaultValue:{value:"false"},description:"Defers re-render to the next frame — useful for rapid SignalR updates",name:"lazyUpdate",required:!1,type:{name:"boolean"}},ariaLabel:{defaultValue:null,description:"ARIA label for accessibility (canvas is not screen-reader accessible)",name:"ariaLabel",required:!1,type:{name:"string"}},ariaDescription:{defaultValue:null,description:"ARIA description for screen readers",name:"ariaDescription",required:!1,type:{name:"string"}},onEvents:{defaultValue:null,description:"Event handlers — e.g. { 'click': handler } for drill-down navigation",name:"onEvents",required:!1,type:{name:"Record<string, Function>"}},onChartReady:{defaultValue:null,description:"",name:"onChartReady",required:!1,type:{name:"((instance: EChartsType) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/shared/HbcEChart.tsx#HbcEChart"]={docgenInfo:HbcEChart.__docgenInfo,name:"HbcEChart",path:"src/webparts/hbcProjectControls/components/shared/HbcEChart.tsx#HbcEChart"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/components/shared/PageHeader.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{z:()=>PageHeader});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./node_modules/@griffel/core/index.esm.js")),_fluentui_react_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@griffel/react/makeStyles.esm.js"),_fluentui_react_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@fluentui/tokens/lib/tokens.js"),_theme_tokens__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");const useStyles=(0,_fluentui_react_components__WEBPACK_IMPORTED_MODULE_3__.n)({root:{marginBottom:"24px"},breadcrumbRow:{marginBottom:"8px"},titleRow:Object.assign({display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap"},_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__.Pt.gap("12px")),title:Object.assign(Object.assign({},_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__.Pt.margin("0")),{fontSize:"24px",fontWeight:"700",color:_theme_tokens__WEBPACK_IMPORTED_MODULE_5__.rf.navy}),subtitle:Object.assign(Object.assign({},_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__.Pt.margin("4px","0","0","0")),{fontSize:"14px",color:_fluentui_react_components__WEBPACK_IMPORTED_MODULE_4__.L.colorNeutralForeground3}),actions:Object.assign(Object.assign({display:"flex"},_fluentui_react_components__WEBPACK_IMPORTED_MODULE_2__.Pt.gap("8px")),{alignItems:"center"})}),PageHeader=({title,subtitle,actions,breadcrumb})=>{const styles=useStyles();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:styles.root,children:[breadcrumb&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:styles.breadcrumbRow,children:breadcrumb}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:styles.titleRow,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h1",{className:styles.title,children:title}),subtitle&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:styles.subtitle,children:subtitle})]}),actions&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:styles.actions,children:actions})]})]})};try{PageHeader.displayName="PageHeader",PageHeader.__docgenInfo={description:"",displayName:"PageHeader",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},subtitle:{defaultValue:null,description:"",name:"subtitle",required:!1,type:{name:"string"}},actions:{defaultValue:null,description:"",name:"actions",required:!1,type:{name:"ReactNode"}},breadcrumb:{defaultValue:null,description:"",name:"breadcrumb",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/shared/PageHeader.tsx#PageHeader"]={docgenInfo:PageHeader.__docgenInfo,name:"PageHeader",path:"src/webparts/hbcProjectControls/components/shared/PageHeader.tsx#PageHeader"})}catch(__react_docgen_typescript_loader_error){}},"./src/webparts/hbcProjectControls/components/shared/SkeletonLoader.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{j:()=>SkeletonLoader});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_theme_tokens__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/webparts/hbcProjectControls/theme/tokens.ts");const barStyle={background:`linear-gradient(90deg, ${_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray100} 25%, ${_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray200} 50%, ${_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray100} 75%)`,backgroundSize:"800px 100%",animation:"hbc-shimmer 1.5s infinite linear",borderRadius:"4px"},SkeletonBar=({width="100%",height="14px",style:extra})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"hbc-skeleton-bar",style:Object.assign(Object.assign(Object.assign({},barStyle),{width,height}),extra)});function TableSkeleton({rows=5,columns=5}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"8px",padding:"16px",overflow:"hidden"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{display:"flex",gap:"16px",marginBottom:"16px",paddingBottom:"12px",borderBottom:`2px solid ${_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray200}`},children:Array.from({length:columns}).map((_,i)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:0===i?"30%":`${Math.floor(70/(columns-1))}%`,height:"12px"},i))}),Array.from({length:rows}).map((_,r)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{display:"flex",gap:"16px",padding:"10px 0",borderBottom:`1px solid ${_theme_tokens__WEBPACK_IMPORTED_MODULE_2__.rf.gray100}`},children:Array.from({length:columns}).map((_,i)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:0===i?"30%":`${Math.floor(70/(columns-1))}%`,height:"14px"},i))},r))]})}function KPIGridSkeleton({columns=4}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{display:"grid",gridTemplateColumns:`repeat(${columns}, 1fr)`,gap:"16px"},children:Array.from({length:columns}).map((_,i)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"8px",padding:"20px"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"60%",height:"12px"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"40%",height:"28px",style:{marginTop:"12px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"50%",height:"10px",style:{marginTop:"8px"}})]},i))})}function FormSkeleton({rows=6}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{backgroundColor:"#fff",borderRadius:"8px",padding:"24px"},children:Array.from({length:rows}).map((_,i)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"120px",height:"12px",style:{marginBottom:"8px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"100%",height:"36px"})]},i))})}function CardSkeleton(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"8px",padding:"20px"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"70%",height:"16px"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"100%",height:"14px",style:{marginTop:"12px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"90%",height:"14px",style:{marginTop:"8px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:"40%",height:"14px",style:{marginTop:"8px"}})]})}function TextSkeleton({rows=3}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{children:Array.from({length:rows}).map((_,i)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SkeletonBar,{width:i===rows-1?"60%":"100%",height:"14px",style:{marginBottom:"10px"}},i))})}const SkeletonLoader=({variant,rows,columns,style})=>{react__WEBPACK_IMPORTED_MODULE_1__.useEffect(()=>{!function ensureShimmerStyles(){if("undefined"==typeof document)return;if(document.getElementById("hbc-skeleton-shimmer"))return;const style=document.createElement("style");style.id="hbc-skeleton-shimmer",style.textContent="\n    @keyframes hbc-shimmer {\n      0% { background-position: -400px 0; }\n      100% { background-position: 400px 0; }\n    }\n    @media (prefers-reduced-motion: reduce) {\n      .hbc-skeleton-bar {\n        animation: none !important;\n      }\n    }\n  ",document.head.appendChild(style)}()},[]);const content=(()=>{switch(variant){case"table":default:return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(TableSkeleton,{rows,columns});case"kpi-grid":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(KPIGridSkeleton,{columns});case"form":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(FormSkeleton,{rows});case"card":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(CardSkeleton,{});case"text":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(TextSkeleton,{rows})}})();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style,children:content})};try{SkeletonLoader.displayName="SkeletonLoader",SkeletonLoader.__docgenInfo={description:"",displayName:"SkeletonLoader",props:{variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"enum",value:[{value:'"table"'},{value:'"kpi-grid"'},{value:'"form"'},{value:'"card"'},{value:'"text"'}]}},rows:{defaultValue:null,description:"",name:"rows",required:!1,type:{name:"number"}},columns:{defaultValue:null,description:"",name:"columns",required:!1,type:{name:"number"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/webparts/hbcProjectControls/components/shared/SkeletonLoader.tsx#SkeletonLoader"]={docgenInfo:SkeletonLoader.__docgenInfo,name:"SkeletonLoader",path:"src/webparts/hbcProjectControls/components/shared/SkeletonLoader.tsx#SkeletonLoader"})}catch(__react_docgen_typescript_loader_error){}}}]);